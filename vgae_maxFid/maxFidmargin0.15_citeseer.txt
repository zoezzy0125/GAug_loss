difference_matrix tensor([[0.0000, 0.3832, 0.3834, 0.3832, 0.3837, 0.3827, 0.3839, 0.3831, 0.3836,
         0.3823],
        [0.3832, 0.0000, 0.3834, 0.3834, 0.3837, 0.3827, 0.3839, 0.3837, 0.3836,
         0.3825],
        [0.3834, 0.3834, 0.0000, 0.3835, 0.3840, 0.3826, 0.3841, 0.3836, 0.3838,
         0.3827],
        [0.3832, 0.3834, 0.3835, 0.0000, 0.3839, 0.3830, 0.3841, 0.3838, 0.3835,
         0.3825],
        [0.3837, 0.3837, 0.3840, 0.3839, 0.0000, 0.3831, 0.3847, 0.3836, 0.3837,
         0.3828],
        [0.3827, 0.3827, 0.3826, 0.3830, 0.3831, 0.0000, 0.3836, 0.3831, 0.3829,
         0.3821],
        [0.3839, 0.3839, 0.3841, 0.3841, 0.3847, 0.3836, 0.0000, 0.3843, 0.3848,
         0.3832],
        [0.3831, 0.3837, 0.3836, 0.3838, 0.3836, 0.3831, 0.3843, 0.0000, 0.3837,
         0.3827],
        [0.3836, 0.3836, 0.3838, 0.3835, 0.3837, 0.3829, 0.3848, 0.3837, 0.0000,
         0.3828],
        [0.3823, 0.3825, 0.3827, 0.3825, 0.3828, 0.3821, 0.3832, 0.3827, 0.3828,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.002306571
Epoch  1: train_loss: 12.9369 recon_acc: 0.0636 val_roc: 0.5262 val_ap: 0.5191 f1: 0.6687 time: 1.1769
thresh 1.614486e-05
          test_roc: 0.4927 test_ap: 0.4975 test_f1: 0.6672 test_recon_acc: 0.0051
difference_matrix tensor([[0.0000, 0.3782, 0.3785, 0.3782, 0.3788, 0.3777, 0.3790, 0.3781, 0.3786,
         0.3772],
        [0.3782, 0.0000, 0.3785, 0.3785, 0.3788, 0.3778, 0.3790, 0.3787, 0.3786,
         0.3775],
        [0.3785, 0.3785, 0.0000, 0.3786, 0.3791, 0.3777, 0.3793, 0.3786, 0.3789,
         0.3777],
        [0.3782, 0.3785, 0.3786, 0.0000, 0.3790, 0.3781, 0.3792, 0.3788, 0.3786,
         0.3775],
        [0.3788, 0.3788, 0.3791, 0.3790, 0.0000, 0.3782, 0.3799, 0.3788, 0.3788,
         0.3779],
        [0.3777, 0.3778, 0.3777, 0.3781, 0.3782, 0.0000, 0.3788, 0.3782, 0.3780,
         0.3771],
        [0.3790, 0.3790, 0.3793, 0.3792, 0.3799, 0.3788, 0.0000, 0.3795, 0.3799,
         0.3783],
        [0.3781, 0.3787, 0.3786, 0.3788, 0.3788, 0.3782, 0.3795, 0.0000, 0.3788,
         0.3778],
        [0.3786, 0.3786, 0.3789, 0.3786, 0.3788, 0.3780, 0.3799, 0.3788, 0.0000,
         0.3778],
        [0.3772, 0.3775, 0.3777, 0.3775, 0.3779, 0.3771, 0.3783, 0.3778, 0.3778,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.0027670509
Epoch  2: train_loss: 12.3539 recon_acc: 0.0619 val_roc: 0.5270 val_ap: 0.5198 f1: 0.6687 time: 0.2863
thresh 8.769138e-06
          test_roc: 0.4929 test_ap: 0.4975 test_f1: 0.6672 test_recon_acc: 0.0030
difference_matrix tensor([[0.0000, 0.3721, 0.3724, 0.3721, 0.3728, 0.3716, 0.3730, 0.3720, 0.3725,
         0.3711],
        [0.3721, 0.0000, 0.3724, 0.3723, 0.3728, 0.3716, 0.3729, 0.3726, 0.3725,
         0.3714],
        [0.3724, 0.3724, 0.0000, 0.3725, 0.3731, 0.3716, 0.3733, 0.3725, 0.3728,
         0.3716],
        [0.3721, 0.3723, 0.3725, 0.0000, 0.3730, 0.3719, 0.3732, 0.3727, 0.3725,
         0.3713],
        [0.3728, 0.3728, 0.3731, 0.3730, 0.0000, 0.3722, 0.3740, 0.3728, 0.3729,
         0.3719],
        [0.3716, 0.3716, 0.3716, 0.3719, 0.3722, 0.0000, 0.3727, 0.3721, 0.3718,
         0.3709],
        [0.3730, 0.3729, 0.3733, 0.3732, 0.3740, 0.3727, 0.0000, 0.3735, 0.3739,
         0.3722],
        [0.3720, 0.3726, 0.3725, 0.3727, 0.3728, 0.3721, 0.3735, 0.0000, 0.3727,
         0.3717],
        [0.3725, 0.3725, 0.3728, 0.3725, 0.3729, 0.3718, 0.3739, 0.3727, 0.0000,
         0.3717],
        [0.3711, 0.3714, 0.3716, 0.3713, 0.3719, 0.3709, 0.3722, 0.3717, 0.3717,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.0037918019
Epoch  3: train_loss: 11.7407 recon_acc: 0.0633 val_roc: 0.5283 val_ap: 0.5196 f1: 0.6677 time: 0.2514
thresh 1.7786471e-05
          test_roc: 0.4933 test_ap: 0.4969 test_f1: 0.6676 test_recon_acc: 0.0033
difference_matrix tensor([[0.0000, 0.3645, 0.3648, 0.3645, 0.3654, 0.3640, 0.3656, 0.3644, 0.3649,
         0.3636],
        [0.3645, 0.0000, 0.3648, 0.3647, 0.3654, 0.3640, 0.3655, 0.3650, 0.3649,
         0.3639],
        [0.3648, 0.3648, 0.0000, 0.3649, 0.3657, 0.3640, 0.3659, 0.3650, 0.3652,
         0.3641],
        [0.3645, 0.3647, 0.3649, 0.0000, 0.3655, 0.3643, 0.3657, 0.3651, 0.3649,
         0.3637],
        [0.3654, 0.3654, 0.3657, 0.3655, 0.0000, 0.3648, 0.3667, 0.3654, 0.3654,
         0.3645],
        [0.3640, 0.3640, 0.3640, 0.3643, 0.3648, 0.0000, 0.3653, 0.3645, 0.3643,
         0.3634],
        [0.3656, 0.3655, 0.3659, 0.3657, 0.3667, 0.3653, 0.0000, 0.3661, 0.3665,
         0.3648],
        [0.3644, 0.3650, 0.3650, 0.3651, 0.3654, 0.3645, 0.3661, 0.0000, 0.3652,
         0.3642],
        [0.3649, 0.3649, 0.3652, 0.3649, 0.3654, 0.3643, 0.3665, 0.3652, 0.0000,
         0.3641],
        [0.3636, 0.3639, 0.3641, 0.3637, 0.3645, 0.3634, 0.3648, 0.3642, 0.3641,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.0046361033
Epoch  4: train_loss: 11.0922 recon_acc: 0.0599 val_roc: 0.5293 val_ap: 0.5199 f1: 0.6687 time: 0.2646
thresh 3.0207484e-05
          test_roc: 0.4936 test_ap: 0.4962 test_f1: 0.6676 test_recon_acc: 0.0032
difference_matrix tensor([[0.0000, 0.3554, 0.3557, 0.3553, 0.3563, 0.3548, 0.3565, 0.3553, 0.3558,
         0.3545],
        [0.3554, 0.0000, 0.3556, 0.3555, 0.3562, 0.3548, 0.3563, 0.3558, 0.3557,
         0.3547],
        [0.3557, 0.3556, 0.0000, 0.3556, 0.3566, 0.3548, 0.3568, 0.3558, 0.3561,
         0.3549],
        [0.3553, 0.3555, 0.3556, 0.0000, 0.3564, 0.3551, 0.3566, 0.3558, 0.3557,
         0.3546],
        [0.3563, 0.3562, 0.3566, 0.3564, 0.0000, 0.3557, 0.3577, 0.3563, 0.3564,
         0.3554],
        [0.3548, 0.3548, 0.3548, 0.3551, 0.3557, 0.0000, 0.3562, 0.3553, 0.3551,
         0.3542],
        [0.3565, 0.3563, 0.3568, 0.3566, 0.3577, 0.3562, 0.0000, 0.3570, 0.3574,
         0.3558],
        [0.3553, 0.3558, 0.3558, 0.3558, 0.3563, 0.3553, 0.3570, 0.0000, 0.3560,
         0.3551],
        [0.3558, 0.3557, 0.3561, 0.3557, 0.3564, 0.3551, 0.3574, 0.3560, 0.0000,
         0.3550],
        [0.3545, 0.3547, 0.3549, 0.3546, 0.3554, 0.3542, 0.3558, 0.3551, 0.3550,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.0067351605
Epoch  5: train_loss: 10.4222 recon_acc: 0.0609 val_roc: 0.5296 val_ap: 0.5187 f1: 0.6687 time: 0.2722
thresh 4.7187186e-05
          test_roc: 0.4939 test_ap: 0.4954 test_f1: 0.6676 test_recon_acc: 0.0028
difference_matrix tensor([[0.0000, 0.3442, 0.3445, 0.3442, 0.3453, 0.3437, 0.3455, 0.3442, 0.3447,
         0.3435],
        [0.3442, 0.0000, 0.3444, 0.3443, 0.3451, 0.3437, 0.3452, 0.3446, 0.3446,
         0.3436],
        [0.3445, 0.3444, 0.0000, 0.3444, 0.3455, 0.3437, 0.3457, 0.3447, 0.3449,
         0.3437],
        [0.3442, 0.3443, 0.3444, 0.0000, 0.3453, 0.3439, 0.3455, 0.3447, 0.3445,
         0.3435],
        [0.3453, 0.3451, 0.3455, 0.3453, 0.0000, 0.3446, 0.3467, 0.3453, 0.3453,
         0.3444],
        [0.3437, 0.3437, 0.3437, 0.3439, 0.3446, 0.0000, 0.3451, 0.3442, 0.3439,
         0.3431],
        [0.3455, 0.3452, 0.3457, 0.3455, 0.3467, 0.3451, 0.0000, 0.3460, 0.3464,
         0.3448],
        [0.3442, 0.3446, 0.3447, 0.3447, 0.3453, 0.3442, 0.3460, 0.0000, 0.3449,
         0.3440],
        [0.3447, 0.3446, 0.3449, 0.3445, 0.3453, 0.3439, 0.3464, 0.3449, 0.0000,
         0.3439],
        [0.3435, 0.3436, 0.3437, 0.3435, 0.3444, 0.3431, 0.3448, 0.3440, 0.3439,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.0010831708
Epoch  6: train_loss: 9.7498 recon_acc: 0.0145 val_roc: 0.5308 val_ap: 0.5186 f1: 0.6677 time: 0.2499
thresh 8.1560065e-05
          test_roc: 0.4945 test_ap: 0.4948 test_f1: 0.6676 test_recon_acc: 0.0025
difference_matrix tensor([[0.0000, 0.3309, 0.3311, 0.3308, 0.3319, 0.3304, 0.3322, 0.3308, 0.3313,
         0.3302],
        [0.3309, 0.0000, 0.3310, 0.3309, 0.3318, 0.3304, 0.3320, 0.3312, 0.3312,
         0.3303],
        [0.3311, 0.3310, 0.0000, 0.3309, 0.3321, 0.3303, 0.3323, 0.3312, 0.3314,
         0.3303],
        [0.3308, 0.3309, 0.3309, 0.0000, 0.3318, 0.3305, 0.3322, 0.3312, 0.3311,
         0.3300],
        [0.3319, 0.3318, 0.3321, 0.3318, 0.0000, 0.3313, 0.3334, 0.3319, 0.3320,
         0.3311],
        [0.3304, 0.3304, 0.3303, 0.3305, 0.3313, 0.0000, 0.3318, 0.3308, 0.3306,
         0.3298],
        [0.3322, 0.3320, 0.3323, 0.3322, 0.3334, 0.3318, 0.0000, 0.3326, 0.3330,
         0.3315],
        [0.3308, 0.3312, 0.3312, 0.3312, 0.3319, 0.3308, 0.3326, 0.0000, 0.3315,
         0.3306],
        [0.3313, 0.3312, 0.3314, 0.3311, 0.3320, 0.3306, 0.3330, 0.3315, 0.0000,
         0.3306],
        [0.3302, 0.3303, 0.3303, 0.3300, 0.3311, 0.3298, 0.3315, 0.3306, 0.3306,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.0023581088
Epoch  7: train_loss: 9.0953 recon_acc: 0.0171 val_roc: 0.5321 val_ap: 0.5190 f1: 0.6677 time: 0.2498
thresh 0.0001472049
          test_roc: 0.4953 test_ap: 0.4946 test_f1: 0.6672 test_recon_acc: 0.0023
difference_matrix tensor([[0.0000, 0.3151, 0.3152, 0.3148, 0.3160, 0.3144, 0.3164, 0.3149, 0.3153,
         0.3142],
        [0.3151, 0.0000, 0.3151, 0.3150, 0.3160, 0.3145, 0.3162, 0.3153, 0.3153,
         0.3144],
        [0.3152, 0.3151, 0.0000, 0.3149, 0.3161, 0.3143, 0.3164, 0.3151, 0.3154,
         0.3143],
        [0.3148, 0.3150, 0.3149, 0.0000, 0.3158, 0.3144, 0.3162, 0.3151, 0.3151,
         0.3140],
        [0.3160, 0.3160, 0.3161, 0.3158, 0.0000, 0.3153, 0.3175, 0.3159, 0.3160,
         0.3151],
        [0.3144, 0.3145, 0.3143, 0.3144, 0.3153, 0.0000, 0.3159, 0.3148, 0.3146,
         0.3138],
        [0.3164, 0.3162, 0.3164, 0.3162, 0.3175, 0.3159, 0.0000, 0.3167, 0.3171,
         0.3156],
        [0.3149, 0.3153, 0.3151, 0.3151, 0.3159, 0.3148, 0.3167, 0.0000, 0.3155,
         0.3146],
        [0.3153, 0.3153, 0.3154, 0.3151, 0.3160, 0.3146, 0.3171, 0.3155, 0.0000,
         0.3146],
        [0.3142, 0.3144, 0.3143, 0.3140, 0.3151, 0.3138, 0.3156, 0.3146, 0.3146,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.0050927126
Epoch  8: train_loss: 8.4782 recon_acc: 0.0204 val_roc: 0.5330 val_ap: 0.5178 f1: 0.6677 time: 0.2622
thresh 0.0002766589
          test_roc: 0.4968 test_ap: 0.4948 test_f1: 0.6672 test_recon_acc: 0.0021
difference_matrix tensor([[0.0000, 0.2965, 0.2964, 0.2961, 0.2973, 0.2956, 0.2977, 0.2961, 0.2966,
         0.2954],
        [0.2965, 0.0000, 0.2965, 0.2963, 0.2974, 0.2958, 0.2977, 0.2966, 0.2967,
         0.2957],
        [0.2964, 0.2965, 0.0000, 0.2961, 0.2974, 0.2955, 0.2977, 0.2964, 0.2967,
         0.2954],
        [0.2961, 0.2963, 0.2961, 0.0000, 0.2971, 0.2956, 0.2976, 0.2963, 0.2963,
         0.2952],
        [0.2973, 0.2974, 0.2974, 0.2971, 0.0000, 0.2965, 0.2988, 0.2971, 0.2974,
         0.2963],
        [0.2956, 0.2958, 0.2955, 0.2956, 0.2965, 0.0000, 0.2972, 0.2960, 0.2958,
         0.2950],
        [0.2977, 0.2977, 0.2977, 0.2976, 0.2988, 0.2972, 0.0000, 0.2980, 0.2984,
         0.2968],
        [0.2961, 0.2966, 0.2964, 0.2963, 0.2971, 0.2960, 0.2980, 0.0000, 0.2967,
         0.2957],
        [0.2966, 0.2967, 0.2967, 0.2963, 0.2974, 0.2958, 0.2984, 0.2967, 0.0000,
         0.2958],
        [0.2954, 0.2957, 0.2954, 0.2952, 0.2963, 0.2950, 0.2968, 0.2957, 0.2958,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.010534731
Epoch  9: train_loss: 7.9164 recon_acc: 0.0244 val_roc: 0.5323 val_ap: 0.5165 f1: 0.6677 time: 0.2698
difference_matrix tensor([[0.0000, 0.2751, 0.2749, 0.2746, 0.2758, 0.2741, 0.2763, 0.2746, 0.2751,
         0.2739],
        [0.2751, 0.0000, 0.2751, 0.2749, 0.2760, 0.2744, 0.2764, 0.2752, 0.2754,
         0.2742],
        [0.2749, 0.2751, 0.0000, 0.2747, 0.2759, 0.2740, 0.2763, 0.2749, 0.2753,
         0.2738],
        [0.2746, 0.2749, 0.2747, 0.0000, 0.2756, 0.2741, 0.2762, 0.2748, 0.2749,
         0.2736],
        [0.2758, 0.2760, 0.2759, 0.2756, 0.0000, 0.2751, 0.2775, 0.2757, 0.2760,
         0.2748],
        [0.2741, 0.2744, 0.2740, 0.2741, 0.2751, 0.0000, 0.2757, 0.2744, 0.2744,
         0.2733],
        [0.2763, 0.2764, 0.2763, 0.2762, 0.2775, 0.2757, 0.0000, 0.2766, 0.2771,
         0.2754],
        [0.2746, 0.2752, 0.2749, 0.2748, 0.2757, 0.2744, 0.2766, 0.0000, 0.2753,
         0.2742],
        [0.2751, 0.2754, 0.2753, 0.2749, 0.2760, 0.2744, 0.2771, 0.2753, 0.0000,
         0.2743],
        [0.2739, 0.2742, 0.2738, 0.2736, 0.2748, 0.2733, 0.2754, 0.2742, 0.2743,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.003039031
Epoch 10: train_loss: 7.4232 recon_acc: 0.0044 val_roc: 0.5317 val_ap: 0.5146 f1: 0.6686 time: 0.2518
difference_matrix tensor([[0.0000, 0.2511, 0.2509, 0.2507, 0.2519, 0.2502, 0.2524, 0.2507, 0.2512,
         0.2499],
        [0.2511, 0.0000, 0.2511, 0.2510, 0.2522, 0.2506, 0.2526, 0.2513, 0.2515,
         0.2503],
        [0.2509, 0.2511, 0.0000, 0.2507, 0.2520, 0.2501, 0.2524, 0.2510, 0.2513,
         0.2498],
        [0.2507, 0.2510, 0.2507, 0.0000, 0.2518, 0.2502, 0.2523, 0.2509, 0.2510,
         0.2497],
        [0.2519, 0.2522, 0.2520, 0.2518, 0.0000, 0.2513, 0.2537, 0.2519, 0.2522,
         0.2510],
        [0.2502, 0.2506, 0.2501, 0.2502, 0.2513, 0.0000, 0.2520, 0.2506, 0.2505,
         0.2495],
        [0.2524, 0.2526, 0.2524, 0.2523, 0.2537, 0.2520, 0.0000, 0.2528, 0.2532,
         0.2515],
        [0.2507, 0.2513, 0.2510, 0.2509, 0.2519, 0.2506, 0.2528, 0.0000, 0.2514,
         0.2503],
        [0.2512, 0.2515, 0.2513, 0.2510, 0.2522, 0.2505, 0.2532, 0.2514, 0.0000,
         0.2503],
        [0.2499, 0.2503, 0.2498, 0.2497, 0.2510, 0.2495, 0.2515, 0.2503, 0.2503,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.006067357
Epoch 11: train_loss: 7.0086 recon_acc: 0.0046 val_roc: 0.5317 val_ap: 0.5135 f1: 0.6686 time: 0.2463
difference_matrix tensor([[0.0000, 0.2253, 0.2249, 0.2248, 0.2262, 0.2245, 0.2266, 0.2249, 0.2253,
         0.2241],
        [0.2253, 0.0000, 0.2252, 0.2252, 0.2265, 0.2248, 0.2268, 0.2255, 0.2256,
         0.2245],
        [0.2249, 0.2252, 0.0000, 0.2247, 0.2262, 0.2243, 0.2265, 0.2251, 0.2254,
         0.2240],
        [0.2248, 0.2252, 0.2247, 0.0000, 0.2261, 0.2245, 0.2265, 0.2251, 0.2252,
         0.2239],
        [0.2262, 0.2265, 0.2262, 0.2261, 0.0000, 0.2257, 0.2280, 0.2262, 0.2265,
         0.2253],
        [0.2245, 0.2248, 0.2243, 0.2245, 0.2257, 0.0000, 0.2263, 0.2249, 0.2248,
         0.2238],
        [0.2266, 0.2268, 0.2265, 0.2265, 0.2280, 0.2263, 0.0000, 0.2270, 0.2274,
         0.2257],
        [0.2249, 0.2255, 0.2251, 0.2251, 0.2262, 0.2249, 0.2270, 0.0000, 0.2256,
         0.2245],
        [0.2253, 0.2256, 0.2254, 0.2252, 0.2265, 0.2248, 0.2274, 0.2256, 0.0000,
         0.2246],
        [0.2241, 0.2245, 0.2240, 0.2239, 0.2253, 0.2238, 0.2257, 0.2245, 0.2246,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.011520528
Epoch 12: train_loss: 6.6803 recon_acc: 0.0048 val_roc: 0.5315 val_ap: 0.5125 f1: 0.6686 time: 0.2513
difference_matrix tensor([[0.0000, 0.1983, 0.1979, 0.1978, 0.1993, 0.1976, 0.1996, 0.1980, 0.1984,
         0.1972],
        [0.1983, 0.0000, 0.1982, 0.1982, 0.1996, 0.1980, 0.1999, 0.1985, 0.1987,
         0.1976],
        [0.1979, 0.1982, 0.0000, 0.1978, 0.1993, 0.1975, 0.1995, 0.1981, 0.1985,
         0.1970],
        [0.1978, 0.1982, 0.1978, 0.0000, 0.1992, 0.1977, 0.1996, 0.1981, 0.1983,
         0.1970],
        [0.1993, 0.1996, 0.1993, 0.1992, 0.0000, 0.1990, 0.2011, 0.1994, 0.1997,
         0.1985],
        [0.1976, 0.1980, 0.1975, 0.1977, 0.1990, 0.0000, 0.1994, 0.1981, 0.1981,
         0.1970],
        [0.1996, 0.1999, 0.1995, 0.1996, 0.2011, 0.1994, 0.0000, 0.2000, 0.2004,
         0.1988],
        [0.1980, 0.1985, 0.1981, 0.1981, 0.1994, 0.1981, 0.2000, 0.0000, 0.1987,
         0.1976],
        [0.1984, 0.1987, 0.1985, 0.1983, 0.1997, 0.1981, 0.2004, 0.1987, 0.0000,
         0.1977],
        [0.1972, 0.1976, 0.1970, 0.1970, 0.1985, 0.1970, 0.1988, 0.1976, 0.1977,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.020744799
Epoch 13: train_loss: 6.4406 recon_acc: 0.0051 val_roc: 0.5323 val_ap: 0.5097 f1: 0.6686 time: 0.2339
difference_matrix tensor([[0.0000, 0.1717, 0.1713, 0.1712, 0.1726, 0.1710, 0.1729, 0.1714, 0.1718,
         0.1706],
        [0.1717, 0.0000, 0.1716, 0.1716, 0.1729, 0.1714, 0.1731, 0.1719, 0.1721,
         0.1710],
        [0.1713, 0.1716, 0.0000, 0.1711, 0.1726, 0.1709, 0.1728, 0.1715, 0.1719,
         0.1704],
        [0.1712, 0.1716, 0.1711, 0.0000, 0.1725, 0.1711, 0.1729, 0.1715, 0.1717,
         0.1704],
        [0.1726, 0.1729, 0.1726, 0.1725, 0.0000, 0.1723, 0.1743, 0.1727, 0.1730,
         0.1718],
        [0.1710, 0.1714, 0.1709, 0.1711, 0.1723, 0.0000, 0.1727, 0.1714, 0.1715,
         0.1704],
        [0.1729, 0.1731, 0.1728, 0.1729, 0.1743, 0.1727, 0.0000, 0.1733, 0.1737,
         0.1722],
        [0.1714, 0.1719, 0.1715, 0.1715, 0.1727, 0.1714, 0.1733, 0.0000, 0.1721,
         0.1710],
        [0.1718, 0.1721, 0.1719, 0.1717, 0.1730, 0.1715, 0.1737, 0.1721, 0.0000,
         0.1712],
        [0.1706, 0.1710, 0.1704, 0.1704, 0.1718, 0.1704, 0.1722, 0.1710, 0.1712,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.11439758
Epoch 14: train_loss: 6.2831 recon_acc: 0.0418 val_roc: 0.5326 val_ap: 0.5088 f1: 0.6697 time: 0.5889
difference_matrix tensor([[0.0000, 0.1467, 0.1463, 0.1462, 0.1475, 0.1461, 0.1478, 0.1464, 0.1468,
         0.1457],
        [0.1467, 0.0000, 0.1466, 0.1466, 0.1478, 0.1464, 0.1480, 0.1469, 0.1471,
         0.1460],
        [0.1463, 0.1466, 0.0000, 0.1462, 0.1475, 0.1460, 0.1477, 0.1465, 0.1469,
         0.1455],
        [0.1462, 0.1466, 0.1462, 0.0000, 0.1474, 0.1461, 0.1477, 0.1465, 0.1467,
         0.1455],
        [0.1475, 0.1478, 0.1475, 0.1474, 0.0000, 0.1472, 0.1490, 0.1476, 0.1479,
         0.1468],
        [0.1461, 0.1464, 0.1460, 0.1461, 0.1472, 0.0000, 0.1476, 0.1464, 0.1465,
         0.1455],
        [0.1478, 0.1480, 0.1477, 0.1477, 0.1490, 0.1476, 0.0000, 0.1482, 0.1485,
         0.1471],
        [0.1464, 0.1469, 0.1465, 0.1465, 0.1476, 0.1464, 0.1482, 0.0000, 0.1471,
         0.1460],
        [0.1468, 0.1471, 0.1469, 0.1467, 0.1479, 0.1465, 0.1485, 0.1471, 0.0000,
         0.1462],
        [0.1457, 0.1460, 0.1455, 0.1455, 0.1468, 0.1455, 0.1471, 0.1460, 0.1462,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0031, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.14394103
Epoch 15: train_loss: 6.1994 recon_acc: 0.0419 val_roc: 0.5326 val_ap: 0.5073 f1: 0.6687 time: 0.6847
difference_matrix tensor([[0.0000, 0.1247, 0.1243, 0.1243, 0.1254, 0.1241, 0.1257, 0.1244, 0.1248,
         0.1237],
        [0.1247, 0.0000, 0.1246, 0.1246, 0.1257, 0.1245, 0.1259, 0.1249, 0.1251,
         0.1241],
        [0.1243, 0.1246, 0.0000, 0.1242, 0.1254, 0.1240, 0.1256, 0.1245, 0.1249,
         0.1236],
        [0.1243, 0.1246, 0.1242, 0.0000, 0.1253, 0.1241, 0.1256, 0.1245, 0.1247,
         0.1236],
        [0.1254, 0.1257, 0.1254, 0.1253, 0.0000, 0.1252, 0.1268, 0.1255, 0.1258,
         0.1248],
        [0.1241, 0.1245, 0.1240, 0.1241, 0.1252, 0.0000, 0.1255, 0.1245, 0.1246,
         0.1236],
        [0.1257, 0.1259, 0.1256, 0.1256, 0.1268, 0.1255, 0.0000, 0.1260, 0.1264,
         0.1250],
        [0.1244, 0.1249, 0.1245, 0.1245, 0.1255, 0.1245, 0.1260, 0.0000, 0.1251,
         0.1241],
        [0.1248, 0.1251, 0.1249, 0.1247, 0.1258, 0.1246, 0.1264, 0.1251, 0.0000,
         0.1243],
        [0.1237, 0.1241, 0.1236, 0.1236, 0.1248, 0.1236, 0.1250, 0.1241, 0.1243,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0252, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.07792949
Epoch 16: train_loss: 6.1902 recon_acc: 0.0068 val_roc: 0.5312 val_ap: 0.5053 f1: 0.6686 time: 0.5908
difference_matrix tensor([[0.0000, 0.1063, 0.1060, 0.1059, 0.1069, 0.1058, 0.1072, 0.1061, 0.1064,
         0.1054],
        [0.1063, 0.0000, 0.1063, 0.1063, 0.1073, 0.1062, 0.1075, 0.1065, 0.1068,
         0.1058],
        [0.1060, 0.1063, 0.0000, 0.1059, 0.1070, 0.1058, 0.1071, 0.1062, 0.1065,
         0.1054],
        [0.1059, 0.1063, 0.1059, 0.0000, 0.1069, 0.1059, 0.1071, 0.1061, 0.1064,
         0.1053],
        [0.1069, 0.1073, 0.1070, 0.1069, 0.0000, 0.1068, 0.1082, 0.1070, 0.1073,
         0.1063],
        [0.1058, 0.1062, 0.1058, 0.1059, 0.1068, 0.0000, 0.1071, 0.1061, 0.1063,
         0.1054],
        [0.1072, 0.1075, 0.1071, 0.1071, 0.1082, 0.1071, 0.0000, 0.1074, 0.1078,
         0.1066],
        [0.1061, 0.1065, 0.1062, 0.1061, 0.1070, 0.1061, 0.1074, 0.0000, 0.1066,
         0.1057],
        [0.1064, 0.1068, 0.1065, 0.1064, 0.1073, 0.1063, 0.1078, 0.1066, 0.0000,
         0.1059],
        [0.1054, 0.1058, 0.1054, 0.1053, 0.1063, 0.1054, 0.1066, 0.1057, 0.1059,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0435, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.16873673
Epoch 17: train_loss: 6.2148 recon_acc: 0.0267 val_roc: 0.5291 val_ap: 0.5036 f1: 0.6687 time: 0.6513
difference_matrix tensor([[0.0000, 0.0917, 0.0913, 0.0913, 0.0922, 0.0912, 0.0924, 0.0914, 0.0918,
         0.0908],
        [0.0917, 0.0000, 0.0917, 0.0917, 0.0926, 0.0916, 0.0927, 0.0919, 0.0921,
         0.0912],
        [0.0913, 0.0917, 0.0000, 0.0913, 0.0923, 0.0912, 0.0924, 0.0915, 0.0919,
         0.0908],
        [0.0913, 0.0917, 0.0913, 0.0000, 0.0922, 0.0913, 0.0924, 0.0915, 0.0918,
         0.0908],
        [0.0922, 0.0926, 0.0923, 0.0922, 0.0000, 0.0921, 0.0933, 0.0923, 0.0926,
         0.0917],
        [0.0912, 0.0916, 0.0912, 0.0913, 0.0921, 0.0000, 0.0924, 0.0915, 0.0917,
         0.0908],
        [0.0924, 0.0927, 0.0924, 0.0924, 0.0933, 0.0924, 0.0000, 0.0927, 0.0930,
         0.0919],
        [0.0914, 0.0919, 0.0915, 0.0915, 0.0923, 0.0915, 0.0927, 0.0000, 0.0920,
         0.0911],
        [0.0918, 0.0921, 0.0919, 0.0918, 0.0926, 0.0917, 0.0930, 0.0920, 0.0000,
         0.0913],
        [0.0908, 0.0912, 0.0908, 0.0908, 0.0917, 0.0908, 0.0919, 0.0911, 0.0913,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0582, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.19466944
Epoch 18: train_loss: 6.2575 recon_acc: 0.0279 val_roc: 0.5270 val_ap: 0.5025 f1: 0.6687 time: 0.7123
difference_matrix tensor([[0.0000, 0.0806, 0.0803, 0.0802, 0.0810, 0.0801, 0.0812, 0.0803, 0.0806,
         0.0798],
        [0.0806, 0.0000, 0.0806, 0.0806, 0.0814, 0.0805, 0.0815, 0.0807, 0.0810,
         0.0801],
        [0.0803, 0.0806, 0.0000, 0.0802, 0.0811, 0.0801, 0.0812, 0.0804, 0.0807,
         0.0798],
        [0.0802, 0.0806, 0.0802, 0.0000, 0.0810, 0.0802, 0.0812, 0.0804, 0.0807,
         0.0797],
        [0.0810, 0.0814, 0.0811, 0.0810, 0.0000, 0.0809, 0.0820, 0.0811, 0.0814,
         0.0805],
        [0.0801, 0.0805, 0.0801, 0.0802, 0.0809, 0.0000, 0.0811, 0.0804, 0.0806,
         0.0797],
        [0.0812, 0.0815, 0.0812, 0.0812, 0.0820, 0.0811, 0.0000, 0.0814, 0.0817,
         0.0807],
        [0.0803, 0.0807, 0.0804, 0.0804, 0.0811, 0.0804, 0.0814, 0.0000, 0.0808,
         0.0800],
        [0.0806, 0.0810, 0.0807, 0.0807, 0.0814, 0.0806, 0.0817, 0.0808, 0.0000,
         0.0802],
        [0.0798, 0.0801, 0.0798, 0.0797, 0.0805, 0.0797, 0.0807, 0.0800, 0.0802,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0693, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.21512221
Epoch 19: train_loss: 6.3045 recon_acc: 0.0285 val_roc: 0.5266 val_ap: 0.5011 f1: 0.6687 time: 0.5867
difference_matrix tensor([[0.0000, 0.0726, 0.0723, 0.0723, 0.0729, 0.0722, 0.0731, 0.0723, 0.0727,
         0.0718],
        [0.0726, 0.0000, 0.0726, 0.0726, 0.0733, 0.0726, 0.0734, 0.0727, 0.0730,
         0.0722],
        [0.0723, 0.0726, 0.0000, 0.0723, 0.0731, 0.0722, 0.0731, 0.0725, 0.0728,
         0.0718],
        [0.0723, 0.0726, 0.0723, 0.0000, 0.0730, 0.0723, 0.0732, 0.0724, 0.0727,
         0.0718],
        [0.0729, 0.0733, 0.0731, 0.0730, 0.0000, 0.0729, 0.0739, 0.0730, 0.0734,
         0.0725],
        [0.0722, 0.0726, 0.0722, 0.0723, 0.0729, 0.0000, 0.0731, 0.0724, 0.0726,
         0.0718],
        [0.0731, 0.0734, 0.0731, 0.0732, 0.0739, 0.0731, 0.0000, 0.0733, 0.0737,
         0.0727],
        [0.0723, 0.0727, 0.0725, 0.0724, 0.0730, 0.0724, 0.0733, 0.0000, 0.0728,
         0.0720],
        [0.0727, 0.0730, 0.0728, 0.0727, 0.0734, 0.0726, 0.0737, 0.0728, 0.0000,
         0.0723],
        [0.0718, 0.0722, 0.0718, 0.0718, 0.0725, 0.0718, 0.0727, 0.0720, 0.0723,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0773, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.15606949
Epoch 20: train_loss: 6.3438 recon_acc: 0.0073 val_roc: 0.5259 val_ap: 0.4999 f1: 0.6696 time: 0.6556
difference_matrix tensor([[0.0000, 0.0673, 0.0671, 0.0670, 0.0676, 0.0669, 0.0678, 0.0671, 0.0674,
         0.0666],
        [0.0673, 0.0000, 0.0674, 0.0673, 0.0680, 0.0673, 0.0681, 0.0674, 0.0677,
         0.0669],
        [0.0671, 0.0674, 0.0000, 0.0671, 0.0678, 0.0670, 0.0678, 0.0672, 0.0675,
         0.0666],
        [0.0670, 0.0673, 0.0671, 0.0000, 0.0677, 0.0670, 0.0678, 0.0672, 0.0674,
         0.0665],
        [0.0676, 0.0680, 0.0678, 0.0677, 0.0000, 0.0676, 0.0684, 0.0677, 0.0680,
         0.0672],
        [0.0669, 0.0673, 0.0670, 0.0670, 0.0676, 0.0000, 0.0677, 0.0671, 0.0673,
         0.0665],
        [0.0678, 0.0681, 0.0678, 0.0678, 0.0684, 0.0677, 0.0000, 0.0680, 0.0683,
         0.0673],
        [0.0671, 0.0674, 0.0672, 0.0672, 0.0677, 0.0671, 0.0680, 0.0000, 0.0675,
         0.0667],
        [0.0674, 0.0677, 0.0675, 0.0674, 0.0680, 0.0673, 0.0683, 0.0675, 0.0000,
         0.0670],
        [0.0666, 0.0669, 0.0666, 0.0665, 0.0672, 0.0665, 0.0673, 0.0667, 0.0670,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0826, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.16565727
Epoch 21: train_loss: 6.3697 recon_acc: 0.0072 val_roc: 0.5259 val_ap: 0.4992 f1: 0.6696 time: 0.8069
difference_matrix tensor([[0.0000, 0.0643, 0.0641, 0.0640, 0.0646, 0.0639, 0.0647, 0.0640, 0.0644,
         0.0636],
        [0.0643, 0.0000, 0.0644, 0.0644, 0.0649, 0.0642, 0.0650, 0.0644, 0.0647,
         0.0639],
        [0.0641, 0.0644, 0.0000, 0.0641, 0.0647, 0.0640, 0.0648, 0.0642, 0.0645,
         0.0636],
        [0.0640, 0.0644, 0.0641, 0.0000, 0.0646, 0.0640, 0.0648, 0.0642, 0.0644,
         0.0635],
        [0.0646, 0.0649, 0.0647, 0.0646, 0.0000, 0.0645, 0.0654, 0.0647, 0.0650,
         0.0641],
        [0.0639, 0.0642, 0.0640, 0.0640, 0.0645, 0.0000, 0.0647, 0.0641, 0.0643,
         0.0635],
        [0.0647, 0.0650, 0.0648, 0.0648, 0.0654, 0.0647, 0.0000, 0.0649, 0.0652,
         0.0643],
        [0.0640, 0.0644, 0.0642, 0.0642, 0.0647, 0.0641, 0.0649, 0.0000, 0.0645,
         0.0637],
        [0.0644, 0.0647, 0.0645, 0.0644, 0.0650, 0.0643, 0.0652, 0.0645, 0.0000,
         0.0640],
        [0.0636, 0.0639, 0.0636, 0.0635, 0.0641, 0.0635, 0.0643, 0.0637, 0.0640,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0856, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.1701706
Epoch 22: train_loss: 6.3789 recon_acc: 0.0069 val_roc: 0.5253 val_ap: 0.4987 f1: 0.6696 time: 0.8026
difference_matrix tensor([[0.0000, 0.0633, 0.0631, 0.0630, 0.0635, 0.0629, 0.0637, 0.0630, 0.0634,
         0.0625],
        [0.0633, 0.0000, 0.0634, 0.0633, 0.0639, 0.0632, 0.0640, 0.0634, 0.0637,
         0.0628],
        [0.0631, 0.0634, 0.0000, 0.0631, 0.0637, 0.0630, 0.0638, 0.0632, 0.0635,
         0.0626],
        [0.0630, 0.0633, 0.0631, 0.0000, 0.0636, 0.0630, 0.0638, 0.0631, 0.0634,
         0.0625],
        [0.0635, 0.0639, 0.0637, 0.0636, 0.0000, 0.0635, 0.0643, 0.0636, 0.0639,
         0.0631],
        [0.0629, 0.0632, 0.0630, 0.0630, 0.0635, 0.0000, 0.0636, 0.0630, 0.0632,
         0.0624],
        [0.0637, 0.0640, 0.0638, 0.0638, 0.0643, 0.0636, 0.0000, 0.0638, 0.0642,
         0.0632],
        [0.0630, 0.0634, 0.0632, 0.0631, 0.0636, 0.0630, 0.0638, 0.0000, 0.0635,
         0.0627],
        [0.0634, 0.0637, 0.0635, 0.0634, 0.0639, 0.0632, 0.0642, 0.0635, 0.0000,
         0.0629],
        [0.0625, 0.0628, 0.0626, 0.0625, 0.0631, 0.0624, 0.0632, 0.0627, 0.0629,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0867, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.17012599
Epoch 23: train_loss: 6.3705 recon_acc: 0.0066 val_roc: 0.5246 val_ap: 0.4980 f1: 0.6696 time: 0.7712
difference_matrix tensor([[0.0000, 0.0640, 0.0638, 0.0638, 0.0642, 0.0636, 0.0644, 0.0637, 0.0641,
         0.0632],
        [0.0640, 0.0000, 0.0641, 0.0641, 0.0646, 0.0639, 0.0647, 0.0641, 0.0644,
         0.0635],
        [0.0638, 0.0641, 0.0000, 0.0639, 0.0645, 0.0637, 0.0645, 0.0639, 0.0643,
         0.0633],
        [0.0638, 0.0641, 0.0639, 0.0000, 0.0644, 0.0637, 0.0645, 0.0639, 0.0642,
         0.0632],
        [0.0642, 0.0646, 0.0645, 0.0644, 0.0000, 0.0642, 0.0650, 0.0643, 0.0646,
         0.0638],
        [0.0636, 0.0639, 0.0637, 0.0637, 0.0642, 0.0000, 0.0643, 0.0637, 0.0640,
         0.0631],
        [0.0644, 0.0647, 0.0645, 0.0645, 0.0650, 0.0643, 0.0000, 0.0645, 0.0649,
         0.0639],
        [0.0637, 0.0641, 0.0639, 0.0639, 0.0643, 0.0637, 0.0645, 0.0000, 0.0642,
         0.0634],
        [0.0641, 0.0644, 0.0643, 0.0642, 0.0646, 0.0640, 0.0649, 0.0642, 0.0000,
         0.0636],
        [0.0632, 0.0635, 0.0633, 0.0632, 0.0638, 0.0631, 0.0639, 0.0634, 0.0636,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0860, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.23982872
Epoch 24: train_loss: 6.3453 recon_acc: 0.0256 val_roc: 0.5242 val_ap: 0.4969 f1: 0.6706 time: 0.7948
difference_matrix tensor([[0.0000, 0.0664, 0.0662, 0.0661, 0.0666, 0.0659, 0.0668, 0.0661, 0.0665,
         0.0656],
        [0.0664, 0.0000, 0.0665, 0.0665, 0.0670, 0.0663, 0.0671, 0.0665, 0.0668,
         0.0659],
        [0.0662, 0.0665, 0.0000, 0.0663, 0.0669, 0.0661, 0.0669, 0.0663, 0.0667,
         0.0657],
        [0.0661, 0.0665, 0.0663, 0.0000, 0.0667, 0.0661, 0.0669, 0.0663, 0.0666,
         0.0656],
        [0.0666, 0.0670, 0.0669, 0.0667, 0.0000, 0.0665, 0.0674, 0.0667, 0.0670,
         0.0661],
        [0.0659, 0.0663, 0.0661, 0.0661, 0.0665, 0.0000, 0.0667, 0.0661, 0.0663,
         0.0654],
        [0.0668, 0.0671, 0.0669, 0.0669, 0.0674, 0.0667, 0.0000, 0.0669, 0.0673,
         0.0662],
        [0.0661, 0.0665, 0.0663, 0.0663, 0.0667, 0.0661, 0.0669, 0.0000, 0.0665,
         0.0657],
        [0.0665, 0.0668, 0.0667, 0.0666, 0.0670, 0.0663, 0.0673, 0.0665, 0.0000,
         0.0660],
        [0.0656, 0.0659, 0.0657, 0.0656, 0.0661, 0.0654, 0.0662, 0.0657, 0.0660,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0836, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.24700809
Epoch 25: train_loss: 6.3054 recon_acc: 0.0321 val_roc: 0.4919 val_ap: 0.4789 f1: 0.6756 time: 0.7855
difference_matrix tensor([[0.0000, 0.0703, 0.0702, 0.0701, 0.0706, 0.0698, 0.0707, 0.0700, 0.0704,
         0.0694],
        [0.0703, 0.0000, 0.0705, 0.0704, 0.0709, 0.0702, 0.0710, 0.0704, 0.0707,
         0.0698],
        [0.0702, 0.0705, 0.0000, 0.0703, 0.0708, 0.0700, 0.0709, 0.0703, 0.0706,
         0.0696],
        [0.0701, 0.0704, 0.0703, 0.0000, 0.0707, 0.0700, 0.0708, 0.0702, 0.0705,
         0.0695],
        [0.0706, 0.0709, 0.0708, 0.0707, 0.0000, 0.0704, 0.0713, 0.0706, 0.0710,
         0.0700],
        [0.0698, 0.0702, 0.0700, 0.0700, 0.0704, 0.0000, 0.0706, 0.0700, 0.0702,
         0.0693],
        [0.0707, 0.0710, 0.0709, 0.0708, 0.0713, 0.0706, 0.0000, 0.0708, 0.0712,
         0.0701],
        [0.0700, 0.0704, 0.0703, 0.0702, 0.0706, 0.0700, 0.0708, 0.0000, 0.0705,
         0.0696],
        [0.0704, 0.0707, 0.0706, 0.0705, 0.0710, 0.0702, 0.0712, 0.0705, 0.0000,
         0.0698],
        [0.0694, 0.0698, 0.0696, 0.0695, 0.0700, 0.0693, 0.0701, 0.0696, 0.0698,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0797, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.23968273
Epoch 26: train_loss: 6.2528 recon_acc: 0.0322 val_roc: 0.4936 val_ap: 0.4824 f1: 0.6756 time: 0.4075
difference_matrix tensor([[0.0000, 0.0758, 0.0757, 0.0756, 0.0760, 0.0752, 0.0762, 0.0754, 0.0759,
         0.0748],
        [0.0758, 0.0000, 0.0760, 0.0759, 0.0764, 0.0756, 0.0765, 0.0759, 0.0762,
         0.0751],
        [0.0757, 0.0760, 0.0000, 0.0758, 0.0763, 0.0754, 0.0764, 0.0757, 0.0761,
         0.0750],
        [0.0756, 0.0759, 0.0758, 0.0000, 0.0762, 0.0755, 0.0763, 0.0757, 0.0760,
         0.0749],
        [0.0760, 0.0764, 0.0763, 0.0762, 0.0000, 0.0759, 0.0768, 0.0761, 0.0764,
         0.0754],
        [0.0752, 0.0756, 0.0754, 0.0755, 0.0759, 0.0000, 0.0760, 0.0754, 0.0757,
         0.0746],
        [0.0762, 0.0765, 0.0764, 0.0763, 0.0768, 0.0760, 0.0000, 0.0763, 0.0767,
         0.0755],
        [0.0754, 0.0759, 0.0757, 0.0757, 0.0761, 0.0754, 0.0763, 0.0000, 0.0759,
         0.0749],
        [0.0759, 0.0762, 0.0761, 0.0760, 0.0764, 0.0757, 0.0767, 0.0759, 0.0000,
         0.0752],
        [0.0748, 0.0751, 0.0750, 0.0749, 0.0754, 0.0746, 0.0755, 0.0749, 0.0752,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0742, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.21423316
Epoch 27: train_loss: 6.1905 recon_acc: 0.0243 val_roc: 0.5218 val_ap: 0.4948 f1: 0.6706 time: 0.4166
difference_matrix tensor([[0.0000, 0.0827, 0.0826, 0.0825, 0.0830, 0.0821, 0.0831, 0.0824, 0.0828,
         0.0817],
        [0.0827, 0.0000, 0.0830, 0.0829, 0.0834, 0.0825, 0.0835, 0.0828, 0.0832,
         0.0820],
        [0.0826, 0.0830, 0.0000, 0.0828, 0.0833, 0.0824, 0.0833, 0.0827, 0.0831,
         0.0819],
        [0.0825, 0.0829, 0.0828, 0.0000, 0.0832, 0.0824, 0.0833, 0.0826, 0.0830,
         0.0818],
        [0.0830, 0.0834, 0.0833, 0.0832, 0.0000, 0.0828, 0.0838, 0.0830, 0.0834,
         0.0823],
        [0.0821, 0.0825, 0.0824, 0.0824, 0.0828, 0.0000, 0.0829, 0.0823, 0.0826,
         0.0814],
        [0.0831, 0.0835, 0.0833, 0.0833, 0.0838, 0.0829, 0.0000, 0.0832, 0.0837,
         0.0824],
        [0.0824, 0.0828, 0.0827, 0.0826, 0.0830, 0.0823, 0.0832, 0.0000, 0.0829,
         0.0818],
        [0.0828, 0.0832, 0.0831, 0.0830, 0.0834, 0.0826, 0.0837, 0.0829, 0.0000,
         0.0821],
        [0.0817, 0.0820, 0.0819, 0.0818, 0.0823, 0.0814, 0.0824, 0.0818, 0.0821,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0673, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.20369889
Epoch 28: train_loss: 6.1233 recon_acc: 0.0250 val_roc: 0.5210 val_ap: 0.4950 f1: 0.6706 time: 0.6449
difference_matrix tensor([[0.0000, 0.0911, 0.0910, 0.0908, 0.0913, 0.0904, 0.0915, 0.0906, 0.0911,
         0.0899],
        [0.0911, 0.0000, 0.0913, 0.0913, 0.0918, 0.0908, 0.0918, 0.0911, 0.0915,
         0.0903],
        [0.0910, 0.0913, 0.0000, 0.0911, 0.0917, 0.0907, 0.0917, 0.0910, 0.0915,
         0.0902],
        [0.0908, 0.0913, 0.0911, 0.0000, 0.0916, 0.0907, 0.0917, 0.0909, 0.0913,
         0.0900],
        [0.0913, 0.0918, 0.0917, 0.0916, 0.0000, 0.0911, 0.0922, 0.0913, 0.0918,
         0.0905],
        [0.0904, 0.0908, 0.0907, 0.0907, 0.0911, 0.0000, 0.0912, 0.0905, 0.0909,
         0.0896],
        [0.0915, 0.0918, 0.0917, 0.0917, 0.0922, 0.0912, 0.0000, 0.0916, 0.0921,
         0.0907],
        [0.0906, 0.0911, 0.0910, 0.0909, 0.0913, 0.0905, 0.0916, 0.0000, 0.0912,
         0.0900],
        [0.0911, 0.0915, 0.0915, 0.0913, 0.0918, 0.0909, 0.0921, 0.0912, 0.0000,
         0.0904],
        [0.0899, 0.0903, 0.0902, 0.0900, 0.0905, 0.0896, 0.0907, 0.0900, 0.0904,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0590, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.19231239
Epoch 29: train_loss: 6.0550 recon_acc: 0.0261 val_roc: 0.5211 val_ap: 0.4958 f1: 0.6706 time: 0.3015
difference_matrix tensor([[0.0000, 0.1007, 0.1006, 0.1005, 0.1009, 0.1000, 0.1011, 0.1002, 0.1008,
         0.0994],
        [0.1007, 0.0000, 0.1010, 0.1009, 0.1014, 0.1004, 0.1015, 0.1008, 0.1011,
         0.0998],
        [0.1006, 0.1010, 0.0000, 0.1008, 0.1014, 0.1003, 0.1014, 0.1006, 0.1011,
         0.0997],
        [0.1005, 0.1009, 0.1008, 0.0000, 0.1012, 0.1003, 0.1013, 0.1005, 0.1009,
         0.0996],
        [0.1009, 0.1014, 0.1014, 0.1012, 0.0000, 0.1007, 0.1018, 0.1009, 0.1014,
         0.1001],
        [0.1000, 0.1004, 0.1003, 0.1003, 0.1007, 0.0000, 0.1008, 0.1001, 0.1004,
         0.0991],
        [0.1011, 0.1015, 0.1014, 0.1013, 0.1018, 0.1008, 0.0000, 0.1012, 0.1017,
         0.1002],
        [0.1002, 0.1008, 0.1006, 0.1005, 0.1009, 0.1001, 0.1012, 0.0000, 0.1008,
         0.0995],
        [0.1008, 0.1011, 0.1011, 0.1009, 0.1014, 0.1004, 0.1017, 0.1008, 0.0000,
         0.0999],
        [0.0994, 0.0998, 0.0997, 0.0996, 0.1001, 0.0991, 0.1002, 0.0995, 0.0999,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0494, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.17911926
Epoch 30: train_loss: 5.9887 recon_acc: 0.0270 val_roc: 0.5209 val_ap: 0.4959 f1: 0.6706 time: 0.2536
difference_matrix tensor([[0.0000, 0.1114, 0.1113, 0.1111, 0.1116, 0.1106, 0.1118, 0.1109, 0.1114,
         0.1100],
        [0.1114, 0.0000, 0.1117, 0.1116, 0.1121, 0.1110, 0.1122, 0.1114, 0.1118,
         0.1104],
        [0.1113, 0.1117, 0.0000, 0.1115, 0.1121, 0.1109, 0.1121, 0.1113, 0.1118,
         0.1103],
        [0.1111, 0.1116, 0.1115, 0.0000, 0.1119, 0.1109, 0.1120, 0.1112, 0.1116,
         0.1101],
        [0.1116, 0.1121, 0.1121, 0.1119, 0.0000, 0.1113, 0.1126, 0.1116, 0.1121,
         0.1107],
        [0.1106, 0.1110, 0.1109, 0.1109, 0.1113, 0.0000, 0.1114, 0.1107, 0.1111,
         0.1097],
        [0.1118, 0.1122, 0.1121, 0.1120, 0.1126, 0.1114, 0.0000, 0.1119, 0.1124,
         0.1108],
        [0.1109, 0.1114, 0.1113, 0.1112, 0.1116, 0.1107, 0.1119, 0.0000, 0.1114,
         0.1101],
        [0.1114, 0.1118, 0.1118, 0.1116, 0.1121, 0.1111, 0.1124, 0.1114, 0.0000,
         0.1105],
        [0.1100, 0.1104, 0.1103, 0.1101, 0.1107, 0.1097, 0.1108, 0.1101, 0.1105,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0387, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.16364703
Epoch 31: train_loss: 5.9278 recon_acc: 0.0272 val_roc: 0.5203 val_ap: 0.4950 f1: 0.6706 time: 0.2695
difference_matrix tensor([[0.0000, 0.1228, 0.1227, 0.1226, 0.1231, 0.1219, 0.1232, 0.1223, 0.1229,
         0.1213],
        [0.1228, 0.0000, 0.1232, 0.1230, 0.1236, 0.1224, 0.1236, 0.1229, 0.1233,
         0.1217],
        [0.1227, 0.1232, 0.0000, 0.1230, 0.1236, 0.1223, 0.1235, 0.1227, 0.1233,
         0.1217],
        [0.1226, 0.1230, 0.1230, 0.0000, 0.1234, 0.1223, 0.1235, 0.1226, 0.1231,
         0.1215],
        [0.1231, 0.1236, 0.1236, 0.1234, 0.0000, 0.1227, 0.1240, 0.1230, 0.1235,
         0.1220],
        [0.1219, 0.1224, 0.1223, 0.1223, 0.1227, 0.0000, 0.1228, 0.1221, 0.1224,
         0.1210],
        [0.1232, 0.1236, 0.1235, 0.1235, 0.1240, 0.1228, 0.0000, 0.1233, 0.1239,
         0.1222],
        [0.1223, 0.1229, 0.1227, 0.1226, 0.1230, 0.1221, 0.1233, 0.0000, 0.1228,
         0.1214],
        [0.1229, 0.1233, 0.1233, 0.1231, 0.1235, 0.1224, 0.1239, 0.1228, 0.0000,
         0.1218],
        [0.1213, 0.1217, 0.1217, 0.1215, 0.1220, 0.1210, 0.1222, 0.1214, 0.1218,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0273, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.14737192
Epoch 32: train_loss: 5.8752 recon_acc: 0.0270 val_roc: 0.5197 val_ap: 0.4949 f1: 0.6706 time: 0.2496
difference_matrix tensor([[0.0000, 0.1346, 0.1346, 0.1344, 0.1349, 0.1337, 0.1350, 0.1340, 0.1347,
         0.1331],
        [0.1346, 0.0000, 0.1350, 0.1349, 0.1354, 0.1342, 0.1354, 0.1347, 0.1351,
         0.1335],
        [0.1346, 0.1350, 0.0000, 0.1348, 0.1355, 0.1341, 0.1354, 0.1346, 0.1351,
         0.1335],
        [0.1344, 0.1349, 0.1348, 0.0000, 0.1352, 0.1341, 0.1353, 0.1344, 0.1349,
         0.1332],
        [0.1349, 0.1354, 0.1355, 0.1352, 0.0000, 0.1345, 0.1359, 0.1348, 0.1354,
         0.1338],
        [0.1337, 0.1342, 0.1341, 0.1341, 0.1345, 0.0000, 0.1346, 0.1338, 0.1342,
         0.1326],
        [0.1350, 0.1354, 0.1354, 0.1353, 0.1359, 0.1346, 0.0000, 0.1351, 0.1358,
         0.1339],
        [0.1340, 0.1347, 0.1346, 0.1344, 0.1348, 0.1338, 0.1351, 0.0000, 0.1346,
         0.1331],
        [0.1347, 0.1351, 0.1351, 0.1349, 0.1354, 0.1342, 0.1358, 0.1346, 0.0000,
         0.1336],
        [0.1331, 0.1335, 0.1335, 0.1332, 0.1338, 0.1326, 0.1339, 0.1331, 0.1336,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0155, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.132604
Epoch 33: train_loss: 5.8329 recon_acc: 0.0272 val_roc: 0.5199 val_ap: 0.4957 f1: 0.6706 time: 0.2786
difference_matrix tensor([[0.0000, 0.1463, 0.1463, 0.1461, 0.1466, 0.1454, 0.1467, 0.1458, 0.1464,
         0.1447],
        [0.1463, 0.0000, 0.1468, 0.1466, 0.1472, 0.1459, 0.1472, 0.1464, 0.1469,
         0.1451],
        [0.1463, 0.1468, 0.0000, 0.1466, 0.1473, 0.1458, 0.1472, 0.1464, 0.1469,
         0.1452],
        [0.1461, 0.1466, 0.1466, 0.0000, 0.1470, 0.1458, 0.1471, 0.1462, 0.1467,
         0.1449],
        [0.1466, 0.1472, 0.1473, 0.1470, 0.0000, 0.1462, 0.1477, 0.1466, 0.1471,
         0.1455],
        [0.1454, 0.1459, 0.1458, 0.1458, 0.1462, 0.0000, 0.1463, 0.1455, 0.1459,
         0.1443],
        [0.1467, 0.1472, 0.1472, 0.1471, 0.1477, 0.1463, 0.0000, 0.1469, 0.1475,
         0.1456],
        [0.1458, 0.1464, 0.1464, 0.1462, 0.1466, 0.1455, 0.1469, 0.0000, 0.1464,
         0.1448],
        [0.1464, 0.1469, 0.1469, 0.1467, 0.1471, 0.1459, 0.1475, 0.1464, 0.0000,
         0.1453],
        [0.1447, 0.1451, 0.1452, 0.1449, 0.1455, 0.1443, 0.1456, 0.1448, 0.1453,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0037, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.12031039
Epoch 34: train_loss: 5.8010 recon_acc: 0.0281 val_roc: 0.5198 val_ap: 0.4960 f1: 0.6706 time: 0.2760
difference_matrix tensor([[0.0000, 0.1576, 0.1576, 0.1574, 0.1579, 0.1566, 0.1580, 0.1570, 0.1576,
         0.1559],
        [0.1576, 0.0000, 0.1581, 0.1579, 0.1585, 0.1571, 0.1584, 0.1577, 0.1581,
         0.1564],
        [0.1576, 0.1581, 0.0000, 0.1579, 0.1586, 0.1571, 0.1585, 0.1576, 0.1582,
         0.1564],
        [0.1574, 0.1579, 0.1579, 0.0000, 0.1583, 0.1571, 0.1584, 0.1574, 0.1579,
         0.1562],
        [0.1579, 0.1585, 0.1586, 0.1583, 0.0000, 0.1574, 0.1590, 0.1579, 0.1584,
         0.1567],
        [0.1566, 0.1571, 0.1571, 0.1571, 0.1574, 0.0000, 0.1576, 0.1568, 0.1572,
         0.1555],
        [0.1580, 0.1584, 0.1585, 0.1584, 0.1590, 0.1576, 0.0000, 0.1581, 0.1588,
         0.1568],
        [0.1570, 0.1577, 0.1576, 0.1574, 0.1579, 0.1568, 0.1581, 0.0000, 0.1577,
         0.1560],
        [0.1576, 0.1581, 0.1582, 0.1579, 0.1584, 0.1572, 0.1588, 0.1577, 0.0000,
         0.1565],
        [0.1559, 0.1564, 0.1564, 0.1562, 0.1567, 0.1555, 0.1568, 0.1560, 0.1565,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.10995861
Epoch 35: train_loss: 5.7862 recon_acc: 0.0293 val_roc: 0.5205 val_ap: 0.4968 f1: 0.6706 time: 0.2923
difference_matrix tensor([[0.0000, 0.1675, 0.1676, 0.1673, 0.1678, 0.1665, 0.1679, 0.1669, 0.1676,
         0.1658],
        [0.1675, 0.0000, 0.1680, 0.1679, 0.1685, 0.1670, 0.1684, 0.1677, 0.1681,
         0.1662],
        [0.1676, 0.1680, 0.0000, 0.1679, 0.1686, 0.1670, 0.1684, 0.1676, 0.1681,
         0.1663],
        [0.1673, 0.1679, 0.1679, 0.0000, 0.1683, 0.1670, 0.1683, 0.1674, 0.1679,
         0.1661],
        [0.1678, 0.1685, 0.1686, 0.1683, 0.0000, 0.1674, 0.1689, 0.1678, 0.1683,
         0.1666],
        [0.1665, 0.1670, 0.1670, 0.1670, 0.1674, 0.0000, 0.1675, 0.1667, 0.1671,
         0.1653],
        [0.1679, 0.1684, 0.1684, 0.1683, 0.1689, 0.1675, 0.0000, 0.1681, 0.1688,
         0.1667],
        [0.1669, 0.1677, 0.1676, 0.1674, 0.1678, 0.1667, 0.1681, 0.0000, 0.1676,
         0.1659],
        [0.1676, 0.1681, 0.1681, 0.1679, 0.1683, 0.1671, 0.1688, 0.1676, 0.0000,
         0.1664],
        [0.1658, 0.1662, 0.1663, 0.1661, 0.1666, 0.1653, 0.1667, 0.1659, 0.1664,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.10128352
Epoch 36: train_loss: 5.7815 recon_acc: 0.0304 val_roc: 0.5217 val_ap: 0.4983 f1: 0.6706 time: 0.2797
difference_matrix tensor([[0.0000, 0.1759, 0.1759, 0.1756, 0.1762, 0.1748, 0.1762, 0.1752, 0.1759,
         0.1741],
        [0.1759, 0.0000, 0.1764, 0.1762, 0.1768, 0.1753, 0.1767, 0.1760, 0.1764,
         0.1745],
        [0.1759, 0.1764, 0.0000, 0.1762, 0.1770, 0.1753, 0.1767, 0.1759, 0.1765,
         0.1747],
        [0.1756, 0.1762, 0.1762, 0.0000, 0.1766, 0.1753, 0.1766, 0.1757, 0.1762,
         0.1744],
        [0.1762, 0.1768, 0.1770, 0.1766, 0.0000, 0.1757, 0.1772, 0.1761, 0.1766,
         0.1749],
        [0.1748, 0.1753, 0.1753, 0.1753, 0.1757, 0.0000, 0.1758, 0.1750, 0.1754,
         0.1736],
        [0.1762, 0.1767, 0.1767, 0.1766, 0.1772, 0.1758, 0.0000, 0.1764, 0.1771,
         0.1750],
        [0.1752, 0.1760, 0.1759, 0.1757, 0.1761, 0.1750, 0.1764, 0.0000, 0.1759,
         0.1742],
        [0.1759, 0.1764, 0.1765, 0.1762, 0.1766, 0.1754, 0.1771, 0.1759, 0.0000,
         0.1747],
        [0.1741, 0.1746, 0.1747, 0.1744, 0.1749, 0.1736, 0.1750, 0.1742, 0.1747,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.094021775
Epoch 37: train_loss: 5.7794 recon_acc: 0.0311 val_roc: 0.5220 val_ap: 0.4990 f1: 0.6706 time: 0.2874
difference_matrix tensor([[0.0000, 0.1824, 0.1825, 0.1822, 0.1827, 0.1813, 0.1828, 0.1818, 0.1825,
         0.1807],
        [0.1824, 0.0000, 0.1830, 0.1828, 0.1834, 0.1819, 0.1833, 0.1826, 0.1830,
         0.1811],
        [0.1825, 0.1830, 0.0000, 0.1828, 0.1836, 0.1819, 0.1833, 0.1825, 0.1831,
         0.1812],
        [0.1822, 0.1828, 0.1828, 0.0000, 0.1832, 0.1819, 0.1832, 0.1823, 0.1828,
         0.1809],
        [0.1827, 0.1834, 0.1836, 0.1832, 0.0000, 0.1822, 0.1838, 0.1827, 0.1832,
         0.1815],
        [0.1813, 0.1819, 0.1819, 0.1819, 0.1822, 0.0000, 0.1824, 0.1816, 0.1819,
         0.1802],
        [0.1828, 0.1833, 0.1833, 0.1832, 0.1838, 0.1824, 0.0000, 0.1830, 0.1837,
         0.1816],
        [0.1818, 0.1826, 0.1825, 0.1823, 0.1827, 0.1816, 0.1830, 0.0000, 0.1825,
         0.1808],
        [0.1825, 0.1830, 0.1831, 0.1828, 0.1832, 0.1819, 0.1837, 0.1825, 0.0000,
         0.1812],
        [0.1807, 0.1811, 0.1812, 0.1809, 0.1815, 0.1802, 0.1816, 0.1808, 0.1812,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.08796913
Epoch 38: train_loss: 5.7765 recon_acc: 0.0313 val_roc: 0.5228 val_ap: 0.5003 f1: 0.6706 time: 0.3371
difference_matrix tensor([[0.0000, 0.1873, 0.1873, 0.1870, 0.1875, 0.1861, 0.1876, 0.1866, 0.1872,
         0.1855],
        [0.1873, 0.0000, 0.1878, 0.1876, 0.1882, 0.1867, 0.1881, 0.1874, 0.1878,
         0.1859],
        [0.1873, 0.1878, 0.0000, 0.1876, 0.1884, 0.1867, 0.1881, 0.1873, 0.1879,
         0.1861],
        [0.1870, 0.1876, 0.1876, 0.0000, 0.1880, 0.1867, 0.1880, 0.1871, 0.1876,
         0.1857],
        [0.1875, 0.1882, 0.1884, 0.1880, 0.0000, 0.1870, 0.1886, 0.1875, 0.1880,
         0.1863],
        [0.1861, 0.1867, 0.1867, 0.1867, 0.1870, 0.0000, 0.1872, 0.1864, 0.1867,
         0.1850],
        [0.1876, 0.1881, 0.1881, 0.1880, 0.1886, 0.1872, 0.0000, 0.1878, 0.1885,
         0.1864],
        [0.1866, 0.1874, 0.1873, 0.1871, 0.1875, 0.1864, 0.1878, 0.0000, 0.1873,
         0.1856],
        [0.1872, 0.1878, 0.1879, 0.1876, 0.1880, 0.1867, 0.1885, 0.1873, 0.0000,
         0.1860],
        [0.1855, 0.1859, 0.1861, 0.1857, 0.1863, 0.1850, 0.1864, 0.1856, 0.1860,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.08300766
Epoch 39: train_loss: 5.7702 recon_acc: 0.0309 val_roc: 0.5240 val_ap: 0.5022 f1: 0.6706 time: 0.3116
difference_matrix tensor([[0.0000, 0.1903, 0.1904, 0.1901, 0.1906, 0.1892, 0.1907, 0.1897, 0.1903,
         0.1886],
        [0.1903, 0.0000, 0.1909, 0.1907, 0.1913, 0.1898, 0.1912, 0.1905, 0.1908,
         0.1890],
        [0.1904, 0.1909, 0.0000, 0.1907, 0.1915, 0.1898, 0.1912, 0.1904, 0.1909,
         0.1892],
        [0.1901, 0.1907, 0.1907, 0.0000, 0.1911, 0.1898, 0.1911, 0.1902, 0.1906,
         0.1888],
        [0.1906, 0.1913, 0.1915, 0.1911, 0.0000, 0.1901, 0.1917, 0.1906, 0.1910,
         0.1894],
        [0.1892, 0.1898, 0.1898, 0.1898, 0.1901, 0.0000, 0.1903, 0.1895, 0.1898,
         0.1881],
        [0.1907, 0.1912, 0.1912, 0.1911, 0.1917, 0.1903, 0.0000, 0.1909, 0.1916,
         0.1895],
        [0.1897, 0.1905, 0.1904, 0.1902, 0.1906, 0.1895, 0.1909, 0.0000, 0.1903,
         0.1887],
        [0.1903, 0.1908, 0.1909, 0.1906, 0.1910, 0.1898, 0.1916, 0.1903, 0.0000,
         0.1891],
        [0.1886, 0.1890, 0.1892, 0.1888, 0.1894, 0.1881, 0.1895, 0.1887, 0.1891,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.079396136
Epoch 40: train_loss: 5.7593 recon_acc: 0.0304 val_roc: 0.5252 val_ap: 0.5034 f1: 0.6706 time: 0.2737
difference_matrix tensor([[0.0000, 0.1918, 0.1919, 0.1916, 0.1921, 0.1907, 0.1922, 0.1912, 0.1918,
         0.1901],
        [0.1918, 0.0000, 0.1924, 0.1921, 0.1927, 0.1913, 0.1927, 0.1920, 0.1923,
         0.1905],
        [0.1919, 0.1924, 0.0000, 0.1921, 0.1929, 0.1913, 0.1927, 0.1919, 0.1924,
         0.1907],
        [0.1916, 0.1921, 0.1921, 0.0000, 0.1925, 0.1913, 0.1926, 0.1916, 0.1921,
         0.1903],
        [0.1921, 0.1927, 0.1929, 0.1925, 0.0000, 0.1916, 0.1932, 0.1921, 0.1925,
         0.1909],
        [0.1907, 0.1913, 0.1913, 0.1913, 0.1916, 0.0000, 0.1918, 0.1910, 0.1912,
         0.1896],
        [0.1922, 0.1927, 0.1927, 0.1926, 0.1932, 0.1918, 0.0000, 0.1924, 0.1930,
         0.1910],
        [0.1912, 0.1920, 0.1919, 0.1916, 0.1921, 0.1910, 0.1924, 0.0000, 0.1918,
         0.1902],
        [0.1918, 0.1923, 0.1924, 0.1921, 0.1925, 0.1912, 0.1930, 0.1918, 0.0000,
         0.1906],
        [0.1901, 0.1905, 0.1907, 0.1903, 0.1909, 0.1896, 0.1910, 0.1902, 0.1906,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.07753717
Epoch 41: train_loss: 5.7436 recon_acc: 0.0299 val_roc: 0.5269 val_ap: 0.5056 f1: 0.6706 time: 0.2627
difference_matrix tensor([[0.0000, 0.1919, 0.1919, 0.1916, 0.1922, 0.1908, 0.1923, 0.1913, 0.1918,
         0.1902],
        [0.1919, 0.0000, 0.1924, 0.1922, 0.1928, 0.1914, 0.1928, 0.1921, 0.1924,
         0.1906],
        [0.1919, 0.1924, 0.0000, 0.1922, 0.1930, 0.1914, 0.1928, 0.1920, 0.1924,
         0.1907],
        [0.1916, 0.1922, 0.1922, 0.0000, 0.1926, 0.1913, 0.1927, 0.1917, 0.1921,
         0.1904],
        [0.1922, 0.1928, 0.1930, 0.1926, 0.0000, 0.1917, 0.1933, 0.1921, 0.1926,
         0.1910],
        [0.1908, 0.1914, 0.1914, 0.1913, 0.1917, 0.0000, 0.1919, 0.1911, 0.1913,
         0.1897],
        [0.1923, 0.1928, 0.1928, 0.1927, 0.1933, 0.1919, 0.0000, 0.1925, 0.1931,
         0.1911],
        [0.1913, 0.1921, 0.1920, 0.1917, 0.1921, 0.1911, 0.1925, 0.0000, 0.1919,
         0.1903],
        [0.1918, 0.1924, 0.1924, 0.1921, 0.1926, 0.1913, 0.1931, 0.1919, 0.0000,
         0.1907],
        [0.1902, 0.1906, 0.1907, 0.1904, 0.1910, 0.1897, 0.1911, 0.1903, 0.1907,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.07748324
Epoch 42: train_loss: 5.7234 recon_acc: 0.0298 val_roc: 0.5288 val_ap: 0.5075 f1: 0.6706 time: 0.2738
difference_matrix tensor([[0.0000, 0.1908, 0.1908, 0.1905, 0.1910, 0.1897, 0.1912, 0.1901, 0.1907,
         0.1891],
        [0.1908, 0.0000, 0.1913, 0.1911, 0.1917, 0.1902, 0.1916, 0.1909, 0.1912,
         0.1895],
        [0.1908, 0.1913, 0.0000, 0.1910, 0.1918, 0.1902, 0.1917, 0.1908, 0.1913,
         0.1896],
        [0.1905, 0.1911, 0.1910, 0.0000, 0.1914, 0.1902, 0.1916, 0.1906, 0.1910,
         0.1893],
        [0.1910, 0.1917, 0.1918, 0.1914, 0.0000, 0.1905, 0.1922, 0.1910, 0.1914,
         0.1899],
        [0.1897, 0.1902, 0.1902, 0.1902, 0.1905, 0.0000, 0.1908, 0.1900, 0.1902,
         0.1887],
        [0.1912, 0.1916, 0.1917, 0.1916, 0.1922, 0.1908, 0.0000, 0.1914, 0.1920,
         0.1901],
        [0.1901, 0.1909, 0.1908, 0.1906, 0.1910, 0.1900, 0.1914, 0.0000, 0.1907,
         0.1892],
        [0.1907, 0.1912, 0.1913, 0.1910, 0.1914, 0.1902, 0.1920, 0.1907, 0.0000,
         0.1895],
        [0.1891, 0.1895, 0.1896, 0.1893, 0.1899, 0.1887, 0.1901, 0.1892, 0.1895,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.07882315
Epoch 43: train_loss: 5.6998 recon_acc: 0.0299 val_roc: 0.5302 val_ap: 0.5091 f1: 0.6706 time: 0.2793
difference_matrix tensor([[0.0000, 0.1886, 0.1886, 0.1884, 0.1889, 0.1876, 0.1891, 0.1880, 0.1886,
         0.1870],
        [0.1886, 0.0000, 0.1891, 0.1889, 0.1895, 0.1881, 0.1895, 0.1888, 0.1890,
         0.1874],
        [0.1886, 0.1891, 0.0000, 0.1889, 0.1897, 0.1881, 0.1896, 0.1887, 0.1891,
         0.1875],
        [0.1884, 0.1889, 0.1889, 0.0000, 0.1893, 0.1881, 0.1894, 0.1885, 0.1888,
         0.1872],
        [0.1889, 0.1895, 0.1897, 0.1893, 0.0000, 0.1884, 0.1901, 0.1889, 0.1892,
         0.1878],
        [0.1876, 0.1881, 0.1881, 0.1881, 0.1884, 0.0000, 0.1887, 0.1878, 0.1880,
         0.1866],
        [0.1891, 0.1895, 0.1896, 0.1894, 0.1901, 0.1887, 0.0000, 0.1893, 0.1899,
         0.1880],
        [0.1880, 0.1888, 0.1887, 0.1885, 0.1889, 0.1878, 0.1893, 0.0000, 0.1886,
         0.1872],
        [0.1886, 0.1890, 0.1891, 0.1888, 0.1892, 0.1880, 0.1899, 0.1886, 0.0000,
         0.1874],
        [0.1870, 0.1874, 0.1875, 0.1872, 0.1878, 0.1866, 0.1880, 0.1872, 0.1874,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.079435825
Epoch 44: train_loss: 5.6742 recon_acc: 0.0290 val_roc: 0.5317 val_ap: 0.5100 f1: 0.6706 time: 0.2507
difference_matrix tensor([[0.0000, 0.1857, 0.1857, 0.1854, 0.1860, 0.1847, 0.1862, 0.1851, 0.1856,
         0.1841],
        [0.1857, 0.0000, 0.1862, 0.1860, 0.1866, 0.1852, 0.1866, 0.1859, 0.1861,
         0.1845],
        [0.1857, 0.1862, 0.0000, 0.1859, 0.1867, 0.1852, 0.1866, 0.1858, 0.1862,
         0.1846],
        [0.1854, 0.1860, 0.1859, 0.0000, 0.1863, 0.1852, 0.1865, 0.1855, 0.1859,
         0.1843],
        [0.1860, 0.1866, 0.1867, 0.1863, 0.0000, 0.1855, 0.1872, 0.1860, 0.1863,
         0.1849],
        [0.1847, 0.1852, 0.1852, 0.1852, 0.1855, 0.0000, 0.1858, 0.1850, 0.1851,
         0.1837],
        [0.1862, 0.1866, 0.1866, 0.1865, 0.1872, 0.1858, 0.0000, 0.1864, 0.1869,
         0.1851],
        [0.1851, 0.1859, 0.1858, 0.1855, 0.1860, 0.1850, 0.1864, 0.0000, 0.1857,
         0.1843],
        [0.1856, 0.1861, 0.1862, 0.1859, 0.1863, 0.1851, 0.1869, 0.1857, 0.0000,
         0.1845],
        [0.1841, 0.1845, 0.1846, 0.1843, 0.1849, 0.1837, 0.1851, 0.1843, 0.1845,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.0812316
Epoch 45: train_loss: 5.6482 recon_acc: 0.0283 val_roc: 0.5333 val_ap: 0.5116 f1: 0.6706 time: 0.2472
thresh 0.025704505
          test_roc: 0.5004 test_ap: 0.4882 test_f1: 0.6672 test_recon_acc: 0.0040
difference_matrix tensor([[0.0000, 0.1822, 0.1822, 0.1819, 0.1825, 0.1812, 0.1827, 0.1817, 0.1821,
         0.1807],
        [0.1822, 0.0000, 0.1827, 0.1825, 0.1831, 0.1817, 0.1831, 0.1824, 0.1826,
         0.1811],
        [0.1822, 0.1827, 0.0000, 0.1824, 0.1832, 0.1817, 0.1832, 0.1823, 0.1827,
         0.1811],
        [0.1819, 0.1825, 0.1824, 0.0000, 0.1828, 0.1817, 0.1830, 0.1821, 0.1824,
         0.1808],
        [0.1825, 0.1831, 0.1832, 0.1828, 0.0000, 0.1820, 0.1837, 0.1825, 0.1828,
         0.1814],
        [0.1812, 0.1817, 0.1817, 0.1817, 0.1820, 0.0000, 0.1824, 0.1815, 0.1816,
         0.1803],
        [0.1827, 0.1831, 0.1832, 0.1830, 0.1837, 0.1824, 0.0000, 0.1830, 0.1835,
         0.1817],
        [0.1817, 0.1824, 0.1823, 0.1821, 0.1825, 0.1815, 0.1830, 0.0000, 0.1822,
         0.1808],
        [0.1821, 0.1826, 0.1827, 0.1824, 0.1828, 0.1816, 0.1835, 0.1822, 0.0000,
         0.1811],
        [0.1807, 0.1811, 0.1811, 0.1808, 0.1814, 0.1803, 0.1817, 0.1808, 0.1811,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.0841312
Epoch 46: train_loss: 5.6226 recon_acc: 0.0281 val_roc: 0.5353 val_ap: 0.5132 f1: 0.6706 time: 0.2900
thresh 0.025918534
          test_roc: 0.5013 test_ap: 0.4891 test_f1: 0.6672 test_recon_acc: 0.0036
difference_matrix tensor([[0.0000, 0.1784, 0.1784, 0.1781, 0.1786, 0.1774, 0.1789, 0.1778, 0.1783,
         0.1769],
        [0.1784, 0.0000, 0.1788, 0.1786, 0.1792, 0.1779, 0.1793, 0.1786, 0.1787,
         0.1773],
        [0.1784, 0.1788, 0.0000, 0.1785, 0.1793, 0.1779, 0.1793, 0.1784, 0.1788,
         0.1773],
        [0.1781, 0.1786, 0.1785, 0.0000, 0.1789, 0.1778, 0.1792, 0.1782, 0.1785,
         0.1770],
        [0.1786, 0.1792, 0.1793, 0.1789, 0.0000, 0.1781, 0.1798, 0.1787, 0.1789,
         0.1776],
        [0.1774, 0.1779, 0.1779, 0.1778, 0.1781, 0.0000, 0.1785, 0.1777, 0.1778,
         0.1765],
        [0.1789, 0.1793, 0.1793, 0.1792, 0.1798, 0.1785, 0.0000, 0.1791, 0.1796,
         0.1779],
        [0.1778, 0.1786, 0.1784, 0.1782, 0.1787, 0.1777, 0.1791, 0.0000, 0.1783,
         0.1770],
        [0.1783, 0.1787, 0.1788, 0.1785, 0.1789, 0.1778, 0.1796, 0.1783, 0.0000,
         0.1772],
        [0.1769, 0.1773, 0.1773, 0.1770, 0.1776, 0.1765, 0.1779, 0.1770, 0.1772,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.087604344
Epoch 47: train_loss: 5.5984 recon_acc: 0.0279 val_roc: 0.5362 val_ap: 0.5142 f1: 0.6696 time: 0.3000
thresh 0.026438266
          test_roc: 0.5023 test_ap: 0.4901 test_f1: 0.6672 test_recon_acc: 0.0033
difference_matrix tensor([[0.0000, 0.1743, 0.1743, 0.1740, 0.1745, 0.1734, 0.1749, 0.1738, 0.1742,
         0.1729],
        [0.1743, 0.0000, 0.1747, 0.1745, 0.1751, 0.1739, 0.1753, 0.1745, 0.1747,
         0.1733],
        [0.1743, 0.1747, 0.0000, 0.1744, 0.1753, 0.1738, 0.1752, 0.1744, 0.1747,
         0.1732],
        [0.1740, 0.1745, 0.1744, 0.0000, 0.1748, 0.1738, 0.1751, 0.1741, 0.1744,
         0.1729],
        [0.1745, 0.1751, 0.1753, 0.1748, 0.0000, 0.1741, 0.1758, 0.1746, 0.1749,
         0.1735],
        [0.1734, 0.1739, 0.1738, 0.1738, 0.1741, 0.0000, 0.1745, 0.1737, 0.1737,
         0.1725],
        [0.1749, 0.1753, 0.1752, 0.1751, 0.1758, 0.1745, 0.0000, 0.1751, 0.1755,
         0.1738],
        [0.1738, 0.1745, 0.1744, 0.1741, 0.1746, 0.1737, 0.1751, 0.0000, 0.1743,
         0.1730],
        [0.1742, 0.1747, 0.1747, 0.1744, 0.1749, 0.1737, 0.1755, 0.1743, 0.0000,
         0.1732],
        [0.1729, 0.1733, 0.1732, 0.1729, 0.1735, 0.1725, 0.1738, 0.1730, 0.1732,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.09128681
Epoch 48: train_loss: 5.5762 recon_acc: 0.0276 val_roc: 0.5379 val_ap: 0.5162 f1: 0.6696 time: 0.2811
thresh 0.027151907
          test_roc: 0.5034 test_ap: 0.4914 test_f1: 0.6672 test_recon_acc: 0.0030
difference_matrix tensor([[0.0000, 0.1702, 0.1702, 0.1699, 0.1705, 0.1693, 0.1708, 0.1697, 0.1701,
         0.1688],
        [0.1702, 0.0000, 0.1706, 0.1704, 0.1710, 0.1698, 0.1712, 0.1704, 0.1706,
         0.1692],
        [0.1702, 0.1706, 0.0000, 0.1703, 0.1712, 0.1697, 0.1711, 0.1703, 0.1706,
         0.1692],
        [0.1699, 0.1704, 0.1703, 0.0000, 0.1707, 0.1697, 0.1710, 0.1700, 0.1703,
         0.1688],
        [0.1705, 0.1710, 0.1712, 0.1707, 0.0000, 0.1700, 0.1717, 0.1705, 0.1707,
         0.1695],
        [0.1693, 0.1698, 0.1697, 0.1697, 0.1700, 0.0000, 0.1704, 0.1696, 0.1696,
         0.1684],
        [0.1708, 0.1712, 0.1711, 0.1710, 0.1717, 0.1704, 0.0000, 0.1710, 0.1714,
         0.1698],
        [0.1697, 0.1704, 0.1703, 0.1700, 0.1705, 0.1696, 0.1710, 0.0000, 0.1702,
         0.1690],
        [0.1701, 0.1706, 0.1706, 0.1703, 0.1707, 0.1696, 0.1714, 0.1702, 0.0000,
         0.1691],
        [0.1688, 0.1692, 0.1692, 0.1688, 0.1695, 0.1684, 0.1698, 0.1690, 0.1691,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.09797166
Epoch 49: train_loss: 5.5563 recon_acc: 0.0290 val_roc: 0.5397 val_ap: 0.5177 f1: 0.6687 time: 0.2671
thresh 0.027962886
          test_roc: 0.5047 test_ap: 0.4923 test_f1: 0.6672 test_recon_acc: 0.0028
difference_matrix tensor([[0.0000, 0.1663, 0.1662, 0.1659, 0.1665, 0.1654, 0.1668, 0.1658, 0.1661,
         0.1649],
        [0.1663, 0.0000, 0.1666, 0.1664, 0.1670, 0.1658, 0.1672, 0.1665, 0.1666,
         0.1653],
        [0.1662, 0.1666, 0.0000, 0.1663, 0.1672, 0.1658, 0.1672, 0.1663, 0.1666,
         0.1652],
        [0.1659, 0.1664, 0.1663, 0.0000, 0.1667, 0.1657, 0.1670, 0.1661, 0.1663,
         0.1649],
        [0.1665, 0.1670, 0.1672, 0.1667, 0.0000, 0.1661, 0.1677, 0.1666, 0.1668,
         0.1655],
        [0.1654, 0.1658, 0.1658, 0.1657, 0.1661, 0.0000, 0.1665, 0.1657, 0.1657,
         0.1645],
        [0.1668, 0.1672, 0.1672, 0.1670, 0.1677, 0.1665, 0.0000, 0.1671, 0.1674,
         0.1659],
        [0.1658, 0.1665, 0.1663, 0.1661, 0.1666, 0.1657, 0.1671, 0.0000, 0.1662,
         0.1651],
        [0.1661, 0.1666, 0.1666, 0.1663, 0.1668, 0.1657, 0.1674, 0.1662, 0.0000,
         0.1652],
        [0.1649, 0.1653, 0.1652, 0.1649, 0.1655, 0.1645, 0.1659, 0.1651, 0.1652,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.10161141
Epoch 50: train_loss: 5.5385 recon_acc: 0.0287 val_roc: 0.5416 val_ap: 0.5193 f1: 0.6687 time: 0.3062
thresh 0.028939502
          test_roc: 0.5061 test_ap: 0.4935 test_f1: 0.6672 test_recon_acc: 0.0026
difference_matrix tensor([[0.0000, 0.1626, 0.1625, 0.1622, 0.1628, 0.1617, 0.1631, 0.1621, 0.1624,
         0.1612],
        [0.1626, 0.0000, 0.1629, 0.1626, 0.1633, 0.1621, 0.1635, 0.1628, 0.1628,
         0.1616],
        [0.1625, 0.1629, 0.0000, 0.1625, 0.1634, 0.1621, 0.1634, 0.1626, 0.1629,
         0.1615],
        [0.1622, 0.1626, 0.1625, 0.0000, 0.1630, 0.1620, 0.1633, 0.1623, 0.1625,
         0.1612],
        [0.1628, 0.1633, 0.1634, 0.1630, 0.0000, 0.1624, 0.1640, 0.1629, 0.1630,
         0.1619],
        [0.1617, 0.1621, 0.1621, 0.1620, 0.1624, 0.0000, 0.1628, 0.1620, 0.1620,
         0.1609],
        [0.1631, 0.1635, 0.1634, 0.1633, 0.1640, 0.1628, 0.0000, 0.1634, 0.1637,
         0.1622],
        [0.1621, 0.1628, 0.1626, 0.1623, 0.1629, 0.1620, 0.1634, 0.0000, 0.1625,
         0.1614],
        [0.1624, 0.1628, 0.1629, 0.1625, 0.1630, 0.1620, 0.1637, 0.1625, 0.0000,
         0.1615],
        [0.1612, 0.1616, 0.1615, 0.1612, 0.1619, 0.1609, 0.1622, 0.1614, 0.1615,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.105178446
Epoch 51: train_loss: 5.5226 recon_acc: 0.0284 val_roc: 0.5435 val_ap: 0.5211 f1: 0.6687 time: 0.2671
thresh 0.03008306
          test_roc: 0.5074 test_ap: 0.4948 test_f1: 0.6672 test_recon_acc: 0.0025
difference_matrix tensor([[0.0000, 0.1592, 0.1592, 0.1588, 0.1594, 0.1584, 0.1598, 0.1588, 0.1591,
         0.1579],
        [0.1592, 0.0000, 0.1595, 0.1593, 0.1599, 0.1588, 0.1601, 0.1594, 0.1595,
         0.1583],
        [0.1592, 0.1595, 0.0000, 0.1592, 0.1600, 0.1587, 0.1601, 0.1593, 0.1595,
         0.1582],
        [0.1588, 0.1593, 0.1592, 0.0000, 0.1596, 0.1586, 0.1599, 0.1590, 0.1592,
         0.1579],
        [0.1594, 0.1599, 0.1600, 0.1596, 0.0000, 0.1590, 0.1606, 0.1595, 0.1597,
         0.1585],
        [0.1584, 0.1588, 0.1587, 0.1586, 0.1590, 0.0000, 0.1595, 0.1587, 0.1586,
         0.1576],
        [0.1598, 0.1601, 0.1601, 0.1599, 0.1606, 0.1595, 0.0000, 0.1600, 0.1603,
         0.1589],
        [0.1588, 0.1594, 0.1593, 0.1590, 0.1595, 0.1587, 0.1600, 0.0000, 0.1592,
         0.1581],
        [0.1591, 0.1595, 0.1595, 0.1592, 0.1597, 0.1586, 0.1603, 0.1592, 0.0000,
         0.1582],
        [0.1579, 0.1583, 0.1582, 0.1579, 0.1585, 0.1576, 0.1589, 0.1581, 0.1582,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.106525764
Epoch 52: train_loss: 5.5081 recon_acc: 0.0271 val_roc: 0.5453 val_ap: 0.5234 f1: 0.6686 time: 0.2724
thresh 0.03128749
          test_roc: 0.5085 test_ap: 0.4959 test_f1: 0.6672 test_recon_acc: 0.0024
difference_matrix tensor([[0.0000, 0.1563, 0.1562, 0.1559, 0.1565, 0.1555, 0.1568, 0.1559, 0.1561,
         0.1550],
        [0.1563, 0.0000, 0.1566, 0.1563, 0.1570, 0.1559, 0.1572, 0.1565, 0.1566,
         0.1554],
        [0.1562, 0.1566, 0.0000, 0.1562, 0.1571, 0.1558, 0.1571, 0.1564, 0.1566,
         0.1553],
        [0.1559, 0.1563, 0.1562, 0.0000, 0.1567, 0.1557, 0.1570, 0.1561, 0.1562,
         0.1550],
        [0.1565, 0.1570, 0.1571, 0.1567, 0.0000, 0.1561, 0.1577, 0.1566, 0.1567,
         0.1556],
        [0.1555, 0.1559, 0.1558, 0.1557, 0.1561, 0.0000, 0.1566, 0.1558, 0.1557,
         0.1547],
        [0.1568, 0.1572, 0.1571, 0.1570, 0.1577, 0.1566, 0.0000, 0.1571, 0.1574,
         0.1560],
        [0.1559, 0.1565, 0.1564, 0.1561, 0.1566, 0.1558, 0.1571, 0.0000, 0.1563,
         0.1552],
        [0.1561, 0.1566, 0.1566, 0.1562, 0.1567, 0.1557, 0.1574, 0.1563, 0.0000,
         0.1553],
        [0.1550, 0.1554, 0.1553, 0.1550, 0.1556, 0.1547, 0.1560, 0.1552, 0.1553,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.11008636
Epoch 53: train_loss: 5.4945 recon_acc: 0.0273 val_roc: 0.5468 val_ap: 0.5247 f1: 0.6686 time: 0.2682
thresh 0.032524727
          test_roc: 0.5100 test_ap: 0.4974 test_f1: 0.6672 test_recon_acc: 0.0023
difference_matrix tensor([[0.0000, 0.1539, 0.1538, 0.1535, 0.1541, 0.1531, 0.1544, 0.1535, 0.1537,
         0.1527],
        [0.1539, 0.0000, 0.1542, 0.1539, 0.1546, 0.1535, 0.1548, 0.1541, 0.1541,
         0.1530],
        [0.1538, 0.1542, 0.0000, 0.1538, 0.1547, 0.1534, 0.1547, 0.1539, 0.1542,
         0.1529],
        [0.1535, 0.1539, 0.1538, 0.0000, 0.1542, 0.1533, 0.1545, 0.1537, 0.1538,
         0.1526],
        [0.1541, 0.1546, 0.1547, 0.1542, 0.0000, 0.1537, 0.1552, 0.1542, 0.1543,
         0.1533],
        [0.1531, 0.1535, 0.1534, 0.1533, 0.1537, 0.0000, 0.1542, 0.1534, 0.1533,
         0.1523],
        [0.1544, 0.1548, 0.1547, 0.1545, 0.1552, 0.1542, 0.0000, 0.1547, 0.1550,
         0.1536],
        [0.1535, 0.1541, 0.1539, 0.1537, 0.1542, 0.1534, 0.1547, 0.0000, 0.1539,
         0.1529],
        [0.1537, 0.1541, 0.1542, 0.1538, 0.1543, 0.1533, 0.1550, 0.1539, 0.0000,
         0.1529],
        [0.1527, 0.1530, 0.1529, 0.1526, 0.1533, 0.1523, 0.1536, 0.1529, 0.1529,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.11331652
Epoch 54: train_loss: 5.4813 recon_acc: 0.0275 val_roc: 0.5488 val_ap: 0.5263 f1: 0.6696 time: 0.2851
thresh 0.033736136
          test_roc: 0.5116 test_ap: 0.4990 test_f1: 0.6672 test_recon_acc: 0.0023
difference_matrix tensor([[0.0000, 0.1520, 0.1520, 0.1516, 0.1522, 0.1512, 0.1526, 0.1516, 0.1519,
         0.1508],
        [0.1520, 0.0000, 0.1523, 0.1520, 0.1527, 0.1516, 0.1529, 0.1522, 0.1523,
         0.1511],
        [0.1520, 0.1523, 0.0000, 0.1519, 0.1528, 0.1516, 0.1528, 0.1521, 0.1523,
         0.1511],
        [0.1516, 0.1520, 0.1519, 0.0000, 0.1523, 0.1514, 0.1526, 0.1518, 0.1519,
         0.1507],
        [0.1522, 0.1527, 0.1528, 0.1523, 0.0000, 0.1519, 0.1533, 0.1524, 0.1525,
         0.1514],
        [0.1512, 0.1516, 0.1516, 0.1514, 0.1519, 0.0000, 0.1523, 0.1515, 0.1515,
         0.1505],
        [0.1526, 0.1529, 0.1528, 0.1526, 0.1533, 0.1523, 0.0000, 0.1528, 0.1531,
         0.1517],
        [0.1516, 0.1522, 0.1521, 0.1518, 0.1524, 0.1515, 0.1528, 0.0000, 0.1520,
         0.1510],
        [0.1519, 0.1523, 0.1523, 0.1519, 0.1525, 0.1515, 0.1531, 0.1520, 0.0000,
         0.1511],
        [0.1508, 0.1511, 0.1511, 0.1507, 0.1514, 0.1505, 0.1517, 0.1510, 0.1511,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.057888277
Epoch 55: train_loss: 5.4680 recon_acc: 0.0062 val_roc: 0.5507 val_ap: 0.5285 f1: 0.6696 time: 0.2812
thresh 0.03476614
          test_roc: 0.5130 test_ap: 0.5003 test_f1: 0.6672 test_recon_acc: 0.0023
difference_matrix tensor([[0.0000, 0.1507, 0.1507, 0.1503, 0.1509, 0.1499, 0.1512, 0.1503, 0.1506,
         0.1495],
        [0.1507, 0.0000, 0.1510, 0.1507, 0.1514, 0.1503, 0.1516, 0.1509, 0.1510,
         0.1498],
        [0.1507, 0.1510, 0.0000, 0.1506, 0.1515, 0.1503, 0.1515, 0.1508, 0.1510,
         0.1498],
        [0.1503, 0.1507, 0.1506, 0.0000, 0.1510, 0.1501, 0.1513, 0.1505, 0.1506,
         0.1494],
        [0.1509, 0.1514, 0.1515, 0.1510, 0.0000, 0.1506, 0.1520, 0.1511, 0.1511,
         0.1501],
        [0.1499, 0.1503, 0.1503, 0.1501, 0.1506, 0.0000, 0.1510, 0.1502, 0.1502,
         0.1493],
        [0.1512, 0.1516, 0.1515, 0.1513, 0.1520, 0.1510, 0.0000, 0.1515, 0.1518,
         0.1504],
        [0.1503, 0.1509, 0.1508, 0.1505, 0.1511, 0.1502, 0.1515, 0.0000, 0.1507,
         0.1498],
        [0.1506, 0.1510, 0.1510, 0.1506, 0.1511, 0.1502, 0.1518, 0.1507, 0.0000,
         0.1498],
        [0.1495, 0.1498, 0.1498, 0.1494, 0.1501, 0.1493, 0.1504, 0.1498, 0.1498,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(6.0023e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.060417503
Epoch 56: train_loss: 5.4541 recon_acc: 0.0065 val_roc: 0.5521 val_ap: 0.5308 f1: 0.6696 time: 0.2536
thresh 0.03566109
          test_roc: 0.5142 test_ap: 0.5013 test_f1: 0.6672 test_recon_acc: 0.0023
difference_matrix tensor([[0.0000, 0.1500, 0.1500, 0.1496, 0.1502, 0.1493, 0.1505, 0.1497, 0.1499,
         0.1489],
        [0.1500, 0.0000, 0.1503, 0.1500, 0.1507, 0.1496, 0.1509, 0.1502, 0.1503,
         0.1492],
        [0.1500, 0.1503, 0.0000, 0.1499, 0.1508, 0.1496, 0.1508, 0.1501, 0.1503,
         0.1491],
        [0.1496, 0.1500, 0.1499, 0.0000, 0.1503, 0.1494, 0.1506, 0.1498, 0.1499,
         0.1487],
        [0.1502, 0.1507, 0.1508, 0.1503, 0.0000, 0.1499, 0.1513, 0.1504, 0.1504,
         0.1495],
        [0.1493, 0.1496, 0.1496, 0.1494, 0.1499, 0.0000, 0.1503, 0.1496, 0.1495,
         0.1486],
        [0.1505, 0.1509, 0.1508, 0.1506, 0.1513, 0.1503, 0.0000, 0.1508, 0.1511,
         0.1497],
        [0.1497, 0.1502, 0.1501, 0.1498, 0.1504, 0.1496, 0.1508, 0.0000, 0.1500,
         0.1491],
        [0.1499, 0.1503, 0.1503, 0.1499, 0.1504, 0.1495, 0.1511, 0.1500, 0.0000,
         0.1491],
        [0.1489, 0.1492, 0.1491, 0.1487, 0.1495, 0.1486, 0.1497, 0.1491, 0.1491,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0003, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.06257725
Epoch 57: train_loss: 5.4395 recon_acc: 0.0068 val_roc: 0.5539 val_ap: 0.5330 f1: 0.6696 time: 0.2995
thresh 0.036575206
          test_roc: 0.5156 test_ap: 0.5025 test_f1: 0.6672 test_recon_acc: 0.0023
difference_matrix tensor([[0.0000, 0.1501, 0.1501, 0.1497, 0.1503, 0.1494, 0.1506, 0.1498, 0.1500,
         0.1490],
        [0.1501, 0.0000, 0.1504, 0.1501, 0.1508, 0.1497, 0.1509, 0.1503, 0.1504,
         0.1493],
        [0.1501, 0.1504, 0.0000, 0.1499, 0.1509, 0.1497, 0.1508, 0.1502, 0.1504,
         0.1492],
        [0.1497, 0.1501, 0.1499, 0.0000, 0.1504, 0.1495, 0.1507, 0.1498, 0.1500,
         0.1488],
        [0.1503, 0.1508, 0.1509, 0.1504, 0.0000, 0.1500, 0.1514, 0.1505, 0.1505,
         0.1496],
        [0.1494, 0.1497, 0.1497, 0.1495, 0.1500, 0.0000, 0.1504, 0.1497, 0.1496,
         0.1487],
        [0.1506, 0.1509, 0.1508, 0.1507, 0.1514, 0.1504, 0.0000, 0.1509, 0.1511,
         0.1498],
        [0.1498, 0.1503, 0.1502, 0.1498, 0.1505, 0.1497, 0.1509, 0.0000, 0.1501,
         0.1492],
        [0.1500, 0.1504, 0.1504, 0.1500, 0.1505, 0.1496, 0.1511, 0.1501, 0.0000,
         0.1492],
        [0.1490, 0.1493, 0.1492, 0.1488, 0.1496, 0.1487, 0.1498, 0.1492, 0.1492,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0002, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.06413657
Epoch 58: train_loss: 5.4235 recon_acc: 0.0071 val_roc: 0.5559 val_ap: 0.5358 f1: 0.6696 time: 0.2847
thresh 0.037399236
          test_roc: 0.5175 test_ap: 0.5045 test_f1: 0.6672 test_recon_acc: 0.0024
difference_matrix tensor([[0.0000, 0.1509, 0.1508, 0.1505, 0.1511, 0.1502, 0.1513, 0.1506, 0.1507,
         0.1498],
        [0.1509, 0.0000, 0.1511, 0.1508, 0.1515, 0.1505, 0.1517, 0.1511, 0.1511,
         0.1501],
        [0.1508, 0.1511, 0.0000, 0.1507, 0.1516, 0.1505, 0.1515, 0.1509, 0.1511,
         0.1500],
        [0.1505, 0.1508, 0.1507, 0.0000, 0.1511, 0.1503, 0.1514, 0.1506, 0.1507,
         0.1496],
        [0.1511, 0.1515, 0.1516, 0.1511, 0.0000, 0.1507, 0.1521, 0.1512, 0.1513,
         0.1504],
        [0.1502, 0.1505, 0.1505, 0.1503, 0.1507, 0.0000, 0.1511, 0.1505, 0.1504,
         0.1496],
        [0.1513, 0.1517, 0.1515, 0.1514, 0.1521, 0.1511, 0.0000, 0.1516, 0.1519,
         0.1506],
        [0.1506, 0.1511, 0.1509, 0.1506, 0.1512, 0.1505, 0.1516, 0.0000, 0.1508,
         0.1500],
        [0.1507, 0.1511, 0.1511, 0.1507, 0.1513, 0.1504, 0.1519, 0.1508, 0.0000,
         0.1500],
        [0.1498, 0.1501, 0.1500, 0.1496, 0.1504, 0.1496, 0.1506, 0.1500, 0.1500,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(2.2315e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.065199435
Epoch 59: train_loss: 5.4061 recon_acc: 0.0075 val_roc: 0.5577 val_ap: 0.5388 f1: 0.6696 time: 0.2975
thresh 0.038035356
          test_roc: 0.5196 test_ap: 0.5065 test_f1: 0.6672 test_recon_acc: 0.0025
difference_matrix tensor([[0.0000, 0.1521, 0.1521, 0.1517, 0.1523, 0.1514, 0.1525, 0.1518, 0.1519,
         0.1511],
        [0.1521, 0.0000, 0.1523, 0.1520, 0.1527, 0.1517, 0.1528, 0.1523, 0.1523,
         0.1513],
        [0.1521, 0.1523, 0.0000, 0.1519, 0.1529, 0.1517, 0.1527, 0.1521, 0.1523,
         0.1513],
        [0.1517, 0.1520, 0.1519, 0.0000, 0.1523, 0.1515, 0.1526, 0.1518, 0.1519,
         0.1509],
        [0.1523, 0.1527, 0.1529, 0.1523, 0.0000, 0.1520, 0.1533, 0.1524, 0.1524,
         0.1516],
        [0.1514, 0.1517, 0.1517, 0.1515, 0.1520, 0.0000, 0.1523, 0.1517, 0.1516,
         0.1508],
        [0.1525, 0.1528, 0.1527, 0.1526, 0.1533, 0.1523, 0.0000, 0.1528, 0.1531,
         0.1518],
        [0.1518, 0.1523, 0.1521, 0.1518, 0.1524, 0.1517, 0.1528, 0.0000, 0.1520,
         0.1513],
        [0.1519, 0.1523, 0.1523, 0.1519, 0.1524, 0.1516, 0.1531, 0.1520, 0.0000,
         0.1512],
        [0.1511, 0.1513, 0.1513, 0.1509, 0.1516, 0.1508, 0.1518, 0.1513, 0.1512,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.06628023
Epoch 60: train_loss: 5.3881 recon_acc: 0.0080 val_roc: 0.5592 val_ap: 0.5430 f1: 0.6696 time: 0.2929
thresh 0.03859762
          test_roc: 0.5216 test_ap: 0.5087 test_f1: 0.6672 test_recon_acc: 0.0027
difference_matrix tensor([[0.0000, 0.1536, 0.1536, 0.1533, 0.1538, 0.1530, 0.1541, 0.1533, 0.1535,
         0.1527],
        [0.1536, 0.0000, 0.1539, 0.1536, 0.1543, 0.1532, 0.1544, 0.1539, 0.1539,
         0.1529],
        [0.1536, 0.1539, 0.0000, 0.1535, 0.1544, 0.1533, 0.1542, 0.1537, 0.1539,
         0.1528],
        [0.1533, 0.1536, 0.1535, 0.0000, 0.1539, 0.1531, 0.1541, 0.1534, 0.1535,
         0.1524],
        [0.1538, 0.1543, 0.1544, 0.1539, 0.0000, 0.1535, 0.1548, 0.1540, 0.1540,
         0.1532],
        [0.1530, 0.1532, 0.1533, 0.1531, 0.1535, 0.0000, 0.1539, 0.1532, 0.1531,
         0.1524],
        [0.1541, 0.1544, 0.1542, 0.1541, 0.1548, 0.1539, 0.0000, 0.1543, 0.1546,
         0.1533],
        [0.1533, 0.1539, 0.1537, 0.1534, 0.1540, 0.1532, 0.1543, 0.0000, 0.1536,
         0.1529],
        [0.1535, 0.1539, 0.1539, 0.1535, 0.1540, 0.1531, 0.1546, 0.1536, 0.0000,
         0.1528],
        [0.1527, 0.1529, 0.1528, 0.1524, 0.1532, 0.1524, 0.1533, 0.1529, 0.1528,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.067311995
Epoch 61: train_loss: 5.3695 recon_acc: 0.0086 val_roc: 0.5610 val_ap: 0.5460 f1: 0.6696 time: 0.2865
thresh 0.039048053
          test_roc: 0.5235 test_ap: 0.5106 test_f1: 0.6672 test_recon_acc: 0.0028
difference_matrix tensor([[0.0000, 0.1555, 0.1555, 0.1551, 0.1557, 0.1549, 0.1559, 0.1552, 0.1554,
         0.1545],
        [0.1555, 0.0000, 0.1557, 0.1554, 0.1561, 0.1551, 0.1562, 0.1557, 0.1557,
         0.1548],
        [0.1555, 0.1557, 0.0000, 0.1553, 0.1563, 0.1551, 0.1561, 0.1555, 0.1557,
         0.1547],
        [0.1551, 0.1554, 0.1553, 0.0000, 0.1557, 0.1549, 0.1559, 0.1552, 0.1553,
         0.1543],
        [0.1557, 0.1561, 0.1563, 0.1557, 0.0000, 0.1554, 0.1566, 0.1558, 0.1558,
         0.1550],
        [0.1549, 0.1551, 0.1551, 0.1549, 0.1554, 0.0000, 0.1557, 0.1551, 0.1550,
         0.1543],
        [0.1559, 0.1562, 0.1561, 0.1559, 0.1566, 0.1557, 0.0000, 0.1562, 0.1564,
         0.1552],
        [0.1552, 0.1557, 0.1555, 0.1552, 0.1558, 0.1551, 0.1562, 0.0000, 0.1554,
         0.1548],
        [0.1554, 0.1557, 0.1557, 0.1553, 0.1558, 0.1550, 0.1564, 0.1554, 0.0000,
         0.1547],
        [0.1545, 0.1548, 0.1547, 0.1543, 0.1550, 0.1543, 0.1552, 0.1548, 0.1547,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.06814345
Epoch 62: train_loss: 5.3504 recon_acc: 0.0092 val_roc: 0.5632 val_ap: 0.5489 f1: 0.6696 time: 0.2827
thresh 0.039394792
          test_roc: 0.5257 test_ap: 0.5134 test_f1: 0.6672 test_recon_acc: 0.0030
difference_matrix tensor([[0.0000, 0.1575, 0.1576, 0.1572, 0.1577, 0.1569, 0.1579, 0.1573, 0.1574,
         0.1566],
        [0.1575, 0.0000, 0.1578, 0.1575, 0.1582, 0.1571, 0.1582, 0.1578, 0.1578,
         0.1568],
        [0.1576, 0.1578, 0.0000, 0.1574, 0.1583, 0.1572, 0.1581, 0.1576, 0.1578,
         0.1568],
        [0.1572, 0.1575, 0.1574, 0.0000, 0.1578, 0.1570, 0.1580, 0.1573, 0.1574,
         0.1564],
        [0.1577, 0.1582, 0.1583, 0.1578, 0.0000, 0.1574, 0.1586, 0.1578, 0.1578,
         0.1571],
        [0.1569, 0.1571, 0.1572, 0.1570, 0.1574, 0.0000, 0.1578, 0.1572, 0.1571,
         0.1564],
        [0.1579, 0.1582, 0.1581, 0.1580, 0.1586, 0.1578, 0.0000, 0.1582, 0.1584,
         0.1572],
        [0.1573, 0.1578, 0.1576, 0.1573, 0.1578, 0.1572, 0.1582, 0.0000, 0.1575,
         0.1568],
        [0.1574, 0.1578, 0.1578, 0.1574, 0.1578, 0.1571, 0.1584, 0.1575, 0.0000,
         0.1567],
        [0.1566, 0.1568, 0.1568, 0.1564, 0.1571, 0.1564, 0.1572, 0.1568, 0.1567,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.069224454
Epoch 63: train_loss: 5.3311 recon_acc: 0.0101 val_roc: 0.5656 val_ap: 0.5529 f1: 0.6696 time: 0.2801
thresh 0.03987215
          test_roc: 0.5284 test_ap: 0.5161 test_f1: 0.6672 test_recon_acc: 0.0033
difference_matrix tensor([[0.0000, 0.1597, 0.1597, 0.1594, 0.1599, 0.1591, 0.1601, 0.1594, 0.1596,
         0.1588],
        [0.1597, 0.0000, 0.1599, 0.1596, 0.1603, 0.1593, 0.1604, 0.1599, 0.1599,
         0.1590],
        [0.1597, 0.1599, 0.0000, 0.1595, 0.1605, 0.1594, 0.1602, 0.1598, 0.1599,
         0.1590],
        [0.1594, 0.1596, 0.1595, 0.0000, 0.1599, 0.1592, 0.1601, 0.1594, 0.1595,
         0.1586],
        [0.1599, 0.1603, 0.1605, 0.1599, 0.0000, 0.1596, 0.1607, 0.1600, 0.1600,
         0.1593],
        [0.1591, 0.1593, 0.1594, 0.1592, 0.1596, 0.0000, 0.1599, 0.1593, 0.1592,
         0.1586],
        [0.1601, 0.1604, 0.1602, 0.1601, 0.1607, 0.1599, 0.0000, 0.1603, 0.1606,
         0.1594],
        [0.1594, 0.1599, 0.1598, 0.1594, 0.1600, 0.1593, 0.1603, 0.0000, 0.1596,
         0.1590],
        [0.1596, 0.1599, 0.1599, 0.1595, 0.1600, 0.1592, 0.1606, 0.1596, 0.0000,
         0.1589],
        [0.1588, 0.1590, 0.1590, 0.1586, 0.1593, 0.1586, 0.1594, 0.1590, 0.1589,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.071114734
Epoch 64: train_loss: 5.3117 recon_acc: 0.0113 val_roc: 0.5681 val_ap: 0.5570 f1: 0.6696 time: 0.2632
thresh 0.040552925
          test_roc: 0.5316 test_ap: 0.5193 test_f1: 0.6672 test_recon_acc: 0.0036
difference_matrix tensor([[0.0000, 0.1619, 0.1620, 0.1616, 0.1621, 0.1614, 0.1623, 0.1617, 0.1618,
         0.1610],
        [0.1619, 0.0000, 0.1621, 0.1618, 0.1625, 0.1615, 0.1626, 0.1621, 0.1622,
         0.1612],
        [0.1620, 0.1622, 0.0000, 0.1617, 0.1627, 0.1616, 0.1624, 0.1620, 0.1621,
         0.1612],
        [0.1616, 0.1618, 0.1617, 0.0000, 0.1621, 0.1614, 0.1623, 0.1616, 0.1617,
         0.1608],
        [0.1621, 0.1625, 0.1627, 0.1621, 0.0000, 0.1618, 0.1629, 0.1622, 0.1622,
         0.1615],
        [0.1614, 0.1615, 0.1616, 0.1614, 0.1618, 0.0000, 0.1621, 0.1616, 0.1614,
         0.1608],
        [0.1623, 0.1626, 0.1624, 0.1623, 0.1629, 0.1621, 0.0000, 0.1625, 0.1628,
         0.1616],
        [0.1617, 0.1621, 0.1620, 0.1616, 0.1622, 0.1616, 0.1625, 0.0000, 0.1618,
         0.1613],
        [0.1618, 0.1622, 0.1621, 0.1617, 0.1622, 0.1614, 0.1628, 0.1618, 0.0000,
         0.1611],
        [0.1610, 0.1612, 0.1612, 0.1608, 0.1615, 0.1608, 0.1616, 0.1613, 0.1611,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.07384521
Epoch 65: train_loss: 5.2923 recon_acc: 0.0130 val_roc: 0.5708 val_ap: 0.5621 f1: 0.6706 time: 0.2556
thresh 0.041289955
          test_roc: 0.5344 test_ap: 0.5234 test_f1: 0.6672 test_recon_acc: 0.0039
difference_matrix tensor([[0.0000, 0.1641, 0.1641, 0.1638, 0.1643, 0.1636, 0.1644, 0.1639, 0.1640,
         0.1632],
        [0.1641, 0.0000, 0.1643, 0.1640, 0.1647, 0.1637, 0.1647, 0.1643, 0.1643,
         0.1634],
        [0.1641, 0.1643, 0.0000, 0.1639, 0.1649, 0.1638, 0.1645, 0.1641, 0.1643,
         0.1634],
        [0.1638, 0.1640, 0.1639, 0.0000, 0.1643, 0.1636, 0.1645, 0.1638, 0.1639,
         0.1630],
        [0.1643, 0.1647, 0.1649, 0.1643, 0.0000, 0.1640, 0.1650, 0.1644, 0.1643,
         0.1637],
        [0.1636, 0.1637, 0.1638, 0.1636, 0.1640, 0.0000, 0.1643, 0.1637, 0.1636,
         0.1631],
        [0.1644, 0.1647, 0.1645, 0.1645, 0.1650, 0.1643, 0.0000, 0.1647, 0.1649,
         0.1637],
        [0.1639, 0.1643, 0.1641, 0.1638, 0.1644, 0.1637, 0.1647, 0.0000, 0.1640,
         0.1635],
        [0.1640, 0.1643, 0.1643, 0.1639, 0.1643, 0.1636, 0.1649, 0.1640, 0.0000,
         0.1633],
        [0.1632, 0.1634, 0.1634, 0.1630, 0.1637, 0.1631, 0.1637, 0.1635, 0.1633,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.07735122
Epoch 66: train_loss: 5.2730 recon_acc: 0.0150 val_roc: 0.5739 val_ap: 0.5674 f1: 0.6706 time: 0.2452
thresh 0.04207932
          test_roc: 0.5377 test_ap: 0.5288 test_f1: 0.6672 test_recon_acc: 0.0044
difference_matrix tensor([[0.0000, 0.1662, 0.1662, 0.1659, 0.1664, 0.1656, 0.1665, 0.1659, 0.1660,
         0.1653],
        [0.1662, 0.0000, 0.1664, 0.1661, 0.1668, 0.1658, 0.1668, 0.1664, 0.1664,
         0.1655],
        [0.1662, 0.1664, 0.0000, 0.1660, 0.1670, 0.1659, 0.1665, 0.1662, 0.1664,
         0.1655],
        [0.1659, 0.1661, 0.1660, 0.0000, 0.1664, 0.1657, 0.1665, 0.1659, 0.1660,
         0.1651],
        [0.1664, 0.1668, 0.1670, 0.1664, 0.0000, 0.1660, 0.1671, 0.1664, 0.1663,
         0.1657],
        [0.1656, 0.1658, 0.1659, 0.1657, 0.1660, 0.0000, 0.1664, 0.1658, 0.1657,
         0.1652],
        [0.1665, 0.1668, 0.1665, 0.1665, 0.1671, 0.1664, 0.0000, 0.1667, 0.1670,
         0.1658],
        [0.1659, 0.1664, 0.1662, 0.1659, 0.1664, 0.1658, 0.1667, 0.0000, 0.1660,
         0.1656],
        [0.1660, 0.1664, 0.1664, 0.1660, 0.1663, 0.1657, 0.1670, 0.1660, 0.0000,
         0.1654],
        [0.1653, 0.1655, 0.1655, 0.1651, 0.1657, 0.1652, 0.1658, 0.1656, 0.1654,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.08209684
Epoch 67: train_loss: 5.2539 recon_acc: 0.0179 val_roc: 0.5766 val_ap: 0.5726 f1: 0.6706 time: 0.2678
thresh 0.043000817
          test_roc: 0.5415 test_ap: 0.5339 test_f1: 0.6676 test_recon_acc: 0.0048
difference_matrix tensor([[0.0000, 0.1680, 0.1681, 0.1678, 0.1683, 0.1676, 0.1683, 0.1678, 0.1679,
         0.1672],
        [0.1680, 0.0000, 0.1683, 0.1680, 0.1687, 0.1676, 0.1687, 0.1683, 0.1683,
         0.1674],
        [0.1681, 0.1683, 0.0000, 0.1679, 0.1689, 0.1678, 0.1684, 0.1681, 0.1683,
         0.1674],
        [0.1678, 0.1680, 0.1679, 0.0000, 0.1683, 0.1676, 0.1684, 0.1678, 0.1679,
         0.1670],
        [0.1683, 0.1687, 0.1689, 0.1683, 0.0000, 0.1679, 0.1689, 0.1683, 0.1682,
         0.1676],
        [0.1676, 0.1676, 0.1678, 0.1676, 0.1679, 0.0000, 0.1683, 0.1677, 0.1676,
         0.1671],
        [0.1683, 0.1687, 0.1684, 0.1684, 0.1689, 0.1683, 0.0000, 0.1686, 0.1688,
         0.1677],
        [0.1678, 0.1683, 0.1681, 0.1678, 0.1683, 0.1677, 0.1686, 0.0000, 0.1679,
         0.1675],
        [0.1679, 0.1683, 0.1683, 0.1679, 0.1682, 0.1676, 0.1688, 0.1679, 0.0000,
         0.1673],
        [0.1672, 0.1674, 0.1674, 0.1670, 0.1676, 0.1671, 0.1677, 0.1675, 0.1673,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.08885118
Epoch 68: train_loss: 5.2349 recon_acc: 0.0220 val_roc: 0.5800 val_ap: 0.5782 f1: 0.6706 time: 0.2621
thresh 0.044107456
          test_roc: 0.5456 test_ap: 0.5397 test_f1: 0.6676 test_recon_acc: 0.0053
difference_matrix tensor([[0.0000, 0.1697, 0.1698, 0.1695, 0.1699, 0.1692, 0.1700, 0.1695, 0.1696,
         0.1689],
        [0.1697, 0.0000, 0.1699, 0.1696, 0.1703, 0.1693, 0.1703, 0.1700, 0.1700,
         0.1691],
        [0.1698, 0.1699, 0.0000, 0.1696, 0.1705, 0.1694, 0.1700, 0.1697, 0.1699,
         0.1691],
        [0.1695, 0.1696, 0.1696, 0.0000, 0.1699, 0.1693, 0.1701, 0.1694, 0.1695,
         0.1687],
        [0.1699, 0.1703, 0.1705, 0.1699, 0.0000, 0.1696, 0.1705, 0.1699, 0.1698,
         0.1693],
        [0.1692, 0.1693, 0.1694, 0.1693, 0.1696, 0.0000, 0.1699, 0.1694, 0.1692,
         0.1688],
        [0.1700, 0.1703, 0.1700, 0.1701, 0.1705, 0.1699, 0.0000, 0.1702, 0.1705,
         0.1693],
        [0.1695, 0.1700, 0.1697, 0.1694, 0.1699, 0.1694, 0.1702, 0.0000, 0.1696,
         0.1692],
        [0.1696, 0.1700, 0.1699, 0.1695, 0.1698, 0.1692, 0.1705, 0.1696, 0.0000,
         0.1689],
        [0.1689, 0.1691, 0.1691, 0.1687, 0.1693, 0.1688, 0.1693, 0.1692, 0.1689,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.09815238
Epoch 69: train_loss: 5.2160 recon_acc: 0.0279 val_roc: 0.5840 val_ap: 0.5869 f1: 0.6716 time: 0.2676
thresh 0.04551425
          test_roc: 0.5503 test_ap: 0.5462 test_f1: 0.6676 test_recon_acc: 0.0060
difference_matrix tensor([[0.0000, 0.1710, 0.1712, 0.1709, 0.1713, 0.1706, 0.1713, 0.1709, 0.1709,
         0.1703],
        [0.1710, 0.0000, 0.1713, 0.1710, 0.1717, 0.1706, 0.1717, 0.1713, 0.1714,
         0.1704],
        [0.1712, 0.1713, 0.0000, 0.1709, 0.1719, 0.1708, 0.1713, 0.1711, 0.1713,
         0.1705],
        [0.1709, 0.1710, 0.1709, 0.0000, 0.1713, 0.1706, 0.1715, 0.1708, 0.1709,
         0.1701],
        [0.1713, 0.1717, 0.1719, 0.1713, 0.0000, 0.1709, 0.1719, 0.1713, 0.1712,
         0.1707],
        [0.1706, 0.1706, 0.1708, 0.1706, 0.1709, 0.0000, 0.1713, 0.1707, 0.1706,
         0.1702],
        [0.1713, 0.1717, 0.1713, 0.1715, 0.1719, 0.1713, 0.0000, 0.1716, 0.1718,
         0.1706],
        [0.1709, 0.1713, 0.1711, 0.1708, 0.1713, 0.1707, 0.1716, 0.0000, 0.1709,
         0.1706],
        [0.1709, 0.1714, 0.1713, 0.1709, 0.1712, 0.1706, 0.1718, 0.1709, 0.0000,
         0.1703],
        [0.1703, 0.1704, 0.1705, 0.1701, 0.1707, 0.1702, 0.1706, 0.1706, 0.1703,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.102812745
Epoch 70: train_loss: 5.1972 recon_acc: 0.0316 val_roc: 0.5880 val_ap: 0.5947 f1: 0.6716 time: 0.2797
thresh 0.04724321
          test_roc: 0.5555 test_ap: 0.5547 test_f1: 0.6676 test_recon_acc: 0.0067
difference_matrix tensor([[0.0000, 0.1720, 0.1722, 0.1719, 0.1723, 0.1716, 0.1723, 0.1719, 0.1719,
         0.1713],
        [0.1720, 0.0000, 0.1723, 0.1720, 0.1727, 0.1716, 0.1727, 0.1724, 0.1724,
         0.1715],
        [0.1722, 0.1723, 0.0000, 0.1720, 0.1729, 0.1718, 0.1723, 0.1721, 0.1723,
         0.1715],
        [0.1719, 0.1720, 0.1720, 0.0000, 0.1723, 0.1717, 0.1725, 0.1718, 0.1719,
         0.1711],
        [0.1723, 0.1727, 0.1729, 0.1723, 0.0000, 0.1720, 0.1729, 0.1723, 0.1721,
         0.1717],
        [0.1716, 0.1716, 0.1718, 0.1717, 0.1720, 0.0000, 0.1723, 0.1717, 0.1716,
         0.1712],
        [0.1723, 0.1727, 0.1723, 0.1725, 0.1729, 0.1723, 0.0000, 0.1726, 0.1728,
         0.1716],
        [0.1719, 0.1724, 0.1721, 0.1718, 0.1723, 0.1717, 0.1726, 0.0000, 0.1719,
         0.1716],
        [0.1719, 0.1724, 0.1723, 0.1719, 0.1721, 0.1716, 0.1728, 0.1719, 0.0000,
         0.1713],
        [0.1713, 0.1715, 0.1715, 0.1711, 0.1717, 0.1712, 0.1716, 0.1716, 0.1713,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.101880275
Epoch 71: train_loss: 5.1787 recon_acc: 0.0318 val_roc: 0.5922 val_ap: 0.6027 f1: 0.6716 time: 0.2653
thresh 0.049267344
          test_roc: 0.5611 test_ap: 0.5625 test_f1: 0.6676 test_recon_acc: 0.0075
difference_matrix tensor([[0.0000, 0.1727, 0.1729, 0.1726, 0.1730, 0.1723, 0.1730, 0.1726, 0.1726,
         0.1720],
        [0.1727, 0.0000, 0.1729, 0.1727, 0.1734, 0.1723, 0.1734, 0.1730, 0.1731,
         0.1721],
        [0.1729, 0.1729, 0.0000, 0.1727, 0.1736, 0.1725, 0.1729, 0.1728, 0.1729,
         0.1722],
        [0.1726, 0.1727, 0.1727, 0.0000, 0.1730, 0.1724, 0.1732, 0.1725, 0.1726,
         0.1718],
        [0.1730, 0.1734, 0.1736, 0.1730, 0.0000, 0.1726, 0.1735, 0.1730, 0.1728,
         0.1724],
        [0.1723, 0.1723, 0.1725, 0.1724, 0.1726, 0.0000, 0.1730, 0.1724, 0.1723,
         0.1719],
        [0.1730, 0.1734, 0.1729, 0.1732, 0.1735, 0.1730, 0.0000, 0.1732, 0.1734,
         0.1723],
        [0.1726, 0.1730, 0.1728, 0.1725, 0.1730, 0.1724, 0.1732, 0.0000, 0.1725,
         0.1723],
        [0.1726, 0.1731, 0.1729, 0.1726, 0.1728, 0.1723, 0.1734, 0.1725, 0.0000,
         0.1720],
        [0.1720, 0.1722, 0.1722, 0.1718, 0.1724, 0.1719, 0.1723, 0.1723, 0.1720,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.21844056
Epoch 72: train_loss: 5.1604 recon_acc: 0.1338 val_roc: 0.5971 val_ap: 0.6105 f1: 0.6719 time: 0.2759
thresh 0.055828393
          test_roc: 0.5669 test_ap: 0.5715 test_f1: 0.6676 test_recon_acc: 0.0099
difference_matrix tensor([[0.0000, 0.1730, 0.1732, 0.1730, 0.1733, 0.1726, 0.1732, 0.1729, 0.1729,
         0.1723],
        [0.1730, 0.0000, 0.1732, 0.1730, 0.1737, 0.1726, 0.1737, 0.1734, 0.1734,
         0.1725],
        [0.1732, 0.1732, 0.0000, 0.1730, 0.1739, 0.1728, 0.1732, 0.1731, 0.1732,
         0.1725],
        [0.1730, 0.1730, 0.1730, 0.0000, 0.1733, 0.1727, 0.1735, 0.1727, 0.1729,
         0.1721],
        [0.1733, 0.1737, 0.1739, 0.1733, 0.0000, 0.1729, 0.1738, 0.1733, 0.1730,
         0.1727],
        [0.1726, 0.1726, 0.1728, 0.1727, 0.1729, 0.0000, 0.1733, 0.1727, 0.1726,
         0.1723],
        [0.1732, 0.1737, 0.1732, 0.1735, 0.1738, 0.1733, 0.0000, 0.1735, 0.1737,
         0.1726],
        [0.1729, 0.1734, 0.1731, 0.1727, 0.1733, 0.1727, 0.1735, 0.0000, 0.1728,
         0.1727],
        [0.1729, 0.1734, 0.1732, 0.1729, 0.1730, 0.1726, 0.1737, 0.1728, 0.0000,
         0.1723],
        [0.1723, 0.1725, 0.1725, 0.1721, 0.1727, 0.1723, 0.1726, 0.1727, 0.1723,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.21960461
Epoch 73: train_loss: 5.1426 recon_acc: 0.1358 val_roc: 0.6022 val_ap: 0.6188 f1: 0.6730 time: 0.2695
thresh 0.054513436
          test_roc: 0.5733 test_ap: 0.5820 test_f1: 0.6681 test_recon_acc: 0.0097
difference_matrix tensor([[0.0000, 0.1729, 0.1731, 0.1729, 0.1732, 0.1726, 0.1732, 0.1729, 0.1728,
         0.1723],
        [0.1729, 0.0000, 0.1731, 0.1730, 0.1737, 0.1725, 0.1737, 0.1733, 0.1734,
         0.1724],
        [0.1731, 0.1731, 0.0000, 0.1729, 0.1739, 0.1727, 0.1731, 0.1730, 0.1732,
         0.1724],
        [0.1729, 0.1730, 0.1729, 0.0000, 0.1732, 0.1726, 0.1735, 0.1727, 0.1729,
         0.1721],
        [0.1732, 0.1737, 0.1739, 0.1732, 0.0000, 0.1729, 0.1737, 0.1732, 0.1730,
         0.1726],
        [0.1726, 0.1725, 0.1727, 0.1726, 0.1729, 0.0000, 0.1733, 0.1726, 0.1725,
         0.1722],
        [0.1732, 0.1737, 0.1731, 0.1735, 0.1737, 0.1733, 0.0000, 0.1735, 0.1737,
         0.1725],
        [0.1729, 0.1733, 0.1730, 0.1727, 0.1732, 0.1726, 0.1735, 0.0000, 0.1727,
         0.1726],
        [0.1728, 0.1734, 0.1732, 0.1729, 0.1730, 0.1725, 0.1737, 0.1727, 0.0000,
         0.1723],
        [0.1723, 0.1724, 0.1724, 0.1721, 0.1726, 0.1722, 0.1725, 0.1726, 0.1723,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.22329582
Epoch 74: train_loss: 5.1254 recon_acc: 0.1402 val_roc: 0.6081 val_ap: 0.6274 f1: 0.6719 time: 0.2392
thresh 0.057004154
          test_roc: 0.5800 test_ap: 0.5923 test_f1: 0.6686 test_recon_acc: 0.0107
difference_matrix tensor([[0.0000, 0.1724, 0.1727, 0.1725, 0.1728, 0.1722, 0.1727, 0.1724, 0.1723,
         0.1719],
        [0.1724, 0.0000, 0.1727, 0.1726, 0.1732, 0.1720, 0.1733, 0.1729, 0.1729,
         0.1720],
        [0.1727, 0.1727, 0.0000, 0.1725, 0.1735, 0.1722, 0.1726, 0.1725, 0.1727,
         0.1720],
        [0.1725, 0.1726, 0.1725, 0.0000, 0.1728, 0.1722, 0.1731, 0.1722, 0.1724,
         0.1717],
        [0.1728, 0.1732, 0.1735, 0.1728, 0.0000, 0.1725, 0.1733, 0.1728, 0.1725,
         0.1722],
        [0.1722, 0.1720, 0.1722, 0.1722, 0.1725, 0.0000, 0.1729, 0.1722, 0.1721,
         0.1718],
        [0.1727, 0.1733, 0.1726, 0.1731, 0.1733, 0.1729, 0.0000, 0.1730, 0.1732,
         0.1720],
        [0.1724, 0.1729, 0.1725, 0.1722, 0.1728, 0.1722, 0.1730, 0.0000, 0.1723,
         0.1722],
        [0.1723, 0.1729, 0.1727, 0.1724, 0.1725, 0.1721, 0.1732, 0.1723, 0.0000,
         0.1718],
        [0.1719, 0.1720, 0.1720, 0.1717, 0.1722, 0.1718, 0.1720, 0.1722, 0.1718,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.23675135
Epoch 75: train_loss: 5.1090 recon_acc: 0.1549 val_roc: 0.6141 val_ap: 0.6350 f1: 0.6762 time: 0.2756
thresh 0.05823241
          test_roc: 0.5870 test_ap: 0.6016 test_f1: 0.6686 test_recon_acc: 0.0112
difference_matrix tensor([[0.0000, 0.1716, 0.1720, 0.1718, 0.1721, 0.1714, 0.1720, 0.1717, 0.1716,
         0.1711],
        [0.1716, 0.0000, 0.1719, 0.1718, 0.1725, 0.1713, 0.1725, 0.1721, 0.1722,
         0.1713],
        [0.1720, 0.1719, 0.0000, 0.1718, 0.1727, 0.1715, 0.1718, 0.1717, 0.1719,
         0.1713],
        [0.1718, 0.1718, 0.1718, 0.0000, 0.1720, 0.1715, 0.1724, 0.1714, 0.1717,
         0.1710],
        [0.1721, 0.1725, 0.1727, 0.1720, 0.0000, 0.1717, 0.1725, 0.1720, 0.1717,
         0.1714],
        [0.1714, 0.1713, 0.1715, 0.1715, 0.1717, 0.0000, 0.1721, 0.1714, 0.1713,
         0.1711],
        [0.1720, 0.1725, 0.1718, 0.1724, 0.1725, 0.1721, 0.0000, 0.1723, 0.1724,
         0.1713],
        [0.1717, 0.1721, 0.1717, 0.1714, 0.1720, 0.1714, 0.1723, 0.0000, 0.1715,
         0.1715],
        [0.1716, 0.1722, 0.1719, 0.1717, 0.1717, 0.1713, 0.1724, 0.1715, 0.0000,
         0.1711],
        [0.1711, 0.1713, 0.1713, 0.1710, 0.1714, 0.1711, 0.1713, 0.1715, 0.1711,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.23796201
Epoch 76: train_loss: 5.0936 recon_acc: 0.1560 val_roc: 0.6202 val_ap: 0.6433 f1: 0.6783 time: 0.2742
thresh 0.059909165
          test_roc: 0.5937 test_ap: 0.6121 test_f1: 0.6686 test_recon_acc: 0.0119
difference_matrix tensor([[0.0000, 0.1705, 0.1709, 0.1708, 0.1710, 0.1703, 0.1709, 0.1706, 0.1705,
         0.1701],
        [0.1705, 0.0000, 0.1708, 0.1708, 0.1714, 0.1702, 0.1715, 0.1711, 0.1711,
         0.1702],
        [0.1709, 0.1708, 0.0000, 0.1707, 0.1717, 0.1704, 0.1707, 0.1707, 0.1709,
         0.1702],
        [0.1708, 0.1708, 0.1707, 0.0000, 0.1710, 0.1704, 0.1713, 0.1704, 0.1706,
         0.1700],
        [0.1710, 0.1714, 0.1717, 0.1710, 0.0000, 0.1706, 0.1714, 0.1709, 0.1706,
         0.1704],
        [0.1703, 0.1702, 0.1704, 0.1704, 0.1706, 0.0000, 0.1711, 0.1703, 0.1702,
         0.1701],
        [0.1709, 0.1715, 0.1707, 0.1713, 0.1714, 0.1711, 0.0000, 0.1712, 0.1714,
         0.1702],
        [0.1706, 0.1711, 0.1707, 0.1704, 0.1709, 0.1703, 0.1712, 0.0000, 0.1704,
         0.1705],
        [0.1705, 0.1711, 0.1709, 0.1706, 0.1706, 0.1702, 0.1714, 0.1704, 0.0000,
         0.1700],
        [0.1701, 0.1702, 0.1702, 0.1700, 0.1704, 0.1701, 0.1702, 0.1705, 0.1700,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.12153759
Epoch 77: train_loss: 5.0794 recon_acc: 0.0455 val_roc: 0.6512 val_ap: 0.6801 f1: 0.6796 time: 0.2882
thresh 0.028721513
          test_roc: 0.5995 test_ap: 0.6317 test_f1: 0.6672 test_recon_acc: 0.0030
difference_matrix tensor([[0.0000, 0.1692, 0.1696, 0.1695, 0.1697, 0.1690, 0.1695, 0.1693, 0.1691,
         0.1687],
        [0.1692, 0.0000, 0.1694, 0.1694, 0.1701, 0.1688, 0.1701, 0.1697, 0.1698,
         0.1689],
        [0.1696, 0.1694, 0.0000, 0.1694, 0.1704, 0.1690, 0.1693, 0.1693, 0.1695,
         0.1689],
        [0.1695, 0.1694, 0.1694, 0.0000, 0.1697, 0.1691, 0.1700, 0.1690, 0.1693,
         0.1687],
        [0.1697, 0.1701, 0.1704, 0.1697, 0.0000, 0.1693, 0.1700, 0.1696, 0.1693,
         0.1691],
        [0.1690, 0.1688, 0.1690, 0.1691, 0.1693, 0.0000, 0.1698, 0.1689, 0.1689,
         0.1688],
        [0.1695, 0.1701, 0.1693, 0.1700, 0.1700, 0.1698, 0.0000, 0.1699, 0.1700,
         0.1688],
        [0.1693, 0.1697, 0.1693, 0.1690, 0.1696, 0.1689, 0.1699, 0.0000, 0.1691,
         0.1692],
        [0.1691, 0.1698, 0.1695, 0.1693, 0.1693, 0.1689, 0.1700, 0.1691, 0.0000,
         0.1687],
        [0.1687, 0.1689, 0.1689, 0.1687, 0.1691, 0.1688, 0.1688, 0.1692, 0.1687,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.1226274
Epoch 78: train_loss: 5.0662 recon_acc: 0.0458 val_roc: 0.6565 val_ap: 0.6869 f1: 0.6796 time: 0.2543
thresh 0.02930873
          test_roc: 0.6069 test_ap: 0.6433 test_f1: 0.6672 test_recon_acc: 0.0031
difference_matrix tensor([[0.0000, 0.1676, 0.1680, 0.1680, 0.1681, 0.1674, 0.1680, 0.1677, 0.1675,
         0.1672],
        [0.1676, 0.0000, 0.1678, 0.1679, 0.1686, 0.1672, 0.1686, 0.1682, 0.1683,
         0.1674],
        [0.1680, 0.1678, 0.0000, 0.1678, 0.1688, 0.1674, 0.1678, 0.1677, 0.1679,
         0.1673],
        [0.1680, 0.1679, 0.1678, 0.0000, 0.1681, 0.1675, 0.1685, 0.1674, 0.1678,
         0.1672],
        [0.1681, 0.1686, 0.1688, 0.1681, 0.0000, 0.1678, 0.1685, 0.1680, 0.1677,
         0.1675],
        [0.1674, 0.1672, 0.1674, 0.1675, 0.1678, 0.0000, 0.1682, 0.1674, 0.1674,
         0.1673],
        [0.1680, 0.1686, 0.1678, 0.1685, 0.1685, 0.1682, 0.0000, 0.1683, 0.1684,
         0.1673],
        [0.1677, 0.1682, 0.1677, 0.1674, 0.1680, 0.1674, 0.1683, 0.0000, 0.1675,
         0.1676],
        [0.1675, 0.1683, 0.1679, 0.1678, 0.1677, 0.1674, 0.1684, 0.1675, 0.0000,
         0.1672],
        [0.1672, 0.1674, 0.1673, 0.1672, 0.1675, 0.1673, 0.1673, 0.1676, 0.1672,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.123216316
Epoch 79: train_loss: 5.0542 recon_acc: 0.0457 val_roc: 0.6627 val_ap: 0.6945 f1: 0.6786 time: 0.2506
thresh 0.14692113
          test_roc: 0.6139 test_ap: 0.6523 test_f1: 0.6672 test_recon_acc: 0.0638
difference_matrix tensor([[0.0000, 0.1659, 0.1663, 0.1663, 0.1664, 0.1657, 0.1663, 0.1660, 0.1658,
         0.1655],
        [0.1659, 0.0000, 0.1661, 0.1662, 0.1669, 0.1655, 0.1669, 0.1665, 0.1666,
         0.1657],
        [0.1663, 0.1661, 0.0000, 0.1661, 0.1671, 0.1657, 0.1660, 0.1660, 0.1662,
         0.1656],
        [0.1663, 0.1662, 0.1661, 0.0000, 0.1664, 0.1658, 0.1669, 0.1657, 0.1661,
         0.1655],
        [0.1664, 0.1669, 0.1671, 0.1664, 0.0000, 0.1661, 0.1668, 0.1663, 0.1660,
         0.1658],
        [0.1657, 0.1655, 0.1657, 0.1658, 0.1661, 0.0000, 0.1665, 0.1656, 0.1656,
         0.1656],
        [0.1663, 0.1669, 0.1660, 0.1669, 0.1668, 0.1665, 0.0000, 0.1666, 0.1667,
         0.1656],
        [0.1660, 0.1665, 0.1660, 0.1657, 0.1663, 0.1656, 0.1666, 0.0000, 0.1657,
         0.1659],
        [0.1658, 0.1666, 0.1662, 0.1661, 0.1660, 0.1656, 0.1667, 0.1657, 0.0000,
         0.1655],
        [0.1655, 0.1657, 0.1656, 0.1655, 0.1658, 0.1656, 0.1656, 0.1659, 0.1655,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.38002038
Epoch 80: train_loss: 5.0431 recon_acc: 0.3315 val_roc: 0.6680 val_ap: 0.7007 f1: 0.6795 time: 0.2752
thresh 0.1512709
          test_roc: 0.6204 test_ap: 0.6615 test_f1: 0.6677 test_recon_acc: 0.0665
difference_matrix tensor([[0.0000, 0.1640, 0.1645, 0.1645, 0.1646, 0.1639, 0.1645, 0.1642, 0.1640,
         0.1637],
        [0.1640, 0.0000, 0.1642, 0.1644, 0.1651, 0.1637, 0.1651, 0.1647, 0.1648,
         0.1639],
        [0.1645, 0.1642, 0.0000, 0.1643, 0.1654, 0.1638, 0.1642, 0.1641, 0.1644,
         0.1638],
        [0.1645, 0.1644, 0.1643, 0.0000, 0.1647, 0.1640, 0.1651, 0.1639, 0.1643,
         0.1637],
        [0.1646, 0.1651, 0.1654, 0.1647, 0.0000, 0.1643, 0.1650, 0.1645, 0.1641,
         0.1640],
        [0.1639, 0.1637, 0.1638, 0.1640, 0.1643, 0.0000, 0.1647, 0.1638, 0.1638,
         0.1638],
        [0.1645, 0.1651, 0.1642, 0.1651, 0.1650, 0.1647, 0.0000, 0.1648, 0.1649,
         0.1637],
        [0.1642, 0.1647, 0.1641, 0.1639, 0.1645, 0.1638, 0.1648, 0.0000, 0.1639,
         0.1641],
        [0.1640, 0.1648, 0.1644, 0.1643, 0.1641, 0.1638, 0.1649, 0.1639, 0.0000,
         0.1637],
        [0.1637, 0.1639, 0.1638, 0.1637, 0.1640, 0.1638, 0.1637, 0.1641, 0.1637,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.25908032
Epoch 81: train_loss: 5.0327 recon_acc: 0.1743 val_roc: 0.6725 val_ap: 0.7065 f1: 0.6795 time: 0.2783
thresh 0.15339081
          test_roc: 0.6260 test_ap: 0.6686 test_f1: 0.6682 test_recon_acc: 0.0672
difference_matrix tensor([[0.0000, 0.1621, 0.1626, 0.1627, 0.1628, 0.1620, 0.1626, 0.1623, 0.1621,
         0.1619],
        [0.1621, 0.0000, 0.1623, 0.1626, 0.1632, 0.1618, 0.1633, 0.1628, 0.1629,
         0.1621],
        [0.1626, 0.1623, 0.0000, 0.1625, 0.1635, 0.1620, 0.1623, 0.1623, 0.1625,
         0.1620],
        [0.1627, 0.1626, 0.1625, 0.0000, 0.1628, 0.1622, 0.1632, 0.1620, 0.1624,
         0.1619],
        [0.1628, 0.1632, 0.1635, 0.1628, 0.0000, 0.1624, 0.1631, 0.1626, 0.1623,
         0.1622],
        [0.1620, 0.1618, 0.1620, 0.1622, 0.1624, 0.0000, 0.1628, 0.1619, 0.1619,
         0.1619],
        [0.1626, 0.1633, 0.1623, 0.1632, 0.1631, 0.1628, 0.0000, 0.1629, 0.1630,
         0.1619],
        [0.1623, 0.1628, 0.1623, 0.1620, 0.1626, 0.1619, 0.1629, 0.0000, 0.1620,
         0.1623],
        [0.1621, 0.1629, 0.1625, 0.1624, 0.1623, 0.1619, 0.1630, 0.1620, 0.0000,
         0.1618],
        [0.1619, 0.1621, 0.1620, 0.1619, 0.1622, 0.1619, 0.1619, 0.1623, 0.1618,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.26150388
Epoch 82: train_loss: 5.0228 recon_acc: 0.1755 val_roc: 0.6766 val_ap: 0.7115 f1: 0.6795 time: 0.2674
thresh 0.15542026
          test_roc: 0.6311 test_ap: 0.6747 test_f1: 0.6682 test_recon_acc: 0.0677
difference_matrix tensor([[0.0000, 0.1603, 0.1608, 0.1609, 0.1610, 0.1601, 0.1608, 0.1605, 0.1603,
         0.1600],
        [0.1603, 0.0000, 0.1605, 0.1607, 0.1614, 0.1599, 0.1614, 0.1610, 0.1611,
         0.1602],
        [0.1608, 0.1605, 0.0000, 0.1606, 0.1617, 0.1601, 0.1605, 0.1604, 0.1607,
         0.1601],
        [0.1609, 0.1607, 0.1606, 0.0000, 0.1610, 0.1603, 0.1614, 0.1602, 0.1606,
         0.1601],
        [0.1610, 0.1614, 0.1617, 0.1610, 0.0000, 0.1606, 0.1613, 0.1608, 0.1605,
         0.1604],
        [0.1601, 0.1599, 0.1601, 0.1603, 0.1606, 0.0000, 0.1610, 0.1600, 0.1601,
         0.1601],
        [0.1608, 0.1614, 0.1605, 0.1614, 0.1613, 0.1610, 0.0000, 0.1610, 0.1612,
         0.1601],
        [0.1605, 0.1610, 0.1604, 0.1602, 0.1608, 0.1600, 0.1610, 0.0000, 0.1602,
         0.1605],
        [0.1603, 0.1611, 0.1606, 0.1606, 0.1605, 0.1601, 0.1612, 0.1602, 0.0000,
         0.1600],
        [0.1600, 0.1602, 0.1601, 0.1601, 0.1604, 0.1601, 0.1601, 0.1605, 0.1600,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.26375294
Epoch 83: train_loss: 5.0130 recon_acc: 0.1764 val_roc: 0.6800 val_ap: 0.7158 f1: 0.6795 time: 0.2671
thresh 0.1571295
          test_roc: 0.6354 test_ap: 0.6798 test_f1: 0.6687 test_recon_acc: 0.0678
difference_matrix tensor([[0.0000, 0.1585, 0.1590, 0.1591, 0.1592, 0.1584, 0.1590, 0.1587, 0.1585,
         0.1583],
        [0.1585, 0.0000, 0.1587, 0.1590, 0.1597, 0.1582, 0.1597, 0.1592, 0.1593,
         0.1585],
        [0.1590, 0.1587, 0.0000, 0.1589, 0.1600, 0.1583, 0.1587, 0.1586, 0.1589,
         0.1584],
        [0.1591, 0.1590, 0.1589, 0.0000, 0.1593, 0.1586, 0.1597, 0.1584, 0.1589,
         0.1584],
        [0.1592, 0.1597, 0.1600, 0.1593, 0.0000, 0.1588, 0.1595, 0.1591, 0.1587,
         0.1587],
        [0.1584, 0.1582, 0.1583, 0.1586, 0.1588, 0.0000, 0.1592, 0.1583, 0.1583,
         0.1584],
        [0.1590, 0.1597, 0.1587, 0.1597, 0.1595, 0.1592, 0.0000, 0.1593, 0.1594,
         0.1583],
        [0.1587, 0.1592, 0.1586, 0.1584, 0.1591, 0.1583, 0.1593, 0.0000, 0.1584,
         0.1587],
        [0.1585, 0.1593, 0.1589, 0.1589, 0.1587, 0.1583, 0.1594, 0.1584, 0.0000,
         0.1582],
        [0.1583, 0.1585, 0.1584, 0.1584, 0.1587, 0.1584, 0.1583, 0.1587, 0.1582,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29918206
Epoch 84: train_loss: 5.0031 recon_acc: 0.2181 val_roc: 0.6826 val_ap: 0.7186 f1: 0.6799 time: 0.2798
thresh 0.15854038
          test_roc: 0.6389 test_ap: 0.6837 test_f1: 0.6692 test_recon_acc: 0.0676
difference_matrix tensor([[0.0000, 0.1569, 0.1574, 0.1575, 0.1576, 0.1568, 0.1574, 0.1571, 0.1569,
         0.1567],
        [0.1569, 0.0000, 0.1571, 0.1574, 0.1581, 0.1566, 0.1581, 0.1576, 0.1577,
         0.1569],
        [0.1574, 0.1571, 0.0000, 0.1573, 0.1584, 0.1567, 0.1571, 0.1570, 0.1573,
         0.1567],
        [0.1575, 0.1574, 0.1573, 0.0000, 0.1577, 0.1570, 0.1581, 0.1568, 0.1573,
         0.1568],
        [0.1576, 0.1581, 0.1584, 0.1577, 0.0000, 0.1572, 0.1579, 0.1574, 0.1571,
         0.1571],
        [0.1568, 0.1566, 0.1567, 0.1570, 0.1572, 0.0000, 0.1576, 0.1566, 0.1567,
         0.1568],
        [0.1574, 0.1581, 0.1571, 0.1581, 0.1579, 0.1576, 0.0000, 0.1577, 0.1578,
         0.1567],
        [0.1571, 0.1576, 0.1570, 0.1568, 0.1574, 0.1566, 0.1577, 0.0000, 0.1568,
         0.1571],
        [0.1569, 0.1577, 0.1573, 0.1572, 0.1571, 0.1567, 0.1578, 0.1568, 0.0000,
         0.1566],
        [0.1567, 0.1569, 0.1567, 0.1568, 0.1571, 0.1568, 0.1567, 0.1571, 0.1566,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.30272648
Epoch 85: train_loss: 4.9932 recon_acc: 0.2208 val_roc: 0.6843 val_ap: 0.7206 f1: 0.6799 time: 0.3087
thresh 0.15972959
          test_roc: 0.6417 test_ap: 0.6868 test_f1: 0.6692 test_recon_acc: 0.0671
difference_matrix tensor([[0.0000, 0.1555, 0.1560, 0.1561, 0.1562, 0.1553, 0.1560, 0.1557, 0.1554,
         0.1553],
        [0.1555, 0.0000, 0.1557, 0.1560, 0.1566, 0.1551, 0.1566, 0.1562, 0.1563,
         0.1555],
        [0.1560, 0.1557, 0.0000, 0.1558, 0.1569, 0.1553, 0.1557, 0.1556, 0.1558,
         0.1553],
        [0.1561, 0.1560, 0.1558, 0.0000, 0.1563, 0.1556, 0.1566, 0.1554, 0.1558,
         0.1554],
        [0.1562, 0.1566, 0.1569, 0.1563, 0.0000, 0.1558, 0.1565, 0.1560, 0.1557,
         0.1557],
        [0.1553, 0.1551, 0.1553, 0.1556, 0.1558, 0.0000, 0.1562, 0.1552, 0.1553,
         0.1553],
        [0.1560, 0.1566, 0.1557, 0.1566, 0.1565, 0.1562, 0.0000, 0.1562, 0.1564,
         0.1553],
        [0.1557, 0.1562, 0.1556, 0.1554, 0.1560, 0.1552, 0.1562, 0.0000, 0.1553,
         0.1557],
        [0.1554, 0.1563, 0.1558, 0.1558, 0.1557, 0.1553, 0.1564, 0.1553, 0.0000,
         0.1552],
        [0.1553, 0.1555, 0.1553, 0.1554, 0.1557, 0.1553, 0.1553, 0.1557, 0.1552,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29980335
Epoch 86: train_loss: 4.9830 recon_acc: 0.2154 val_roc: 0.6859 val_ap: 0.7221 f1: 0.6820 time: 0.2703
thresh 0.16067125
          test_roc: 0.6438 test_ap: 0.6889 test_f1: 0.6692 test_recon_acc: 0.0665
difference_matrix tensor([[0.0000, 0.1543, 0.1547, 0.1549, 0.1550, 0.1541, 0.1547, 0.1545, 0.1542,
         0.1541],
        [0.1543, 0.0000, 0.1545, 0.1548, 0.1554, 0.1539, 0.1554, 0.1549, 0.1551,
         0.1543],
        [0.1547, 0.1545, 0.0000, 0.1546, 0.1557, 0.1541, 0.1545, 0.1544, 0.1546,
         0.1541],
        [0.1549, 0.1548, 0.1546, 0.0000, 0.1551, 0.1543, 0.1554, 0.1542, 0.1546,
         0.1542],
        [0.1550, 0.1554, 0.1557, 0.1551, 0.0000, 0.1546, 0.1553, 0.1548, 0.1545,
         0.1545],
        [0.1541, 0.1539, 0.1541, 0.1543, 0.1546, 0.0000, 0.1550, 0.1540, 0.1540,
         0.1541],
        [0.1547, 0.1554, 0.1545, 0.1554, 0.1553, 0.1550, 0.0000, 0.1550, 0.1552,
         0.1541],
        [0.1545, 0.1549, 0.1544, 0.1542, 0.1548, 0.1540, 0.1550, 0.0000, 0.1541,
         0.1545],
        [0.1542, 0.1551, 0.1546, 0.1546, 0.1545, 0.1540, 0.1552, 0.1541, 0.0000,
         0.1540],
        [0.1541, 0.1543, 0.1541, 0.1542, 0.1545, 0.1541, 0.1541, 0.1545, 0.1540,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3023305
Epoch 87: train_loss: 4.9727 recon_acc: 0.2170 val_roc: 0.6862 val_ap: 0.7227 f1: 0.6820 time: 0.2715
thresh 0.13237154
          test_roc: 0.6451 test_ap: 0.6900 test_f1: 0.6696 test_recon_acc: 0.0443
difference_matrix tensor([[0.0000, 0.1534, 0.1538, 0.1539, 0.1541, 0.1532, 0.1538, 0.1535, 0.1533,
         0.1531],
        [0.1534, 0.0000, 0.1535, 0.1538, 0.1545, 0.1530, 0.1544, 0.1540, 0.1541,
         0.1533],
        [0.1538, 0.1535, 0.0000, 0.1537, 0.1548, 0.1532, 0.1535, 0.1534, 0.1536,
         0.1531],
        [0.1539, 0.1538, 0.1537, 0.0000, 0.1541, 0.1534, 0.1544, 0.1532, 0.1536,
         0.1532],
        [0.1541, 0.1545, 0.1548, 0.1541, 0.0000, 0.1537, 0.1544, 0.1539, 0.1536,
         0.1535],
        [0.1532, 0.1530, 0.1532, 0.1534, 0.1537, 0.0000, 0.1540, 0.1530, 0.1531,
         0.1532],
        [0.1538, 0.1544, 0.1535, 0.1544, 0.1544, 0.1540, 0.0000, 0.1540, 0.1542,
         0.1532],
        [0.1535, 0.1540, 0.1534, 0.1532, 0.1539, 0.1530, 0.1540, 0.0000, 0.1531,
         0.1535],
        [0.1533, 0.1541, 0.1536, 0.1536, 0.1536, 0.1531, 0.1542, 0.1531, 0.0000,
         0.1530],
        [0.1531, 0.1533, 0.1531, 0.1532, 0.1535, 0.1532, 0.1532, 0.1535, 0.1530,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.30384275
Epoch 88: train_loss: 4.9624 recon_acc: 0.2176 val_roc: 0.6866 val_ap: 0.7232 f1: 0.6820 time: 0.2849
thresh 0.13366134
          test_roc: 0.6459 test_ap: 0.6903 test_f1: 0.6696 test_recon_acc: 0.0442
difference_matrix tensor([[0.0000, 0.1527, 0.1531, 0.1532, 0.1534, 0.1525, 0.1531, 0.1528, 0.1526,
         0.1524],
        [0.1527, 0.0000, 0.1528, 0.1531, 0.1538, 0.1523, 0.1537, 0.1533, 0.1534,
         0.1526],
        [0.1531, 0.1528, 0.0000, 0.1530, 0.1541, 0.1525, 0.1528, 0.1527, 0.1529,
         0.1524],
        [0.1532, 0.1531, 0.1530, 0.0000, 0.1534, 0.1527, 0.1537, 0.1525, 0.1530,
         0.1525],
        [0.1534, 0.1538, 0.1541, 0.1534, 0.0000, 0.1530, 0.1537, 0.1532, 0.1529,
         0.1529],
        [0.1525, 0.1523, 0.1525, 0.1527, 0.1530, 0.0000, 0.1533, 0.1523, 0.1524,
         0.1525],
        [0.1531, 0.1537, 0.1528, 0.1537, 0.1537, 0.1533, 0.0000, 0.1533, 0.1535,
         0.1525],
        [0.1528, 0.1533, 0.1527, 0.1525, 0.1532, 0.1523, 0.1533, 0.0000, 0.1524,
         0.1528],
        [0.1526, 0.1534, 0.1529, 0.1530, 0.1529, 0.1524, 0.1535, 0.1524, 0.0000,
         0.1523],
        [0.1524, 0.1526, 0.1524, 0.1525, 0.1529, 0.1525, 0.1525, 0.1528, 0.1523,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2922609
Epoch 89: train_loss: 4.9521 recon_acc: 0.2017 val_roc: 0.6857 val_ap: 0.7223 f1: 0.6829 time: 0.2600
difference_matrix tensor([[0.0000, 0.1523, 0.1527, 0.1528, 0.1530, 0.1521, 0.1527, 0.1524, 0.1521,
         0.1520],
        [0.1523, 0.0000, 0.1524, 0.1527, 0.1534, 0.1519, 0.1533, 0.1528, 0.1530,
         0.1522],
        [0.1527, 0.1524, 0.0000, 0.1525, 0.1537, 0.1521, 0.1524, 0.1523, 0.1525,
         0.1520],
        [0.1528, 0.1527, 0.1525, 0.0000, 0.1530, 0.1523, 0.1533, 0.1521, 0.1525,
         0.1521],
        [0.1530, 0.1534, 0.1537, 0.1530, 0.0000, 0.1526, 0.1533, 0.1528, 0.1525,
         0.1525],
        [0.1521, 0.1519, 0.1521, 0.1523, 0.1526, 0.0000, 0.1528, 0.1519, 0.1520,
         0.1521],
        [0.1527, 0.1533, 0.1524, 0.1533, 0.1533, 0.1528, 0.0000, 0.1529, 0.1531,
         0.1521],
        [0.1524, 0.1528, 0.1523, 0.1521, 0.1528, 0.1519, 0.1529, 0.0000, 0.1520,
         0.1524],
        [0.1521, 0.1530, 0.1525, 0.1525, 0.1525, 0.1520, 0.1531, 0.1520, 0.0000,
         0.1519],
        [0.1520, 0.1522, 0.1520, 0.1521, 0.1525, 0.1521, 0.1521, 0.1524, 0.1519,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2898039
Epoch 90: train_loss: 4.9420 recon_acc: 0.1977 val_roc: 0.6852 val_ap: 0.7219 f1: 0.6829 time: 0.2509
difference_matrix tensor([[0.0000, 0.1522, 0.1525, 0.1526, 0.1528, 0.1519, 0.1525, 0.1522, 0.1520,
         0.1519],
        [0.1522, 0.0000, 0.1523, 0.1526, 0.1533, 0.1518, 0.1531, 0.1527, 0.1528,
         0.1521],
        [0.1525, 0.1523, 0.0000, 0.1524, 0.1535, 0.1519, 0.1523, 0.1521, 0.1523,
         0.1519],
        [0.1526, 0.1526, 0.1524, 0.0000, 0.1529, 0.1521, 0.1531, 0.1520, 0.1524,
         0.1519],
        [0.1528, 0.1533, 0.1535, 0.1529, 0.0000, 0.1524, 0.1531, 0.1526, 0.1524,
         0.1523],
        [0.1519, 0.1518, 0.1519, 0.1521, 0.1524, 0.0000, 0.1527, 0.1517, 0.1518,
         0.1519],
        [0.1525, 0.1531, 0.1523, 0.1531, 0.1531, 0.1527, 0.0000, 0.1527, 0.1529,
         0.1519],
        [0.1522, 0.1527, 0.1521, 0.1520, 0.1526, 0.1517, 0.1527, 0.0000, 0.1519,
         0.1522],
        [0.1520, 0.1528, 0.1523, 0.1524, 0.1524, 0.1518, 0.1529, 0.1519, 0.0000,
         0.1518],
        [0.1519, 0.1521, 0.1519, 0.1519, 0.1523, 0.1519, 0.1519, 0.1522, 0.1518,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28700313
Epoch 91: train_loss: 4.9320 recon_acc: 0.1936 val_roc: 0.6845 val_ap: 0.7212 f1: 0.6829 time: 0.2504
difference_matrix tensor([[0.0000, 0.1523, 0.1526, 0.1527, 0.1530, 0.1520, 0.1526, 0.1524, 0.1521,
         0.1520],
        [0.1523, 0.0000, 0.1524, 0.1527, 0.1534, 0.1519, 0.1532, 0.1528, 0.1529,
         0.1522],
        [0.1526, 0.1524, 0.0000, 0.1525, 0.1537, 0.1521, 0.1524, 0.1522, 0.1524,
         0.1520],
        [0.1527, 0.1527, 0.1525, 0.0000, 0.1530, 0.1522, 0.1532, 0.1521, 0.1525,
         0.1520],
        [0.1530, 0.1534, 0.1537, 0.1530, 0.0000, 0.1525, 0.1532, 0.1527, 0.1525,
         0.1524],
        [0.1520, 0.1519, 0.1521, 0.1522, 0.1525, 0.0000, 0.1528, 0.1519, 0.1519,
         0.1520],
        [0.1526, 0.1532, 0.1524, 0.1532, 0.1532, 0.1528, 0.0000, 0.1528, 0.1530,
         0.1520],
        [0.1524, 0.1528, 0.1522, 0.1521, 0.1527, 0.1519, 0.1528, 0.0000, 0.1520,
         0.1523],
        [0.1521, 0.1529, 0.1524, 0.1525, 0.1525, 0.1519, 0.1530, 0.1520, 0.0000,
         0.1519],
        [0.1520, 0.1522, 0.1520, 0.1520, 0.1524, 0.1520, 0.1520, 0.1523, 0.1519,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29643223
Epoch 92: train_loss: 4.9223 recon_acc: 0.2054 val_roc: 0.6839 val_ap: 0.7202 f1: 0.6820 time: 0.2569
difference_matrix tensor([[0.0000, 0.1526, 0.1530, 0.1530, 0.1533, 0.1523, 0.1529, 0.1527, 0.1524,
         0.1523],
        [0.1526, 0.0000, 0.1528, 0.1530, 0.1537, 0.1522, 0.1535, 0.1531, 0.1533,
         0.1525],
        [0.1530, 0.1528, 0.0000, 0.1528, 0.1540, 0.1524, 0.1527, 0.1525, 0.1528,
         0.1523],
        [0.1530, 0.1530, 0.1528, 0.0000, 0.1534, 0.1526, 0.1535, 0.1524, 0.1528,
         0.1523],
        [0.1533, 0.1537, 0.1540, 0.1534, 0.0000, 0.1529, 0.1536, 0.1531, 0.1529,
         0.1528],
        [0.1523, 0.1522, 0.1524, 0.1526, 0.1529, 0.0000, 0.1531, 0.1522, 0.1522,
         0.1523],
        [0.1529, 0.1535, 0.1527, 0.1535, 0.1536, 0.1531, 0.0000, 0.1531, 0.1534,
         0.1524],
        [0.1527, 0.1531, 0.1525, 0.1524, 0.1531, 0.1522, 0.1531, 0.0000, 0.1523,
         0.1526],
        [0.1524, 0.1533, 0.1528, 0.1528, 0.1529, 0.1522, 0.1534, 0.1523, 0.0000,
         0.1522],
        [0.1523, 0.1525, 0.1523, 0.1523, 0.1528, 0.1523, 0.1524, 0.1526, 0.1522,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29275864
Epoch 93: train_loss: 4.9130 recon_acc: 0.2008 val_roc: 0.6831 val_ap: 0.7190 f1: 0.6819 time: 0.2861
difference_matrix tensor([[0.0000, 0.1532, 0.1535, 0.1536, 0.1538, 0.1529, 0.1534, 0.1532, 0.1530,
         0.1529],
        [0.1532, 0.0000, 0.1533, 0.1536, 0.1543, 0.1527, 0.1541, 0.1536, 0.1538,
         0.1530],
        [0.1535, 0.1533, 0.0000, 0.1533, 0.1545, 0.1530, 0.1533, 0.1531, 0.1533,
         0.1528],
        [0.1536, 0.1536, 0.1533, 0.0000, 0.1539, 0.1531, 0.1540, 0.1530, 0.1533,
         0.1529],
        [0.1538, 0.1543, 0.1545, 0.1539, 0.0000, 0.1534, 0.1541, 0.1536, 0.1534,
         0.1533],
        [0.1529, 0.1527, 0.1530, 0.1531, 0.1534, 0.0000, 0.1536, 0.1527, 0.1528,
         0.1529],
        [0.1534, 0.1541, 0.1533, 0.1540, 0.1541, 0.1536, 0.0000, 0.1536, 0.1539,
         0.1529],
        [0.1532, 0.1536, 0.1531, 0.1530, 0.1536, 0.1527, 0.1536, 0.0000, 0.1528,
         0.1531],
        [0.1530, 0.1538, 0.1533, 0.1533, 0.1534, 0.1528, 0.1539, 0.1528, 0.0000,
         0.1527],
        [0.1529, 0.1530, 0.1528, 0.1529, 0.1533, 0.1529, 0.1529, 0.1531, 0.1527,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3171861
Epoch 94: train_loss: 4.9039 recon_acc: 0.2330 val_roc: 0.6817 val_ap: 0.7170 f1: 0.6811 time: 0.2907
difference_matrix tensor([[0.0000, 0.1539, 0.1542, 0.1542, 0.1545, 0.1535, 0.1541, 0.1539, 0.1536,
         0.1535],
        [0.1539, 0.0000, 0.1540, 0.1543, 0.1550, 0.1534, 0.1547, 0.1543, 0.1545,
         0.1537],
        [0.1542, 0.1540, 0.0000, 0.1540, 0.1552, 0.1537, 0.1540, 0.1538, 0.1540,
         0.1535],
        [0.1542, 0.1543, 0.1540, 0.0000, 0.1546, 0.1538, 0.1547, 0.1537, 0.1540,
         0.1535],
        [0.1545, 0.1550, 0.1552, 0.1546, 0.0000, 0.1541, 0.1548, 0.1543, 0.1541,
         0.1540],
        [0.1535, 0.1534, 0.1537, 0.1538, 0.1541, 0.0000, 0.1543, 0.1534, 0.1535,
         0.1535],
        [0.1541, 0.1547, 0.1540, 0.1547, 0.1548, 0.1543, 0.0000, 0.1543, 0.1546,
         0.1536],
        [0.1539, 0.1543, 0.1538, 0.1537, 0.1543, 0.1534, 0.1543, 0.0000, 0.1535,
         0.1538],
        [0.1536, 0.1545, 0.1540, 0.1540, 0.1541, 0.1535, 0.1546, 0.1535, 0.0000,
         0.1534],
        [0.1535, 0.1537, 0.1535, 0.1535, 0.1540, 0.1535, 0.1536, 0.1538, 0.1534,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3129854
Epoch 95: train_loss: 4.8953 recon_acc: 0.2281 val_roc: 0.6810 val_ap: 0.7164 f1: 0.6811 time: 0.2772
difference_matrix tensor([[0.0000, 0.1547, 0.1550, 0.1550, 0.1553, 0.1543, 0.1549, 0.1547, 0.1544,
         0.1543],
        [0.1547, 0.0000, 0.1548, 0.1551, 0.1558, 0.1542, 0.1555, 0.1551, 0.1553,
         0.1545],
        [0.1550, 0.1548, 0.0000, 0.1548, 0.1560, 0.1545, 0.1548, 0.1545, 0.1548,
         0.1543],
        [0.1550, 0.1551, 0.1548, 0.0000, 0.1554, 0.1546, 0.1554, 0.1545, 0.1548,
         0.1543],
        [0.1553, 0.1558, 0.1560, 0.1554, 0.0000, 0.1549, 0.1556, 0.1551, 0.1549,
         0.1548],
        [0.1543, 0.1542, 0.1545, 0.1546, 0.1549, 0.0000, 0.1550, 0.1542, 0.1543,
         0.1543],
        [0.1549, 0.1555, 0.1548, 0.1554, 0.1556, 0.1550, 0.0000, 0.1551, 0.1554,
         0.1544],
        [0.1547, 0.1551, 0.1545, 0.1545, 0.1551, 0.1542, 0.1551, 0.0000, 0.1543,
         0.1546],
        [0.1544, 0.1553, 0.1548, 0.1548, 0.1549, 0.1543, 0.1554, 0.1543, 0.0000,
         0.1542],
        [0.1543, 0.1545, 0.1543, 0.1543, 0.1548, 0.1543, 0.1544, 0.1546, 0.1542,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.30549532
Epoch 96: train_loss: 4.8869 recon_acc: 0.2191 val_roc: 0.6805 val_ap: 0.7153 f1: 0.6821 time: 0.2725
difference_matrix tensor([[0.0000, 0.1555, 0.1558, 0.1559, 0.1562, 0.1552, 0.1557, 0.1556, 0.1553,
         0.1552],
        [0.1555, 0.0000, 0.1556, 0.1559, 0.1566, 0.1551, 0.1564, 0.1559, 0.1562,
         0.1553],
        [0.1558, 0.1556, 0.0000, 0.1556, 0.1569, 0.1553, 0.1556, 0.1554, 0.1556,
         0.1551],
        [0.1559, 0.1559, 0.1556, 0.0000, 0.1563, 0.1555, 0.1563, 0.1553, 0.1557,
         0.1552],
        [0.1562, 0.1566, 0.1569, 0.1563, 0.0000, 0.1558, 0.1565, 0.1560, 0.1558,
         0.1557],
        [0.1552, 0.1551, 0.1553, 0.1555, 0.1558, 0.0000, 0.1559, 0.1550, 0.1551,
         0.1552],
        [0.1557, 0.1564, 0.1556, 0.1563, 0.1565, 0.1559, 0.0000, 0.1559, 0.1562,
         0.1552],
        [0.1556, 0.1559, 0.1554, 0.1553, 0.1560, 0.1550, 0.1559, 0.0000, 0.1552,
         0.1555],
        [0.1553, 0.1562, 0.1556, 0.1557, 0.1558, 0.1551, 0.1562, 0.1552, 0.0000,
         0.1551],
        [0.1552, 0.1553, 0.1551, 0.1552, 0.1557, 0.1552, 0.1552, 0.1555, 0.1551,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3053968
Epoch 97: train_loss: 4.8789 recon_acc: 0.2199 val_roc: 0.6802 val_ap: 0.7147 f1: 0.6821 time: 0.2730
difference_matrix tensor([[0.0000, 0.1564, 0.1567, 0.1567, 0.1571, 0.1561, 0.1566, 0.1564, 0.1562,
         0.1561],
        [0.1564, 0.0000, 0.1565, 0.1568, 0.1575, 0.1559, 0.1572, 0.1568, 0.1570,
         0.1562],
        [0.1567, 0.1565, 0.0000, 0.1565, 0.1577, 0.1562, 0.1565, 0.1563, 0.1565,
         0.1560],
        [0.1567, 0.1568, 0.1565, 0.0000, 0.1571, 0.1563, 0.1571, 0.1562, 0.1565,
         0.1560],
        [0.1571, 0.1575, 0.1577, 0.1571, 0.0000, 0.1566, 0.1573, 0.1568, 0.1567,
         0.1566],
        [0.1561, 0.1559, 0.1562, 0.1563, 0.1566, 0.0000, 0.1567, 0.1559, 0.1560,
         0.1561],
        [0.1566, 0.1572, 0.1565, 0.1571, 0.1573, 0.1567, 0.0000, 0.1568, 0.1571,
         0.1561],
        [0.1564, 0.1568, 0.1563, 0.1562, 0.1568, 0.1559, 0.1568, 0.0000, 0.1561,
         0.1563],
        [0.1562, 0.1570, 0.1565, 0.1565, 0.1567, 0.1560, 0.1571, 0.1561, 0.0000,
         0.1559],
        [0.1561, 0.1562, 0.1560, 0.1560, 0.1566, 0.1561, 0.1561, 0.1563, 0.1559,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31578708
Epoch 98: train_loss: 4.8712 recon_acc: 0.2344 val_roc: 0.6799 val_ap: 0.7143 f1: 0.6812 time: 0.2503
difference_matrix tensor([[0.0000, 0.1573, 0.1575, 0.1576, 0.1579, 0.1569, 0.1574, 0.1573, 0.1570,
         0.1569],
        [0.1573, 0.0000, 0.1573, 0.1576, 0.1583, 0.1568, 0.1581, 0.1576, 0.1579,
         0.1570],
        [0.1575, 0.1573, 0.0000, 0.1573, 0.1586, 0.1570, 0.1573, 0.1571, 0.1573,
         0.1568],
        [0.1576, 0.1576, 0.1573, 0.0000, 0.1580, 0.1572, 0.1580, 0.1570, 0.1574,
         0.1569],
        [0.1579, 0.1583, 0.1586, 0.1580, 0.0000, 0.1575, 0.1582, 0.1577, 0.1575,
         0.1574],
        [0.1569, 0.1568, 0.1570, 0.1572, 0.1575, 0.0000, 0.1576, 0.1568, 0.1568,
         0.1569],
        [0.1574, 0.1581, 0.1573, 0.1580, 0.1582, 0.1576, 0.0000, 0.1576, 0.1579,
         0.1570],
        [0.1573, 0.1576, 0.1571, 0.1570, 0.1577, 0.1568, 0.1576, 0.0000, 0.1569,
         0.1572],
        [0.1570, 0.1579, 0.1573, 0.1574, 0.1575, 0.1568, 0.1579, 0.1569, 0.0000,
         0.1568],
        [0.1569, 0.1570, 0.1568, 0.1569, 0.1574, 0.1569, 0.1570, 0.1572, 0.1568,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31536895
Epoch 99: train_loss: 4.8637 recon_acc: 0.2347 val_roc: 0.6800 val_ap: 0.7144 f1: 0.6812 time: 0.2507
difference_matrix tensor([[0.0000, 0.1580, 0.1583, 0.1583, 0.1587, 0.1576, 0.1582, 0.1581, 0.1578,
         0.1577],
        [0.1580, 0.0000, 0.1581, 0.1584, 0.1591, 0.1575, 0.1588, 0.1584, 0.1586,
         0.1578],
        [0.1583, 0.1581, 0.0000, 0.1581, 0.1594, 0.1578, 0.1581, 0.1579, 0.1581,
         0.1576],
        [0.1583, 0.1584, 0.1581, 0.0000, 0.1587, 0.1579, 0.1587, 0.1578, 0.1581,
         0.1576],
        [0.1587, 0.1591, 0.1594, 0.1587, 0.0000, 0.1582, 0.1589, 0.1584, 0.1583,
         0.1582],
        [0.1576, 0.1575, 0.1578, 0.1579, 0.1582, 0.0000, 0.1583, 0.1575, 0.1576,
         0.1577],
        [0.1582, 0.1588, 0.1581, 0.1587, 0.1589, 0.1583, 0.0000, 0.1584, 0.1587,
         0.1577],
        [0.1581, 0.1584, 0.1579, 0.1578, 0.1584, 0.1575, 0.1584, 0.0000, 0.1577,
         0.1579],
        [0.1578, 0.1586, 0.1581, 0.1581, 0.1583, 0.1576, 0.1587, 0.1577, 0.0000,
         0.1575],
        [0.1577, 0.1578, 0.1576, 0.1576, 0.1582, 0.1577, 0.1577, 0.1579, 0.1575,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3121938
Epoch100: train_loss: 4.8565 recon_acc: 0.2315 val_roc: 0.6807 val_ap: 0.7149 f1: 0.6823 time: 0.2551
difference_matrix tensor([[0.0000, 0.1587, 0.1589, 0.1590, 0.1593, 0.1583, 0.1588, 0.1587, 0.1584,
         0.1583],
        [0.1587, 0.0000, 0.1587, 0.1590, 0.1597, 0.1582, 0.1595, 0.1590, 0.1593,
         0.1584],
        [0.1589, 0.1587, 0.0000, 0.1587, 0.1600, 0.1585, 0.1587, 0.1585, 0.1587,
         0.1582],
        [0.1590, 0.1590, 0.1587, 0.0000, 0.1594, 0.1586, 0.1594, 0.1584, 0.1588,
         0.1583],
        [0.1593, 0.1597, 0.1600, 0.1594, 0.0000, 0.1589, 0.1596, 0.1591, 0.1590,
         0.1588],
        [0.1583, 0.1582, 0.1585, 0.1586, 0.1589, 0.0000, 0.1590, 0.1582, 0.1582,
         0.1583],
        [0.1588, 0.1595, 0.1587, 0.1594, 0.1596, 0.1590, 0.0000, 0.1590, 0.1594,
         0.1584],
        [0.1587, 0.1590, 0.1585, 0.1584, 0.1591, 0.1582, 0.1590, 0.0000, 0.1583,
         0.1586],
        [0.1584, 0.1593, 0.1587, 0.1588, 0.1590, 0.1582, 0.1594, 0.1583, 0.0000,
         0.1582],
        [0.1583, 0.1584, 0.1582, 0.1583, 0.1588, 0.1583, 0.1584, 0.1586, 0.1582,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31449983
Epoch101: train_loss: 4.8495 recon_acc: 0.2352 val_roc: 0.6809 val_ap: 0.7152 f1: 0.6812 time: 0.2785
difference_matrix tensor([[0.0000, 0.1592, 0.1594, 0.1595, 0.1598, 0.1588, 0.1593, 0.1592, 0.1589,
         0.1588],
        [0.1592, 0.0000, 0.1593, 0.1596, 0.1602, 0.1587, 0.1600, 0.1595, 0.1598,
         0.1590],
        [0.1594, 0.1593, 0.0000, 0.1592, 0.1605, 0.1590, 0.1592, 0.1590, 0.1592,
         0.1587],
        [0.1595, 0.1596, 0.1592, 0.0000, 0.1599, 0.1591, 0.1599, 0.1589, 0.1593,
         0.1588],
        [0.1598, 0.1602, 0.1605, 0.1599, 0.0000, 0.1594, 0.1601, 0.1596, 0.1595,
         0.1593],
        [0.1588, 0.1587, 0.1590, 0.1591, 0.1594, 0.0000, 0.1595, 0.1587, 0.1588,
         0.1589],
        [0.1593, 0.1600, 0.1592, 0.1599, 0.1601, 0.1595, 0.0000, 0.1596, 0.1599,
         0.1589],
        [0.1592, 0.1595, 0.1590, 0.1589, 0.1596, 0.1587, 0.1596, 0.0000, 0.1588,
         0.1591],
        [0.1589, 0.1598, 0.1592, 0.1593, 0.1595, 0.1588, 0.1599, 0.1588, 0.0000,
         0.1587],
        [0.1588, 0.1590, 0.1587, 0.1588, 0.1593, 0.1589, 0.1589, 0.1591, 0.1587,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31426284
Epoch102: train_loss: 4.8426 recon_acc: 0.2351 val_roc: 0.6656 val_ap: 0.6885 f1: 0.6820 time: 0.2872
difference_matrix tensor([[0.0000, 0.1595, 0.1598, 0.1598, 0.1602, 0.1591, 0.1597, 0.1596, 0.1593,
         0.1592],
        [0.1595, 0.0000, 0.1596, 0.1599, 0.1606, 0.1590, 0.1603, 0.1599, 0.1602,
         0.1593],
        [0.1598, 0.1596, 0.0000, 0.1595, 0.1609, 0.1593, 0.1596, 0.1594, 0.1596,
         0.1591],
        [0.1598, 0.1599, 0.1595, 0.0000, 0.1602, 0.1594, 0.1602, 0.1593, 0.1596,
         0.1591],
        [0.1602, 0.1606, 0.1609, 0.1602, 0.0000, 0.1598, 0.1605, 0.1599, 0.1598,
         0.1597],
        [0.1591, 0.1590, 0.1593, 0.1594, 0.1598, 0.0000, 0.1598, 0.1590, 0.1591,
         0.1592],
        [0.1597, 0.1603, 0.1596, 0.1602, 0.1605, 0.1598, 0.0000, 0.1599, 0.1602,
         0.1592],
        [0.1596, 0.1599, 0.1594, 0.1593, 0.1599, 0.1590, 0.1599, 0.0000, 0.1592,
         0.1594],
        [0.1593, 0.1602, 0.1596, 0.1596, 0.1598, 0.1591, 0.1602, 0.1592, 0.0000,
         0.1591],
        [0.1592, 0.1593, 0.1591, 0.1591, 0.1597, 0.1592, 0.1592, 0.1594, 0.1591,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2743951
Epoch103: train_loss: 4.8358 recon_acc: 0.1850 val_roc: 0.6662 val_ap: 0.6888 f1: 0.6828 time: 0.2941
difference_matrix tensor([[0.0000, 0.1597, 0.1600, 0.1600, 0.1603, 0.1593, 0.1598, 0.1598, 0.1594,
         0.1594],
        [0.1597, 0.0000, 0.1598, 0.1601, 0.1608, 0.1592, 0.1605, 0.1600, 0.1603,
         0.1595],
        [0.1600, 0.1598, 0.0000, 0.1597, 0.1610, 0.1595, 0.1598, 0.1595, 0.1598,
         0.1592],
        [0.1600, 0.1601, 0.1597, 0.0000, 0.1604, 0.1596, 0.1604, 0.1594, 0.1598,
         0.1593],
        [0.1603, 0.1608, 0.1610, 0.1604, 0.0000, 0.1599, 0.1606, 0.1601, 0.1600,
         0.1598],
        [0.1593, 0.1592, 0.1595, 0.1596, 0.1599, 0.0000, 0.1600, 0.1592, 0.1593,
         0.1594],
        [0.1598, 0.1605, 0.1598, 0.1604, 0.1606, 0.1600, 0.0000, 0.1601, 0.1604,
         0.1594],
        [0.1598, 0.1600, 0.1595, 0.1594, 0.1601, 0.1592, 0.1601, 0.0000, 0.1594,
         0.1596],
        [0.1594, 0.1603, 0.1598, 0.1598, 0.1600, 0.1593, 0.1604, 0.1594, 0.0000,
         0.1592],
        [0.1594, 0.1595, 0.1592, 0.1593, 0.1598, 0.1594, 0.1594, 0.1596, 0.1592,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31709492
Epoch104: train_loss: 4.8291 recon_acc: 0.2396 val_roc: 0.6671 val_ap: 0.6901 f1: 0.6832 time: 0.2766
difference_matrix tensor([[0.0000, 0.1597, 0.1599, 0.1600, 0.1603, 0.1593, 0.1598, 0.1598, 0.1594,
         0.1594],
        [0.1597, 0.0000, 0.1597, 0.1601, 0.1608, 0.1592, 0.1605, 0.1600, 0.1603,
         0.1595],
        [0.1599, 0.1597, 0.0000, 0.1597, 0.1610, 0.1595, 0.1597, 0.1595, 0.1597,
         0.1592],
        [0.1600, 0.1601, 0.1597, 0.0000, 0.1604, 0.1596, 0.1604, 0.1594, 0.1598,
         0.1593],
        [0.1603, 0.1608, 0.1610, 0.1604, 0.0000, 0.1599, 0.1606, 0.1601, 0.1600,
         0.1598],
        [0.1593, 0.1592, 0.1595, 0.1596, 0.1599, 0.0000, 0.1600, 0.1592, 0.1593,
         0.1594],
        [0.1598, 0.1605, 0.1597, 0.1604, 0.1606, 0.1600, 0.0000, 0.1601, 0.1604,
         0.1594],
        [0.1598, 0.1600, 0.1595, 0.1594, 0.1601, 0.1592, 0.1601, 0.0000, 0.1594,
         0.1596],
        [0.1594, 0.1603, 0.1597, 0.1598, 0.1600, 0.1593, 0.1604, 0.1594, 0.0000,
         0.1593],
        [0.1594, 0.1595, 0.1592, 0.1593, 0.1598, 0.1594, 0.1594, 0.1596, 0.1593,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3176943
Epoch105: train_loss: 4.8224 recon_acc: 0.2404 val_roc: 0.6683 val_ap: 0.6914 f1: 0.6832 time: 0.2844
difference_matrix tensor([[0.0000, 0.1595, 0.1598, 0.1598, 0.1602, 0.1592, 0.1597, 0.1596, 0.1593,
         0.1592],
        [0.1595, 0.0000, 0.1596, 0.1599, 0.1606, 0.1590, 0.1603, 0.1599, 0.1602,
         0.1593],
        [0.1598, 0.1596, 0.0000, 0.1595, 0.1609, 0.1593, 0.1596, 0.1593, 0.1596,
         0.1590],
        [0.1598, 0.1599, 0.1595, 0.0000, 0.1602, 0.1594, 0.1602, 0.1593, 0.1597,
         0.1591],
        [0.1602, 0.1606, 0.1609, 0.1602, 0.0000, 0.1598, 0.1605, 0.1599, 0.1598,
         0.1597],
        [0.1592, 0.1590, 0.1593, 0.1594, 0.1598, 0.0000, 0.1599, 0.1590, 0.1591,
         0.1593],
        [0.1597, 0.1603, 0.1596, 0.1602, 0.1605, 0.1599, 0.0000, 0.1599, 0.1602,
         0.1593],
        [0.1596, 0.1599, 0.1593, 0.1593, 0.1599, 0.1590, 0.1599, 0.0000, 0.1592,
         0.1595],
        [0.1593, 0.1602, 0.1596, 0.1597, 0.1598, 0.1591, 0.1602, 0.1592, 0.0000,
         0.1591],
        [0.1592, 0.1593, 0.1590, 0.1591, 0.1597, 0.1593, 0.1593, 0.1595, 0.1591,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31841224
Epoch106: train_loss: 4.8159 recon_acc: 0.2413 val_roc: 0.6692 val_ap: 0.6924 f1: 0.6832 time: 0.2445
difference_matrix tensor([[0.0000, 0.1592, 0.1594, 0.1595, 0.1598, 0.1588, 0.1593, 0.1593, 0.1589,
         0.1589],
        [0.1592, 0.0000, 0.1592, 0.1596, 0.1602, 0.1587, 0.1600, 0.1595, 0.1598,
         0.1590],
        [0.1594, 0.1592, 0.0000, 0.1592, 0.1605, 0.1590, 0.1592, 0.1590, 0.1592,
         0.1587],
        [0.1595, 0.1596, 0.1592, 0.0000, 0.1599, 0.1591, 0.1599, 0.1589, 0.1593,
         0.1588],
        [0.1598, 0.1602, 0.1605, 0.1599, 0.0000, 0.1594, 0.1601, 0.1596, 0.1595,
         0.1593],
        [0.1588, 0.1587, 0.1590, 0.1591, 0.1594, 0.0000, 0.1595, 0.1587, 0.1588,
         0.1589],
        [0.1593, 0.1600, 0.1592, 0.1599, 0.1601, 0.1595, 0.0000, 0.1596, 0.1599,
         0.1589],
        [0.1593, 0.1595, 0.1590, 0.1589, 0.1596, 0.1587, 0.1596, 0.0000, 0.1589,
         0.1592],
        [0.1589, 0.1598, 0.1592, 0.1593, 0.1595, 0.1588, 0.1599, 0.1589, 0.0000,
         0.1588],
        [0.1589, 0.1590, 0.1587, 0.1588, 0.1593, 0.1589, 0.1589, 0.1592, 0.1588,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3193925
Epoch107: train_loss: 4.8094 recon_acc: 0.2423 val_roc: 0.6706 val_ap: 0.6937 f1: 0.6832 time: 0.2463
difference_matrix tensor([[0.0000, 0.1587, 0.1590, 0.1590, 0.1593, 0.1583, 0.1589, 0.1588, 0.1584,
         0.1584],
        [0.1587, 0.0000, 0.1587, 0.1591, 0.1597, 0.1582, 0.1595, 0.1590, 0.1594,
         0.1585],
        [0.1590, 0.1587, 0.0000, 0.1587, 0.1601, 0.1585, 0.1588, 0.1585, 0.1587,
         0.1582],
        [0.1590, 0.1591, 0.1587, 0.0000, 0.1594, 0.1586, 0.1594, 0.1584, 0.1588,
         0.1583],
        [0.1593, 0.1597, 0.1601, 0.1594, 0.0000, 0.1590, 0.1596, 0.1591, 0.1590,
         0.1589],
        [0.1583, 0.1582, 0.1585, 0.1586, 0.1590, 0.0000, 0.1591, 0.1582, 0.1583,
         0.1585],
        [0.1589, 0.1595, 0.1588, 0.1594, 0.1596, 0.1591, 0.0000, 0.1591, 0.1594,
         0.1585],
        [0.1588, 0.1590, 0.1585, 0.1584, 0.1591, 0.1582, 0.1591, 0.0000, 0.1584,
         0.1587],
        [0.1584, 0.1594, 0.1587, 0.1588, 0.1590, 0.1583, 0.1594, 0.1584, 0.0000,
         0.1583],
        [0.1584, 0.1585, 0.1582, 0.1583, 0.1589, 0.1585, 0.1585, 0.1587, 0.1583,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32556742
Epoch108: train_loss: 4.8029 recon_acc: 0.2500 val_roc: 0.6719 val_ap: 0.6955 f1: 0.6833 time: 0.2481
difference_matrix tensor([[0.0000, 0.1581, 0.1584, 0.1584, 0.1587, 0.1577, 0.1583, 0.1582, 0.1578,
         0.1578],
        [0.1581, 0.0000, 0.1581, 0.1585, 0.1591, 0.1576, 0.1589, 0.1584, 0.1588,
         0.1579],
        [0.1584, 0.1581, 0.0000, 0.1581, 0.1595, 0.1579, 0.1582, 0.1579, 0.1581,
         0.1576],
        [0.1584, 0.1585, 0.1581, 0.0000, 0.1588, 0.1580, 0.1588, 0.1578, 0.1582,
         0.1578],
        [0.1587, 0.1591, 0.1595, 0.1588, 0.0000, 0.1584, 0.1590, 0.1585, 0.1584,
         0.1583],
        [0.1577, 0.1576, 0.1579, 0.1580, 0.1584, 0.0000, 0.1585, 0.1577, 0.1577,
         0.1579],
        [0.1583, 0.1589, 0.1582, 0.1588, 0.1590, 0.1585, 0.0000, 0.1585, 0.1588,
         0.1579],
        [0.1582, 0.1584, 0.1579, 0.1578, 0.1585, 0.1577, 0.1585, 0.0000, 0.1578,
         0.1581],
        [0.1578, 0.1588, 0.1581, 0.1582, 0.1584, 0.1577, 0.1588, 0.1578, 0.0000,
         0.1577],
        [0.1578, 0.1579, 0.1576, 0.1578, 0.1583, 0.1579, 0.1579, 0.1581, 0.1577,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32686627
Epoch109: train_loss: 4.7966 recon_acc: 0.2511 val_roc: 0.6730 val_ap: 0.6968 f1: 0.6833 time: 0.2513
difference_matrix tensor([[0.0000, 0.1574, 0.1577, 0.1577, 0.1580, 0.1571, 0.1576, 0.1575, 0.1571,
         0.1571],
        [0.1574, 0.0000, 0.1574, 0.1578, 0.1584, 0.1569, 0.1582, 0.1577, 0.1581,
         0.1572],
        [0.1577, 0.1574, 0.0000, 0.1574, 0.1588, 0.1572, 0.1575, 0.1572, 0.1574,
         0.1569],
        [0.1577, 0.1578, 0.1574, 0.0000, 0.1581, 0.1573, 0.1581, 0.1571, 0.1576,
         0.1571],
        [0.1580, 0.1584, 0.1588, 0.1581, 0.0000, 0.1577, 0.1583, 0.1578, 0.1577,
         0.1576],
        [0.1571, 0.1569, 0.1572, 0.1573, 0.1577, 0.0000, 0.1578, 0.1570, 0.1570,
         0.1572],
        [0.1576, 0.1582, 0.1575, 0.1581, 0.1583, 0.1578, 0.0000, 0.1578, 0.1582,
         0.1572],
        [0.1575, 0.1577, 0.1572, 0.1571, 0.1578, 0.1570, 0.1578, 0.0000, 0.1571,
         0.1574],
        [0.1571, 0.1581, 0.1574, 0.1576, 0.1577, 0.1570, 0.1582, 0.1571, 0.0000,
         0.1570],
        [0.1571, 0.1572, 0.1569, 0.1571, 0.1576, 0.1572, 0.1572, 0.1574, 0.1570,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32326794
Epoch110: train_loss: 4.7903 recon_acc: 0.2456 val_roc: 0.6742 val_ap: 0.6982 f1: 0.6843 time: 0.2465
difference_matrix tensor([[0.0000, 0.1566, 0.1569, 0.1570, 0.1573, 0.1563, 0.1568, 0.1568, 0.1564,
         0.1564],
        [0.1566, 0.0000, 0.1566, 0.1570, 0.1577, 0.1562, 0.1574, 0.1570, 0.1573,
         0.1565],
        [0.1569, 0.1566, 0.0000, 0.1566, 0.1580, 0.1565, 0.1567, 0.1565, 0.1567,
         0.1562],
        [0.1570, 0.1570, 0.1566, 0.0000, 0.1573, 0.1566, 0.1573, 0.1564, 0.1568,
         0.1563],
        [0.1573, 0.1577, 0.1580, 0.1573, 0.0000, 0.1569, 0.1576, 0.1571, 0.1570,
         0.1568],
        [0.1563, 0.1562, 0.1565, 0.1566, 0.1569, 0.0000, 0.1570, 0.1562, 0.1563,
         0.1564],
        [0.1568, 0.1574, 0.1567, 0.1573, 0.1576, 0.1570, 0.0000, 0.1571, 0.1574,
         0.1564],
        [0.1568, 0.1570, 0.1565, 0.1564, 0.1571, 0.1562, 0.1571, 0.0000, 0.1564,
         0.1567],
        [0.1564, 0.1573, 0.1567, 0.1568, 0.1570, 0.1563, 0.1574, 0.1564, 0.0000,
         0.1563],
        [0.1564, 0.1565, 0.1562, 0.1563, 0.1568, 0.1564, 0.1564, 0.1567, 0.1563,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3294408
Epoch111: train_loss: 4.7842 recon_acc: 0.2531 val_roc: 0.6755 val_ap: 0.7000 f1: 0.6833 time: 0.2622
difference_matrix tensor([[0.0000, 0.1558, 0.1561, 0.1562, 0.1565, 0.1555, 0.1560, 0.1560, 0.1556,
         0.1556],
        [0.1558, 0.0000, 0.1558, 0.1562, 0.1568, 0.1554, 0.1566, 0.1562, 0.1565,
         0.1557],
        [0.1561, 0.1558, 0.0000, 0.1558, 0.1572, 0.1557, 0.1559, 0.1557, 0.1559,
         0.1554],
        [0.1562, 0.1562, 0.1558, 0.0000, 0.1565, 0.1558, 0.1566, 0.1556, 0.1560,
         0.1555],
        [0.1565, 0.1568, 0.1572, 0.1565, 0.0000, 0.1561, 0.1568, 0.1563, 0.1562,
         0.1560],
        [0.1555, 0.1554, 0.1557, 0.1558, 0.1561, 0.0000, 0.1562, 0.1554, 0.1555,
         0.1557],
        [0.1560, 0.1566, 0.1559, 0.1566, 0.1568, 0.1562, 0.0000, 0.1563, 0.1566,
         0.1556],
        [0.1560, 0.1562, 0.1557, 0.1556, 0.1563, 0.1554, 0.1563, 0.0000, 0.1556,
         0.1559],
        [0.1556, 0.1565, 0.1559, 0.1560, 0.1562, 0.1555, 0.1566, 0.1556, 0.0000,
         0.1555],
        [0.1556, 0.1557, 0.1554, 0.1555, 0.1560, 0.1557, 0.1556, 0.1559, 0.1555,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33002198
Epoch112: train_loss: 4.7781 recon_acc: 0.2530 val_roc: 0.6767 val_ap: 0.7016 f1: 0.6844 time: 0.2772
difference_matrix tensor([[0.0000, 0.1550, 0.1553, 0.1554, 0.1557, 0.1547, 0.1552, 0.1552, 0.1548,
         0.1548],
        [0.1550, 0.0000, 0.1550, 0.1554, 0.1560, 0.1546, 0.1558, 0.1554, 0.1557,
         0.1549],
        [0.1553, 0.1550, 0.0000, 0.1550, 0.1564, 0.1549, 0.1551, 0.1549, 0.1551,
         0.1546],
        [0.1554, 0.1554, 0.1550, 0.0000, 0.1557, 0.1550, 0.1558, 0.1548, 0.1552,
         0.1547],
        [0.1557, 0.1560, 0.1564, 0.1557, 0.0000, 0.1553, 0.1560, 0.1555, 0.1554,
         0.1552],
        [0.1547, 0.1546, 0.1549, 0.1550, 0.1553, 0.0000, 0.1554, 0.1546, 0.1547,
         0.1549],
        [0.1552, 0.1558, 0.1551, 0.1558, 0.1560, 0.1554, 0.0000, 0.1555, 0.1558,
         0.1548],
        [0.1552, 0.1554, 0.1549, 0.1548, 0.1555, 0.1546, 0.1555, 0.0000, 0.1548,
         0.1551],
        [0.1548, 0.1557, 0.1551, 0.1552, 0.1554, 0.1547, 0.1558, 0.1548, 0.0000,
         0.1547],
        [0.1548, 0.1549, 0.1546, 0.1547, 0.1552, 0.1549, 0.1548, 0.1551, 0.1547,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33036664
Epoch113: train_loss: 4.7722 recon_acc: 0.2526 val_roc: 0.6777 val_ap: 0.7028 f1: 0.6844 time: 0.2650
difference_matrix tensor([[0.0000, 0.1542, 0.1545, 0.1546, 0.1549, 0.1539, 0.1544, 0.1544, 0.1540,
         0.1540],
        [0.1542, 0.0000, 0.1542, 0.1546, 0.1552, 0.1538, 0.1550, 0.1546, 0.1549,
         0.1541],
        [0.1545, 0.1542, 0.0000, 0.1542, 0.1556, 0.1541, 0.1543, 0.1541, 0.1543,
         0.1538],
        [0.1546, 0.1546, 0.1542, 0.0000, 0.1549, 0.1542, 0.1550, 0.1540, 0.1544,
         0.1540],
        [0.1549, 0.1552, 0.1556, 0.1549, 0.0000, 0.1545, 0.1552, 0.1547, 0.1546,
         0.1544],
        [0.1539, 0.1538, 0.1541, 0.1542, 0.1545, 0.0000, 0.1546, 0.1539, 0.1539,
         0.1541],
        [0.1544, 0.1550, 0.1543, 0.1550, 0.1552, 0.1546, 0.0000, 0.1547, 0.1550,
         0.1541],
        [0.1544, 0.1546, 0.1541, 0.1540, 0.1547, 0.1539, 0.1547, 0.0000, 0.1540,
         0.1543],
        [0.1540, 0.1549, 0.1543, 0.1544, 0.1546, 0.1539, 0.1550, 0.1540, 0.0000,
         0.1539],
        [0.1540, 0.1541, 0.1538, 0.1540, 0.1544, 0.1541, 0.1541, 0.1543, 0.1539,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2617013
Epoch114: train_loss: 4.7664 recon_acc: 0.1640 val_roc: 0.6786 val_ap: 0.7039 f1: 0.6847 time: 0.2895
difference_matrix tensor([[0.0000, 0.1535, 0.1538, 0.1539, 0.1541, 0.1532, 0.1537, 0.1537, 0.1533,
         0.1532],
        [0.1535, 0.0000, 0.1535, 0.1538, 0.1545, 0.1530, 0.1543, 0.1538, 0.1542,
         0.1533],
        [0.1538, 0.1535, 0.0000, 0.1535, 0.1549, 0.1534, 0.1536, 0.1534, 0.1535,
         0.1530],
        [0.1539, 0.1538, 0.1535, 0.0000, 0.1541, 0.1535, 0.1542, 0.1532, 0.1537,
         0.1532],
        [0.1541, 0.1545, 0.1549, 0.1541, 0.0000, 0.1538, 0.1544, 0.1539, 0.1538,
         0.1537],
        [0.1532, 0.1530, 0.1534, 0.1535, 0.1538, 0.0000, 0.1539, 0.1531, 0.1532,
         0.1533],
        [0.1537, 0.1543, 0.1536, 0.1542, 0.1544, 0.1539, 0.0000, 0.1540, 0.1543,
         0.1533],
        [0.1537, 0.1538, 0.1534, 0.1532, 0.1539, 0.1531, 0.1540, 0.0000, 0.1532,
         0.1536],
        [0.1533, 0.1542, 0.1535, 0.1537, 0.1538, 0.1532, 0.1543, 0.1532, 0.0000,
         0.1532],
        [0.1532, 0.1533, 0.1530, 0.1532, 0.1537, 0.1533, 0.1533, 0.1536, 0.1532,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2640559
Epoch115: train_loss: 4.7607 recon_acc: 0.1658 val_roc: 0.6789 val_ap: 0.7045 f1: 0.6847 time: 0.2879
difference_matrix tensor([[0.0000, 0.1528, 0.1531, 0.1532, 0.1534, 0.1525, 0.1530, 0.1530, 0.1526,
         0.1526],
        [0.1528, 0.0000, 0.1528, 0.1532, 0.1538, 0.1524, 0.1536, 0.1531, 0.1535,
         0.1527],
        [0.1531, 0.1528, 0.0000, 0.1528, 0.1542, 0.1527, 0.1529, 0.1527, 0.1529,
         0.1524],
        [0.1532, 0.1532, 0.1528, 0.0000, 0.1535, 0.1528, 0.1535, 0.1526, 0.1530,
         0.1525],
        [0.1534, 0.1538, 0.1542, 0.1535, 0.0000, 0.1531, 0.1538, 0.1533, 0.1532,
         0.1530],
        [0.1525, 0.1524, 0.1527, 0.1528, 0.1531, 0.0000, 0.1532, 0.1524, 0.1525,
         0.1527],
        [0.1530, 0.1536, 0.1529, 0.1535, 0.1538, 0.1532, 0.0000, 0.1533, 0.1536,
         0.1526],
        [0.1530, 0.1531, 0.1527, 0.1526, 0.1533, 0.1524, 0.1533, 0.0000, 0.1526,
         0.1529],
        [0.1526, 0.1535, 0.1529, 0.1530, 0.1532, 0.1525, 0.1536, 0.1526, 0.0000,
         0.1525],
        [0.1526, 0.1527, 0.1524, 0.1525, 0.1530, 0.1527, 0.1526, 0.1529, 0.1525,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.26516157
Epoch116: train_loss: 4.7551 recon_acc: 0.1663 val_roc: 0.6798 val_ap: 0.7057 f1: 0.6847 time: 0.2674
difference_matrix tensor([[0.0000, 0.1522, 0.1525, 0.1526, 0.1528, 0.1519, 0.1524, 0.1524, 0.1520,
         0.1519],
        [0.1522, 0.0000, 0.1522, 0.1525, 0.1531, 0.1517, 0.1530, 0.1525, 0.1528,
         0.1520],
        [0.1525, 0.1522, 0.0000, 0.1521, 0.1536, 0.1521, 0.1523, 0.1521, 0.1522,
         0.1518],
        [0.1526, 0.1525, 0.1521, 0.0000, 0.1528, 0.1522, 0.1529, 0.1520, 0.1524,
         0.1519],
        [0.1528, 0.1531, 0.1536, 0.1528, 0.0000, 0.1525, 0.1532, 0.1527, 0.1525,
         0.1524],
        [0.1519, 0.1517, 0.1521, 0.1522, 0.1525, 0.0000, 0.1526, 0.1518, 0.1519,
         0.1521],
        [0.1524, 0.1530, 0.1523, 0.1529, 0.1532, 0.1526, 0.0000, 0.1527, 0.1530,
         0.1520],
        [0.1524, 0.1525, 0.1521, 0.1520, 0.1527, 0.1518, 0.1527, 0.0000, 0.1520,
         0.1523],
        [0.1520, 0.1528, 0.1522, 0.1524, 0.1525, 0.1519, 0.1530, 0.1520, 0.0000,
         0.1519],
        [0.1519, 0.1520, 0.1518, 0.1519, 0.1524, 0.1521, 0.1520, 0.1523, 0.1519,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28015944
Epoch117: train_loss: 4.7496 recon_acc: 0.1839 val_roc: 0.6800 val_ap: 0.7059 f1: 0.6848 time: 0.2464
difference_matrix tensor([[0.0000, 0.1516, 0.1520, 0.1520, 0.1523, 0.1514, 0.1519, 0.1519, 0.1514,
         0.1514],
        [0.1516, 0.0000, 0.1516, 0.1520, 0.1526, 0.1512, 0.1525, 0.1520, 0.1523,
         0.1515],
        [0.1520, 0.1516, 0.0000, 0.1516, 0.1530, 0.1516, 0.1518, 0.1515, 0.1517,
         0.1512],
        [0.1520, 0.1520, 0.1516, 0.0000, 0.1523, 0.1516, 0.1524, 0.1514, 0.1519,
         0.1514],
        [0.1523, 0.1526, 0.1530, 0.1523, 0.0000, 0.1520, 0.1526, 0.1521, 0.1520,
         0.1519],
        [0.1514, 0.1512, 0.1516, 0.1516, 0.1520, 0.0000, 0.1521, 0.1513, 0.1514,
         0.1515],
        [0.1519, 0.1525, 0.1518, 0.1524, 0.1526, 0.1521, 0.0000, 0.1521, 0.1525,
         0.1515],
        [0.1519, 0.1520, 0.1515, 0.1514, 0.1521, 0.1513, 0.1521, 0.0000, 0.1514,
         0.1518],
        [0.1514, 0.1523, 0.1517, 0.1519, 0.1520, 0.1514, 0.1525, 0.1514, 0.0000,
         0.1514],
        [0.1514, 0.1515, 0.1512, 0.1514, 0.1519, 0.1515, 0.1515, 0.1518, 0.1514,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2862138
Epoch118: train_loss: 4.7442 recon_acc: 0.1908 val_roc: 0.6805 val_ap: 0.7065 f1: 0.6848 time: 0.2524
difference_matrix tensor([[0.0000, 0.1512, 0.1515, 0.1516, 0.1519, 0.1509, 0.1514, 0.1514, 0.1510,
         0.1510],
        [0.1512, 0.0000, 0.1512, 0.1516, 0.1522, 0.1508, 0.1520, 0.1515, 0.1519,
         0.1511],
        [0.1515, 0.1512, 0.0000, 0.1512, 0.1526, 0.1511, 0.1514, 0.1511, 0.1513,
         0.1508],
        [0.1516, 0.1516, 0.1512, 0.0000, 0.1519, 0.1512, 0.1520, 0.1510, 0.1514,
         0.1510],
        [0.1519, 0.1522, 0.1526, 0.1519, 0.0000, 0.1515, 0.1522, 0.1517, 0.1516,
         0.1515],
        [0.1509, 0.1508, 0.1511, 0.1512, 0.1515, 0.0000, 0.1516, 0.1509, 0.1510,
         0.1511],
        [0.1514, 0.1520, 0.1514, 0.1520, 0.1522, 0.1516, 0.0000, 0.1517, 0.1520,
         0.1511],
        [0.1514, 0.1515, 0.1511, 0.1510, 0.1517, 0.1509, 0.1517, 0.0000, 0.1510,
         0.1514],
        [0.1510, 0.1519, 0.1513, 0.1514, 0.1516, 0.1510, 0.1520, 0.1510, 0.0000,
         0.1509],
        [0.1510, 0.1511, 0.1508, 0.1510, 0.1515, 0.1511, 0.1511, 0.1514, 0.1509,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28749862
Epoch119: train_loss: 4.7388 recon_acc: 0.1919 val_roc: 0.6810 val_ap: 0.7072 f1: 0.6859 time: 0.2765
difference_matrix tensor([[0.0000, 0.1508, 0.1512, 0.1513, 0.1515, 0.1506, 0.1511, 0.1511, 0.1507,
         0.1507],
        [0.1508, 0.0000, 0.1508, 0.1512, 0.1518, 0.1504, 0.1517, 0.1512, 0.1515,
         0.1507],
        [0.1512, 0.1508, 0.0000, 0.1508, 0.1522, 0.1508, 0.1510, 0.1508, 0.1510,
         0.1505],
        [0.1513, 0.1512, 0.1508, 0.0000, 0.1515, 0.1509, 0.1516, 0.1507, 0.1511,
         0.1506],
        [0.1515, 0.1518, 0.1522, 0.1515, 0.0000, 0.1512, 0.1518, 0.1514, 0.1513,
         0.1511],
        [0.1506, 0.1504, 0.1508, 0.1509, 0.1512, 0.0000, 0.1513, 0.1505, 0.1506,
         0.1508],
        [0.1511, 0.1517, 0.1510, 0.1516, 0.1518, 0.1513, 0.0000, 0.1514, 0.1517,
         0.1507],
        [0.1511, 0.1512, 0.1508, 0.1507, 0.1514, 0.1505, 0.1514, 0.0000, 0.1507,
         0.1510],
        [0.1507, 0.1515, 0.1510, 0.1511, 0.1513, 0.1506, 0.1517, 0.1507, 0.0000,
         0.1506],
        [0.1507, 0.1507, 0.1505, 0.1506, 0.1511, 0.1508, 0.1507, 0.1510, 0.1506,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28825727
Epoch120: train_loss: 4.7335 recon_acc: 0.1924 val_roc: 0.6812 val_ap: 0.7075 f1: 0.6859 time: 0.2856
difference_matrix tensor([[0.0000, 0.1506, 0.1509, 0.1510, 0.1513, 0.1503, 0.1508, 0.1509, 0.1504,
         0.1504],
        [0.1506, 0.0000, 0.1506, 0.1510, 0.1515, 0.1502, 0.1514, 0.1509, 0.1513,
         0.1505],
        [0.1509, 0.1506, 0.0000, 0.1506, 0.1520, 0.1505, 0.1508, 0.1505, 0.1507,
         0.1502],
        [0.1510, 0.1510, 0.1506, 0.0000, 0.1513, 0.1506, 0.1514, 0.1504, 0.1508,
         0.1504],
        [0.1513, 0.1515, 0.1520, 0.1513, 0.0000, 0.1510, 0.1516, 0.1511, 0.1510,
         0.1509],
        [0.1503, 0.1502, 0.1505, 0.1506, 0.1510, 0.0000, 0.1511, 0.1503, 0.1504,
         0.1505],
        [0.1508, 0.1514, 0.1508, 0.1514, 0.1516, 0.1511, 0.0000, 0.1511, 0.1514,
         0.1505],
        [0.1509, 0.1509, 0.1505, 0.1504, 0.1511, 0.1503, 0.1511, 0.0000, 0.1504,
         0.1508],
        [0.1504, 0.1513, 0.1507, 0.1508, 0.1510, 0.1504, 0.1514, 0.1504, 0.0000,
         0.1504],
        [0.1504, 0.1505, 0.1502, 0.1504, 0.1509, 0.1505, 0.1505, 0.1508, 0.1504,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28903988
Epoch121: train_loss: 4.7282 recon_acc: 0.1930 val_roc: 0.6814 val_ap: 0.7078 f1: 0.6859 time: 0.2782
difference_matrix tensor([[0.0000, 0.1504, 0.1508, 0.1508, 0.1511, 0.1502, 0.1507, 0.1507, 0.1503,
         0.1502],
        [0.1504, 0.0000, 0.1504, 0.1508, 0.1514, 0.1500, 0.1512, 0.1508, 0.1511,
         0.1503],
        [0.1508, 0.1504, 0.0000, 0.1504, 0.1518, 0.1504, 0.1506, 0.1504, 0.1505,
         0.1501],
        [0.1508, 0.1508, 0.1504, 0.0000, 0.1511, 0.1505, 0.1512, 0.1502, 0.1507,
         0.1502],
        [0.1511, 0.1514, 0.1518, 0.1511, 0.0000, 0.1508, 0.1514, 0.1509, 0.1508,
         0.1507],
        [0.1502, 0.1500, 0.1504, 0.1505, 0.1508, 0.0000, 0.1509, 0.1501, 0.1502,
         0.1504],
        [0.1507, 0.1512, 0.1506, 0.1512, 0.1514, 0.1509, 0.0000, 0.1509, 0.1513,
         0.1503],
        [0.1507, 0.1508, 0.1504, 0.1502, 0.1509, 0.1501, 0.1509, 0.0000, 0.1503,
         0.1506],
        [0.1503, 0.1511, 0.1505, 0.1507, 0.1508, 0.1502, 0.1513, 0.1503, 0.0000,
         0.1502],
        [0.1502, 0.1503, 0.1501, 0.1502, 0.1507, 0.1504, 0.1503, 0.1506, 0.1502,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28970578
Epoch122: train_loss: 4.7229 recon_acc: 0.1936 val_roc: 0.6816 val_ap: 0.7080 f1: 0.6870 time: 0.2733
difference_matrix tensor([[0.0000, 0.1503, 0.1507, 0.1507, 0.1510, 0.1501, 0.1506, 0.1506, 0.1502,
         0.1502],
        [0.1503, 0.0000, 0.1503, 0.1507, 0.1513, 0.1499, 0.1511, 0.1507, 0.1510,
         0.1502],
        [0.1507, 0.1503, 0.0000, 0.1503, 0.1517, 0.1503, 0.1505, 0.1503, 0.1505,
         0.1500],
        [0.1507, 0.1507, 0.1503, 0.0000, 0.1510, 0.1504, 0.1511, 0.1502, 0.1506,
         0.1501],
        [0.1510, 0.1513, 0.1517, 0.1510, 0.0000, 0.1507, 0.1513, 0.1508, 0.1508,
         0.1506],
        [0.1501, 0.1499, 0.1503, 0.1504, 0.1507, 0.0000, 0.1508, 0.1501, 0.1501,
         0.1503],
        [0.1506, 0.1511, 0.1505, 0.1511, 0.1513, 0.1508, 0.0000, 0.1508, 0.1512,
         0.1502],
        [0.1506, 0.1507, 0.1503, 0.1502, 0.1508, 0.1501, 0.1508, 0.0000, 0.1502,
         0.1505],
        [0.1502, 0.1510, 0.1505, 0.1506, 0.1508, 0.1501, 0.1512, 0.1502, 0.0000,
         0.1501],
        [0.1502, 0.1502, 0.1500, 0.1501, 0.1506, 0.1503, 0.1502, 0.1505, 0.1501,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(2.3829e-06, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2903855
Epoch123: train_loss: 4.7178 recon_acc: 0.1943 val_roc: 0.6817 val_ap: 0.7078 f1: 0.6870 time: 0.2910
difference_matrix tensor([[0.0000, 0.1503, 0.1507, 0.1507, 0.1510, 0.1501, 0.1506, 0.1506, 0.1502,
         0.1502],
        [0.1503, 0.0000, 0.1503, 0.1507, 0.1512, 0.1499, 0.1511, 0.1506, 0.1510,
         0.1502],
        [0.1507, 0.1503, 0.0000, 0.1503, 0.1517, 0.1503, 0.1505, 0.1503, 0.1505,
         0.1500],
        [0.1507, 0.1507, 0.1503, 0.0000, 0.1510, 0.1504, 0.1511, 0.1501, 0.1506,
         0.1501],
        [0.1510, 0.1512, 0.1517, 0.1510, 0.0000, 0.1507, 0.1513, 0.1508, 0.1508,
         0.1506],
        [0.1501, 0.1499, 0.1503, 0.1504, 0.1507, 0.0000, 0.1508, 0.1501, 0.1501,
         0.1503],
        [0.1506, 0.1511, 0.1505, 0.1511, 0.1513, 0.1508, 0.0000, 0.1508, 0.1512,
         0.1502],
        [0.1506, 0.1506, 0.1503, 0.1501, 0.1508, 0.1501, 0.1508, 0.0000, 0.1502,
         0.1505],
        [0.1502, 0.1510, 0.1505, 0.1506, 0.1508, 0.1501, 0.1512, 0.1502, 0.0000,
         0.1501],
        [0.1502, 0.1502, 0.1500, 0.1501, 0.1506, 0.1503, 0.1502, 0.1505, 0.1501,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(2.5464e-06, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2909009
Epoch124: train_loss: 4.7126 recon_acc: 0.1949 val_roc: 0.6817 val_ap: 0.7079 f1: 0.6870 time: 0.2579
difference_matrix tensor([[0.0000, 0.1504, 0.1508, 0.1508, 0.1510, 0.1501, 0.1506, 0.1506, 0.1502,
         0.1502],
        [0.1504, 0.0000, 0.1504, 0.1507, 0.1513, 0.1500, 0.1511, 0.1507, 0.1511,
         0.1503],
        [0.1508, 0.1504, 0.0000, 0.1504, 0.1518, 0.1504, 0.1506, 0.1503, 0.1505,
         0.1500],
        [0.1508, 0.1507, 0.1504, 0.0000, 0.1510, 0.1504, 0.1511, 0.1502, 0.1507,
         0.1502],
        [0.1510, 0.1513, 0.1518, 0.1510, 0.0000, 0.1507, 0.1514, 0.1509, 0.1508,
         0.1507],
        [0.1501, 0.1500, 0.1504, 0.1504, 0.1507, 0.0000, 0.1508, 0.1501, 0.1502,
         0.1503],
        [0.1506, 0.1511, 0.1506, 0.1511, 0.1514, 0.1508, 0.0000, 0.1509, 0.1512,
         0.1503],
        [0.1506, 0.1507, 0.1503, 0.1502, 0.1509, 0.1501, 0.1509, 0.0000, 0.1503,
         0.1506],
        [0.1502, 0.1511, 0.1505, 0.1507, 0.1508, 0.1502, 0.1512, 0.1503, 0.0000,
         0.1502],
        [0.1502, 0.1503, 0.1500, 0.1502, 0.1507, 0.1503, 0.1503, 0.1506, 0.1502,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(3.2385e-07, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29136887
Epoch125: train_loss: 4.7076 recon_acc: 0.1955 val_roc: 0.6815 val_ap: 0.7078 f1: 0.6870 time: 0.2682
difference_matrix tensor([[0.0000, 0.1505, 0.1509, 0.1509, 0.1511, 0.1502, 0.1507, 0.1507, 0.1503,
         0.1503],
        [0.1505, 0.0000, 0.1505, 0.1508, 0.1514, 0.1501, 0.1512, 0.1508, 0.1511,
         0.1504],
        [0.1509, 0.1505, 0.0000, 0.1505, 0.1519, 0.1505, 0.1507, 0.1504, 0.1506,
         0.1501],
        [0.1509, 0.1508, 0.1505, 0.0000, 0.1511, 0.1505, 0.1512, 0.1503, 0.1507,
         0.1503],
        [0.1511, 0.1514, 0.1519, 0.1511, 0.0000, 0.1508, 0.1515, 0.1510, 0.1509,
         0.1508],
        [0.1502, 0.1501, 0.1505, 0.1505, 0.1508, 0.0000, 0.1509, 0.1502, 0.1503,
         0.1504],
        [0.1507, 0.1512, 0.1507, 0.1512, 0.1515, 0.1509, 0.0000, 0.1510, 0.1513,
         0.1504],
        [0.1507, 0.1508, 0.1504, 0.1503, 0.1510, 0.1502, 0.1510, 0.0000, 0.1504,
         0.1507],
        [0.1503, 0.1511, 0.1506, 0.1507, 0.1509, 0.1503, 0.1513, 0.1504, 0.0000,
         0.1503],
        [0.1503, 0.1504, 0.1501, 0.1503, 0.1508, 0.1504, 0.1504, 0.1507, 0.1503,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29185393
Epoch126: train_loss: 4.7025 recon_acc: 0.1963 val_roc: 0.6814 val_ap: 0.7080 f1: 0.6870 time: 0.2569
difference_matrix tensor([[0.0000, 0.1506, 0.1510, 0.1510, 0.1512, 0.1503, 0.1508, 0.1508, 0.1504,
         0.1504],
        [0.1506, 0.0000, 0.1506, 0.1509, 0.1515, 0.1502, 0.1513, 0.1509, 0.1512,
         0.1505],
        [0.1510, 0.1506, 0.0000, 0.1506, 0.1520, 0.1506, 0.1508, 0.1505, 0.1507,
         0.1502],
        [0.1510, 0.1509, 0.1506, 0.0000, 0.1512, 0.1507, 0.1513, 0.1504, 0.1508,
         0.1504],
        [0.1512, 0.1515, 0.1520, 0.1512, 0.0000, 0.1510, 0.1516, 0.1511, 0.1510,
         0.1509],
        [0.1503, 0.1502, 0.1506, 0.1507, 0.1510, 0.0000, 0.1510, 0.1503, 0.1504,
         0.1506],
        [0.1508, 0.1513, 0.1508, 0.1513, 0.1516, 0.1510, 0.0000, 0.1511, 0.1514,
         0.1505],
        [0.1508, 0.1509, 0.1505, 0.1504, 0.1511, 0.1503, 0.1511, 0.0000, 0.1505,
         0.1508],
        [0.1504, 0.1512, 0.1507, 0.1509, 0.1510, 0.1504, 0.1514, 0.1505, 0.0000,
         0.1504],
        [0.1504, 0.1505, 0.1502, 0.1504, 0.1509, 0.1506, 0.1505, 0.1508, 0.1504,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29221988
Epoch127: train_loss: 4.6976 recon_acc: 0.1968 val_roc: 0.6814 val_ap: 0.7078 f1: 0.6870 time: 0.2601
difference_matrix tensor([[0.0000, 0.1506, 0.1511, 0.1511, 0.1513, 0.1504, 0.1509, 0.1509, 0.1505,
         0.1505],
        [0.1506, 0.0000, 0.1507, 0.1510, 0.1516, 0.1503, 0.1514, 0.1510, 0.1513,
         0.1506],
        [0.1511, 0.1507, 0.0000, 0.1507, 0.1521, 0.1507, 0.1509, 0.1506, 0.1508,
         0.1504],
        [0.1511, 0.1510, 0.1507, 0.0000, 0.1513, 0.1508, 0.1514, 0.1505, 0.1509,
         0.1505],
        [0.1513, 0.1516, 0.1521, 0.1513, 0.0000, 0.1511, 0.1516, 0.1512, 0.1511,
         0.1510],
        [0.1504, 0.1503, 0.1507, 0.1508, 0.1511, 0.0000, 0.1511, 0.1504, 0.1505,
         0.1507],
        [0.1509, 0.1514, 0.1509, 0.1514, 0.1516, 0.1511, 0.0000, 0.1511, 0.1515,
         0.1506],
        [0.1509, 0.1510, 0.1506, 0.1505, 0.1512, 0.1504, 0.1511, 0.0000, 0.1505,
         0.1509],
        [0.1505, 0.1513, 0.1508, 0.1509, 0.1511, 0.1505, 0.1515, 0.1505, 0.0000,
         0.1505],
        [0.1505, 0.1506, 0.1504, 0.1505, 0.1510, 0.1507, 0.1506, 0.1509, 0.1505,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29262993
Epoch128: train_loss: 4.6927 recon_acc: 0.1974 val_roc: 0.6814 val_ap: 0.7080 f1: 0.6870 time: 0.2638
difference_matrix tensor([[0.0000, 0.1507, 0.1511, 0.1511, 0.1514, 0.1505, 0.1510, 0.1510, 0.1506,
         0.1506],
        [0.1507, 0.0000, 0.1508, 0.1511, 0.1516, 0.1504, 0.1515, 0.1510, 0.1514,
         0.1507],
        [0.1511, 0.1508, 0.0000, 0.1508, 0.1521, 0.1508, 0.1509, 0.1507, 0.1509,
         0.1504],
        [0.1511, 0.1511, 0.1508, 0.0000, 0.1514, 0.1508, 0.1514, 0.1506, 0.1510,
         0.1506],
        [0.1514, 0.1516, 0.1521, 0.1514, 0.0000, 0.1511, 0.1517, 0.1512, 0.1512,
         0.1510],
        [0.1505, 0.1504, 0.1508, 0.1508, 0.1511, 0.0000, 0.1512, 0.1505, 0.1506,
         0.1507],
        [0.1510, 0.1515, 0.1509, 0.1514, 0.1517, 0.1512, 0.0000, 0.1512, 0.1516,
         0.1507],
        [0.1510, 0.1510, 0.1507, 0.1506, 0.1512, 0.1505, 0.1512, 0.0000, 0.1506,
         0.1510],
        [0.1506, 0.1514, 0.1509, 0.1510, 0.1512, 0.1506, 0.1516, 0.1506, 0.0000,
         0.1506],
        [0.1506, 0.1507, 0.1504, 0.1506, 0.1510, 0.1507, 0.1507, 0.1510, 0.1506,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29295692
Epoch129: train_loss: 4.6879 recon_acc: 0.1979 val_roc: 0.6815 val_ap: 0.7079 f1: 0.6870 time: 0.2759
difference_matrix tensor([[0.0000, 0.1508, 0.1512, 0.1512, 0.1514, 0.1506, 0.1510, 0.1510, 0.1506,
         0.1506],
        [0.1508, 0.0000, 0.1508, 0.1511, 0.1517, 0.1504, 0.1515, 0.1511, 0.1514,
         0.1507],
        [0.1512, 0.1508, 0.0000, 0.1508, 0.1522, 0.1508, 0.1510, 0.1507, 0.1510,
         0.1505],
        [0.1512, 0.1511, 0.1508, 0.0000, 0.1514, 0.1509, 0.1515, 0.1506, 0.1511,
         0.1506],
        [0.1514, 0.1517, 0.1522, 0.1514, 0.0000, 0.1512, 0.1518, 0.1513, 0.1512,
         0.1511],
        [0.1506, 0.1504, 0.1508, 0.1509, 0.1512, 0.0000, 0.1512, 0.1505, 0.1506,
         0.1508],
        [0.1510, 0.1515, 0.1510, 0.1515, 0.1518, 0.1512, 0.0000, 0.1512, 0.1516,
         0.1507],
        [0.1510, 0.1511, 0.1507, 0.1506, 0.1513, 0.1505, 0.1512, 0.0000, 0.1507,
         0.1510],
        [0.1506, 0.1514, 0.1510, 0.1511, 0.1512, 0.1506, 0.1516, 0.1507, 0.0000,
         0.1506],
        [0.1506, 0.1507, 0.1505, 0.1506, 0.1511, 0.1508, 0.1507, 0.1510, 0.1506,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29328743
Epoch130: train_loss: 4.6831 recon_acc: 0.1983 val_roc: 0.6814 val_ap: 0.7076 f1: 0.6870 time: 0.2604
difference_matrix tensor([[0.0000, 0.1508, 0.1512, 0.1512, 0.1514, 0.1506, 0.1510, 0.1510, 0.1506,
         0.1506],
        [0.1508, 0.0000, 0.1508, 0.1511, 0.1516, 0.1504, 0.1515, 0.1510, 0.1514,
         0.1507],
        [0.1512, 0.1508, 0.0000, 0.1508, 0.1522, 0.1508, 0.1510, 0.1507, 0.1510,
         0.1505],
        [0.1512, 0.1511, 0.1508, 0.0000, 0.1514, 0.1509, 0.1515, 0.1506, 0.1511,
         0.1506],
        [0.1514, 0.1516, 0.1522, 0.1514, 0.0000, 0.1512, 0.1517, 0.1513, 0.1512,
         0.1511],
        [0.1506, 0.1504, 0.1508, 0.1509, 0.1512, 0.0000, 0.1512, 0.1506, 0.1506,
         0.1508],
        [0.1510, 0.1515, 0.1510, 0.1515, 0.1517, 0.1512, 0.0000, 0.1512, 0.1516,
         0.1507],
        [0.1510, 0.1510, 0.1507, 0.1506, 0.1513, 0.1506, 0.1512, 0.0000, 0.1507,
         0.1510],
        [0.1506, 0.1514, 0.1510, 0.1511, 0.1512, 0.1506, 0.1516, 0.1507, 0.0000,
         0.1506],
        [0.1506, 0.1507, 0.1505, 0.1506, 0.1511, 0.1508, 0.1507, 0.1510, 0.1506,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.293606
Epoch131: train_loss: 4.6784 recon_acc: 0.1987 val_roc: 0.6814 val_ap: 0.7076 f1: 0.6881 time: 0.2757
difference_matrix tensor([[0.0000, 0.1507, 0.1511, 0.1511, 0.1514, 0.1505, 0.1509, 0.1510, 0.1506,
         0.1506],
        [0.1507, 0.0000, 0.1507, 0.1510, 0.1516, 0.1504, 0.1514, 0.1510, 0.1514,
         0.1506],
        [0.1511, 0.1507, 0.0000, 0.1508, 0.1521, 0.1508, 0.1509, 0.1507, 0.1509,
         0.1504],
        [0.1511, 0.1510, 0.1508, 0.0000, 0.1514, 0.1508, 0.1514, 0.1505, 0.1510,
         0.1506],
        [0.1514, 0.1516, 0.1521, 0.1514, 0.0000, 0.1511, 0.1517, 0.1512, 0.1512,
         0.1510],
        [0.1505, 0.1504, 0.1508, 0.1508, 0.1511, 0.0000, 0.1512, 0.1505, 0.1506,
         0.1507],
        [0.1509, 0.1514, 0.1509, 0.1514, 0.1517, 0.1512, 0.0000, 0.1512, 0.1516,
         0.1507],
        [0.1510, 0.1510, 0.1507, 0.1505, 0.1512, 0.1505, 0.1512, 0.0000, 0.1506,
         0.1510],
        [0.1506, 0.1514, 0.1509, 0.1510, 0.1512, 0.1506, 0.1516, 0.1506, 0.0000,
         0.1506],
        [0.1506, 0.1506, 0.1504, 0.1506, 0.1510, 0.1507, 0.1507, 0.1510, 0.1506,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29382944
Epoch132: train_loss: 4.6737 recon_acc: 0.1988 val_roc: 0.6815 val_ap: 0.7076 f1: 0.6881 time: 0.2963
difference_matrix tensor([[0.0000, 0.1506, 0.1510, 0.1510, 0.1512, 0.1504, 0.1508, 0.1509, 0.1505,
         0.1505],
        [0.1506, 0.0000, 0.1506, 0.1509, 0.1515, 0.1503, 0.1513, 0.1509, 0.1513,
         0.1505],
        [0.1510, 0.1506, 0.0000, 0.1507, 0.1520, 0.1507, 0.1508, 0.1506, 0.1508,
         0.1503],
        [0.1510, 0.1509, 0.1507, 0.0000, 0.1513, 0.1507, 0.1513, 0.1504, 0.1509,
         0.1505],
        [0.1512, 0.1515, 0.1520, 0.1513, 0.0000, 0.1510, 0.1516, 0.1511, 0.1511,
         0.1509],
        [0.1504, 0.1503, 0.1507, 0.1507, 0.1510, 0.0000, 0.1511, 0.1504, 0.1505,
         0.1506],
        [0.1508, 0.1513, 0.1508, 0.1513, 0.1516, 0.1511, 0.0000, 0.1511, 0.1515,
         0.1506],
        [0.1509, 0.1509, 0.1506, 0.1504, 0.1511, 0.1504, 0.1511, 0.0000, 0.1505,
         0.1509],
        [0.1505, 0.1513, 0.1508, 0.1509, 0.1511, 0.1505, 0.1515, 0.1505, 0.0000,
         0.1505],
        [0.1505, 0.1505, 0.1503, 0.1505, 0.1509, 0.1506, 0.1506, 0.1509, 0.1505,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2941141
Epoch133: train_loss: 4.6690 recon_acc: 0.1990 val_roc: 0.6815 val_ap: 0.7078 f1: 0.6881 time: 0.2826
difference_matrix tensor([[0.0000, 0.1504, 0.1509, 0.1509, 0.1511, 0.1503, 0.1507, 0.1507, 0.1503,
         0.1503],
        [0.1504, 0.0000, 0.1505, 0.1508, 0.1513, 0.1501, 0.1512, 0.1507, 0.1511,
         0.1504],
        [0.1509, 0.1505, 0.0000, 0.1505, 0.1519, 0.1506, 0.1507, 0.1504, 0.1507,
         0.1502],
        [0.1509, 0.1508, 0.1505, 0.0000, 0.1511, 0.1506, 0.1511, 0.1503, 0.1508,
         0.1503],
        [0.1511, 0.1513, 0.1519, 0.1511, 0.0000, 0.1509, 0.1514, 0.1510, 0.1510,
         0.1508],
        [0.1503, 0.1501, 0.1506, 0.1506, 0.1509, 0.0000, 0.1509, 0.1503, 0.1504,
         0.1505],
        [0.1507, 0.1512, 0.1507, 0.1511, 0.1514, 0.1509, 0.0000, 0.1509, 0.1513,
         0.1504],
        [0.1507, 0.1507, 0.1504, 0.1503, 0.1510, 0.1503, 0.1509, 0.0000, 0.1504,
         0.1507],
        [0.1503, 0.1511, 0.1507, 0.1508, 0.1509, 0.1504, 0.1513, 0.1504, 0.0000,
         0.1503],
        [0.1503, 0.1504, 0.1502, 0.1503, 0.1508, 0.1505, 0.1504, 0.1507, 0.1503,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0., device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29435337
Epoch134: train_loss: 4.6644 recon_acc: 0.1991 val_roc: 0.6813 val_ap: 0.7079 f1: 0.6881 time: 0.3020
difference_matrix tensor([[0.0000, 0.1503, 0.1507, 0.1507, 0.1509, 0.1501, 0.1505, 0.1505, 0.1501,
         0.1502],
        [0.1503, 0.0000, 0.1503, 0.1506, 0.1511, 0.1499, 0.1510, 0.1505, 0.1509,
         0.1502],
        [0.1507, 0.1503, 0.0000, 0.1503, 0.1517, 0.1504, 0.1505, 0.1503, 0.1505,
         0.1500],
        [0.1507, 0.1506, 0.1503, 0.0000, 0.1509, 0.1504, 0.1509, 0.1501, 0.1506,
         0.1501],
        [0.1509, 0.1511, 0.1517, 0.1509, 0.0000, 0.1507, 0.1512, 0.1508, 0.1508,
         0.1506],
        [0.1501, 0.1499, 0.1504, 0.1504, 0.1507, 0.0000, 0.1507, 0.1501, 0.1502,
         0.1503],
        [0.1505, 0.1510, 0.1505, 0.1509, 0.1512, 0.1507, 0.0000, 0.1507, 0.1511,
         0.1502],
        [0.1505, 0.1505, 0.1503, 0.1501, 0.1508, 0.1501, 0.1507, 0.0000, 0.1502,
         0.1505],
        [0.1501, 0.1509, 0.1505, 0.1506, 0.1508, 0.1502, 0.1511, 0.1502, 0.0000,
         0.1501],
        [0.1502, 0.1502, 0.1500, 0.1501, 0.1506, 0.1503, 0.1502, 0.1505, 0.1501,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(1.2186e-06, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2942248
Epoch135: train_loss: 4.6599 recon_acc: 0.1987 val_roc: 0.6813 val_ap: 0.7077 f1: 0.6881 time: 0.2608
difference_matrix tensor([[0.0000, 0.1500, 0.1505, 0.1504, 0.1507, 0.1499, 0.1503, 0.1503, 0.1499,
         0.1499],
        [0.1500, 0.0000, 0.1501, 0.1503, 0.1509, 0.1497, 0.1507, 0.1503, 0.1507,
         0.1500],
        [0.1505, 0.1501, 0.0000, 0.1501, 0.1514, 0.1502, 0.1503, 0.1500, 0.1503,
         0.1498],
        [0.1504, 0.1503, 0.1501, 0.0000, 0.1507, 0.1502, 0.1507, 0.1499, 0.1504,
         0.1499],
        [0.1507, 0.1509, 0.1514, 0.1507, 0.0000, 0.1505, 0.1510, 0.1505, 0.1505,
         0.1504],
        [0.1499, 0.1497, 0.1502, 0.1502, 0.1505, 0.0000, 0.1505, 0.1499, 0.1500,
         0.1501],
        [0.1503, 0.1507, 0.1503, 0.1507, 0.1510, 0.1505, 0.0000, 0.1505, 0.1509,
         0.1500],
        [0.1503, 0.1503, 0.1500, 0.1499, 0.1505, 0.1499, 0.1505, 0.0000, 0.1499,
         0.1503],
        [0.1499, 0.1507, 0.1503, 0.1504, 0.1505, 0.1500, 0.1509, 0.1499, 0.0000,
         0.1499],
        [0.1499, 0.1500, 0.1498, 0.1499, 0.1504, 0.1501, 0.1500, 0.1503, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(3.0401e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28453022
Epoch136: train_loss: 4.6554 recon_acc: 0.1860 val_roc: 0.6816 val_ap: 0.7078 f1: 0.6880 time: 0.2643
difference_matrix tensor([[0.0000, 0.1499, 0.1503, 0.1503, 0.1505, 0.1498, 0.1501, 0.1502, 0.1498,
         0.1498],
        [0.1499, 0.0000, 0.1499, 0.1502, 0.1508, 0.1496, 0.1506, 0.1502, 0.1506,
         0.1499],
        [0.1503, 0.1499, 0.0000, 0.1500, 0.1513, 0.1500, 0.1501, 0.1499, 0.1501,
         0.1497],
        [0.1503, 0.1502, 0.1500, 0.0000, 0.1505, 0.1501, 0.1506, 0.1498, 0.1502,
         0.1498],
        [0.1505, 0.1508, 0.1513, 0.1505, 0.0000, 0.1503, 0.1509, 0.1504, 0.1504,
         0.1503],
        [0.1498, 0.1496, 0.1500, 0.1501, 0.1503, 0.0000, 0.1504, 0.1497, 0.1498,
         0.1500],
        [0.1501, 0.1506, 0.1501, 0.1506, 0.1509, 0.1504, 0.0000, 0.1503, 0.1508,
         0.1499],
        [0.1502, 0.1502, 0.1499, 0.1498, 0.1504, 0.1497, 0.1503, 0.0000, 0.1498,
         0.1502],
        [0.1498, 0.1506, 0.1501, 0.1502, 0.1504, 0.1498, 0.1508, 0.1498, 0.0000,
         0.1498],
        [0.1498, 0.1499, 0.1497, 0.1498, 0.1503, 0.1500, 0.1499, 0.1502, 0.1498,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(6.8884e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28705835
Epoch137: train_loss: 4.6509 recon_acc: 0.1890 val_roc: 0.6817 val_ap: 0.7080 f1: 0.6891 time: 0.2637
difference_matrix tensor([[0.0000, 0.1500, 0.1504, 0.1504, 0.1506, 0.1498, 0.1502, 0.1502, 0.1498,
         0.1499],
        [0.1500, 0.0000, 0.1500, 0.1502, 0.1508, 0.1497, 0.1506, 0.1502, 0.1506,
         0.1499],
        [0.1504, 0.1500, 0.0000, 0.1500, 0.1513, 0.1501, 0.1502, 0.1499, 0.1502,
         0.1497],
        [0.1504, 0.1502, 0.1500, 0.0000, 0.1506, 0.1501, 0.1506, 0.1498, 0.1503,
         0.1499],
        [0.1506, 0.1508, 0.1513, 0.1506, 0.0000, 0.1504, 0.1509, 0.1504, 0.1505,
         0.1503],
        [0.1498, 0.1497, 0.1501, 0.1501, 0.1504, 0.0000, 0.1504, 0.1498, 0.1499,
         0.1501],
        [0.1502, 0.1506, 0.1502, 0.1506, 0.1509, 0.1504, 0.0000, 0.1504, 0.1508,
         0.1499],
        [0.1502, 0.1502, 0.1499, 0.1498, 0.1504, 0.1498, 0.1504, 0.0000, 0.1499,
         0.1502],
        [0.1498, 0.1506, 0.1502, 0.1503, 0.1505, 0.1499, 0.1508, 0.1499, 0.0000,
         0.1499],
        [0.1499, 0.1499, 0.1497, 0.1499, 0.1503, 0.1501, 0.1499, 0.1502, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(4.7888e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28946763
Epoch138: train_loss: 4.6465 recon_acc: 0.1921 val_roc: 0.6818 val_ap: 0.7080 f1: 0.6891 time: 0.2583
difference_matrix tensor([[0.0000, 0.1501, 0.1505, 0.1505, 0.1507, 0.1500, 0.1503, 0.1504, 0.1500,
         0.1501],
        [0.1501, 0.0000, 0.1501, 0.1504, 0.1509, 0.1498, 0.1507, 0.1504, 0.1508,
         0.1501],
        [0.1505, 0.1501, 0.0000, 0.1501, 0.1515, 0.1503, 0.1503, 0.1501, 0.1504,
         0.1499],
        [0.1505, 0.1504, 0.1501, 0.0000, 0.1507, 0.1503, 0.1507, 0.1499, 0.1504,
         0.1500],
        [0.1507, 0.1509, 0.1515, 0.1507, 0.0000, 0.1505, 0.1510, 0.1506, 0.1506,
         0.1505],
        [0.1500, 0.1498, 0.1503, 0.1503, 0.1505, 0.0000, 0.1506, 0.1500, 0.1501,
         0.1503],
        [0.1503, 0.1507, 0.1503, 0.1507, 0.1510, 0.1506, 0.0000, 0.1505, 0.1510,
         0.1501],
        [0.1504, 0.1504, 0.1501, 0.1499, 0.1506, 0.1500, 0.1505, 0.0000, 0.1501,
         0.1504],
        [0.1500, 0.1508, 0.1504, 0.1504, 0.1506, 0.1501, 0.1510, 0.1501, 0.0000,
         0.1501],
        [0.1501, 0.1501, 0.1499, 0.1500, 0.1505, 0.1503, 0.1501, 0.1504, 0.1501,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(6.9526e-06, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2908752
Epoch139: train_loss: 4.6421 recon_acc: 0.1941 val_roc: 0.6817 val_ap: 0.7082 f1: 0.6891 time: 0.2586
difference_matrix tensor([[0.0000, 0.1502, 0.1506, 0.1506, 0.1508, 0.1501, 0.1504, 0.1505, 0.1501,
         0.1502],
        [0.1502, 0.0000, 0.1502, 0.1505, 0.1510, 0.1500, 0.1508, 0.1505, 0.1509,
         0.1502],
        [0.1506, 0.1502, 0.0000, 0.1502, 0.1515, 0.1504, 0.1504, 0.1502, 0.1505,
         0.1500],
        [0.1506, 0.1505, 0.1502, 0.0000, 0.1507, 0.1504, 0.1508, 0.1500, 0.1505,
         0.1501],
        [0.1508, 0.1510, 0.1515, 0.1507, 0.0000, 0.1506, 0.1510, 0.1507, 0.1507,
         0.1505],
        [0.1501, 0.1500, 0.1504, 0.1504, 0.1506, 0.0000, 0.1506, 0.1501, 0.1502,
         0.1504],
        [0.1504, 0.1508, 0.1504, 0.1508, 0.1510, 0.1506, 0.0000, 0.1506, 0.1511,
         0.1502],
        [0.1505, 0.1505, 0.1502, 0.1500, 0.1507, 0.1501, 0.1506, 0.0000, 0.1502,
         0.1506],
        [0.1501, 0.1509, 0.1505, 0.1505, 0.1507, 0.1502, 0.1511, 0.1502, 0.0000,
         0.1502],
        [0.1502, 0.1502, 0.1500, 0.1501, 0.1505, 0.1504, 0.1502, 0.1506, 0.1502,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(1.0014e-06, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28979003
Epoch140: train_loss: 4.6377 recon_acc: 0.1928 val_roc: 0.6818 val_ap: 0.7085 f1: 0.6891 time: 0.2638
difference_matrix tensor([[0.0000, 0.1502, 0.1506, 0.1506, 0.1507, 0.1501, 0.1503, 0.1505, 0.1501,
         0.1502],
        [0.1502, 0.0000, 0.1502, 0.1505, 0.1509, 0.1500, 0.1508, 0.1504, 0.1509,
         0.1502],
        [0.1506, 0.1502, 0.0000, 0.1502, 0.1515, 0.1504, 0.1503, 0.1502, 0.1504,
         0.1500],
        [0.1506, 0.1505, 0.1502, 0.0000, 0.1507, 0.1504, 0.1507, 0.1500, 0.1505,
         0.1501],
        [0.1507, 0.1509, 0.1515, 0.1507, 0.0000, 0.1506, 0.1510, 0.1506, 0.1506,
         0.1505],
        [0.1501, 0.1500, 0.1504, 0.1504, 0.1506, 0.0000, 0.1506, 0.1501, 0.1502,
         0.1504],
        [0.1503, 0.1508, 0.1503, 0.1507, 0.1510, 0.1506, 0.0000, 0.1505, 0.1510,
         0.1502],
        [0.1505, 0.1504, 0.1502, 0.1500, 0.1506, 0.1501, 0.1505, 0.0000, 0.1502,
         0.1506],
        [0.1501, 0.1509, 0.1504, 0.1505, 0.1506, 0.1502, 0.1510, 0.1502, 0.0000,
         0.1502],
        [0.1502, 0.1502, 0.1500, 0.1501, 0.1505, 0.1504, 0.1502, 0.1506, 0.1502,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(8.4837e-07, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28893963
Epoch141: train_loss: 4.6334 recon_acc: 0.1918 val_roc: 0.6822 val_ap: 0.7089 f1: 0.6891 time: 0.2678
difference_matrix tensor([[0.0000, 0.1501, 0.1505, 0.1505, 0.1506, 0.1500, 0.1502, 0.1503, 0.1500,
         0.1501],
        [0.1501, 0.0000, 0.1501, 0.1503, 0.1508, 0.1499, 0.1506, 0.1503, 0.1508,
         0.1501],
        [0.1505, 0.1501, 0.0000, 0.1501, 0.1513, 0.1503, 0.1502, 0.1501, 0.1503,
         0.1499],
        [0.1505, 0.1503, 0.1501, 0.0000, 0.1506, 0.1503, 0.1506, 0.1499, 0.1504,
         0.1500],
        [0.1506, 0.1508, 0.1513, 0.1506, 0.0000, 0.1505, 0.1508, 0.1505, 0.1505,
         0.1504],
        [0.1500, 0.1499, 0.1503, 0.1503, 0.1505, 0.0000, 0.1505, 0.1500, 0.1501,
         0.1503],
        [0.1502, 0.1506, 0.1502, 0.1506, 0.1508, 0.1505, 0.0000, 0.1504, 0.1509,
         0.1501],
        [0.1503, 0.1503, 0.1501, 0.1499, 0.1505, 0.1500, 0.1504, 0.0000, 0.1500,
         0.1505],
        [0.1500, 0.1508, 0.1503, 0.1504, 0.1505, 0.1501, 0.1509, 0.1500, 0.0000,
         0.1501],
        [0.1501, 0.1501, 0.1499, 0.1500, 0.1504, 0.1503, 0.1501, 0.1505, 0.1501,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(6.7843e-06, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28826177
Epoch142: train_loss: 4.6291 recon_acc: 0.1908 val_roc: 0.6821 val_ap: 0.7088 f1: 0.6891 time: 0.2396
difference_matrix tensor([[0.0000, 0.1499, 0.1503, 0.1503, 0.1504, 0.1499, 0.1500, 0.1502, 0.1498,
         0.1499],
        [0.1499, 0.0000, 0.1499, 0.1501, 0.1506, 0.1497, 0.1504, 0.1501, 0.1506,
         0.1500],
        [0.1503, 0.1499, 0.0000, 0.1499, 0.1511, 0.1501, 0.1500, 0.1499, 0.1501,
         0.1498],
        [0.1503, 0.1501, 0.1499, 0.0000, 0.1503, 0.1501, 0.1504, 0.1497, 0.1502,
         0.1499],
        [0.1504, 0.1506, 0.1511, 0.1503, 0.0000, 0.1503, 0.1506, 0.1503, 0.1503,
         0.1502],
        [0.1499, 0.1497, 0.1501, 0.1501, 0.1503, 0.0000, 0.1503, 0.1498, 0.1499,
         0.1502],
        [0.1500, 0.1504, 0.1500, 0.1504, 0.1506, 0.1503, 0.0000, 0.1502, 0.1507,
         0.1499],
        [0.1502, 0.1501, 0.1499, 0.1497, 0.1503, 0.1498, 0.1502, 0.0000, 0.1499,
         0.1503],
        [0.1498, 0.1506, 0.1501, 0.1502, 0.1503, 0.1499, 0.1507, 0.1499, 0.0000,
         0.1499],
        [0.1499, 0.1500, 0.1498, 0.1499, 0.1502, 0.1502, 0.1499, 0.1503, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(5.2383e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28741625
Epoch143: train_loss: 4.6249 recon_acc: 0.1894 val_roc: 0.6825 val_ap: 0.7093 f1: 0.6891 time: 0.2627
difference_matrix tensor([[0.0000, 0.1498, 0.1503, 0.1502, 0.1503, 0.1498, 0.1499, 0.1501, 0.1498,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1501, 0.1505, 0.1497, 0.1504, 0.1501, 0.1505,
         0.1499],
        [0.1503, 0.1498, 0.0000, 0.1498, 0.1510, 0.1501, 0.1499, 0.1498, 0.1501,
         0.1497],
        [0.1502, 0.1501, 0.1498, 0.0000, 0.1502, 0.1501, 0.1503, 0.1497, 0.1501,
         0.1498],
        [0.1503, 0.1505, 0.1510, 0.1502, 0.0000, 0.1502, 0.1505, 0.1502, 0.1502,
         0.1501],
        [0.1498, 0.1497, 0.1501, 0.1501, 0.1502, 0.0000, 0.1502, 0.1498, 0.1499,
         0.1501],
        [0.1499, 0.1504, 0.1499, 0.1503, 0.1505, 0.1502, 0.0000, 0.1501, 0.1506,
         0.1498],
        [0.1501, 0.1501, 0.1498, 0.1497, 0.1502, 0.1498, 0.1501, 0.0000, 0.1498,
         0.1502],
        [0.1498, 0.1505, 0.1501, 0.1501, 0.1502, 0.1499, 0.1506, 0.1498, 0.0000,
         0.1499],
        [0.1499, 0.1499, 0.1497, 0.1498, 0.1501, 0.1501, 0.1498, 0.1502, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(7.8942e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28556934
Epoch144: train_loss: 4.6207 recon_acc: 0.1870 val_roc: 0.6827 val_ap: 0.7094 f1: 0.6891 time: 0.2716
difference_matrix tensor([[0.0000, 0.1499, 0.1503, 0.1502, 0.1503, 0.1499, 0.1499, 0.1501, 0.1498,
         0.1499],
        [0.1499, 0.0000, 0.1499, 0.1501, 0.1505, 0.1497, 0.1504, 0.1501, 0.1506,
         0.1500],
        [0.1503, 0.1499, 0.0000, 0.1498, 0.1510, 0.1501, 0.1499, 0.1499, 0.1501,
         0.1498],
        [0.1502, 0.1501, 0.1498, 0.0000, 0.1502, 0.1501, 0.1503, 0.1497, 0.1502,
         0.1498],
        [0.1503, 0.1505, 0.1510, 0.1502, 0.0000, 0.1502, 0.1505, 0.1502, 0.1502,
         0.1502],
        [0.1499, 0.1497, 0.1501, 0.1501, 0.1502, 0.0000, 0.1503, 0.1498, 0.1499,
         0.1502],
        [0.1499, 0.1504, 0.1499, 0.1503, 0.1505, 0.1503, 0.0000, 0.1501, 0.1506,
         0.1498],
        [0.1501, 0.1501, 0.1499, 0.1497, 0.1502, 0.1498, 0.1501, 0.0000, 0.1498,
         0.1503],
        [0.1498, 0.1506, 0.1501, 0.1502, 0.1502, 0.1499, 0.1506, 0.1498, 0.0000,
         0.1499],
        [0.1499, 0.1500, 0.1498, 0.1498, 0.1502, 0.1502, 0.1498, 0.1503, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(6.0215e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28578705
Epoch145: train_loss: 4.6165 recon_acc: 0.1873 val_roc: 0.6827 val_ap: 0.7094 f1: 0.6870 time: 0.2801
difference_matrix tensor([[0.0000, 0.1500, 0.1504, 0.1503, 0.1503, 0.1500, 0.1500, 0.1503, 0.1499,
         0.1501],
        [0.1500, 0.0000, 0.1500, 0.1502, 0.1505, 0.1498, 0.1505, 0.1502, 0.1507,
         0.1501],
        [0.1504, 0.1500, 0.0000, 0.1500, 0.1511, 0.1502, 0.1500, 0.1500, 0.1502,
         0.1499],
        [0.1503, 0.1502, 0.1500, 0.0000, 0.1503, 0.1502, 0.1504, 0.1498, 0.1503,
         0.1500],
        [0.1503, 0.1505, 0.1511, 0.1503, 0.0000, 0.1503, 0.1505, 0.1503, 0.1503,
         0.1502],
        [0.1500, 0.1498, 0.1502, 0.1502, 0.1503, 0.0000, 0.1504, 0.1500, 0.1501,
         0.1503],
        [0.1500, 0.1505, 0.1500, 0.1504, 0.1505, 0.1504, 0.0000, 0.1502, 0.1507,
         0.1500],
        [0.1503, 0.1502, 0.1500, 0.1498, 0.1503, 0.1500, 0.1502, 0.0000, 0.1500,
         0.1504],
        [0.1499, 0.1507, 0.1502, 0.1503, 0.1503, 0.1501, 0.1507, 0.1500, 0.0000,
         0.1501],
        [0.1501, 0.1501, 0.1499, 0.1500, 0.1502, 0.1503, 0.1500, 0.1504, 0.1501,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(1.5291e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.284839
Epoch146: train_loss: 4.6124 recon_acc: 0.1862 val_roc: 0.6827 val_ap: 0.7095 f1: 0.6859 time: 0.3155
difference_matrix tensor([[0.0000, 0.1501, 0.1505, 0.1504, 0.1504, 0.1501, 0.1501, 0.1503, 0.1500,
         0.1502],
        [0.1501, 0.0000, 0.1501, 0.1503, 0.1506, 0.1499, 0.1505, 0.1503, 0.1507,
         0.1502],
        [0.1505, 0.1501, 0.0000, 0.1500, 0.1512, 0.1503, 0.1501, 0.1501, 0.1503,
         0.1500],
        [0.1504, 0.1503, 0.1500, 0.0000, 0.1503, 0.1503, 0.1504, 0.1499, 0.1504,
         0.1501],
        [0.1504, 0.1506, 0.1512, 0.1503, 0.0000, 0.1503, 0.1505, 0.1503, 0.1503,
         0.1503],
        [0.1501, 0.1499, 0.1503, 0.1503, 0.1503, 0.0000, 0.1504, 0.1501, 0.1502,
         0.1505],
        [0.1501, 0.1505, 0.1501, 0.1504, 0.1505, 0.1504, 0.0000, 0.1503, 0.1508,
         0.1500],
        [0.1503, 0.1503, 0.1501, 0.1499, 0.1503, 0.1501, 0.1503, 0.0000, 0.1501,
         0.1506],
        [0.1500, 0.1507, 0.1503, 0.1504, 0.1503, 0.1502, 0.1508, 0.1501, 0.0000,
         0.1502],
        [0.1502, 0.1502, 0.1500, 0.1501, 0.1503, 0.1505, 0.1500, 0.1506, 0.1502,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(4.3763e-06, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28361756
Epoch147: train_loss: 4.6083 recon_acc: 0.1848 val_roc: 0.6827 val_ap: 0.7095 f1: 0.6859 time: 0.2517
difference_matrix tensor([[0.0000, 0.1500, 0.1505, 0.1503, 0.1503, 0.1500, 0.1500, 0.1503, 0.1499,
         0.1501],
        [0.1500, 0.0000, 0.1500, 0.1502, 0.1504, 0.1499, 0.1504, 0.1502, 0.1507,
         0.1502],
        [0.1505, 0.1500, 0.0000, 0.1500, 0.1510, 0.1503, 0.1500, 0.1500, 0.1503,
         0.1500],
        [0.1503, 0.1502, 0.1500, 0.0000, 0.1502, 0.1502, 0.1503, 0.1498, 0.1503,
         0.1500],
        [0.1503, 0.1504, 0.1510, 0.1502, 0.0000, 0.1502, 0.1504, 0.1502, 0.1502,
         0.1502],
        [0.1500, 0.1499, 0.1503, 0.1502, 0.1502, 0.0000, 0.1503, 0.1500, 0.1501,
         0.1504],
        [0.1500, 0.1504, 0.1500, 0.1503, 0.1504, 0.1503, 0.0000, 0.1502, 0.1507,
         0.1500],
        [0.1503, 0.1502, 0.1500, 0.1498, 0.1502, 0.1500, 0.1502, 0.0000, 0.1500,
         0.1505],
        [0.1499, 0.1507, 0.1503, 0.1503, 0.1502, 0.1501, 0.1507, 0.1500, 0.0000,
         0.1501],
        [0.1501, 0.1502, 0.1500, 0.1500, 0.1502, 0.1504, 0.1500, 0.1505, 0.1501,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(1.0647e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28264597
Epoch148: train_loss: 4.6042 recon_acc: 0.1834 val_roc: 0.6829 val_ap: 0.7098 f1: 0.6848 time: 0.2388
difference_matrix tensor([[0.0000, 0.1499, 0.1503, 0.1502, 0.1501, 0.1499, 0.1498, 0.1501, 0.1498,
         0.1500],
        [0.1499, 0.0000, 0.1499, 0.1500, 0.1502, 0.1497, 0.1502, 0.1501, 0.1505,
         0.1500],
        [0.1503, 0.1499, 0.0000, 0.1498, 0.1509, 0.1501, 0.1498, 0.1499, 0.1501,
         0.1499],
        [0.1502, 0.1500, 0.1498, 0.0000, 0.1500, 0.1501, 0.1501, 0.1497, 0.1501,
         0.1499],
        [0.1501, 0.1502, 0.1509, 0.1500, 0.0000, 0.1500, 0.1502, 0.1500, 0.1500,
         0.1500],
        [0.1499, 0.1497, 0.1501, 0.1501, 0.1500, 0.0000, 0.1502, 0.1499, 0.1500,
         0.1503],
        [0.1498, 0.1502, 0.1498, 0.1501, 0.1502, 0.1502, 0.0000, 0.1500, 0.1505,
         0.1498],
        [0.1501, 0.1501, 0.1499, 0.1497, 0.1500, 0.1499, 0.1500, 0.0000, 0.1499,
         0.1504],
        [0.1498, 0.1505, 0.1501, 0.1501, 0.1500, 0.1500, 0.1505, 0.1499, 0.0000,
         0.1500],
        [0.1500, 0.1500, 0.1499, 0.1499, 0.1500, 0.1503, 0.1498, 0.1504, 0.1500,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(5.5460e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3159288
Epoch149: train_loss: 4.6001 recon_acc: 0.2265 val_roc: 0.6833 val_ap: 0.7102 f1: 0.6840 time: 0.2598
difference_matrix tensor([[0.0000, 0.1498, 0.1502, 0.1501, 0.1499, 0.1498, 0.1497, 0.1501, 0.1497,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1501, 0.1496, 0.1501, 0.1500, 0.1504,
         0.1499],
        [0.1502, 0.1498, 0.0000, 0.1498, 0.1507, 0.1501, 0.1497, 0.1498, 0.1500,
         0.1498],
        [0.1501, 0.1499, 0.1498, 0.0000, 0.1499, 0.1500, 0.1500, 0.1496, 0.1500,
         0.1498],
        [0.1499, 0.1501, 0.1507, 0.1499, 0.0000, 0.1499, 0.1500, 0.1499, 0.1499,
         0.1499],
        [0.1498, 0.1496, 0.1501, 0.1500, 0.1499, 0.0000, 0.1501, 0.1498, 0.1499,
         0.1502],
        [0.1497, 0.1501, 0.1497, 0.1500, 0.1500, 0.1501, 0.0000, 0.1499, 0.1504,
         0.1497],
        [0.1501, 0.1500, 0.1498, 0.1496, 0.1499, 0.1498, 0.1499, 0.0000, 0.1498,
         0.1503],
        [0.1497, 0.1504, 0.1500, 0.1500, 0.1499, 0.1499, 0.1504, 0.1498, 0.0000,
         0.1499],
        [0.1499, 0.1499, 0.1498, 0.1498, 0.1499, 0.1502, 0.1497, 0.1503, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0001, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31955528
Epoch150: train_loss: 4.5961 recon_acc: 0.2312 val_roc: 0.6834 val_ap: 0.7102 f1: 0.6840 time: 0.2491
difference_matrix tensor([[0.0000, 0.1499, 0.1503, 0.1502, 0.1500, 0.1499, 0.1498, 0.1501, 0.1498,
         0.1500],
        [0.1499, 0.0000, 0.1499, 0.1500, 0.1501, 0.1497, 0.1502, 0.1501, 0.1505,
         0.1500],
        [0.1503, 0.1499, 0.0000, 0.1498, 0.1508, 0.1502, 0.1498, 0.1499, 0.1501,
         0.1499],
        [0.1502, 0.1500, 0.1498, 0.0000, 0.1499, 0.1501, 0.1501, 0.1497, 0.1501,
         0.1499],
        [0.1500, 0.1501, 0.1508, 0.1499, 0.0000, 0.1499, 0.1500, 0.1499, 0.1499,
         0.1500],
        [0.1499, 0.1497, 0.1502, 0.1501, 0.1499, 0.0000, 0.1501, 0.1499, 0.1500,
         0.1503],
        [0.1498, 0.1502, 0.1498, 0.1501, 0.1500, 0.1501, 0.0000, 0.1500, 0.1505,
         0.1498],
        [0.1501, 0.1501, 0.1499, 0.1497, 0.1499, 0.1499, 0.1500, 0.0000, 0.1499,
         0.1504],
        [0.1498, 0.1505, 0.1501, 0.1501, 0.1499, 0.1500, 0.1505, 0.1499, 0.0000,
         0.1500],
        [0.1500, 0.1500, 0.1499, 0.1499, 0.1500, 0.1503, 0.1498, 0.1504, 0.1500,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(6.1450e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32190764
Epoch151: train_loss: 4.5922 recon_acc: 0.2345 val_roc: 0.6835 val_ap: 0.7103 f1: 0.6840 time: 0.2638
difference_matrix tensor([[0.0000, 0.1500, 0.1505, 0.1503, 0.1501, 0.1501, 0.1499, 0.1503, 0.1500,
         0.1502],
        [0.1500, 0.0000, 0.1500, 0.1501, 0.1502, 0.1499, 0.1503, 0.1502, 0.1506,
         0.1502],
        [0.1505, 0.1500, 0.0000, 0.1500, 0.1509, 0.1503, 0.1500, 0.1501, 0.1503,
         0.1501],
        [0.1503, 0.1501, 0.1500, 0.0000, 0.1500, 0.1502, 0.1502, 0.1499, 0.1503,
         0.1501],
        [0.1501, 0.1502, 0.1509, 0.1500, 0.0000, 0.1501, 0.1502, 0.1501, 0.1501,
         0.1501],
        [0.1501, 0.1499, 0.1503, 0.1502, 0.1501, 0.0000, 0.1503, 0.1501, 0.1501,
         0.1505],
        [0.1499, 0.1503, 0.1500, 0.1502, 0.1502, 0.1503, 0.0000, 0.1501, 0.1506,
         0.1500],
        [0.1503, 0.1502, 0.1501, 0.1499, 0.1501, 0.1501, 0.1501, 0.0000, 0.1500,
         0.1506],
        [0.1500, 0.1506, 0.1503, 0.1503, 0.1501, 0.1501, 0.1506, 0.1500, 0.0000,
         0.1502],
        [0.1502, 0.1502, 0.1501, 0.1501, 0.1501, 0.1505, 0.1500, 0.1506, 0.1502,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(1.0116e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3182148
Epoch152: train_loss: 4.5882 recon_acc: 0.2296 val_roc: 0.6834 val_ap: 0.7101 f1: 0.6862 time: 0.2634
difference_matrix tensor([[0.0000, 0.1500, 0.1505, 0.1503, 0.1501, 0.1501, 0.1499, 0.1503, 0.1500,
         0.1502],
        [0.1500, 0.0000, 0.1500, 0.1501, 0.1502, 0.1499, 0.1503, 0.1502, 0.1506,
         0.1502],
        [0.1505, 0.1500, 0.0000, 0.1500, 0.1509, 0.1503, 0.1500, 0.1501, 0.1503,
         0.1501],
        [0.1503, 0.1501, 0.1500, 0.0000, 0.1500, 0.1502, 0.1502, 0.1499, 0.1503,
         0.1501],
        [0.1501, 0.1502, 0.1509, 0.1500, 0.0000, 0.1501, 0.1501, 0.1501, 0.1500,
         0.1501],
        [0.1501, 0.1499, 0.1503, 0.1502, 0.1501, 0.0000, 0.1502, 0.1501, 0.1501,
         0.1505],
        [0.1499, 0.1503, 0.1500, 0.1502, 0.1501, 0.1502, 0.0000, 0.1501, 0.1506,
         0.1500],
        [0.1503, 0.1502, 0.1501, 0.1499, 0.1501, 0.1501, 0.1501, 0.0000, 0.1501,
         0.1506],
        [0.1500, 0.1506, 0.1503, 0.1503, 0.1500, 0.1501, 0.1506, 0.1501, 0.0000,
         0.1502],
        [0.1502, 0.1502, 0.1501, 0.1501, 0.1501, 0.1505, 0.1500, 0.1506, 0.1502,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(1.0271e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31906182
Epoch153: train_loss: 4.5843 recon_acc: 0.2307 val_roc: 0.6836 val_ap: 0.7105 f1: 0.6862 time: 0.2521
difference_matrix tensor([[0.0000, 0.1499, 0.1504, 0.1502, 0.1499, 0.1499, 0.1498, 0.1502, 0.1498,
         0.1501],
        [0.1499, 0.0000, 0.1499, 0.1500, 0.1500, 0.1497, 0.1501, 0.1501, 0.1504,
         0.1500],
        [0.1504, 0.1499, 0.0000, 0.1499, 0.1507, 0.1502, 0.1498, 0.1500, 0.1501,
         0.1500],
        [0.1502, 0.1500, 0.1499, 0.0000, 0.1498, 0.1501, 0.1500, 0.1497, 0.1501,
         0.1499],
        [0.1499, 0.1500, 0.1507, 0.1498, 0.0000, 0.1499, 0.1500, 0.1499, 0.1499,
         0.1499],
        [0.1499, 0.1497, 0.1502, 0.1501, 0.1499, 0.0000, 0.1501, 0.1500, 0.1500,
         0.1503],
        [0.1498, 0.1501, 0.1498, 0.1500, 0.1500, 0.1501, 0.0000, 0.1500, 0.1504,
         0.1498],
        [0.1502, 0.1501, 0.1500, 0.1497, 0.1499, 0.1500, 0.1500, 0.0000, 0.1499,
         0.1505],
        [0.1498, 0.1504, 0.1501, 0.1501, 0.1499, 0.1500, 0.1504, 0.1499, 0.0000,
         0.1500],
        [0.1501, 0.1500, 0.1500, 0.1499, 0.1499, 0.1503, 0.1498, 0.1505, 0.1500,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(5.9076e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.319942
Epoch154: train_loss: 4.5804 recon_acc: 0.2317 val_roc: 0.6837 val_ap: 0.7105 f1: 0.6862 time: 0.2586
difference_matrix tensor([[0.0000, 0.1498, 0.1503, 0.1501, 0.1499, 0.1499, 0.1497, 0.1501, 0.1498,
         0.1500],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1499, 0.1496, 0.1500, 0.1500, 0.1504,
         0.1500],
        [0.1503, 0.1498, 0.0000, 0.1498, 0.1507, 0.1501, 0.1498, 0.1499, 0.1501,
         0.1499],
        [0.1501, 0.1499, 0.1498, 0.0000, 0.1498, 0.1500, 0.1500, 0.1497, 0.1500,
         0.1499],
        [0.1499, 0.1499, 0.1507, 0.1498, 0.0000, 0.1498, 0.1499, 0.1498, 0.1498,
         0.1499],
        [0.1499, 0.1496, 0.1501, 0.1500, 0.1498, 0.0000, 0.1500, 0.1499, 0.1499,
         0.1503],
        [0.1497, 0.1500, 0.1498, 0.1500, 0.1499, 0.1500, 0.0000, 0.1499, 0.1504,
         0.1498],
        [0.1501, 0.1500, 0.1499, 0.1497, 0.1498, 0.1499, 0.1499, 0.0000, 0.1499,
         0.1504],
        [0.1498, 0.1504, 0.1501, 0.1500, 0.1498, 0.1499, 0.1504, 0.1499, 0.0000,
         0.1500],
        [0.1500, 0.1500, 0.1499, 0.1499, 0.1499, 0.1503, 0.1498, 0.1504, 0.1500,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(9.9034e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33163032
Epoch155: train_loss: 4.5765 recon_acc: 0.2476 val_roc: 0.6839 val_ap: 0.7107 f1: 0.6864 time: 0.2475
difference_matrix tensor([[0.0000, 0.1499, 0.1504, 0.1502, 0.1499, 0.1499, 0.1498, 0.1502, 0.1498,
         0.1501],
        [0.1499, 0.0000, 0.1499, 0.1499, 0.1500, 0.1497, 0.1501, 0.1501, 0.1504,
         0.1500],
        [0.1504, 0.1499, 0.0000, 0.1499, 0.1507, 0.1502, 0.1498, 0.1500, 0.1501,
         0.1500],
        [0.1502, 0.1499, 0.1499, 0.0000, 0.1498, 0.1501, 0.1500, 0.1498, 0.1501,
         0.1500],
        [0.1499, 0.1500, 0.1507, 0.1498, 0.0000, 0.1499, 0.1499, 0.1499, 0.1498,
         0.1499],
        [0.1499, 0.1497, 0.1502, 0.1501, 0.1499, 0.0000, 0.1501, 0.1500, 0.1499,
         0.1503],
        [0.1498, 0.1501, 0.1498, 0.1500, 0.1499, 0.1501, 0.0000, 0.1500, 0.1504,
         0.1498],
        [0.1502, 0.1501, 0.1500, 0.1498, 0.1499, 0.1500, 0.1500, 0.0000, 0.1499,
         0.1505],
        [0.1498, 0.1504, 0.1501, 0.1501, 0.1498, 0.1499, 0.1504, 0.1499, 0.0000,
         0.1500],
        [0.1501, 0.1500, 0.1500, 0.1500, 0.1499, 0.1503, 0.1498, 0.1505, 0.1500,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(5.7927e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33333716
Epoch156: train_loss: 4.5727 recon_acc: 0.2500 val_roc: 0.6842 val_ap: 0.7112 f1: 0.6875 time: 0.2557
difference_matrix tensor([[0.0000, 0.1500, 0.1505, 0.1503, 0.1501, 0.1500, 0.1499, 0.1503, 0.1499,
         0.1502],
        [0.1500, 0.0000, 0.1500, 0.1500, 0.1501, 0.1498, 0.1502, 0.1502, 0.1505,
         0.1501],
        [0.1505, 0.1500, 0.0000, 0.1500, 0.1508, 0.1503, 0.1499, 0.1501, 0.1502,
         0.1501],
        [0.1503, 0.1500, 0.1500, 0.0000, 0.1500, 0.1502, 0.1501, 0.1499, 0.1502,
         0.1501],
        [0.1501, 0.1501, 0.1508, 0.1500, 0.0000, 0.1500, 0.1501, 0.1500, 0.1500,
         0.1501],
        [0.1500, 0.1498, 0.1503, 0.1502, 0.1500, 0.0000, 0.1502, 0.1501, 0.1500,
         0.1504],
        [0.1499, 0.1502, 0.1499, 0.1501, 0.1501, 0.1502, 0.0000, 0.1501, 0.1505,
         0.1499],
        [0.1503, 0.1502, 0.1501, 0.1499, 0.1500, 0.1501, 0.1501, 0.0000, 0.1500,
         0.1506],
        [0.1499, 0.1505, 0.1502, 0.1502, 0.1500, 0.1500, 0.1505, 0.1500, 0.0000,
         0.1501],
        [0.1502, 0.1501, 0.1501, 0.1501, 0.1501, 0.1504, 0.1499, 0.1506, 0.1501,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(1.8032e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32866278
Epoch157: train_loss: 4.5689 recon_acc: 0.2436 val_roc: 0.6844 val_ap: 0.7113 f1: 0.6885 time: 0.2531
difference_matrix tensor([[0.0000, 0.1499, 0.1504, 0.1503, 0.1501, 0.1500, 0.1499, 0.1503, 0.1499,
         0.1502],
        [0.1499, 0.0000, 0.1499, 0.1500, 0.1501, 0.1498, 0.1502, 0.1501, 0.1504,
         0.1501],
        [0.1504, 0.1499, 0.0000, 0.1500, 0.1508, 0.1502, 0.1499, 0.1501, 0.1502,
         0.1501],
        [0.1503, 0.1500, 0.1500, 0.0000, 0.1500, 0.1502, 0.1501, 0.1499, 0.1502,
         0.1500],
        [0.1501, 0.1501, 0.1508, 0.1500, 0.0000, 0.1500, 0.1501, 0.1500, 0.1499,
         0.1500],
        [0.1500, 0.1498, 0.1502, 0.1502, 0.1500, 0.0000, 0.1501, 0.1501, 0.1500,
         0.1504],
        [0.1499, 0.1502, 0.1499, 0.1501, 0.1501, 0.1501, 0.0000, 0.1501, 0.1505,
         0.1499],
        [0.1503, 0.1501, 0.1501, 0.1499, 0.1500, 0.1501, 0.1501, 0.0000, 0.1500,
         0.1506],
        [0.1499, 0.1504, 0.1502, 0.1502, 0.1499, 0.1500, 0.1505, 0.1500, 0.0000,
         0.1501],
        [0.1502, 0.1501, 0.1501, 0.1500, 0.1500, 0.1504, 0.1499, 0.1506, 0.1501,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(2.3166e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3289804
Epoch158: train_loss: 4.5651 recon_acc: 0.2439 val_roc: 0.6844 val_ap: 0.7113 f1: 0.6885 time: 0.2669
difference_matrix tensor([[0.0000, 0.1498, 0.1503, 0.1502, 0.1500, 0.1499, 0.1498, 0.1502, 0.1498,
         0.1500],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1496, 0.1500, 0.1500, 0.1503,
         0.1499],
        [0.1503, 0.1498, 0.0000, 0.1498, 0.1507, 0.1501, 0.1498, 0.1500, 0.1500,
         0.1499],
        [0.1502, 0.1499, 0.1498, 0.0000, 0.1499, 0.1500, 0.1500, 0.1498, 0.1500,
         0.1499],
        [0.1500, 0.1500, 0.1507, 0.1499, 0.0000, 0.1499, 0.1500, 0.1499, 0.1498,
         0.1499],
        [0.1499, 0.1496, 0.1501, 0.1500, 0.1499, 0.0000, 0.1500, 0.1499, 0.1499,
         0.1502],
        [0.1498, 0.1500, 0.1498, 0.1500, 0.1500, 0.1500, 0.0000, 0.1500, 0.1504,
         0.1498],
        [0.1502, 0.1500, 0.1500, 0.1498, 0.1499, 0.1499, 0.1500, 0.0000, 0.1499,
         0.1504],
        [0.1498, 0.1503, 0.1500, 0.1500, 0.1498, 0.1499, 0.1504, 0.1499, 0.0000,
         0.1499],
        [0.1500, 0.1499, 0.1499, 0.1499, 0.1499, 0.1502, 0.1498, 0.1504, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(7.8370e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3294334
Epoch159: train_loss: 4.5614 recon_acc: 0.2443 val_roc: 0.6846 val_ap: 0.7115 f1: 0.6885 time: 0.2754
difference_matrix tensor([[0.0000, 0.1498, 0.1503, 0.1501, 0.1500, 0.1499, 0.1498, 0.1501, 0.1497,
         0.1500],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1496, 0.1500, 0.1500, 0.1503,
         0.1499],
        [0.1503, 0.1498, 0.0000, 0.1498, 0.1507, 0.1501, 0.1498, 0.1499, 0.1500,
         0.1499],
        [0.1501, 0.1499, 0.1498, 0.0000, 0.1499, 0.1500, 0.1500, 0.1497, 0.1500,
         0.1499],
        [0.1500, 0.1500, 0.1507, 0.1499, 0.0000, 0.1499, 0.1500, 0.1499, 0.1498,
         0.1499],
        [0.1499, 0.1496, 0.1501, 0.1500, 0.1499, 0.0000, 0.1500, 0.1499, 0.1498,
         0.1502],
        [0.1498, 0.1500, 0.1498, 0.1500, 0.1500, 0.1500, 0.0000, 0.1499, 0.1503,
         0.1498],
        [0.1501, 0.1500, 0.1499, 0.1497, 0.1499, 0.1499, 0.1499, 0.0000, 0.1498,
         0.1504],
        [0.1497, 0.1503, 0.1500, 0.1500, 0.1498, 0.1498, 0.1503, 0.1498, 0.0000,
         0.1499],
        [0.1500, 0.1499, 0.1499, 0.1499, 0.1499, 0.1502, 0.1498, 0.1504, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(9.6604e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32995453
Epoch160: train_loss: 4.5577 recon_acc: 0.2449 val_roc: 0.6845 val_ap: 0.7117 f1: 0.6885 time: 0.2693
difference_matrix tensor([[0.0000, 0.1499, 0.1504, 0.1502, 0.1501, 0.1499, 0.1499, 0.1502, 0.1498,
         0.1501],
        [0.1499, 0.0000, 0.1499, 0.1500, 0.1501, 0.1497, 0.1501, 0.1500, 0.1504,
         0.1500],
        [0.1504, 0.1499, 0.0000, 0.1499, 0.1508, 0.1501, 0.1499, 0.1500, 0.1501,
         0.1499],
        [0.1502, 0.1500, 0.1499, 0.0000, 0.1500, 0.1501, 0.1501, 0.1498, 0.1501,
         0.1499],
        [0.1501, 0.1501, 0.1508, 0.1500, 0.0000, 0.1500, 0.1501, 0.1501, 0.1499,
         0.1500],
        [0.1499, 0.1497, 0.1501, 0.1501, 0.1500, 0.0000, 0.1501, 0.1500, 0.1499,
         0.1502],
        [0.1499, 0.1501, 0.1499, 0.1501, 0.1501, 0.1501, 0.0000, 0.1500, 0.1504,
         0.1498],
        [0.1502, 0.1500, 0.1500, 0.1498, 0.1501, 0.1500, 0.1500, 0.0000, 0.1499,
         0.1504],
        [0.1498, 0.1504, 0.1501, 0.1501, 0.1499, 0.1499, 0.1504, 0.1499, 0.0000,
         0.1499],
        [0.1501, 0.1500, 0.1499, 0.1499, 0.1500, 0.1502, 0.1498, 0.1504, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(4.5388e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32669747
Epoch161: train_loss: 4.5540 recon_acc: 0.2404 val_roc: 0.6844 val_ap: 0.7116 f1: 0.6895 time: 0.2700
difference_matrix tensor([[0.0000, 0.1499, 0.1504, 0.1503, 0.1501, 0.1500, 0.1499, 0.1503, 0.1499,
         0.1501],
        [0.1499, 0.0000, 0.1499, 0.1500, 0.1502, 0.1497, 0.1501, 0.1501, 0.1504,
         0.1500],
        [0.1504, 0.1499, 0.0000, 0.1499, 0.1509, 0.1502, 0.1499, 0.1500, 0.1501,
         0.1500],
        [0.1503, 0.1500, 0.1499, 0.0000, 0.1501, 0.1501, 0.1501, 0.1499, 0.1501,
         0.1500],
        [0.1501, 0.1502, 0.1509, 0.1501, 0.0000, 0.1500, 0.1502, 0.1501, 0.1500,
         0.1501],
        [0.1500, 0.1497, 0.1502, 0.1501, 0.1500, 0.0000, 0.1501, 0.1500, 0.1499,
         0.1503],
        [0.1499, 0.1501, 0.1499, 0.1501, 0.1502, 0.1501, 0.0000, 0.1501, 0.1505,
         0.1499],
        [0.1503, 0.1501, 0.1500, 0.1499, 0.1501, 0.1500, 0.1501, 0.0000, 0.1499,
         0.1505],
        [0.1499, 0.1504, 0.1501, 0.1501, 0.1500, 0.1499, 0.1505, 0.1499, 0.0000,
         0.1500],
        [0.1501, 0.1500, 0.1500, 0.1500, 0.1501, 0.1503, 0.1499, 0.1505, 0.1500,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(3.0381e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32774726
Epoch162: train_loss: 4.5503 recon_acc: 0.2418 val_roc: 0.6845 val_ap: 0.7121 f1: 0.6895 time: 0.2855
difference_matrix tensor([[0.0000, 0.1499, 0.1503, 0.1502, 0.1501, 0.1499, 0.1499, 0.1502, 0.1498,
         0.1500],
        [0.1499, 0.0000, 0.1498, 0.1499, 0.1501, 0.1497, 0.1501, 0.1500, 0.1503,
         0.1499],
        [0.1503, 0.1498, 0.0000, 0.1499, 0.1508, 0.1501, 0.1498, 0.1500, 0.1500,
         0.1499],
        [0.1502, 0.1499, 0.1499, 0.0000, 0.1500, 0.1500, 0.1500, 0.1498, 0.1501,
         0.1499],
        [0.1501, 0.1501, 0.1508, 0.1500, 0.0000, 0.1500, 0.1501, 0.1500, 0.1499,
         0.1500],
        [0.1499, 0.1497, 0.1501, 0.1500, 0.1500, 0.0000, 0.1500, 0.1499, 0.1498,
         0.1502],
        [0.1499, 0.1501, 0.1498, 0.1500, 0.1501, 0.1500, 0.0000, 0.1500, 0.1504,
         0.1498],
        [0.1502, 0.1500, 0.1500, 0.1498, 0.1500, 0.1499, 0.1500, 0.0000, 0.1499,
         0.1504],
        [0.1498, 0.1503, 0.1500, 0.1501, 0.1499, 0.1498, 0.1504, 0.1499, 0.0000,
         0.1499],
        [0.1500, 0.1499, 0.1499, 0.1499, 0.1500, 0.1502, 0.1498, 0.1504, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(6.4417e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32328296
Epoch163: train_loss: 4.5466 recon_acc: 0.2356 val_roc: 0.6989 val_ap: 0.7379 f1: 0.6866 time: 0.2826
thresh 0.059124127
          test_roc: 0.6742 test_ap: 0.7060 test_f1: 0.6676 test_recon_acc: 0.0071
difference_matrix tensor([[0.0000, 0.1498, 0.1502, 0.1501, 0.1500, 0.1498, 0.1498, 0.1501, 0.1497,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1496, 0.1500, 0.1499, 0.1502,
         0.1498],
        [0.1502, 0.1498, 0.0000, 0.1498, 0.1507, 0.1500, 0.1497, 0.1499, 0.1499,
         0.1498],
        [0.1501, 0.1499, 0.1498, 0.0000, 0.1499, 0.1499, 0.1499, 0.1497, 0.1500,
         0.1498],
        [0.1500, 0.1500, 0.1507, 0.1499, 0.0000, 0.1499, 0.1500, 0.1500, 0.1499,
         0.1499],
        [0.1498, 0.1496, 0.1500, 0.1499, 0.1499, 0.0000, 0.1499, 0.1498, 0.1497,
         0.1501],
        [0.1498, 0.1500, 0.1497, 0.1499, 0.1500, 0.1499, 0.0000, 0.1499, 0.1503,
         0.1497],
        [0.1501, 0.1499, 0.1499, 0.1497, 0.1500, 0.1498, 0.1499, 0.0000, 0.1498,
         0.1503],
        [0.1497, 0.1502, 0.1499, 0.1500, 0.1499, 0.1497, 0.1503, 0.1498, 0.0000,
         0.1498],
        [0.1499, 0.1498, 0.1498, 0.1498, 0.1499, 0.1501, 0.1497, 0.1503, 0.1498,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0001, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32284215
Epoch164: train_loss: 4.5430 recon_acc: 0.2348 val_roc: 0.6989 val_ap: 0.7378 f1: 0.6866 time: 0.2944
thresh 0.05869743
          test_roc: 0.6745 test_ap: 0.7063 test_f1: 0.6676 test_recon_acc: 0.0070
difference_matrix tensor([[0.0000, 0.1498, 0.1502, 0.1501, 0.1500, 0.1498, 0.1498, 0.1501, 0.1497,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1501, 0.1496, 0.1500, 0.1499, 0.1503,
         0.1499],
        [0.1502, 0.1498, 0.0000, 0.1498, 0.1507, 0.1500, 0.1498, 0.1499, 0.1499,
         0.1498],
        [0.1501, 0.1499, 0.1498, 0.0000, 0.1500, 0.1500, 0.1500, 0.1497, 0.1500,
         0.1498],
        [0.1500, 0.1501, 0.1507, 0.1500, 0.0000, 0.1499, 0.1501, 0.1500, 0.1499,
         0.1499],
        [0.1498, 0.1496, 0.1500, 0.1500, 0.1499, 0.0000, 0.1499, 0.1498, 0.1498,
         0.1501],
        [0.1498, 0.1500, 0.1498, 0.1500, 0.1501, 0.1499, 0.0000, 0.1499, 0.1503,
         0.1497],
        [0.1501, 0.1499, 0.1499, 0.1497, 0.1500, 0.1498, 0.1499, 0.0000, 0.1498,
         0.1503],
        [0.1497, 0.1503, 0.1499, 0.1500, 0.1499, 0.1498, 0.1503, 0.1498, 0.0000,
         0.1498],
        [0.1499, 0.1499, 0.1498, 0.1498, 0.1499, 0.1501, 0.1497, 0.1503, 0.1498,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0001, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3189919
Epoch165: train_loss: 4.5394 recon_acc: 0.2296 val_roc: 0.6991 val_ap: 0.7380 f1: 0.6865 time: 0.2653
thresh 0.05818134
          test_roc: 0.6746 test_ap: 0.7062 test_f1: 0.6676 test_recon_acc: 0.0069
difference_matrix tensor([[0.0000, 0.1499, 0.1503, 0.1502, 0.1501, 0.1499, 0.1499, 0.1501, 0.1498,
         0.1500],
        [0.1499, 0.0000, 0.1499, 0.1500, 0.1502, 0.1497, 0.1501, 0.1500, 0.1504,
         0.1500],
        [0.1503, 0.1499, 0.0000, 0.1499, 0.1508, 0.1501, 0.1498, 0.1500, 0.1500,
         0.1499],
        [0.1502, 0.1500, 0.1499, 0.0000, 0.1501, 0.1501, 0.1501, 0.1498, 0.1501,
         0.1499],
        [0.1501, 0.1502, 0.1508, 0.1501, 0.0000, 0.1500, 0.1501, 0.1501, 0.1500,
         0.1500],
        [0.1499, 0.1497, 0.1501, 0.1501, 0.1500, 0.0000, 0.1500, 0.1499, 0.1499,
         0.1502],
        [0.1499, 0.1501, 0.1498, 0.1501, 0.1501, 0.1500, 0.0000, 0.1500, 0.1504,
         0.1498],
        [0.1502, 0.1500, 0.1500, 0.1498, 0.1501, 0.1499, 0.1500, 0.0000, 0.1499,
         0.1504],
        [0.1498, 0.1504, 0.1500, 0.1501, 0.1500, 0.1499, 0.1504, 0.1499, 0.0000,
         0.1499],
        [0.1500, 0.1500, 0.1499, 0.1499, 0.1500, 0.1502, 0.1498, 0.1504, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(4.8480e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3192391
Epoch166: train_loss: 4.5359 recon_acc: 0.2299 val_roc: 0.6990 val_ap: 0.7380 f1: 0.6865 time: 0.2659
difference_matrix tensor([[0.0000, 0.1499, 0.1503, 0.1502, 0.1501, 0.1499, 0.1499, 0.1501, 0.1498,
         0.1500],
        [0.1499, 0.0000, 0.1499, 0.1500, 0.1501, 0.1497, 0.1501, 0.1500, 0.1503,
         0.1500],
        [0.1503, 0.1499, 0.0000, 0.1499, 0.1508, 0.1501, 0.1498, 0.1500, 0.1500,
         0.1499],
        [0.1502, 0.1500, 0.1499, 0.0000, 0.1501, 0.1501, 0.1501, 0.1498, 0.1501,
         0.1499],
        [0.1501, 0.1501, 0.1508, 0.1501, 0.0000, 0.1500, 0.1501, 0.1500, 0.1500,
         0.1500],
        [0.1499, 0.1497, 0.1501, 0.1501, 0.1500, 0.0000, 0.1500, 0.1499, 0.1499,
         0.1502],
        [0.1499, 0.1501, 0.1498, 0.1501, 0.1501, 0.1500, 0.0000, 0.1500, 0.1504,
         0.1498],
        [0.1501, 0.1500, 0.1500, 0.1498, 0.1500, 0.1499, 0.1500, 0.0000, 0.1499,
         0.1503],
        [0.1498, 0.1503, 0.1500, 0.1501, 0.1500, 0.1499, 0.1504, 0.1499, 0.0000,
         0.1499],
        [0.1500, 0.1500, 0.1499, 0.1499, 0.1500, 0.1502, 0.1498, 0.1503, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(4.9741e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31957284
Epoch167: train_loss: 4.5323 recon_acc: 0.2303 val_roc: 0.6986 val_ap: 0.7378 f1: 0.6853 time: 0.2620
difference_matrix tensor([[0.0000, 0.1498, 0.1502, 0.1501, 0.1500, 0.1498, 0.1498, 0.1500, 0.1497,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1496, 0.1500, 0.1499, 0.1503,
         0.1499],
        [0.1502, 0.1498, 0.0000, 0.1498, 0.1507, 0.1500, 0.1498, 0.1499, 0.1500,
         0.1498],
        [0.1501, 0.1499, 0.1498, 0.0000, 0.1500, 0.1500, 0.1500, 0.1497, 0.1500,
         0.1499],
        [0.1500, 0.1500, 0.1507, 0.1500, 0.0000, 0.1499, 0.1500, 0.1499, 0.1499,
         0.1499],
        [0.1498, 0.1496, 0.1500, 0.1500, 0.1499, 0.0000, 0.1499, 0.1498, 0.1498,
         0.1501],
        [0.1498, 0.1500, 0.1498, 0.1500, 0.1500, 0.1499, 0.0000, 0.1499, 0.1503,
         0.1498],
        [0.1500, 0.1499, 0.1499, 0.1497, 0.1499, 0.1498, 0.1499, 0.0000, 0.1498,
         0.1503],
        [0.1497, 0.1503, 0.1500, 0.1500, 0.1499, 0.1498, 0.1503, 0.1498, 0.0000,
         0.1498],
        [0.1499, 0.1499, 0.1498, 0.1499, 0.1499, 0.1501, 0.1498, 0.1503, 0.1498,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0001, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31989264
Epoch168: train_loss: 4.5288 recon_acc: 0.2305 val_roc: 0.6984 val_ap: 0.7378 f1: 0.6853 time: 0.2718
difference_matrix tensor([[0.0000, 0.1498, 0.1502, 0.1500, 0.1499, 0.1498, 0.1497, 0.1500, 0.1497,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1496, 0.1500, 0.1499, 0.1502,
         0.1498],
        [0.1502, 0.1498, 0.0000, 0.1498, 0.1506, 0.1500, 0.1497, 0.1498, 0.1499,
         0.1498],
        [0.1500, 0.1499, 0.1498, 0.0000, 0.1499, 0.1500, 0.1499, 0.1497, 0.1500,
         0.1498],
        [0.1499, 0.1500, 0.1506, 0.1499, 0.0000, 0.1499, 0.1500, 0.1499, 0.1499,
         0.1499],
        [0.1498, 0.1496, 0.1500, 0.1500, 0.1499, 0.0000, 0.1499, 0.1498, 0.1498,
         0.1501],
        [0.1497, 0.1500, 0.1497, 0.1499, 0.1500, 0.1499, 0.0000, 0.1498, 0.1503,
         0.1497],
        [0.1500, 0.1499, 0.1498, 0.1497, 0.1499, 0.1498, 0.1498, 0.0000, 0.1498,
         0.1502],
        [0.1497, 0.1502, 0.1499, 0.1500, 0.1499, 0.1498, 0.1503, 0.1498, 0.0000,
         0.1498],
        [0.1499, 0.1498, 0.1498, 0.1498, 0.1499, 0.1501, 0.1497, 0.1502, 0.1498,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0001, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32016575
Epoch169: train_loss: 4.5253 recon_acc: 0.2308 val_roc: 0.6983 val_ap: 0.7378 f1: 0.6853 time: 0.2686
difference_matrix tensor([[0.0000, 0.1498, 0.1502, 0.1501, 0.1499, 0.1499, 0.1498, 0.1500, 0.1497,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1497, 0.1500, 0.1499, 0.1503,
         0.1499],
        [0.1502, 0.1498, 0.0000, 0.1499, 0.1507, 0.1500, 0.1498, 0.1499, 0.1500,
         0.1499],
        [0.1501, 0.1499, 0.1499, 0.0000, 0.1500, 0.1500, 0.1500, 0.1498, 0.1500,
         0.1499],
        [0.1499, 0.1500, 0.1507, 0.1500, 0.0000, 0.1499, 0.1500, 0.1499, 0.1499,
         0.1499],
        [0.1499, 0.1497, 0.1500, 0.1500, 0.1499, 0.0000, 0.1500, 0.1499, 0.1499,
         0.1501],
        [0.1498, 0.1500, 0.1498, 0.1500, 0.1500, 0.1500, 0.0000, 0.1499, 0.1504,
         0.1498],
        [0.1500, 0.1499, 0.1499, 0.1498, 0.1499, 0.1499, 0.1499, 0.0000, 0.1498,
         0.1503],
        [0.1497, 0.1503, 0.1500, 0.1500, 0.1499, 0.1499, 0.1504, 0.1498, 0.0000,
         0.1499],
        [0.1499, 0.1499, 0.1499, 0.1499, 0.1499, 0.1501, 0.1498, 0.1503, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(8.3192e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.25723368
Epoch170: train_loss: 4.5218 recon_acc: 0.1510 val_roc: 0.6983 val_ap: 0.7379 f1: 0.6845 time: 0.2876
difference_matrix tensor([[0.0000, 0.1499, 0.1502, 0.1501, 0.1500, 0.1499, 0.1498, 0.1501, 0.1498,
         0.1499],
        [0.1499, 0.0000, 0.1499, 0.1500, 0.1501, 0.1497, 0.1501, 0.1500, 0.1503,
         0.1500],
        [0.1502, 0.1499, 0.0000, 0.1499, 0.1507, 0.1501, 0.1498, 0.1499, 0.1500,
         0.1499],
        [0.1501, 0.1500, 0.1499, 0.0000, 0.1500, 0.1501, 0.1500, 0.1498, 0.1501,
         0.1499],
        [0.1500, 0.1501, 0.1507, 0.1500, 0.0000, 0.1500, 0.1501, 0.1500, 0.1500,
         0.1500],
        [0.1499, 0.1497, 0.1501, 0.1501, 0.1500, 0.0000, 0.1500, 0.1499, 0.1499,
         0.1502],
        [0.1498, 0.1501, 0.1498, 0.1500, 0.1501, 0.1500, 0.0000, 0.1499, 0.1504,
         0.1498],
        [0.1501, 0.1500, 0.1499, 0.1498, 0.1500, 0.1499, 0.1499, 0.0000, 0.1499,
         0.1503],
        [0.1498, 0.1503, 0.1500, 0.1501, 0.1500, 0.1499, 0.1504, 0.1499, 0.0000,
         0.1499],
        [0.1499, 0.1500, 0.1499, 0.1499, 0.1500, 0.1502, 0.1498, 0.1503, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(5.7015e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31708854
Epoch171: train_loss: 4.5184 recon_acc: 0.2267 val_roc: 0.6860 val_ap: 0.7147 f1: 0.6873 time: 0.2891
difference_matrix tensor([[0.0000, 0.1498, 0.1502, 0.1501, 0.1499, 0.1499, 0.1498, 0.1500, 0.1497,
         0.1499],
        [0.1498, 0.0000, 0.1499, 0.1500, 0.1500, 0.1497, 0.1500, 0.1500, 0.1503,
         0.1500],
        [0.1502, 0.1499, 0.0000, 0.1499, 0.1507, 0.1501, 0.1498, 0.1499, 0.1500,
         0.1499],
        [0.1501, 0.1500, 0.1499, 0.0000, 0.1500, 0.1501, 0.1500, 0.1498, 0.1501,
         0.1499],
        [0.1499, 0.1500, 0.1507, 0.1500, 0.0000, 0.1500, 0.1500, 0.1500, 0.1499,
         0.1500],
        [0.1499, 0.1497, 0.1501, 0.1501, 0.1500, 0.0000, 0.1500, 0.1499, 0.1499,
         0.1502],
        [0.1498, 0.1500, 0.1498, 0.1500, 0.1500, 0.1500, 0.0000, 0.1499, 0.1504,
         0.1498],
        [0.1500, 0.1500, 0.1499, 0.1498, 0.1500, 0.1499, 0.1499, 0.0000, 0.1499,
         0.1503],
        [0.1497, 0.1503, 0.1500, 0.1501, 0.1499, 0.1499, 0.1504, 0.1499, 0.0000,
         0.1499],
        [0.1499, 0.1500, 0.1499, 0.1499, 0.1500, 0.1502, 0.1498, 0.1503, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(6.3932e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31536782
Epoch172: train_loss: 4.5149 recon_acc: 0.2243 val_roc: 0.6860 val_ap: 0.7147 f1: 0.6873 time: 0.3199
difference_matrix tensor([[0.0000, 0.1498, 0.1501, 0.1500, 0.1499, 0.1498, 0.1497, 0.1500, 0.1497,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1497, 0.1499, 0.1499, 0.1502,
         0.1499],
        [0.1501, 0.1498, 0.0000, 0.1498, 0.1506, 0.1500, 0.1497, 0.1499, 0.1499,
         0.1498],
        [0.1500, 0.1499, 0.1498, 0.0000, 0.1499, 0.1500, 0.1499, 0.1497, 0.1500,
         0.1499],
        [0.1499, 0.1500, 0.1506, 0.1499, 0.0000, 0.1499, 0.1500, 0.1499, 0.1499,
         0.1499],
        [0.1498, 0.1497, 0.1500, 0.1500, 0.1499, 0.0000, 0.1499, 0.1499, 0.1498,
         0.1501],
        [0.1497, 0.1499, 0.1497, 0.1499, 0.1500, 0.1499, 0.0000, 0.1499, 0.1503,
         0.1498],
        [0.1500, 0.1499, 0.1499, 0.1497, 0.1499, 0.1499, 0.1499, 0.0000, 0.1498,
         0.1503],
        [0.1497, 0.1502, 0.1499, 0.1500, 0.1499, 0.1498, 0.1503, 0.1498, 0.0000,
         0.1499],
        [0.1499, 0.1499, 0.1498, 0.1499, 0.1499, 0.1501, 0.1498, 0.1503, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0001, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31374383
Epoch173: train_loss: 4.5115 recon_acc: 0.2220 val_roc: 0.6861 val_ap: 0.7145 f1: 0.6873 time: 0.2659
difference_matrix tensor([[0.0000, 0.1498, 0.1501, 0.1500, 0.1499, 0.1498, 0.1497, 0.1500, 0.1497,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1497, 0.1499, 0.1499, 0.1502,
         0.1499],
        [0.1501, 0.1498, 0.0000, 0.1498, 0.1506, 0.1500, 0.1497, 0.1499, 0.1499,
         0.1499],
        [0.1500, 0.1499, 0.1498, 0.0000, 0.1499, 0.1500, 0.1499, 0.1497, 0.1500,
         0.1499],
        [0.1499, 0.1500, 0.1506, 0.1499, 0.0000, 0.1499, 0.1500, 0.1499, 0.1499,
         0.1499],
        [0.1498, 0.1497, 0.1500, 0.1500, 0.1499, 0.0000, 0.1499, 0.1499, 0.1498,
         0.1501],
        [0.1497, 0.1499, 0.1497, 0.1499, 0.1500, 0.1499, 0.0000, 0.1499, 0.1503,
         0.1498],
        [0.1500, 0.1499, 0.1499, 0.1497, 0.1499, 0.1499, 0.1499, 0.0000, 0.1498,
         0.1503],
        [0.1497, 0.1502, 0.1499, 0.1500, 0.1499, 0.1498, 0.1503, 0.1498, 0.0000,
         0.1499],
        [0.1499, 0.1499, 0.1499, 0.1499, 0.1499, 0.1501, 0.1498, 0.1503, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0001, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34091327
Epoch174: train_loss: 4.5082 recon_acc: 0.2592 val_roc: 0.6985 val_ap: 0.7386 f1: 0.6871 time: 0.2513
difference_matrix tensor([[0.0000, 0.1498, 0.1501, 0.1500, 0.1499, 0.1499, 0.1498, 0.1500, 0.1497,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1497, 0.1500, 0.1500, 0.1503,
         0.1500],
        [0.1501, 0.1498, 0.0000, 0.1499, 0.1507, 0.1500, 0.1498, 0.1499, 0.1500,
         0.1499],
        [0.1500, 0.1499, 0.1499, 0.0000, 0.1500, 0.1501, 0.1500, 0.1498, 0.1500,
         0.1499],
        [0.1499, 0.1500, 0.1507, 0.1500, 0.0000, 0.1500, 0.1500, 0.1500, 0.1499,
         0.1500],
        [0.1499, 0.1497, 0.1500, 0.1501, 0.1500, 0.0000, 0.1500, 0.1500, 0.1499,
         0.1502],
        [0.1498, 0.1500, 0.1498, 0.1500, 0.1500, 0.1500, 0.0000, 0.1499, 0.1503,
         0.1498],
        [0.1500, 0.1500, 0.1499, 0.1498, 0.1500, 0.1500, 0.1499, 0.0000, 0.1499,
         0.1503],
        [0.1497, 0.1503, 0.1500, 0.1500, 0.1499, 0.1499, 0.1503, 0.1499, 0.0000,
         0.1499],
        [0.1499, 0.1500, 0.1499, 0.1499, 0.1500, 0.1502, 0.1498, 0.1503, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(7.1930e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34103647
Epoch175: train_loss: 4.5048 recon_acc: 0.2594 val_roc: 0.6983 val_ap: 0.7385 f1: 0.6871 time: 0.2446
difference_matrix tensor([[0.0000, 0.1498, 0.1501, 0.1500, 0.1499, 0.1499, 0.1498, 0.1500, 0.1497,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1497, 0.1500, 0.1500, 0.1502,
         0.1500],
        [0.1501, 0.1498, 0.0000, 0.1498, 0.1506, 0.1500, 0.1498, 0.1499, 0.1500,
         0.1499],
        [0.1500, 0.1499, 0.1498, 0.0000, 0.1500, 0.1500, 0.1499, 0.1498, 0.1500,
         0.1499],
        [0.1499, 0.1500, 0.1506, 0.1500, 0.0000, 0.1499, 0.1500, 0.1500, 0.1499,
         0.1500],
        [0.1499, 0.1497, 0.1500, 0.1500, 0.1499, 0.0000, 0.1500, 0.1500, 0.1499,
         0.1502],
        [0.1498, 0.1500, 0.1498, 0.1499, 0.1500, 0.1500, 0.0000, 0.1499, 0.1503,
         0.1498],
        [0.1500, 0.1500, 0.1499, 0.1498, 0.1500, 0.1500, 0.1499, 0.0000, 0.1499,
         0.1503],
        [0.1497, 0.1502, 0.1500, 0.1500, 0.1499, 0.1499, 0.1503, 0.1499, 0.0000,
         0.1499],
        [0.1499, 0.1500, 0.1499, 0.1499, 0.1500, 0.1502, 0.1498, 0.1503, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(7.5308e-05, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34090614
Epoch176: train_loss: 4.5015 recon_acc: 0.2592 val_roc: 0.6985 val_ap: 0.7388 f1: 0.6871 time: 0.2409
difference_matrix tensor([[0.0000, 0.1498, 0.1501, 0.1500, 0.1499, 0.1498, 0.1497, 0.1500, 0.1496,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1497, 0.1499, 0.1499, 0.1502,
         0.1499],
        [0.1501, 0.1498, 0.0000, 0.1498, 0.1506, 0.1499, 0.1497, 0.1499, 0.1499,
         0.1498],
        [0.1500, 0.1499, 0.1498, 0.0000, 0.1499, 0.1500, 0.1499, 0.1497, 0.1500,
         0.1499],
        [0.1499, 0.1500, 0.1506, 0.1499, 0.0000, 0.1499, 0.1500, 0.1500, 0.1499,
         0.1500],
        [0.1498, 0.1497, 0.1499, 0.1500, 0.1499, 0.0000, 0.1499, 0.1499, 0.1498,
         0.1501],
        [0.1497, 0.1499, 0.1497, 0.1499, 0.1500, 0.1499, 0.0000, 0.1499, 0.1503,
         0.1498],
        [0.1500, 0.1499, 0.1499, 0.1497, 0.1500, 0.1499, 0.1499, 0.0000, 0.1498,
         0.1503],
        [0.1496, 0.1502, 0.1499, 0.1500, 0.1499, 0.1498, 0.1503, 0.1498, 0.0000,
         0.1499],
        [0.1499, 0.1499, 0.1498, 0.1499, 0.1500, 0.1501, 0.1498, 0.1503, 0.1499,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0001, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34072644
Epoch177: train_loss: 4.4982 recon_acc: 0.2588 val_roc: 0.6984 val_ap: 0.7388 f1: 0.6871 time: 0.2537
difference_matrix tensor([[0.0000, 0.1498, 0.1500, 0.1499, 0.1498, 0.1498, 0.1497, 0.1499, 0.1496,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1496, 0.1499, 0.1499, 0.1502,
         0.1499],
        [0.1500, 0.1498, 0.0000, 0.1498, 0.1506, 0.1499, 0.1497, 0.1499, 0.1499,
         0.1498],
        [0.1500, 0.1499, 0.1498, 0.0000, 0.1499, 0.1500, 0.1499, 0.1497, 0.1499,
         0.1499],
        [0.1498, 0.1500, 0.1506, 0.1499, 0.0000, 0.1499, 0.1500, 0.1499, 0.1499,
         0.1499],
        [0.1498, 0.1496, 0.1499, 0.1500, 0.1499, 0.0000, 0.1499, 0.1499, 0.1498,
         0.1501],
        [0.1497, 0.1499, 0.1497, 0.1499, 0.1500, 0.1499, 0.0000, 0.1499, 0.1502,
         0.1498],
        [0.1499, 0.1499, 0.1499, 0.1497, 0.1499, 0.1499, 0.1499, 0.0000, 0.1498,
         0.1503],
        [0.1496, 0.1502, 0.1499, 0.1499, 0.1499, 0.1498, 0.1502, 0.1498, 0.0000,
         0.1498],
        [0.1499, 0.1499, 0.1498, 0.1499, 0.1499, 0.1501, 0.1498, 0.1503, 0.1498,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0001, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3449447
Epoch178: train_loss: 4.4949 recon_acc: 0.2647 val_roc: 0.6986 val_ap: 0.7388 f1: 0.6872 time: 0.2578
difference_matrix tensor([[0.0000, 0.1498, 0.1500, 0.1500, 0.1499, 0.1498, 0.1497, 0.1500, 0.1496,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1497, 0.1499, 0.1499, 0.1502,
         0.1499],
        [0.1500, 0.1498, 0.0000, 0.1498, 0.1505, 0.1499, 0.1497, 0.1498, 0.1498,
         0.1498],
        [0.1500, 0.1499, 0.1498, 0.0000, 0.1499, 0.1500, 0.1499, 0.1498, 0.1499,
         0.1499],
        [0.1499, 0.1500, 0.1505, 0.1499, 0.0000, 0.1499, 0.1500, 0.1500, 0.1499,
         0.1500],
        [0.1498, 0.1497, 0.1499, 0.1500, 0.1499, 0.0000, 0.1499, 0.1499, 0.1498,
         0.1501],
        [0.1497, 0.1499, 0.1497, 0.1499, 0.1500, 0.1499, 0.0000, 0.1499, 0.1502,
         0.1498],
        [0.1500, 0.1499, 0.1498, 0.1498, 0.1500, 0.1499, 0.1499, 0.0000, 0.1498,
         0.1503],
        [0.1496, 0.1502, 0.1498, 0.1499, 0.1499, 0.1498, 0.1502, 0.1498, 0.0000,
         0.1498],
        [0.1499, 0.1499, 0.1498, 0.1499, 0.1500, 0.1501, 0.1498, 0.1503, 0.1498,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0001, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34564826
Epoch179: train_loss: 4.4916 recon_acc: 0.2657 val_roc: 0.6985 val_ap: 0.7389 f1: 0.6884 time: 0.2533
difference_matrix tensor([[0.0000, 0.1498, 0.1500, 0.1500, 0.1499, 0.1498, 0.1498, 0.1500, 0.1496,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1497, 0.1500, 0.1500, 0.1502,
         0.1499],
        [0.1500, 0.1498, 0.0000, 0.1498, 0.1506, 0.1499, 0.1497, 0.1499, 0.1498,
         0.1498],
        [0.1500, 0.1499, 0.1498, 0.0000, 0.1500, 0.1500, 0.1500, 0.1498, 0.1500,
         0.1499],
        [0.1499, 0.1500, 0.1506, 0.1500, 0.0000, 0.1499, 0.1500, 0.1500, 0.1499,
         0.1500],
        [0.1498, 0.1497, 0.1499, 0.1500, 0.1499, 0.0000, 0.1499, 0.1499, 0.1498,
         0.1501],
        [0.1498, 0.1500, 0.1497, 0.1500, 0.1500, 0.1499, 0.0000, 0.1499, 0.1502,
         0.1498],
        [0.1500, 0.1500, 0.1499, 0.1498, 0.1500, 0.1499, 0.1499, 0.0000, 0.1498,
         0.1503],
        [0.1496, 0.1502, 0.1498, 0.1500, 0.1499, 0.1498, 0.1502, 0.1498, 0.0000,
         0.1498],
        [0.1499, 0.1499, 0.1498, 0.1499, 0.1500, 0.1501, 0.1498, 0.1503, 0.1498,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0001, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34627286
Epoch180: train_loss: 4.4884 recon_acc: 0.2665 val_roc: 0.6983 val_ap: 0.7388 f1: 0.6884 time: 0.2678
difference_matrix tensor([[0.0000, 0.1498, 0.1500, 0.1500, 0.1499, 0.1498, 0.1498, 0.1500, 0.1496,
         0.1499],
        [0.1498, 0.0000, 0.1498, 0.1499, 0.1500, 0.1497, 0.1500, 0.1500, 0.1501,
         0.1499],
        [0.1500, 0.1498, 0.0000, 0.1498, 0.1505, 0.1499, 0.1497, 0.1498, 0.1498,
         0.1498],
        [0.1500, 0.1499, 0.1498, 0.0000, 0.1500, 0.1500, 0.1500, 0.1498, 0.1499,
         0.1499],
        [0.1499, 0.1500, 0.1505, 0.1500, 0.0000, 0.1499, 0.1500, 0.1500, 0.1499,
         0.1500],
        [0.1498, 0.1497, 0.1499, 0.1500, 0.1499, 0.0000, 0.1499, 0.1499, 0.1497,
         0.1501],
        [0.1498, 0.1500, 0.1497, 0.1500, 0.1500, 0.1499, 0.0000, 0.1499, 0.1502,
         0.1498],
        [0.1500, 0.1500, 0.1498, 0.1498, 0.1500, 0.1499, 0.1499, 0.0000, 0.1498,
         0.1503],
        [0.1496, 0.1501, 0.1498, 0.1499, 0.1499, 0.1497, 0.1502, 0.1498, 0.0000,
         0.1498],
        [0.1499, 0.1499, 0.1498, 0.1499, 0.1500, 0.1501, 0.1498, 0.1503, 0.1498,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0001, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34696853
Epoch181: train_loss: 4.4851 recon_acc: 0.2675 val_roc: 0.6984 val_ap: 0.7390 f1: 0.6884 time: 0.2585
difference_matrix tensor([[0.0000, 0.1498, 0.1500, 0.1500, 0.1499, 0.1498, 0.1498, 0.1500, 0.1496,
         0.1498],
        [0.1498, 0.0000, 0.1497, 0.1499, 0.1500, 0.1496, 0.1500, 0.1499, 0.1501,
         0.1499],
        [0.1500, 0.1497, 0.0000, 0.1497, 0.1505, 0.1498, 0.1497, 0.1498, 0.1498,
         0.1497],
        [0.1500, 0.1499, 0.1497, 0.0000, 0.1500, 0.1500, 0.1500, 0.1498, 0.1499,
         0.1499],
        [0.1499, 0.1500, 0.1505, 0.1500, 0.0000, 0.1499, 0.1500, 0.1500, 0.1498,
         0.1499],
        [0.1498, 0.1496, 0.1498, 0.1500, 0.1499, 0.0000, 0.1499, 0.1499, 0.1497,
         0.1500],
        [0.1498, 0.1500, 0.1497, 0.1500, 0.1500, 0.1499, 0.0000, 0.1499, 0.1502,
         0.1498],
        [0.1500, 0.1499, 0.1498, 0.1498, 0.1500, 0.1499, 0.1499, 0.0000, 0.1498,
         0.1502],
        [0.1496, 0.1501, 0.1498, 0.1499, 0.1498, 0.1497, 0.1502, 0.1498, 0.0000,
         0.1497],
        [0.1498, 0.1499, 0.1497, 0.1499, 0.1499, 0.1500, 0.1498, 0.1502, 0.1497,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0001, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34759536
Epoch182: train_loss: 4.4819 recon_acc: 0.2683 val_roc: 0.6985 val_ap: 0.7390 f1: 0.6884 time: 0.2588
difference_matrix tensor([[0.0000, 0.1498, 0.1499, 0.1500, 0.1499, 0.1497, 0.1497, 0.1499, 0.1495,
         0.1498],
        [0.1498, 0.0000, 0.1497, 0.1499, 0.1500, 0.1496, 0.1499, 0.1499, 0.1500,
         0.1499],
        [0.1499, 0.1497, 0.0000, 0.1497, 0.1505, 0.1498, 0.1496, 0.1498, 0.1497,
         0.1497],
        [0.1500, 0.1499, 0.1497, 0.0000, 0.1500, 0.1500, 0.1499, 0.1498, 0.1499,
         0.1499],
        [0.1499, 0.1500, 0.1505, 0.1500, 0.0000, 0.1498, 0.1500, 0.1499, 0.1498,
         0.1499],
        [0.1497, 0.1496, 0.1498, 0.1500, 0.1498, 0.0000, 0.1499, 0.1499, 0.1496,
         0.1499],
        [0.1497, 0.1499, 0.1496, 0.1499, 0.1500, 0.1499, 0.0000, 0.1499, 0.1501,
         0.1497],
        [0.1499, 0.1499, 0.1498, 0.1498, 0.1499, 0.1499, 0.1499, 0.0000, 0.1497,
         0.1502],
        [0.1495, 0.1500, 0.1497, 0.1499, 0.1498, 0.1496, 0.1501, 0.1497, 0.0000,
         0.1497],
        [0.1498, 0.1499, 0.1497, 0.1499, 0.1499, 0.1499, 0.1497, 0.1502, 0.1497,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0002, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3469572
Epoch183: train_loss: 4.4788 recon_acc: 0.2674 val_roc: 0.6984 val_ap: 0.7393 f1: 0.6872 time: 0.2842
difference_matrix tensor([[0.0000, 0.1498, 0.1499, 0.1500, 0.1498, 0.1497, 0.1497, 0.1499, 0.1495,
         0.1498],
        [0.1498, 0.0000, 0.1496, 0.1499, 0.1499, 0.1496, 0.1499, 0.1499, 0.1500,
         0.1498],
        [0.1499, 0.1496, 0.0000, 0.1497, 0.1504, 0.1497, 0.1496, 0.1497, 0.1496,
         0.1496],
        [0.1500, 0.1499, 0.1497, 0.0000, 0.1500, 0.1499, 0.1499, 0.1498, 0.1499,
         0.1498],
        [0.1498, 0.1499, 0.1504, 0.1500, 0.0000, 0.1498, 0.1499, 0.1499, 0.1498,
         0.1499],
        [0.1497, 0.1496, 0.1497, 0.1499, 0.1498, 0.0000, 0.1498, 0.1498, 0.1496,
         0.1499],
        [0.1497, 0.1499, 0.1496, 0.1499, 0.1499, 0.1498, 0.0000, 0.1498, 0.1501,
         0.1497],
        [0.1499, 0.1499, 0.1497, 0.1498, 0.1499, 0.1498, 0.1498, 0.0000, 0.1497,
         0.1501],
        [0.1495, 0.1500, 0.1496, 0.1499, 0.1498, 0.1496, 0.1501, 0.1497, 0.0000,
         0.1496],
        [0.1498, 0.1498, 0.1496, 0.1498, 0.1499, 0.1499, 0.1497, 0.1501, 0.1496,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0002, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34633034
Epoch184: train_loss: 4.4756 recon_acc: 0.2664 val_roc: 0.6984 val_ap: 0.7395 f1: 0.6860 time: 0.3016
difference_matrix tensor([[0.0000, 0.1498, 0.1499, 0.1500, 0.1498, 0.1497, 0.1497, 0.1499, 0.1495,
         0.1498],
        [0.1498, 0.0000, 0.1496, 0.1499, 0.1499, 0.1496, 0.1499, 0.1499, 0.1500,
         0.1498],
        [0.1499, 0.1496, 0.0000, 0.1497, 0.1504, 0.1497, 0.1496, 0.1497, 0.1496,
         0.1496],
        [0.1500, 0.1499, 0.1497, 0.0000, 0.1500, 0.1499, 0.1499, 0.1497, 0.1498,
         0.1498],
        [0.1498, 0.1499, 0.1504, 0.1500, 0.0000, 0.1498, 0.1499, 0.1499, 0.1497,
         0.1498],
        [0.1497, 0.1496, 0.1497, 0.1499, 0.1498, 0.0000, 0.1498, 0.1498, 0.1496,
         0.1499],
        [0.1497, 0.1499, 0.1496, 0.1499, 0.1499, 0.1498, 0.0000, 0.1498, 0.1501,
         0.1497],
        [0.1499, 0.1499, 0.1497, 0.1497, 0.1499, 0.1498, 0.1498, 0.0000, 0.1496,
         0.1501],
        [0.1495, 0.1500, 0.1496, 0.1498, 0.1497, 0.1496, 0.1501, 0.1496, 0.0000,
         0.1496],
        [0.1498, 0.1498, 0.1496, 0.1498, 0.1498, 0.1499, 0.1497, 0.1501, 0.1496,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0002, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33971694
Epoch185: train_loss: 4.4725 recon_acc: 0.2570 val_roc: 0.6985 val_ap: 0.7395 f1: 0.6847 time: 0.2797
difference_matrix tensor([[0.0000, 0.1498, 0.1499, 0.1500, 0.1498, 0.1497, 0.1497, 0.1499, 0.1495,
         0.1497],
        [0.1498, 0.0000, 0.1496, 0.1499, 0.1499, 0.1495, 0.1499, 0.1498, 0.1499,
         0.1497],
        [0.1499, 0.1496, 0.0000, 0.1497, 0.1503, 0.1497, 0.1495, 0.1497, 0.1496,
         0.1495],
        [0.1500, 0.1499, 0.1497, 0.0000, 0.1500, 0.1499, 0.1499, 0.1497, 0.1498,
         0.1498],
        [0.1498, 0.1499, 0.1503, 0.1500, 0.0000, 0.1498, 0.1499, 0.1499, 0.1497,
         0.1498],
        [0.1497, 0.1495, 0.1497, 0.1499, 0.1498, 0.0000, 0.1498, 0.1498, 0.1495,
         0.1498],
        [0.1497, 0.1499, 0.1495, 0.1499, 0.1499, 0.1498, 0.0000, 0.1498, 0.1500,
         0.1496],
        [0.1499, 0.1498, 0.1497, 0.1497, 0.1499, 0.1498, 0.1498, 0.0000, 0.1496,
         0.1500],
        [0.1495, 0.1499, 0.1496, 0.1498, 0.1497, 0.1495, 0.1500, 0.1496, 0.0000,
         0.1495],
        [0.1497, 0.1497, 0.1495, 0.1498, 0.1498, 0.1498, 0.1496, 0.1500, 0.1495,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0002, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33955884
Epoch186: train_loss: 4.4694 recon_acc: 0.2568 val_roc: 0.6983 val_ap: 0.7394 f1: 0.6847 time: 0.2917
difference_matrix tensor([[0.0000, 0.1497, 0.1498, 0.1500, 0.1498, 0.1497, 0.1497, 0.1499, 0.1494,
         0.1497],
        [0.1497, 0.0000, 0.1496, 0.1499, 0.1499, 0.1495, 0.1498, 0.1498, 0.1499,
         0.1497],
        [0.1498, 0.1496, 0.0000, 0.1496, 0.1503, 0.1496, 0.1495, 0.1496, 0.1495,
         0.1495],
        [0.1500, 0.1499, 0.1496, 0.0000, 0.1499, 0.1499, 0.1499, 0.1497, 0.1498,
         0.1498],
        [0.1498, 0.1499, 0.1503, 0.1499, 0.0000, 0.1497, 0.1499, 0.1498, 0.1496,
         0.1497],
        [0.1497, 0.1495, 0.1496, 0.1499, 0.1497, 0.0000, 0.1498, 0.1497, 0.1495,
         0.1498],
        [0.1497, 0.1498, 0.1495, 0.1499, 0.1499, 0.1498, 0.0000, 0.1497, 0.1500,
         0.1496],
        [0.1499, 0.1498, 0.1496, 0.1497, 0.1498, 0.1497, 0.1497, 0.0000, 0.1495,
         0.1499],
        [0.1494, 0.1499, 0.1495, 0.1498, 0.1496, 0.1495, 0.1500, 0.1495, 0.0000,
         0.1494],
        [0.1497, 0.1497, 0.1495, 0.1498, 0.1497, 0.1498, 0.1496, 0.1499, 0.1494,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0003, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3394008
Epoch187: train_loss: 4.4663 recon_acc: 0.2565 val_roc: 0.6984 val_ap: 0.7394 f1: 0.6847 time: 0.2591
difference_matrix tensor([[0.0000, 0.1497, 0.1498, 0.1500, 0.1498, 0.1497, 0.1497, 0.1498, 0.1494,
         0.1497],
        [0.1497, 0.0000, 0.1495, 0.1499, 0.1498, 0.1495, 0.1498, 0.1498, 0.1498,
         0.1497],
        [0.1498, 0.1495, 0.0000, 0.1496, 0.1502, 0.1496, 0.1495, 0.1496, 0.1495,
         0.1494],
        [0.1500, 0.1499, 0.1496, 0.0000, 0.1499, 0.1499, 0.1499, 0.1497, 0.1498,
         0.1497],
        [0.1498, 0.1498, 0.1502, 0.1499, 0.0000, 0.1497, 0.1498, 0.1498, 0.1496,
         0.1497],
        [0.1497, 0.1495, 0.1496, 0.1499, 0.1497, 0.0000, 0.1497, 0.1497, 0.1494,
         0.1497],
        [0.1497, 0.1498, 0.1495, 0.1499, 0.1498, 0.1497, 0.0000, 0.1497, 0.1499,
         0.1495],
        [0.1498, 0.1498, 0.1496, 0.1497, 0.1498, 0.1497, 0.1497, 0.0000, 0.1495,
         0.1499],
        [0.1494, 0.1498, 0.1495, 0.1498, 0.1496, 0.1494, 0.1499, 0.1495, 0.0000,
         0.1494],
        [0.1497, 0.1497, 0.1494, 0.1497, 0.1497, 0.1497, 0.1495, 0.1499, 0.1494,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0003, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.24697603
Epoch188: train_loss: 4.4632 recon_acc: 0.1381 val_roc: 0.6987 val_ap: 0.7397 f1: 0.6845 time: 0.2682
difference_matrix tensor([[0.0000, 0.1497, 0.1498, 0.1500, 0.1498, 0.1497, 0.1497, 0.1498, 0.1494,
         0.1496],
        [0.1497, 0.0000, 0.1495, 0.1499, 0.1498, 0.1495, 0.1498, 0.1497, 0.1498,
         0.1496],
        [0.1498, 0.1495, 0.0000, 0.1496, 0.1502, 0.1496, 0.1494, 0.1495, 0.1494,
         0.1494],
        [0.1500, 0.1499, 0.1496, 0.0000, 0.1499, 0.1499, 0.1499, 0.1497, 0.1497,
         0.1497],
        [0.1498, 0.1498, 0.1502, 0.1499, 0.0000, 0.1497, 0.1498, 0.1498, 0.1496,
         0.1497],
        [0.1497, 0.1495, 0.1496, 0.1499, 0.1497, 0.0000, 0.1497, 0.1497, 0.1494,
         0.1497],
        [0.1497, 0.1498, 0.1494, 0.1499, 0.1498, 0.1497, 0.0000, 0.1497, 0.1499,
         0.1495],
        [0.1498, 0.1497, 0.1495, 0.1497, 0.1498, 0.1497, 0.1497, 0.0000, 0.1494,
         0.1498],
        [0.1494, 0.1498, 0.1494, 0.1497, 0.1496, 0.1494, 0.1499, 0.1494, 0.0000,
         0.1493],
        [0.1496, 0.1496, 0.1494, 0.1497, 0.1497, 0.1497, 0.1495, 0.1498, 0.1493,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0003, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32258928
Epoch189: train_loss: 4.4601 recon_acc: 0.2331 val_roc: 0.6988 val_ap: 0.7400 f1: 0.6866 time: 0.2408
difference_matrix tensor([[0.0000, 0.1497, 0.1497, 0.1500, 0.1497, 0.1497, 0.1496, 0.1498, 0.1494,
         0.1496],
        [0.1497, 0.0000, 0.1495, 0.1499, 0.1498, 0.1495, 0.1498, 0.1497, 0.1498,
         0.1496],
        [0.1497, 0.1495, 0.0000, 0.1496, 0.1501, 0.1495, 0.1494, 0.1495, 0.1494,
         0.1493],
        [0.1500, 0.1499, 0.1496, 0.0000, 0.1499, 0.1499, 0.1499, 0.1496, 0.1497,
         0.1497],
        [0.1497, 0.1498, 0.1501, 0.1499, 0.0000, 0.1497, 0.1498, 0.1497, 0.1495,
         0.1496],
        [0.1497, 0.1495, 0.1495, 0.1499, 0.1497, 0.0000, 0.1497, 0.1496, 0.1494,
         0.1497],
        [0.1496, 0.1498, 0.1494, 0.1499, 0.1498, 0.1497, 0.0000, 0.1496, 0.1499,
         0.1495],
        [0.1498, 0.1497, 0.1495, 0.1496, 0.1497, 0.1496, 0.1496, 0.0000, 0.1494,
         0.1498],
        [0.1494, 0.1498, 0.1494, 0.1497, 0.1495, 0.1494, 0.1499, 0.1494, 0.0000,
         0.1493],
        [0.1496, 0.1496, 0.1493, 0.1497, 0.1496, 0.1497, 0.1495, 0.1498, 0.1493,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0004, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3229455
Epoch190: train_loss: 4.4571 recon_acc: 0.2335 val_roc: 0.6989 val_ap: 0.7401 f1: 0.6866 time: 0.2680
difference_matrix tensor([[0.0000, 0.1497, 0.1497, 0.1499, 0.1497, 0.1496, 0.1496, 0.1497, 0.1493,
         0.1496],
        [0.1497, 0.0000, 0.1494, 0.1498, 0.1497, 0.1494, 0.1497, 0.1497, 0.1497,
         0.1495],
        [0.1497, 0.1494, 0.0000, 0.1495, 0.1501, 0.1495, 0.1493, 0.1494, 0.1493,
         0.1493],
        [0.1499, 0.1498, 0.1495, 0.0000, 0.1498, 0.1499, 0.1498, 0.1496, 0.1497,
         0.1496],
        [0.1497, 0.1497, 0.1501, 0.1498, 0.0000, 0.1496, 0.1497, 0.1497, 0.1495,
         0.1496],
        [0.1496, 0.1494, 0.1495, 0.1499, 0.1496, 0.0000, 0.1497, 0.1496, 0.1493,
         0.1496],
        [0.1496, 0.1497, 0.1493, 0.1498, 0.1497, 0.1497, 0.0000, 0.1496, 0.1498,
         0.1494],
        [0.1497, 0.1497, 0.1494, 0.1496, 0.1497, 0.1496, 0.1496, 0.0000, 0.1493,
         0.1497],
        [0.1493, 0.1497, 0.1493, 0.1497, 0.1495, 0.1493, 0.1498, 0.1493, 0.0000,
         0.1492],
        [0.1496, 0.1495, 0.1493, 0.1496, 0.1496, 0.1496, 0.1494, 0.1497, 0.1493,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0004, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3228776
Epoch191: train_loss: 4.4541 recon_acc: 0.2334 val_roc: 0.6990 val_ap: 0.7403 f1: 0.6866 time: 0.2811
difference_matrix tensor([[0.0000, 0.1496, 0.1496, 0.1499, 0.1496, 0.1496, 0.1496, 0.1497, 0.1493,
         0.1495],
        [0.1496, 0.0000, 0.1493, 0.1498, 0.1497, 0.1494, 0.1497, 0.1496, 0.1497,
         0.1495],
        [0.1496, 0.1493, 0.0000, 0.1494, 0.1500, 0.1494, 0.1493, 0.1493, 0.1492,
         0.1492],
        [0.1499, 0.1498, 0.1494, 0.0000, 0.1498, 0.1498, 0.1498, 0.1495, 0.1496,
         0.1496],
        [0.1496, 0.1497, 0.1500, 0.1498, 0.0000, 0.1496, 0.1497, 0.1496, 0.1494,
         0.1495],
        [0.1496, 0.1494, 0.1494, 0.1498, 0.1496, 0.0000, 0.1496, 0.1495, 0.1493,
         0.1495],
        [0.1496, 0.1497, 0.1493, 0.1498, 0.1497, 0.1496, 0.0000, 0.1495, 0.1498,
         0.1493],
        [0.1497, 0.1496, 0.1493, 0.1495, 0.1496, 0.1495, 0.1495, 0.0000, 0.1493,
         0.1497],
        [0.1493, 0.1497, 0.1492, 0.1496, 0.1494, 0.1493, 0.1498, 0.1493, 0.0000,
         0.1492],
        [0.1495, 0.1495, 0.1492, 0.1496, 0.1495, 0.1495, 0.1493, 0.1497, 0.1492,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0005, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32803363
Epoch192: train_loss: 4.4511 recon_acc: 0.2404 val_roc: 0.6991 val_ap: 0.7404 f1: 0.6867 time: 0.2810
difference_matrix tensor([[0.0000, 0.1495, 0.1496, 0.1498, 0.1496, 0.1495, 0.1495, 0.1496, 0.1492,
         0.1494],
        [0.1495, 0.0000, 0.1493, 0.1497, 0.1496, 0.1493, 0.1496, 0.1495, 0.1496,
         0.1494],
        [0.1496, 0.1493, 0.0000, 0.1494, 0.1499, 0.1493, 0.1492, 0.1492, 0.1492,
         0.1491],
        [0.1498, 0.1497, 0.1494, 0.0000, 0.1497, 0.1498, 0.1497, 0.1495, 0.1496,
         0.1495],
        [0.1496, 0.1496, 0.1499, 0.1497, 0.0000, 0.1495, 0.1496, 0.1495, 0.1493,
         0.1494],
        [0.1495, 0.1493, 0.1493, 0.1498, 0.1495, 0.0000, 0.1495, 0.1495, 0.1492,
         0.1495],
        [0.1495, 0.1496, 0.1492, 0.1497, 0.1496, 0.1495, 0.0000, 0.1494, 0.1497,
         0.1493],
        [0.1496, 0.1495, 0.1492, 0.1495, 0.1495, 0.1495, 0.1494, 0.0000, 0.1492,
         0.1496],
        [0.1492, 0.1496, 0.1492, 0.1496, 0.1493, 0.1492, 0.1497, 0.1492, 0.0000,
         0.1491],
        [0.1494, 0.1494, 0.1491, 0.1495, 0.1494, 0.1495, 0.1493, 0.1496, 0.1491,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0005, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3279618
Epoch193: train_loss: 4.4481 recon_acc: 0.2402 val_roc: 0.6989 val_ap: 0.7403 f1: 0.6867 time: 0.2563
difference_matrix tensor([[0.0000, 0.1495, 0.1495, 0.1498, 0.1495, 0.1495, 0.1494, 0.1495, 0.1491,
         0.1494],
        [0.1495, 0.0000, 0.1492, 0.1496, 0.1495, 0.1492, 0.1495, 0.1494, 0.1495,
         0.1493],
        [0.1495, 0.1492, 0.0000, 0.1493, 0.1498, 0.1493, 0.1491, 0.1491, 0.1491,
         0.1490],
        [0.1498, 0.1496, 0.1493, 0.0000, 0.1496, 0.1497, 0.1496, 0.1494, 0.1495,
         0.1494],
        [0.1495, 0.1495, 0.1498, 0.1496, 0.0000, 0.1494, 0.1495, 0.1494, 0.1493,
         0.1493],
        [0.1495, 0.1492, 0.1493, 0.1497, 0.1494, 0.0000, 0.1495, 0.1494, 0.1491,
         0.1494],
        [0.1494, 0.1495, 0.1491, 0.1496, 0.1495, 0.1495, 0.0000, 0.1494, 0.1496,
         0.1492],
        [0.1495, 0.1494, 0.1491, 0.1494, 0.1494, 0.1494, 0.1494, 0.0000, 0.1491,
         0.1495],
        [0.1491, 0.1495, 0.1491, 0.1495, 0.1493, 0.1491, 0.1496, 0.1491, 0.0000,
         0.1490],
        [0.1494, 0.1493, 0.1490, 0.1494, 0.1493, 0.1494, 0.1492, 0.1495, 0.1490,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0006, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3278179
Epoch194: train_loss: 4.4452 recon_acc: 0.2398 val_roc: 0.6987 val_ap: 0.7403 f1: 0.6878 time: 0.2924
difference_matrix tensor([[0.0000, 0.1494, 0.1494, 0.1497, 0.1494, 0.1494, 0.1493, 0.1494, 0.1490,
         0.1492],
        [0.1494, 0.0000, 0.1490, 0.1495, 0.1494, 0.1491, 0.1494, 0.1493, 0.1494,
         0.1492],
        [0.1494, 0.1490, 0.0000, 0.1492, 0.1497, 0.1491, 0.1490, 0.1490, 0.1490,
         0.1489],
        [0.1497, 0.1495, 0.1492, 0.0000, 0.1495, 0.1496, 0.1495, 0.1493, 0.1494,
         0.1493],
        [0.1494, 0.1494, 0.1497, 0.1495, 0.0000, 0.1493, 0.1494, 0.1493, 0.1492,
         0.1492],
        [0.1494, 0.1491, 0.1491, 0.1496, 0.1493, 0.0000, 0.1494, 0.1493, 0.1490,
         0.1493],
        [0.1493, 0.1494, 0.1490, 0.1495, 0.1494, 0.1494, 0.0000, 0.1492, 0.1495,
         0.1491],
        [0.1494, 0.1493, 0.1490, 0.1493, 0.1493, 0.1493, 0.1492, 0.0000, 0.1490,
         0.1494],
        [0.1490, 0.1494, 0.1490, 0.1494, 0.1492, 0.1490, 0.1495, 0.1490, 0.0000,
         0.1489],
        [0.1492, 0.1492, 0.1489, 0.1493, 0.1492, 0.1493, 0.1491, 0.1494, 0.1489,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0007, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3277861
Epoch195: train_loss: 4.4422 recon_acc: 0.2397 val_roc: 0.6986 val_ap: 0.7402 f1: 0.6878 time: 0.3063
difference_matrix tensor([[0.0000, 0.1492, 0.1492, 0.1495, 0.1493, 0.1492, 0.1492, 0.1493, 0.1489,
         0.1491],
        [0.1492, 0.0000, 0.1489, 0.1494, 0.1493, 0.1490, 0.1493, 0.1492, 0.1493,
         0.1491],
        [0.1492, 0.1489, 0.0000, 0.1490, 0.1495, 0.1490, 0.1489, 0.1489, 0.1489,
         0.1487],
        [0.1495, 0.1494, 0.1490, 0.0000, 0.1494, 0.1495, 0.1494, 0.1491, 0.1493,
         0.1492],
        [0.1493, 0.1493, 0.1495, 0.1494, 0.0000, 0.1492, 0.1493, 0.1492, 0.1490,
         0.1491],
        [0.1492, 0.1490, 0.1490, 0.1495, 0.1492, 0.0000, 0.1493, 0.1491, 0.1489,
         0.1491],
        [0.1492, 0.1493, 0.1489, 0.1494, 0.1493, 0.1493, 0.0000, 0.1491, 0.1494,
         0.1490],
        [0.1493, 0.1492, 0.1489, 0.1491, 0.1492, 0.1491, 0.1491, 0.0000, 0.1489,
         0.1492],
        [0.1489, 0.1493, 0.1489, 0.1493, 0.1490, 0.1489, 0.1494, 0.1489, 0.0000,
         0.1488],
        [0.1491, 0.1491, 0.1487, 0.1492, 0.1491, 0.1491, 0.1490, 0.1492, 0.1488,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0008, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32691768
Epoch196: train_loss: 4.4393 recon_acc: 0.2383 val_roc: 0.6987 val_ap: 0.7404 f1: 0.6855 time: 0.3066
difference_matrix tensor([[0.0000, 0.1491, 0.1491, 0.1494, 0.1491, 0.1491, 0.1491, 0.1491, 0.1488,
         0.1490],
        [0.1491, 0.0000, 0.1488, 0.1492, 0.1491, 0.1488, 0.1492, 0.1490, 0.1492,
         0.1489],
        [0.1491, 0.1488, 0.0000, 0.1489, 0.1494, 0.1489, 0.1487, 0.1488, 0.1487,
         0.1486],
        [0.1494, 0.1492, 0.1489, 0.0000, 0.1493, 0.1493, 0.1493, 0.1490, 0.1492,
         0.1490],
        [0.1491, 0.1491, 0.1494, 0.1493, 0.0000, 0.1490, 0.1492, 0.1490, 0.1489,
         0.1489],
        [0.1491, 0.1488, 0.1489, 0.1493, 0.1490, 0.0000, 0.1491, 0.1490, 0.1488,
         0.1490],
        [0.1491, 0.1492, 0.1487, 0.1493, 0.1492, 0.1491, 0.0000, 0.1490, 0.1493,
         0.1488],
        [0.1491, 0.1490, 0.1488, 0.1490, 0.1490, 0.1490, 0.1490, 0.0000, 0.1487,
         0.1491],
        [0.1488, 0.1492, 0.1487, 0.1492, 0.1489, 0.1488, 0.1493, 0.1487, 0.0000,
         0.1487],
        [0.1490, 0.1489, 0.1486, 0.1490, 0.1489, 0.1490, 0.1488, 0.1491, 0.1487,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0010, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32299277
Epoch197: train_loss: 4.4364 recon_acc: 0.2327 val_roc: 0.6987 val_ap: 0.7403 f1: 0.6854 time: 0.2688
difference_matrix tensor([[0.0000, 0.1489, 0.1489, 0.1492, 0.1490, 0.1489, 0.1489, 0.1490, 0.1486,
         0.1488],
        [0.1489, 0.0000, 0.1486, 0.1491, 0.1489, 0.1487, 0.1490, 0.1488, 0.1490,
         0.1488],
        [0.1489, 0.1486, 0.0000, 0.1487, 0.1492, 0.1487, 0.1486, 0.1486, 0.1486,
         0.1484],
        [0.1492, 0.1491, 0.1487, 0.0000, 0.1491, 0.1492, 0.1491, 0.1488, 0.1490,
         0.1489],
        [0.1490, 0.1489, 0.1492, 0.1491, 0.0000, 0.1489, 0.1490, 0.1489, 0.1488,
         0.1488],
        [0.1489, 0.1487, 0.1487, 0.1492, 0.1489, 0.0000, 0.1490, 0.1488, 0.1486,
         0.1488],
        [0.1489, 0.1490, 0.1486, 0.1491, 0.1490, 0.1490, 0.0000, 0.1488, 0.1491,
         0.1487],
        [0.1490, 0.1488, 0.1486, 0.1488, 0.1489, 0.1488, 0.1488, 0.0000, 0.1486,
         0.1489],
        [0.1486, 0.1490, 0.1486, 0.1490, 0.1488, 0.1486, 0.1491, 0.1486, 0.0000,
         0.1485],
        [0.1488, 0.1488, 0.1484, 0.1489, 0.1488, 0.1488, 0.1487, 0.1489, 0.1485,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0012, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3231075
Epoch198: train_loss: 4.4335 recon_acc: 0.2326 val_roc: 0.6986 val_ap: 0.7402 f1: 0.6854 time: 0.2483
difference_matrix tensor([[0.0000, 0.1487, 0.1488, 0.1490, 0.1488, 0.1488, 0.1487, 0.1488, 0.1485,
         0.1486],
        [0.1487, 0.0000, 0.1484, 0.1489, 0.1488, 0.1485, 0.1488, 0.1487, 0.1488,
         0.1486],
        [0.1488, 0.1484, 0.0000, 0.1486, 0.1491, 0.1485, 0.1484, 0.1484, 0.1484,
         0.1483],
        [0.1490, 0.1489, 0.1486, 0.0000, 0.1489, 0.1490, 0.1489, 0.1486, 0.1488,
         0.1487],
        [0.1488, 0.1488, 0.1491, 0.1489, 0.0000, 0.1487, 0.1488, 0.1487, 0.1486,
         0.1486],
        [0.1488, 0.1485, 0.1485, 0.1490, 0.1487, 0.0000, 0.1488, 0.1486, 0.1485,
         0.1487],
        [0.1487, 0.1488, 0.1484, 0.1489, 0.1488, 0.1488, 0.0000, 0.1486, 0.1490,
         0.1485],
        [0.1488, 0.1487, 0.1484, 0.1486, 0.1487, 0.1486, 0.1486, 0.0000, 0.1484,
         0.1487],
        [0.1485, 0.1488, 0.1484, 0.1488, 0.1486, 0.1485, 0.1490, 0.1484, 0.0000,
         0.1483],
        [0.1486, 0.1486, 0.1483, 0.1487, 0.1486, 0.1487, 0.1485, 0.1487, 0.1483,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0013, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3225029
Epoch199: train_loss: 4.4306 recon_acc: 0.2315 val_roc: 0.6987 val_ap: 0.7403 f1: 0.6843 time: 0.2593
difference_matrix tensor([[0.0000, 0.1485, 0.1486, 0.1488, 0.1486, 0.1486, 0.1485, 0.1486, 0.1483,
         0.1484],
        [0.1485, 0.0000, 0.1482, 0.1487, 0.1486, 0.1483, 0.1486, 0.1484, 0.1486,
         0.1484],
        [0.1486, 0.1482, 0.0000, 0.1484, 0.1489, 0.1483, 0.1482, 0.1482, 0.1482,
         0.1481],
        [0.1488, 0.1487, 0.1484, 0.0000, 0.1487, 0.1488, 0.1487, 0.1484, 0.1486,
         0.1485],
        [0.1486, 0.1486, 0.1489, 0.1487, 0.0000, 0.1485, 0.1486, 0.1485, 0.1484,
         0.1484],
        [0.1486, 0.1483, 0.1483, 0.1488, 0.1485, 0.0000, 0.1486, 0.1484, 0.1483,
         0.1485],
        [0.1485, 0.1486, 0.1482, 0.1487, 0.1486, 0.1486, 0.0000, 0.1484, 0.1488,
         0.1483],
        [0.1486, 0.1484, 0.1482, 0.1484, 0.1485, 0.1484, 0.1484, 0.0000, 0.1482,
         0.1485],
        [0.1483, 0.1486, 0.1482, 0.1486, 0.1484, 0.1483, 0.1488, 0.1482, 0.0000,
         0.1481],
        [0.1484, 0.1484, 0.1481, 0.1485, 0.1484, 0.1485, 0.1483, 0.1485, 0.1481,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0015, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.321146
Epoch200: train_loss: 4.4278 recon_acc: 0.2294 val_roc: 0.6989 val_ap: 0.7404 f1: 0.6843 time: 0.2525
difference_matrix tensor([[0.0000, 0.1483, 0.1484, 0.1486, 0.1484, 0.1483, 0.1483, 0.1484, 0.1481,
         0.1482],
        [0.1483, 0.0000, 0.1480, 0.1484, 0.1483, 0.1481, 0.1484, 0.1482, 0.1484,
         0.1482],
        [0.1484, 0.1480, 0.0000, 0.1481, 0.1487, 0.1481, 0.1480, 0.1480, 0.1480,
         0.1479],
        [0.1486, 0.1484, 0.1481, 0.0000, 0.1485, 0.1486, 0.1485, 0.1482, 0.1484,
         0.1483],
        [0.1484, 0.1483, 0.1487, 0.1485, 0.0000, 0.1483, 0.1484, 0.1483, 0.1482,
         0.1482],
        [0.1483, 0.1481, 0.1481, 0.1486, 0.1483, 0.0000, 0.1484, 0.1482, 0.1481,
         0.1482],
        [0.1483, 0.1484, 0.1480, 0.1485, 0.1484, 0.1484, 0.0000, 0.1482, 0.1486,
         0.1481],
        [0.1484, 0.1482, 0.1480, 0.1482, 0.1483, 0.1482, 0.1482, 0.0000, 0.1480,
         0.1483],
        [0.1481, 0.1484, 0.1480, 0.1484, 0.1482, 0.1481, 0.1486, 0.1480, 0.0000,
         0.1479],
        [0.1482, 0.1482, 0.1479, 0.1483, 0.1482, 0.1483, 0.1481, 0.1483, 0.1479,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0017, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.26391742
Epoch201: train_loss: 4.4249 recon_acc: 0.1555 val_roc: 0.6990 val_ap: 0.7406 f1: 0.6825 time: 0.2514
difference_matrix tensor([[0.0000, 0.1481, 0.1481, 0.1484, 0.1482, 0.1481, 0.1481, 0.1481, 0.1478,
         0.1480],
        [0.1481, 0.0000, 0.1478, 0.1482, 0.1481, 0.1478, 0.1482, 0.1480, 0.1482,
         0.1479],
        [0.1481, 0.1478, 0.0000, 0.1479, 0.1485, 0.1479, 0.1478, 0.1478, 0.1478,
         0.1476],
        [0.1484, 0.1482, 0.1479, 0.0000, 0.1483, 0.1483, 0.1483, 0.1479, 0.1482,
         0.1480],
        [0.1482, 0.1481, 0.1485, 0.1483, 0.0000, 0.1481, 0.1482, 0.1480, 0.1480,
         0.1480],
        [0.1481, 0.1478, 0.1479, 0.1483, 0.1481, 0.0000, 0.1482, 0.1480, 0.1479,
         0.1480],
        [0.1481, 0.1482, 0.1478, 0.1483, 0.1482, 0.1482, 0.0000, 0.1480, 0.1484,
         0.1479],
        [0.1481, 0.1480, 0.1478, 0.1479, 0.1480, 0.1480, 0.1480, 0.0000, 0.1478,
         0.1481],
        [0.1478, 0.1482, 0.1478, 0.1482, 0.1480, 0.1479, 0.1484, 0.1478, 0.0000,
         0.1477],
        [0.1480, 0.1479, 0.1476, 0.1480, 0.1480, 0.1480, 0.1479, 0.1481, 0.1477,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0020, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.26405397
Epoch202: train_loss: 4.4221 recon_acc: 0.1553 val_roc: 0.6991 val_ap: 0.7408 f1: 0.6825 time: 0.2564
difference_matrix tensor([[0.0000, 0.1478, 0.1479, 0.1482, 0.1479, 0.1479, 0.1479, 0.1479, 0.1476,
         0.1478],
        [0.1478, 0.0000, 0.1476, 0.1480, 0.1479, 0.1476, 0.1480, 0.1477, 0.1480,
         0.1477],
        [0.1479, 0.1476, 0.0000, 0.1477, 0.1482, 0.1477, 0.1476, 0.1475, 0.1476,
         0.1474],
        [0.1482, 0.1480, 0.1477, 0.0000, 0.1481, 0.1481, 0.1481, 0.1477, 0.1480,
         0.1478],
        [0.1479, 0.1479, 0.1482, 0.1481, 0.0000, 0.1478, 0.1480, 0.1478, 0.1478,
         0.1478],
        [0.1479, 0.1476, 0.1477, 0.1481, 0.1478, 0.0000, 0.1479, 0.1477, 0.1476,
         0.1478],
        [0.1479, 0.1480, 0.1476, 0.1481, 0.1480, 0.1479, 0.0000, 0.1477, 0.1482,
         0.1477],
        [0.1479, 0.1477, 0.1475, 0.1477, 0.1478, 0.1477, 0.1477, 0.0000, 0.1476,
         0.1478],
        [0.1476, 0.1480, 0.1476, 0.1480, 0.1478, 0.1476, 0.1482, 0.1476, 0.0000,
         0.1475],
        [0.1478, 0.1477, 0.1474, 0.1478, 0.1478, 0.1478, 0.1477, 0.1478, 0.1475,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0022, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31433427
Epoch203: train_loss: 4.4193 recon_acc: 0.2192 val_roc: 0.6992 val_ap: 0.7410 f1: 0.6831 time: 0.2610
thresh 0.045139395
          test_roc: 0.6807 test_ap: 0.7106 test_f1: 0.6676 test_recon_acc: 0.0042
difference_matrix tensor([[0.0000, 0.1476, 0.1477, 0.1479, 0.1477, 0.1476, 0.1476, 0.1476, 0.1474,
         0.1475],
        [0.1476, 0.0000, 0.1473, 0.1477, 0.1477, 0.1474, 0.1477, 0.1475, 0.1477,
         0.1475],
        [0.1477, 0.1473, 0.0000, 0.1475, 0.1480, 0.1475, 0.1473, 0.1473, 0.1474,
         0.1472],
        [0.1479, 0.1477, 0.1475, 0.0000, 0.1478, 0.1478, 0.1478, 0.1475, 0.1478,
         0.1476],
        [0.1477, 0.1477, 0.1480, 0.1478, 0.0000, 0.1476, 0.1478, 0.1476, 0.1476,
         0.1475],
        [0.1476, 0.1474, 0.1475, 0.1478, 0.1476, 0.0000, 0.1477, 0.1475, 0.1474,
         0.1476],
        [0.1476, 0.1477, 0.1473, 0.1478, 0.1478, 0.1477, 0.0000, 0.1475, 0.1479,
         0.1474],
        [0.1476, 0.1475, 0.1473, 0.1475, 0.1476, 0.1475, 0.1475, 0.0000, 0.1473,
         0.1476],
        [0.1474, 0.1477, 0.1474, 0.1478, 0.1476, 0.1474, 0.1479, 0.1473, 0.0000,
         0.1473],
        [0.1475, 0.1475, 0.1472, 0.1476, 0.1475, 0.1476, 0.1474, 0.1476, 0.1473,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0024, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31578252
Epoch204: train_loss: 4.4165 recon_acc: 0.2208 val_roc: 0.6992 val_ap: 0.7411 f1: 0.6831 time: 0.2973
thresh 0.04505352
          test_roc: 0.6810 test_ap: 0.7110 test_f1: 0.6676 test_recon_acc: 0.0041
difference_matrix tensor([[0.0000, 0.1473, 0.1474, 0.1477, 0.1475, 0.1474, 0.1474, 0.1474, 0.1471,
         0.1473],
        [0.1473, 0.0000, 0.1471, 0.1475, 0.1474, 0.1471, 0.1475, 0.1472, 0.1475,
         0.1472],
        [0.1474, 0.1471, 0.0000, 0.1472, 0.1478, 0.1472, 0.1471, 0.1471, 0.1472,
         0.1470],
        [0.1477, 0.1475, 0.1472, 0.0000, 0.1476, 0.1476, 0.1476, 0.1472, 0.1475,
         0.1473],
        [0.1475, 0.1474, 0.1478, 0.1476, 0.0000, 0.1474, 0.1476, 0.1474, 0.1473,
         0.1473],
        [0.1474, 0.1471, 0.1472, 0.1476, 0.1474, 0.0000, 0.1475, 0.1473, 0.1472,
         0.1473],
        [0.1474, 0.1475, 0.1471, 0.1476, 0.1476, 0.1475, 0.0000, 0.1473, 0.1477,
         0.1472],
        [0.1474, 0.1472, 0.1471, 0.1472, 0.1474, 0.1473, 0.1473, 0.0000, 0.1471,
         0.1474],
        [0.1471, 0.1475, 0.1472, 0.1475, 0.1473, 0.1472, 0.1477, 0.1471, 0.0000,
         0.1471],
        [0.1473, 0.1472, 0.1470, 0.1473, 0.1473, 0.1473, 0.1472, 0.1474, 0.1471,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0027, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31528527
Epoch205: train_loss: 4.4137 recon_acc: 0.2198 val_roc: 0.6992 val_ap: 0.7410 f1: 0.6831 time: 0.2919
thresh 0.044975832
          test_roc: 0.6812 test_ap: 0.7113 test_f1: 0.6676 test_recon_acc: 0.0041
difference_matrix tensor([[0.0000, 0.1471, 0.1472, 0.1474, 0.1472, 0.1471, 0.1472, 0.1471, 0.1469,
         0.1471],
        [0.1471, 0.0000, 0.1469, 0.1472, 0.1472, 0.1469, 0.1473, 0.1470, 0.1473,
         0.1470],
        [0.1472, 0.1469, 0.0000, 0.1470, 0.1476, 0.1470, 0.1469, 0.1469, 0.1470,
         0.1468],
        [0.1474, 0.1472, 0.1470, 0.0000, 0.1473, 0.1474, 0.1473, 0.1470, 0.1473,
         0.1471],
        [0.1472, 0.1472, 0.1476, 0.1473, 0.0000, 0.1471, 0.1473, 0.1471, 0.1471,
         0.1471],
        [0.1471, 0.1469, 0.1470, 0.1474, 0.1471, 0.0000, 0.1472, 0.1470, 0.1469,
         0.1471],
        [0.1472, 0.1473, 0.1469, 0.1473, 0.1473, 0.1472, 0.0000, 0.1470, 0.1475,
         0.1470],
        [0.1471, 0.1470, 0.1469, 0.1470, 0.1471, 0.1470, 0.1470, 0.0000, 0.1469,
         0.1471],
        [0.1469, 0.1473, 0.1470, 0.1473, 0.1471, 0.1469, 0.1475, 0.1469, 0.0000,
         0.1468],
        [0.1471, 0.1470, 0.1468, 0.1471, 0.1471, 0.1471, 0.1470, 0.1471, 0.1468,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0029, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.31422636
Epoch206: train_loss: 4.4110 recon_acc: 0.2180 val_roc: 0.6993 val_ap: 0.7411 f1: 0.6831 time: 0.2511
thresh 0.044904027
          test_roc: 0.6814 test_ap: 0.7115 test_f1: 0.6676 test_recon_acc: 0.0041
difference_matrix tensor([[0.0000, 0.1469, 0.1470, 0.1472, 0.1470, 0.1469, 0.1469, 0.1469, 0.1467,
         0.1468],
        [0.1469, 0.0000, 0.1466, 0.1470, 0.1470, 0.1466, 0.1470, 0.1468, 0.1470,
         0.1467],
        [0.1470, 0.1466, 0.0000, 0.1468, 0.1474, 0.1468, 0.1467, 0.1466, 0.1467,
         0.1465],
        [0.1472, 0.1470, 0.1468, 0.0000, 0.1471, 0.1471, 0.1471, 0.1467, 0.1471,
         0.1468],
        [0.1470, 0.1470, 0.1474, 0.1471, 0.0000, 0.1469, 0.1471, 0.1469, 0.1469,
         0.1469],
        [0.1469, 0.1466, 0.1468, 0.1471, 0.1469, 0.0000, 0.1470, 0.1468, 0.1467,
         0.1469],
        [0.1469, 0.1470, 0.1467, 0.1471, 0.1471, 0.1470, 0.0000, 0.1468, 0.1473,
         0.1467],
        [0.1469, 0.1468, 0.1466, 0.1467, 0.1469, 0.1468, 0.1468, 0.0000, 0.1466,
         0.1469],
        [0.1467, 0.1470, 0.1467, 0.1471, 0.1469, 0.1467, 0.1473, 0.1466, 0.0000,
         0.1466],
        [0.1468, 0.1467, 0.1465, 0.1468, 0.1469, 0.1469, 0.1467, 0.1469, 0.1466,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0031, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.30625367
Epoch207: train_loss: 4.4082 recon_acc: 0.2069 val_roc: 0.6994 val_ap: 0.7413 f1: 0.6829 time: 0.2528
thresh 0.044835955
          test_roc: 0.6815 test_ap: 0.7118 test_f1: 0.6676 test_recon_acc: 0.0040
difference_matrix tensor([[0.0000, 0.1466, 0.1468, 0.1469, 0.1468, 0.1467, 0.1467, 0.1467, 0.1465,
         0.1466],
        [0.1466, 0.0000, 0.1464, 0.1467, 0.1467, 0.1464, 0.1468, 0.1465, 0.1468,
         0.1465],
        [0.1468, 0.1464, 0.0000, 0.1465, 0.1472, 0.1466, 0.1465, 0.1464, 0.1465,
         0.1463],
        [0.1469, 0.1467, 0.1465, 0.0000, 0.1469, 0.1469, 0.1469, 0.1465, 0.1468,
         0.1466],
        [0.1468, 0.1467, 0.1472, 0.1469, 0.0000, 0.1467, 0.1469, 0.1467, 0.1467,
         0.1467],
        [0.1467, 0.1464, 0.1466, 0.1469, 0.1467, 0.0000, 0.1468, 0.1466, 0.1465,
         0.1466],
        [0.1467, 0.1468, 0.1465, 0.1469, 0.1469, 0.1468, 0.0000, 0.1466, 0.1471,
         0.1465],
        [0.1467, 0.1465, 0.1464, 0.1465, 0.1467, 0.1466, 0.1466, 0.0000, 0.1464,
         0.1467],
        [0.1465, 0.1468, 0.1465, 0.1468, 0.1467, 0.1465, 0.1471, 0.1464, 0.0000,
         0.1464],
        [0.1466, 0.1465, 0.1463, 0.1466, 0.1467, 0.1466, 0.1465, 0.1467, 0.1464,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0033, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.30585063
Epoch208: train_loss: 4.4055 recon_acc: 0.2060 val_roc: 0.6998 val_ap: 0.7419 f1: 0.6829 time: 0.2745
thresh 0.044769652
          test_roc: 0.6818 test_ap: 0.7120 test_f1: 0.6676 test_recon_acc: 0.0040
difference_matrix tensor([[0.0000, 0.1464, 0.1466, 0.1467, 0.1466, 0.1464, 0.1465, 0.1464, 0.1462,
         0.1464],
        [0.1464, 0.0000, 0.1462, 0.1465, 0.1465, 0.1462, 0.1466, 0.1463, 0.1466,
         0.1463],
        [0.1466, 0.1462, 0.0000, 0.1463, 0.1470, 0.1464, 0.1463, 0.1462, 0.1463,
         0.1461],
        [0.1467, 0.1465, 0.1463, 0.0000, 0.1467, 0.1467, 0.1467, 0.1462, 0.1466,
         0.1464],
        [0.1466, 0.1465, 0.1470, 0.1467, 0.0000, 0.1465, 0.1467, 0.1465, 0.1465,
         0.1465],
        [0.1464, 0.1462, 0.1464, 0.1467, 0.1465, 0.0000, 0.1465, 0.1463, 0.1463,
         0.1464],
        [0.1465, 0.1466, 0.1463, 0.1467, 0.1467, 0.1465, 0.0000, 0.1463, 0.1469,
         0.1463],
        [0.1464, 0.1463, 0.1462, 0.1462, 0.1465, 0.1463, 0.1463, 0.0000, 0.1462,
         0.1464],
        [0.1462, 0.1466, 0.1463, 0.1466, 0.1465, 0.1463, 0.1469, 0.1462, 0.0000,
         0.1462],
        [0.1464, 0.1463, 0.1461, 0.1464, 0.1465, 0.1464, 0.1463, 0.1464, 0.1462,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0036, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.30541813
Epoch209: train_loss: 4.4028 recon_acc: 0.2051 val_roc: 0.7000 val_ap: 0.7422 f1: 0.6829 time: 0.2682
thresh 0.04470409
          test_roc: 0.6821 test_ap: 0.7122 test_f1: 0.6676 test_recon_acc: 0.0040
difference_matrix tensor([[0.0000, 0.1462, 0.1464, 0.1465, 0.1463, 0.1462, 0.1463, 0.1462, 0.1460,
         0.1462],
        [0.1462, 0.0000, 0.1460, 0.1463, 0.1463, 0.1459, 0.1463, 0.1461, 0.1464,
         0.1461],
        [0.1464, 0.1460, 0.0000, 0.1461, 0.1468, 0.1462, 0.1461, 0.1460, 0.1462,
         0.1459],
        [0.1465, 0.1463, 0.1461, 0.0000, 0.1465, 0.1464, 0.1464, 0.1460, 0.1464,
         0.1462],
        [0.1463, 0.1463, 0.1468, 0.1465, 0.0000, 0.1463, 0.1465, 0.1463, 0.1463,
         0.1463],
        [0.1462, 0.1459, 0.1462, 0.1464, 0.1463, 0.0000, 0.1463, 0.1461, 0.1461,
         0.1462],
        [0.1463, 0.1463, 0.1461, 0.1464, 0.1465, 0.1463, 0.0000, 0.1461, 0.1467,
         0.1461],
        [0.1462, 0.1461, 0.1460, 0.1460, 0.1463, 0.1461, 0.1461, 0.0000, 0.1460,
         0.1462],
        [0.1460, 0.1464, 0.1462, 0.1464, 0.1463, 0.1461, 0.1467, 0.1460, 0.0000,
         0.1460],
        [0.1462, 0.1461, 0.1459, 0.1462, 0.1463, 0.1462, 0.1461, 0.1462, 0.1460,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0038, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2872025
Epoch210: train_loss: 4.4001 recon_acc: 0.1810 val_roc: 0.7002 val_ap: 0.7428 f1: 0.6827 time: 0.2780
thresh 0.04464062
          test_roc: 0.6823 test_ap: 0.7125 test_f1: 0.6676 test_recon_acc: 0.0040
difference_matrix tensor([[0.0000, 0.1459, 0.1462, 0.1463, 0.1461, 0.1460, 0.1460, 0.1460, 0.1458,
         0.1459],
        [0.1459, 0.0000, 0.1458, 0.1460, 0.1461, 0.1457, 0.1461, 0.1458, 0.1462,
         0.1459],
        [0.1462, 0.1458, 0.0000, 0.1459, 0.1466, 0.1460, 0.1459, 0.1458, 0.1460,
         0.1457],
        [0.1463, 0.1460, 0.1459, 0.0000, 0.1463, 0.1462, 0.1462, 0.1458, 0.1462,
         0.1460],
        [0.1461, 0.1461, 0.1466, 0.1463, 0.0000, 0.1461, 0.1463, 0.1461, 0.1461,
         0.1461],
        [0.1460, 0.1457, 0.1460, 0.1462, 0.1461, 0.0000, 0.1461, 0.1459, 0.1459,
         0.1460],
        [0.1460, 0.1461, 0.1459, 0.1462, 0.1463, 0.1461, 0.0000, 0.1459, 0.1465,
         0.1459],
        [0.1460, 0.1458, 0.1458, 0.1458, 0.1461, 0.1459, 0.1459, 0.0000, 0.1458,
         0.1460],
        [0.1458, 0.1462, 0.1460, 0.1462, 0.1461, 0.1459, 0.1465, 0.1458, 0.0000,
         0.1458],
        [0.1459, 0.1459, 0.1457, 0.1460, 0.1461, 0.1460, 0.1459, 0.1460, 0.1458,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0040, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28787813
Epoch211: train_loss: 4.3974 recon_acc: 0.1816 val_roc: 0.7002 val_ap: 0.7429 f1: 0.6838 time: 0.2676
thresh 0.044577345
          test_roc: 0.6826 test_ap: 0.7130 test_f1: 0.6676 test_recon_acc: 0.0039
difference_matrix tensor([[0.0000, 0.1457, 0.1460, 0.1460, 0.1459, 0.1458, 0.1458, 0.1458, 0.1456,
         0.1457],
        [0.1457, 0.0000, 0.1456, 0.1458, 0.1459, 0.1455, 0.1459, 0.1456, 0.1460,
         0.1457],
        [0.1460, 0.1456, 0.0000, 0.1457, 0.1464, 0.1458, 0.1457, 0.1456, 0.1458,
         0.1456],
        [0.1460, 0.1458, 0.1457, 0.0000, 0.1461, 0.1460, 0.1460, 0.1456, 0.1460,
         0.1458],
        [0.1459, 0.1459, 0.1464, 0.1461, 0.0000, 0.1459, 0.1461, 0.1459, 0.1459,
         0.1459],
        [0.1458, 0.1455, 0.1458, 0.1460, 0.1459, 0.0000, 0.1459, 0.1457, 0.1457,
         0.1458],
        [0.1458, 0.1459, 0.1457, 0.1460, 0.1461, 0.1459, 0.0000, 0.1457, 0.1463,
         0.1457],
        [0.1458, 0.1456, 0.1456, 0.1456, 0.1459, 0.1457, 0.1457, 0.0000, 0.1456,
         0.1458],
        [0.1456, 0.1460, 0.1458, 0.1460, 0.1459, 0.1457, 0.1463, 0.1456, 0.0000,
         0.1456],
        [0.1457, 0.1457, 0.1456, 0.1458, 0.1459, 0.1458, 0.1457, 0.1458, 0.1456,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0042, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2885295
Epoch212: train_loss: 4.3947 recon_acc: 0.1821 val_roc: 0.7003 val_ap: 0.7433 f1: 0.6838 time: 0.2662
thresh 0.044511106
          test_roc: 0.6829 test_ap: 0.7133 test_f1: 0.6676 test_recon_acc: 0.0039
difference_matrix tensor([[0.0000, 0.1455, 0.1458, 0.1458, 0.1458, 0.1456, 0.1457, 0.1456, 0.1455,
         0.1456],
        [0.1455, 0.0000, 0.1454, 0.1456, 0.1457, 0.1453, 0.1457, 0.1454, 0.1458,
         0.1455],
        [0.1458, 0.1454, 0.0000, 0.1455, 0.1462, 0.1456, 0.1455, 0.1454, 0.1456,
         0.1454],
        [0.1458, 0.1456, 0.1455, 0.0000, 0.1459, 0.1458, 0.1458, 0.1454, 0.1458,
         0.1456],
        [0.1458, 0.1457, 0.1462, 0.1459, 0.0000, 0.1457, 0.1460, 0.1457, 0.1458,
         0.1457],
        [0.1456, 0.1453, 0.1456, 0.1458, 0.1457, 0.0000, 0.1457, 0.1455, 0.1455,
         0.1456],
        [0.1457, 0.1457, 0.1455, 0.1458, 0.1460, 0.1457, 0.0000, 0.1455, 0.1461,
         0.1455],
        [0.1456, 0.1454, 0.1454, 0.1454, 0.1457, 0.1455, 0.1455, 0.0000, 0.1454,
         0.1456],
        [0.1455, 0.1458, 0.1456, 0.1458, 0.1458, 0.1455, 0.1461, 0.1454, 0.0000,
         0.1454],
        [0.1456, 0.1455, 0.1454, 0.1456, 0.1457, 0.1456, 0.1455, 0.1456, 0.1454,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0044, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2849679
Epoch213: train_loss: 4.3921 recon_acc: 0.1773 val_roc: 0.7005 val_ap: 0.7436 f1: 0.6848 time: 0.2919
thresh 0.044444107
          test_roc: 0.6833 test_ap: 0.7138 test_f1: 0.6676 test_recon_acc: 0.0039
difference_matrix tensor([[0.0000, 0.1453, 0.1456, 0.1457, 0.1456, 0.1454, 0.1455, 0.1454, 0.1453,
         0.1454],
        [0.1453, 0.0000, 0.1452, 0.1454, 0.1456, 0.1451, 0.1456, 0.1453, 0.1456,
         0.1453],
        [0.1456, 0.1452, 0.0000, 0.1454, 0.1461, 0.1454, 0.1453, 0.1453, 0.1455,
         0.1452],
        [0.1457, 0.1454, 0.1454, 0.0000, 0.1457, 0.1456, 0.1456, 0.1452, 0.1457,
         0.1454],
        [0.1456, 0.1456, 0.1461, 0.1457, 0.0000, 0.1455, 0.1458, 0.1455, 0.1456,
         0.1455],
        [0.1454, 0.1451, 0.1454, 0.1456, 0.1455, 0.0000, 0.1456, 0.1453, 0.1453,
         0.1455],
        [0.1455, 0.1456, 0.1453, 0.1456, 0.1458, 0.1456, 0.0000, 0.1453, 0.1459,
         0.1453],
        [0.1454, 0.1453, 0.1453, 0.1452, 0.1455, 0.1453, 0.1453, 0.0000, 0.1452,
         0.1455],
        [0.1453, 0.1456, 0.1455, 0.1457, 0.1456, 0.1453, 0.1459, 0.1452, 0.0000,
         0.1453],
        [0.1454, 0.1453, 0.1452, 0.1454, 0.1455, 0.1455, 0.1453, 0.1455, 0.1453,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0045, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28544128
Epoch214: train_loss: 4.3894 recon_acc: 0.1776 val_roc: 0.7008 val_ap: 0.7440 f1: 0.6859 time: 0.2558
thresh 0.044378743
          test_roc: 0.6835 test_ap: 0.7140 test_f1: 0.6676 test_recon_acc: 0.0039
difference_matrix tensor([[0.0000, 0.1452, 0.1454, 0.1455, 0.1454, 0.1452, 0.1453, 0.1452, 0.1451,
         0.1452],
        [0.1452, 0.0000, 0.1451, 0.1453, 0.1454, 0.1450, 0.1454, 0.1451, 0.1455,
         0.1451],
        [0.1454, 0.1451, 0.0000, 0.1452, 0.1459, 0.1453, 0.1452, 0.1451, 0.1453,
         0.1451],
        [0.1455, 0.1453, 0.1452, 0.0000, 0.1455, 0.1455, 0.1455, 0.1450, 0.1455,
         0.1452],
        [0.1454, 0.1454, 0.1459, 0.1455, 0.0000, 0.1454, 0.1456, 0.1453, 0.1454,
         0.1454],
        [0.1452, 0.1450, 0.1453, 0.1455, 0.1454, 0.0000, 0.1454, 0.1451, 0.1452,
         0.1453],
        [0.1453, 0.1454, 0.1452, 0.1455, 0.1456, 0.1454, 0.0000, 0.1452, 0.1458,
         0.1452],
        [0.1452, 0.1451, 0.1451, 0.1450, 0.1453, 0.1451, 0.1452, 0.0000, 0.1451,
         0.1453],
        [0.1451, 0.1455, 0.1453, 0.1455, 0.1454, 0.1452, 0.1458, 0.1451, 0.0000,
         0.1451],
        [0.1452, 0.1451, 0.1451, 0.1452, 0.1454, 0.1453, 0.1452, 0.1453, 0.1451,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0047, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28591216
Epoch215: train_loss: 4.3868 recon_acc: 0.1780 val_roc: 0.7010 val_ap: 0.7441 f1: 0.6859 time: 0.2575
thresh 0.044314034
          test_roc: 0.6837 test_ap: 0.7142 test_f1: 0.6676 test_recon_acc: 0.0038
difference_matrix tensor([[0.0000, 0.1450, 0.1453, 0.1453, 0.1452, 0.1451, 0.1451, 0.1451, 0.1449,
         0.1450],
        [0.1450, 0.0000, 0.1449, 0.1451, 0.1452, 0.1448, 0.1452, 0.1449, 0.1453,
         0.1449],
        [0.1453, 0.1449, 0.0000, 0.1450, 0.1458, 0.1451, 0.1450, 0.1449, 0.1451,
         0.1449],
        [0.1453, 0.1451, 0.1450, 0.0000, 0.1454, 0.1453, 0.1453, 0.1448, 0.1453,
         0.1450],
        [0.1452, 0.1452, 0.1458, 0.1454, 0.0000, 0.1452, 0.1455, 0.1452, 0.1453,
         0.1452],
        [0.1451, 0.1448, 0.1451, 0.1453, 0.1452, 0.0000, 0.1452, 0.1450, 0.1450,
         0.1451],
        [0.1451, 0.1452, 0.1450, 0.1453, 0.1455, 0.1452, 0.0000, 0.1450, 0.1456,
         0.1450],
        [0.1451, 0.1449, 0.1449, 0.1448, 0.1452, 0.1450, 0.1450, 0.0000, 0.1449,
         0.1451],
        [0.1449, 0.1453, 0.1451, 0.1453, 0.1453, 0.1450, 0.1456, 0.1449, 0.0000,
         0.1449],
        [0.1450, 0.1449, 0.1449, 0.1450, 0.1452, 0.1451, 0.1450, 0.1451, 0.1449,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0049, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28638557
Epoch216: train_loss: 4.3842 recon_acc: 0.1783 val_roc: 0.7011 val_ap: 0.7446 f1: 0.6859 time: 0.2675
thresh 0.044249218
          test_roc: 0.6839 test_ap: 0.7143 test_f1: 0.6676 test_recon_acc: 0.0038
difference_matrix tensor([[0.0000, 0.1448, 0.1451, 0.1451, 0.1451, 0.1449, 0.1449, 0.1449, 0.1448,
         0.1449],
        [0.1448, 0.0000, 0.1447, 0.1449, 0.1450, 0.1446, 0.1450, 0.1447, 0.1451,
         0.1448],
        [0.1451, 0.1447, 0.0000, 0.1449, 0.1456, 0.1449, 0.1448, 0.1448, 0.1450,
         0.1447],
        [0.1451, 0.1449, 0.1449, 0.0000, 0.1452, 0.1451, 0.1451, 0.1447, 0.1451,
         0.1449],
        [0.1451, 0.1450, 0.1456, 0.1452, 0.0000, 0.1450, 0.1453, 0.1450, 0.1451,
         0.1451],
        [0.1449, 0.1446, 0.1449, 0.1451, 0.1450, 0.0000, 0.1450, 0.1448, 0.1448,
         0.1449],
        [0.1449, 0.1450, 0.1448, 0.1451, 0.1453, 0.1450, 0.0000, 0.1448, 0.1454,
         0.1448],
        [0.1449, 0.1447, 0.1448, 0.1447, 0.1450, 0.1448, 0.1448, 0.0000, 0.1447,
         0.1450],
        [0.1448, 0.1451, 0.1450, 0.1451, 0.1451, 0.1448, 0.1454, 0.1447, 0.0000,
         0.1448],
        [0.1449, 0.1448, 0.1447, 0.1449, 0.1451, 0.1449, 0.1448, 0.1450, 0.1448,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0050, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2868534
Epoch217: train_loss: 4.3816 recon_acc: 0.1787 val_roc: 0.7011 val_ap: 0.7449 f1: 0.6859 time: 0.2738
thresh 0.04418435
          test_roc: 0.6842 test_ap: 0.7147 test_f1: 0.6676 test_recon_acc: 0.0038
difference_matrix tensor([[0.0000, 0.1446, 0.1449, 0.1449, 0.1449, 0.1447, 0.1448, 0.1447, 0.1446,
         0.1447],
        [0.1446, 0.0000, 0.1446, 0.1447, 0.1449, 0.1444, 0.1449, 0.1445, 0.1449,
         0.1446],
        [0.1449, 0.1446, 0.0000, 0.1447, 0.1455, 0.1448, 0.1447, 0.1446, 0.1448,
         0.1446],
        [0.1449, 0.1447, 0.1447, 0.0000, 0.1450, 0.1449, 0.1449, 0.1445, 0.1450,
         0.1447],
        [0.1449, 0.1449, 0.1455, 0.1450, 0.0000, 0.1449, 0.1451, 0.1449, 0.1450,
         0.1449],
        [0.1447, 0.1444, 0.1448, 0.1449, 0.1449, 0.0000, 0.1449, 0.1446, 0.1447,
         0.1448],
        [0.1448, 0.1449, 0.1447, 0.1449, 0.1451, 0.1449, 0.0000, 0.1446, 0.1453,
         0.1447],
        [0.1447, 0.1445, 0.1446, 0.1445, 0.1449, 0.1446, 0.1446, 0.0000, 0.1446,
         0.1448],
        [0.1446, 0.1449, 0.1448, 0.1450, 0.1450, 0.1447, 0.1453, 0.1446, 0.0000,
         0.1446],
        [0.1447, 0.1446, 0.1446, 0.1447, 0.1449, 0.1448, 0.1447, 0.1448, 0.1446,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0052, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28731373
Epoch218: train_loss: 4.3790 recon_acc: 0.1790 val_roc: 0.7013 val_ap: 0.7453 f1: 0.6859 time: 0.2562
thresh 0.044121142
          test_roc: 0.6844 test_ap: 0.7150 test_f1: 0.6676 test_recon_acc: 0.0038
difference_matrix tensor([[0.0000, 0.1444, 0.1448, 0.1447, 0.1447, 0.1445, 0.1446, 0.1445, 0.1444,
         0.1445],
        [0.1444, 0.0000, 0.1444, 0.1445, 0.1447, 0.1443, 0.1447, 0.1444, 0.1448,
         0.1444],
        [0.1448, 0.1444, 0.0000, 0.1445, 0.1453, 0.1446, 0.1445, 0.1445, 0.1447,
         0.1444],
        [0.1447, 0.1445, 0.1445, 0.0000, 0.1449, 0.1448, 0.1448, 0.1443, 0.1448,
         0.1445],
        [0.1447, 0.1447, 0.1453, 0.1449, 0.0000, 0.1447, 0.1450, 0.1447, 0.1448,
         0.1447],
        [0.1445, 0.1443, 0.1446, 0.1448, 0.1447, 0.0000, 0.1447, 0.1445, 0.1445,
         0.1446],
        [0.1446, 0.1447, 0.1445, 0.1448, 0.1450, 0.1447, 0.0000, 0.1445, 0.1451,
         0.1445],
        [0.1445, 0.1444, 0.1445, 0.1443, 0.1447, 0.1445, 0.1445, 0.0000, 0.1444,
         0.1446],
        [0.1444, 0.1448, 0.1447, 0.1448, 0.1448, 0.1445, 0.1451, 0.1444, 0.0000,
         0.1445],
        [0.1445, 0.1444, 0.1444, 0.1445, 0.1447, 0.1446, 0.1445, 0.1446, 0.1445,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0054, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28777176
Epoch219: train_loss: 4.3764 recon_acc: 0.1793 val_roc: 0.7016 val_ap: 0.7456 f1: 0.6859 time: 0.2612
thresh 0.04406192
          test_roc: 0.6846 test_ap: 0.7151 test_f1: 0.6676 test_recon_acc: 0.0037
difference_matrix tensor([[0.0000, 0.1443, 0.1446, 0.1446, 0.1446, 0.1444, 0.1444, 0.1444, 0.1442,
         0.1443],
        [0.1443, 0.0000, 0.1442, 0.1444, 0.1445, 0.1441, 0.1445, 0.1442, 0.1446,
         0.1443],
        [0.1446, 0.1442, 0.0000, 0.1444, 0.1452, 0.1444, 0.1444, 0.1443, 0.1445,
         0.1443],
        [0.1446, 0.1444, 0.1444, 0.0000, 0.1447, 0.1446, 0.1446, 0.1441, 0.1446,
         0.1444],
        [0.1446, 0.1445, 0.1452, 0.1447, 0.0000, 0.1445, 0.1448, 0.1445, 0.1447,
         0.1446],
        [0.1444, 0.1441, 0.1444, 0.1446, 0.1445, 0.0000, 0.1445, 0.1443, 0.1443,
         0.1444],
        [0.1444, 0.1445, 0.1444, 0.1446, 0.1448, 0.1445, 0.0000, 0.1443, 0.1450,
         0.1443],
        [0.1444, 0.1442, 0.1443, 0.1441, 0.1445, 0.1443, 0.1443, 0.0000, 0.1442,
         0.1445],
        [0.1442, 0.1446, 0.1445, 0.1446, 0.1447, 0.1443, 0.1450, 0.1442, 0.0000,
         0.1443],
        [0.1443, 0.1443, 0.1443, 0.1444, 0.1446, 0.1444, 0.1443, 0.1445, 0.1443,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0055, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28823063
Epoch220: train_loss: 4.3739 recon_acc: 0.1796 val_roc: 0.7017 val_ap: 0.7458 f1: 0.6848 time: 0.2554
thresh 0.04400625
          test_roc: 0.6849 test_ap: 0.7155 test_f1: 0.6676 test_recon_acc: 0.0037
difference_matrix tensor([[0.0000, 0.1441, 0.1444, 0.1444, 0.1444, 0.1442, 0.1442, 0.1442, 0.1441,
         0.1442],
        [0.1441, 0.0000, 0.1441, 0.1442, 0.1444, 0.1439, 0.1443, 0.1440, 0.1444,
         0.1441],
        [0.1444, 0.1441, 0.0000, 0.1442, 0.1450, 0.1443, 0.1442, 0.1441, 0.1444,
         0.1441],
        [0.1444, 0.1442, 0.1442, 0.0000, 0.1445, 0.1444, 0.1444, 0.1440, 0.1445,
         0.1442],
        [0.1444, 0.1444, 0.1450, 0.1445, 0.0000, 0.1444, 0.1446, 0.1444, 0.1445,
         0.1444],
        [0.1442, 0.1439, 0.1443, 0.1444, 0.1444, 0.0000, 0.1444, 0.1441, 0.1442,
         0.1443],
        [0.1442, 0.1443, 0.1442, 0.1444, 0.1446, 0.1444, 0.0000, 0.1441, 0.1448,
         0.1442],
        [0.1442, 0.1440, 0.1441, 0.1440, 0.1444, 0.1441, 0.1441, 0.0000, 0.1441,
         0.1443],
        [0.1441, 0.1444, 0.1444, 0.1445, 0.1445, 0.1442, 0.1448, 0.1441, 0.0000,
         0.1441],
        [0.1442, 0.1441, 0.1441, 0.1442, 0.1444, 0.1443, 0.1442, 0.1443, 0.1441,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0057, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29140356
Epoch221: train_loss: 4.3713 recon_acc: 0.1834 val_roc: 0.7021 val_ap: 0.7462 f1: 0.6838 time: 0.2735
thresh 0.04395305
          test_roc: 0.6853 test_ap: 0.7160 test_f1: 0.6676 test_recon_acc: 0.0037
difference_matrix tensor([[0.0000, 0.1439, 0.1443, 0.1442, 0.1442, 0.1440, 0.1441, 0.1440, 0.1439,
         0.1440],
        [0.1439, 0.0000, 0.1439, 0.1440, 0.1442, 0.1437, 0.1442, 0.1438, 0.1443,
         0.1439],
        [0.1443, 0.1439, 0.0000, 0.1440, 0.1448, 0.1441, 0.1440, 0.1440, 0.1442,
         0.1439],
        [0.1442, 0.1440, 0.1440, 0.0000, 0.1444, 0.1442, 0.1442, 0.1438, 0.1443,
         0.1440],
        [0.1442, 0.1442, 0.1448, 0.1444, 0.0000, 0.1442, 0.1445, 0.1442, 0.1443,
         0.1443],
        [0.1440, 0.1437, 0.1441, 0.1442, 0.1442, 0.0000, 0.1442, 0.1439, 0.1440,
         0.1441],
        [0.1441, 0.1442, 0.1440, 0.1442, 0.1445, 0.1442, 0.0000, 0.1440, 0.1446,
         0.1440],
        [0.1440, 0.1438, 0.1440, 0.1438, 0.1442, 0.1439, 0.1440, 0.0000, 0.1439,
         0.1441],
        [0.1439, 0.1443, 0.1442, 0.1443, 0.1443, 0.1440, 0.1446, 0.1439, 0.0000,
         0.1440],
        [0.1440, 0.1439, 0.1439, 0.1440, 0.1443, 0.1441, 0.1440, 0.1441, 0.1440,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0059, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28915036
Epoch222: train_loss: 4.3688 recon_acc: 0.1803 val_roc: 0.7023 val_ap: 0.7464 f1: 0.6837 time: 0.2924
thresh 0.043903224
          test_roc: 0.6856 test_ap: 0.7163 test_f1: 0.6676 test_recon_acc: 0.0037
difference_matrix tensor([[0.0000, 0.1437, 0.1441, 0.1440, 0.1440, 0.1438, 0.1439, 0.1438, 0.1437,
         0.1438],
        [0.1437, 0.0000, 0.1437, 0.1438, 0.1440, 0.1436, 0.1440, 0.1437, 0.1441,
         0.1437],
        [0.1441, 0.1437, 0.0000, 0.1438, 0.1447, 0.1439, 0.1439, 0.1438, 0.1440,
         0.1438],
        [0.1440, 0.1438, 0.1438, 0.0000, 0.1442, 0.1441, 0.1441, 0.1436, 0.1441,
         0.1438],
        [0.1440, 0.1440, 0.1447, 0.1442, 0.0000, 0.1440, 0.1443, 0.1440, 0.1442,
         0.1441],
        [0.1438, 0.1436, 0.1439, 0.1441, 0.1440, 0.0000, 0.1440, 0.1438, 0.1438,
         0.1439],
        [0.1439, 0.1440, 0.1439, 0.1441, 0.1443, 0.1440, 0.0000, 0.1438, 0.1444,
         0.1438],
        [0.1438, 0.1437, 0.1438, 0.1436, 0.1440, 0.1438, 0.1438, 0.0000, 0.1437,
         0.1439],
        [0.1437, 0.1441, 0.1440, 0.1441, 0.1442, 0.1438, 0.1444, 0.1437, 0.0000,
         0.1438],
        [0.1438, 0.1437, 0.1438, 0.1438, 0.1441, 0.1439, 0.1438, 0.1439, 0.1438,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0061, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28960955
Epoch223: train_loss: 4.3663 recon_acc: 0.1806 val_roc: 0.7024 val_ap: 0.7466 f1: 0.6837 time: 0.2887
thresh 0.04385745
          test_roc: 0.6858 test_ap: 0.7165 test_f1: 0.6676 test_recon_acc: 0.0036
difference_matrix tensor([[0.0000, 0.1435, 0.1439, 0.1438, 0.1439, 0.1437, 0.1437, 0.1436, 0.1435,
         0.1436],
        [0.1435, 0.0000, 0.1436, 0.1436, 0.1438, 0.1434, 0.1438, 0.1435, 0.1439,
         0.1436],
        [0.1439, 0.1436, 0.0000, 0.1437, 0.1445, 0.1438, 0.1437, 0.1436, 0.1439,
         0.1436],
        [0.1438, 0.1436, 0.1437, 0.0000, 0.1440, 0.1439, 0.1439, 0.1434, 0.1439,
         0.1437],
        [0.1439, 0.1438, 0.1445, 0.1440, 0.0000, 0.1438, 0.1441, 0.1438, 0.1440,
         0.1439],
        [0.1437, 0.1434, 0.1438, 0.1439, 0.1438, 0.0000, 0.1438, 0.1436, 0.1436,
         0.1438],
        [0.1437, 0.1438, 0.1437, 0.1439, 0.1441, 0.1438, 0.0000, 0.1436, 0.1443,
         0.1437],
        [0.1436, 0.1435, 0.1436, 0.1434, 0.1438, 0.1436, 0.1436, 0.0000, 0.1436,
         0.1438],
        [0.1435, 0.1439, 0.1439, 0.1439, 0.1440, 0.1436, 0.1443, 0.1436, 0.0000,
         0.1436],
        [0.1436, 0.1436, 0.1436, 0.1437, 0.1439, 0.1438, 0.1437, 0.1438, 0.1436,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0062, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29007062
Epoch224: train_loss: 4.3638 recon_acc: 0.1809 val_roc: 0.7027 val_ap: 0.7471 f1: 0.6837 time: 0.2797
thresh 0.043815963
          test_roc: 0.6860 test_ap: 0.7168 test_f1: 0.6676 test_recon_acc: 0.0036
difference_matrix tensor([[0.0000, 0.1434, 0.1438, 0.1437, 0.1437, 0.1435, 0.1435, 0.1435, 0.1434,
         0.1435],
        [0.1434, 0.0000, 0.1434, 0.1434, 0.1437, 0.1432, 0.1436, 0.1433, 0.1437,
         0.1434],
        [0.1438, 0.1434, 0.0000, 0.1435, 0.1443, 0.1436, 0.1435, 0.1434, 0.1437,
         0.1434],
        [0.1437, 0.1434, 0.1435, 0.0000, 0.1438, 0.1437, 0.1437, 0.1432, 0.1438,
         0.1435],
        [0.1437, 0.1437, 0.1443, 0.1438, 0.0000, 0.1437, 0.1440, 0.1437, 0.1438,
         0.1437],
        [0.1435, 0.1432, 0.1436, 0.1437, 0.1437, 0.0000, 0.1436, 0.1434, 0.1434,
         0.1436],
        [0.1435, 0.1436, 0.1435, 0.1437, 0.1440, 0.1436, 0.0000, 0.1434, 0.1441,
         0.1435],
        [0.1435, 0.1433, 0.1434, 0.1432, 0.1437, 0.1434, 0.1434, 0.0000, 0.1434,
         0.1436],
        [0.1434, 0.1437, 0.1437, 0.1438, 0.1438, 0.1434, 0.1441, 0.1434, 0.0000,
         0.1434],
        [0.1435, 0.1434, 0.1434, 0.1435, 0.1437, 0.1436, 0.1435, 0.1436, 0.1434,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0064, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29053214
Epoch225: train_loss: 4.3613 recon_acc: 0.1813 val_roc: 0.7030 val_ap: 0.7475 f1: 0.6837 time: 0.2750
thresh 0.043779075
          test_roc: 0.6863 test_ap: 0.7172 test_f1: 0.6676 test_recon_acc: 0.0036
difference_matrix tensor([[0.0000, 0.1432, 0.1436, 0.1435, 0.1435, 0.1433, 0.1433, 0.1433, 0.1432,
         0.1433],
        [0.1432, 0.0000, 0.1432, 0.1433, 0.1435, 0.1430, 0.1434, 0.1431, 0.1435,
         0.1432],
        [0.1436, 0.1432, 0.0000, 0.1433, 0.1441, 0.1434, 0.1433, 0.1433, 0.1435,
         0.1433],
        [0.1435, 0.1433, 0.1433, 0.0000, 0.1436, 0.1435, 0.1435, 0.1431, 0.1436,
         0.1433],
        [0.1435, 0.1435, 0.1441, 0.1436, 0.0000, 0.1435, 0.1438, 0.1435, 0.1436,
         0.1436],
        [0.1433, 0.1430, 0.1434, 0.1435, 0.1435, 0.0000, 0.1435, 0.1432, 0.1433,
         0.1434],
        [0.1433, 0.1434, 0.1433, 0.1435, 0.1438, 0.1435, 0.0000, 0.1432, 0.1439,
         0.1433],
        [0.1433, 0.1431, 0.1433, 0.1431, 0.1435, 0.1432, 0.1432, 0.0000, 0.1432,
         0.1434],
        [0.1432, 0.1435, 0.1435, 0.1436, 0.1436, 0.1433, 0.1439, 0.1432, 0.0000,
         0.1432],
        [0.1433, 0.1432, 0.1433, 0.1433, 0.1436, 0.1434, 0.1433, 0.1434, 0.1432,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0066, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29088268
Epoch226: train_loss: 4.3589 recon_acc: 0.1814 val_roc: 0.7032 val_ap: 0.7479 f1: 0.6837 time: 0.3029
thresh 0.0437463
          test_roc: 0.6865 test_ap: 0.7175 test_f1: 0.6676 test_recon_acc: 0.0036
difference_matrix tensor([[0.0000, 0.1430, 0.1434, 0.1433, 0.1433, 0.1431, 0.1431, 0.1431, 0.1430,
         0.1431],
        [0.1430, 0.0000, 0.1430, 0.1431, 0.1433, 0.1428, 0.1432, 0.1429, 0.1434,
         0.1430],
        [0.1434, 0.1430, 0.0000, 0.1431, 0.1440, 0.1432, 0.1431, 0.1431, 0.1433,
         0.1431],
        [0.1433, 0.1431, 0.1431, 0.0000, 0.1435, 0.1433, 0.1433, 0.1429, 0.1434,
         0.1431],
        [0.1433, 0.1433, 0.1440, 0.1435, 0.0000, 0.1433, 0.1436, 0.1433, 0.1434,
         0.1434],
        [0.1431, 0.1428, 0.1432, 0.1433, 0.1433, 0.0000, 0.1433, 0.1430, 0.1431,
         0.1432],
        [0.1431, 0.1432, 0.1431, 0.1433, 0.1436, 0.1433, 0.0000, 0.1430, 0.1437,
         0.1431],
        [0.1431, 0.1429, 0.1431, 0.1429, 0.1433, 0.1430, 0.1430, 0.0000, 0.1430,
         0.1432],
        [0.1430, 0.1434, 0.1433, 0.1434, 0.1434, 0.1431, 0.1437, 0.1430, 0.0000,
         0.1431],
        [0.1431, 0.1430, 0.1431, 0.1431, 0.1434, 0.1432, 0.1431, 0.1432, 0.1431,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0068, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2907861
Epoch227: train_loss: 4.3564 recon_acc: 0.1810 val_roc: 0.7033 val_ap: 0.7482 f1: 0.6837 time: 0.2700
thresh 0.043717086
          test_roc: 0.6868 test_ap: 0.7178 test_f1: 0.6676 test_recon_acc: 0.0036
difference_matrix tensor([[0.0000, 0.1428, 0.1432, 0.1431, 0.1431, 0.1429, 0.1429, 0.1429, 0.1428,
         0.1429],
        [0.1428, 0.0000, 0.1428, 0.1429, 0.1431, 0.1426, 0.1430, 0.1427, 0.1432,
         0.1428],
        [0.1432, 0.1428, 0.0000, 0.1429, 0.1438, 0.1430, 0.1430, 0.1429, 0.1432,
         0.1429],
        [0.1431, 0.1429, 0.1429, 0.0000, 0.1433, 0.1431, 0.1431, 0.1427, 0.1432,
         0.1429],
        [0.1431, 0.1431, 0.1438, 0.1433, 0.0000, 0.1431, 0.1434, 0.1431, 0.1433,
         0.1432],
        [0.1429, 0.1426, 0.1430, 0.1431, 0.1431, 0.0000, 0.1431, 0.1428, 0.1429,
         0.1430],
        [0.1429, 0.1430, 0.1430, 0.1431, 0.1434, 0.1431, 0.0000, 0.1428, 0.1435,
         0.1429],
        [0.1429, 0.1427, 0.1429, 0.1427, 0.1431, 0.1428, 0.1428, 0.0000, 0.1428,
         0.1430],
        [0.1428, 0.1432, 0.1432, 0.1432, 0.1433, 0.1429, 0.1435, 0.1428, 0.0000,
         0.1429],
        [0.1429, 0.1428, 0.1429, 0.1429, 0.1432, 0.1430, 0.1429, 0.1430, 0.1429,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0070, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29069588
Epoch228: train_loss: 4.3540 recon_acc: 0.1806 val_roc: 0.7035 val_ap: 0.7484 f1: 0.6837 time: 0.2744
thresh 0.043691598
          test_roc: 0.6871 test_ap: 0.7181 test_f1: 0.6676 test_recon_acc: 0.0035
difference_matrix tensor([[0.0000, 0.1426, 0.1430, 0.1429, 0.1429, 0.1427, 0.1427, 0.1427, 0.1426,
         0.1427],
        [0.1426, 0.0000, 0.1426, 0.1427, 0.1429, 0.1424, 0.1428, 0.1425, 0.1430,
         0.1426],
        [0.1430, 0.1426, 0.0000, 0.1427, 0.1436, 0.1429, 0.1428, 0.1427, 0.1430,
         0.1427],
        [0.1429, 0.1427, 0.1427, 0.0000, 0.1431, 0.1429, 0.1429, 0.1425, 0.1430,
         0.1427],
        [0.1429, 0.1429, 0.1436, 0.1431, 0.0000, 0.1429, 0.1432, 0.1429, 0.1431,
         0.1430],
        [0.1427, 0.1424, 0.1429, 0.1429, 0.1429, 0.0000, 0.1429, 0.1426, 0.1427,
         0.1428],
        [0.1427, 0.1428, 0.1428, 0.1429, 0.1432, 0.1429, 0.0000, 0.1426, 0.1433,
         0.1427],
        [0.1427, 0.1425, 0.1427, 0.1425, 0.1429, 0.1426, 0.1426, 0.0000, 0.1426,
         0.1428],
        [0.1426, 0.1430, 0.1430, 0.1430, 0.1431, 0.1427, 0.1433, 0.1426, 0.0000,
         0.1427],
        [0.1427, 0.1426, 0.1427, 0.1427, 0.1430, 0.1428, 0.1427, 0.1428, 0.1427,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0072, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29060754
Epoch229: train_loss: 4.3516 recon_acc: 0.1802 val_roc: 0.7038 val_ap: 0.7487 f1: 0.6837 time: 0.2823
thresh 0.043669567
          test_roc: 0.6873 test_ap: 0.7184 test_f1: 0.6676 test_recon_acc: 0.0035
difference_matrix tensor([[0.0000, 0.1424, 0.1428, 0.1427, 0.1427, 0.1425, 0.1425, 0.1425, 0.1424,
         0.1425],
        [0.1424, 0.0000, 0.1424, 0.1425, 0.1427, 0.1422, 0.1426, 0.1423, 0.1428,
         0.1424],
        [0.1428, 0.1424, 0.0000, 0.1425, 0.1434, 0.1427, 0.1426, 0.1425, 0.1428,
         0.1425],
        [0.1427, 0.1425, 0.1425, 0.0000, 0.1429, 0.1427, 0.1427, 0.1423, 0.1428,
         0.1425],
        [0.1427, 0.1427, 0.1434, 0.1429, 0.0000, 0.1427, 0.1430, 0.1427, 0.1429,
         0.1428],
        [0.1425, 0.1422, 0.1427, 0.1427, 0.1427, 0.0000, 0.1427, 0.1424, 0.1425,
         0.1426],
        [0.1425, 0.1426, 0.1426, 0.1427, 0.1430, 0.1427, 0.0000, 0.1424, 0.1431,
         0.1425],
        [0.1425, 0.1423, 0.1425, 0.1423, 0.1427, 0.1424, 0.1424, 0.0000, 0.1424,
         0.1426],
        [0.1424, 0.1428, 0.1428, 0.1428, 0.1429, 0.1425, 0.1431, 0.1424, 0.0000,
         0.1425],
        [0.1425, 0.1424, 0.1425, 0.1425, 0.1428, 0.1426, 0.1425, 0.1426, 0.1425,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0074, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29051283
Epoch230: train_loss: 4.3492 recon_acc: 0.1798 val_roc: 0.7041 val_ap: 0.7492 f1: 0.6837 time: 0.2741
thresh 0.043650497
          test_roc: 0.6876 test_ap: 0.7186 test_f1: 0.6676 test_recon_acc: 0.0035
difference_matrix tensor([[0.0000, 0.1422, 0.1426, 0.1425, 0.1425, 0.1423, 0.1423, 0.1423, 0.1422,
         0.1423],
        [0.1422, 0.0000, 0.1423, 0.1423, 0.1425, 0.1420, 0.1424, 0.1421, 0.1426,
         0.1422],
        [0.1426, 0.1423, 0.0000, 0.1424, 0.1432, 0.1425, 0.1424, 0.1423, 0.1426,
         0.1423],
        [0.1425, 0.1423, 0.1424, 0.0000, 0.1427, 0.1425, 0.1425, 0.1421, 0.1426,
         0.1423],
        [0.1425, 0.1425, 0.1432, 0.1427, 0.0000, 0.1425, 0.1428, 0.1425, 0.1427,
         0.1426],
        [0.1423, 0.1420, 0.1425, 0.1425, 0.1425, 0.0000, 0.1425, 0.1423, 0.1423,
         0.1424],
        [0.1423, 0.1424, 0.1424, 0.1425, 0.1428, 0.1425, 0.0000, 0.1422, 0.1430,
         0.1423],
        [0.1423, 0.1421, 0.1423, 0.1421, 0.1425, 0.1423, 0.1422, 0.0000, 0.1422,
         0.1424],
        [0.1422, 0.1426, 0.1426, 0.1426, 0.1427, 0.1423, 0.1430, 0.1422, 0.0000,
         0.1423],
        [0.1423, 0.1422, 0.1423, 0.1423, 0.1426, 0.1424, 0.1423, 0.1424, 0.1423,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0076, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29241866
Epoch231: train_loss: 4.3468 recon_acc: 0.1820 val_roc: 0.7043 val_ap: 0.7495 f1: 0.6827 time: 0.2511
thresh 0.043634385
          test_roc: 0.6878 test_ap: 0.7189 test_f1: 0.6676 test_recon_acc: 0.0035
difference_matrix tensor([[0.0000, 0.1420, 0.1424, 0.1423, 0.1423, 0.1421, 0.1421, 0.1421, 0.1420,
         0.1421],
        [0.1420, 0.0000, 0.1421, 0.1421, 0.1423, 0.1418, 0.1423, 0.1419, 0.1424,
         0.1420],
        [0.1424, 0.1421, 0.0000, 0.1422, 0.1430, 0.1423, 0.1422, 0.1421, 0.1424,
         0.1421],
        [0.1423, 0.1421, 0.1422, 0.0000, 0.1425, 0.1423, 0.1423, 0.1419, 0.1424,
         0.1421],
        [0.1423, 0.1423, 0.1430, 0.1425, 0.0000, 0.1423, 0.1426, 0.1423, 0.1425,
         0.1424],
        [0.1421, 0.1418, 0.1423, 0.1423, 0.1423, 0.0000, 0.1423, 0.1421, 0.1421,
         0.1422],
        [0.1421, 0.1423, 0.1422, 0.1423, 0.1426, 0.1423, 0.0000, 0.1420, 0.1428,
         0.1421],
        [0.1421, 0.1419, 0.1421, 0.1419, 0.1423, 0.1421, 0.1420, 0.0000, 0.1420,
         0.1423],
        [0.1420, 0.1424, 0.1424, 0.1424, 0.1425, 0.1421, 0.1428, 0.1420, 0.0000,
         0.1421],
        [0.1421, 0.1420, 0.1421, 0.1421, 0.1424, 0.1422, 0.1421, 0.1423, 0.1421,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0078, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.29032195
Epoch232: train_loss: 4.3444 recon_acc: 0.1790 val_roc: 0.7044 val_ap: 0.7498 f1: 0.6826 time: 0.2510
thresh 0.043621004
          test_roc: 0.6881 test_ap: 0.7193 test_f1: 0.6676 test_recon_acc: 0.0035
difference_matrix tensor([[0.0000, 0.1418, 0.1422, 0.1421, 0.1421, 0.1419, 0.1420, 0.1419, 0.1418,
         0.1419],
        [0.1418, 0.0000, 0.1419, 0.1419, 0.1421, 0.1416, 0.1421, 0.1417, 0.1422,
         0.1418],
        [0.1422, 0.1419, 0.0000, 0.1420, 0.1428, 0.1421, 0.1420, 0.1419, 0.1422,
         0.1419],
        [0.1421, 0.1419, 0.1420, 0.0000, 0.1423, 0.1422, 0.1421, 0.1417, 0.1422,
         0.1419],
        [0.1421, 0.1421, 0.1428, 0.1423, 0.0000, 0.1421, 0.1424, 0.1422, 0.1423,
         0.1422],
        [0.1419, 0.1416, 0.1421, 0.1422, 0.1421, 0.0000, 0.1421, 0.1419, 0.1419,
         0.1420],
        [0.1420, 0.1421, 0.1420, 0.1421, 0.1424, 0.1421, 0.0000, 0.1419, 0.1426,
         0.1419],
        [0.1419, 0.1417, 0.1419, 0.1417, 0.1422, 0.1419, 0.1419, 0.0000, 0.1418,
         0.1421],
        [0.1418, 0.1422, 0.1422, 0.1422, 0.1423, 0.1419, 0.1426, 0.1418, 0.0000,
         0.1419],
        [0.1419, 0.1418, 0.1419, 0.1419, 0.1422, 0.1420, 0.1419, 0.1421, 0.1419,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0080, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2902324
Epoch233: train_loss: 4.3420 recon_acc: 0.1786 val_roc: 0.7046 val_ap: 0.7503 f1: 0.6826 time: 0.2785
thresh 0.043609805
          test_roc: 0.6884 test_ap: 0.7197 test_f1: 0.6676 test_recon_acc: 0.0034
difference_matrix tensor([[0.0000, 0.1416, 0.1420, 0.1419, 0.1419, 0.1417, 0.1418, 0.1417, 0.1416,
         0.1417],
        [0.1416, 0.0000, 0.1417, 0.1417, 0.1419, 0.1415, 0.1419, 0.1415, 0.1420,
         0.1417],
        [0.1420, 0.1417, 0.0000, 0.1418, 0.1426, 0.1419, 0.1418, 0.1417, 0.1420,
         0.1417],
        [0.1419, 0.1417, 0.1418, 0.0000, 0.1421, 0.1420, 0.1419, 0.1415, 0.1420,
         0.1418],
        [0.1419, 0.1419, 0.1426, 0.1421, 0.0000, 0.1419, 0.1422, 0.1420, 0.1421,
         0.1420],
        [0.1417, 0.1415, 0.1419, 0.1420, 0.1419, 0.0000, 0.1419, 0.1417, 0.1417,
         0.1419],
        [0.1418, 0.1419, 0.1418, 0.1419, 0.1422, 0.1419, 0.0000, 0.1417, 0.1424,
         0.1417],
        [0.1417, 0.1415, 0.1417, 0.1415, 0.1420, 0.1417, 0.1417, 0.0000, 0.1416,
         0.1419],
        [0.1416, 0.1420, 0.1420, 0.1420, 0.1421, 0.1417, 0.1424, 0.1416, 0.0000,
         0.1417],
        [0.1417, 0.1417, 0.1417, 0.1418, 0.1420, 0.1419, 0.1417, 0.1419, 0.1417,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0082, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2901371
Epoch234: train_loss: 4.3397 recon_acc: 0.1782 val_roc: 0.7045 val_ap: 0.7503 f1: 0.6826 time: 0.2805
difference_matrix tensor([[0.0000, 0.1414, 0.1418, 0.1417, 0.1417, 0.1415, 0.1416, 0.1415, 0.1414,
         0.1415],
        [0.1414, 0.0000, 0.1415, 0.1415, 0.1417, 0.1413, 0.1417, 0.1414, 0.1418,
         0.1415],
        [0.1418, 0.1415, 0.0000, 0.1416, 0.1424, 0.1417, 0.1416, 0.1416, 0.1418,
         0.1415],
        [0.1417, 0.1415, 0.1416, 0.0000, 0.1419, 0.1418, 0.1417, 0.1413, 0.1418,
         0.1416],
        [0.1417, 0.1417, 0.1424, 0.1419, 0.0000, 0.1417, 0.1420, 0.1418, 0.1419,
         0.1418],
        [0.1415, 0.1413, 0.1417, 0.1418, 0.1417, 0.0000, 0.1417, 0.1415, 0.1415,
         0.1417],
        [0.1416, 0.1417, 0.1416, 0.1417, 0.1420, 0.1417, 0.0000, 0.1415, 0.1422,
         0.1415],
        [0.1415, 0.1414, 0.1416, 0.1413, 0.1418, 0.1415, 0.1415, 0.0000, 0.1415,
         0.1417],
        [0.1414, 0.1418, 0.1418, 0.1418, 0.1419, 0.1415, 0.1422, 0.1415, 0.0000,
         0.1415],
        [0.1415, 0.1415, 0.1415, 0.1416, 0.1418, 0.1417, 0.1415, 0.1417, 0.1415,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0083, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28078672
Epoch235: train_loss: 4.3374 recon_acc: 0.1660 val_roc: 0.7048 val_ap: 0.7507 f1: 0.6825 time: 0.2916
thresh 0.043592554
          test_roc: 0.6891 test_ap: 0.7200 test_f1: 0.6676 test_recon_acc: 0.0034
difference_matrix tensor([[0.0000, 0.1412, 0.1417, 0.1415, 0.1416, 0.1413, 0.1414, 0.1413, 0.1412,
         0.1413],
        [0.1412, 0.0000, 0.1413, 0.1413, 0.1415, 0.1411, 0.1415, 0.1412, 0.1416,
         0.1413],
        [0.1417, 0.1413, 0.0000, 0.1414, 0.1422, 0.1415, 0.1414, 0.1414, 0.1416,
         0.1414],
        [0.1415, 0.1413, 0.1414, 0.0000, 0.1417, 0.1416, 0.1415, 0.1411, 0.1416,
         0.1414],
        [0.1416, 0.1415, 0.1422, 0.1417, 0.0000, 0.1415, 0.1418, 0.1416, 0.1417,
         0.1416],
        [0.1413, 0.1411, 0.1415, 0.1416, 0.1415, 0.0000, 0.1415, 0.1413, 0.1413,
         0.1415],
        [0.1414, 0.1415, 0.1414, 0.1415, 0.1418, 0.1415, 0.0000, 0.1413, 0.1420,
         0.1414],
        [0.1413, 0.1412, 0.1414, 0.1411, 0.1416, 0.1413, 0.1413, 0.0000, 0.1413,
         0.1415],
        [0.1412, 0.1416, 0.1416, 0.1416, 0.1417, 0.1413, 0.1420, 0.1413, 0.0000,
         0.1413],
        [0.1413, 0.1413, 0.1414, 0.1414, 0.1416, 0.1415, 0.1414, 0.1415, 0.1413,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0085, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28158495
Epoch236: train_loss: 4.3350 recon_acc: 0.1668 val_roc: 0.7048 val_ap: 0.7509 f1: 0.6825 time: 0.2711
thresh 0.043586712
          test_roc: 0.6893 test_ap: 0.7203 test_f1: 0.6676 test_recon_acc: 0.0034
difference_matrix tensor([[0.0000, 0.1410, 0.1415, 0.1413, 0.1414, 0.1412, 0.1412, 0.1411, 0.1410,
         0.1411],
        [0.1410, 0.0000, 0.1411, 0.1411, 0.1413, 0.1409, 0.1413, 0.1410, 0.1414,
         0.1411],
        [0.1415, 0.1411, 0.0000, 0.1412, 0.1421, 0.1413, 0.1412, 0.1412, 0.1414,
         0.1412],
        [0.1413, 0.1411, 0.1412, 0.0000, 0.1415, 0.1414, 0.1413, 0.1409, 0.1415,
         0.1412],
        [0.1414, 0.1413, 0.1421, 0.1415, 0.0000, 0.1413, 0.1417, 0.1414, 0.1415,
         0.1415],
        [0.1412, 0.1409, 0.1413, 0.1414, 0.1413, 0.0000, 0.1413, 0.1411, 0.1411,
         0.1413],
        [0.1412, 0.1413, 0.1412, 0.1413, 0.1417, 0.1413, 0.0000, 0.1411, 0.1418,
         0.1412],
        [0.1411, 0.1410, 0.1412, 0.1409, 0.1414, 0.1411, 0.1411, 0.0000, 0.1411,
         0.1413],
        [0.1410, 0.1414, 0.1414, 0.1415, 0.1415, 0.1411, 0.1418, 0.1411, 0.0000,
         0.1411],
        [0.1411, 0.1411, 0.1412, 0.1412, 0.1415, 0.1413, 0.1412, 0.1413, 0.1411,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0087, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28240436
Epoch237: train_loss: 4.3327 recon_acc: 0.1675 val_roc: 0.7051 val_ap: 0.7512 f1: 0.6825 time: 0.3127
thresh 0.04358279
          test_roc: 0.6895 test_ap: 0.7205 test_f1: 0.6676 test_recon_acc: 0.0034
difference_matrix tensor([[0.0000, 0.1408, 0.1413, 0.1411, 0.1412, 0.1410, 0.1410, 0.1409, 0.1408,
         0.1410],
        [0.1408, 0.0000, 0.1409, 0.1409, 0.1412, 0.1407, 0.1411, 0.1408, 0.1412,
         0.1409],
        [0.1413, 0.1409, 0.0000, 0.1410, 0.1419, 0.1411, 0.1410, 0.1410, 0.1413,
         0.1410],
        [0.1411, 0.1409, 0.1410, 0.0000, 0.1413, 0.1412, 0.1412, 0.1407, 0.1413,
         0.1410],
        [0.1412, 0.1412, 0.1419, 0.1413, 0.0000, 0.1412, 0.1415, 0.1412, 0.1413,
         0.1413],
        [0.1410, 0.1407, 0.1411, 0.1412, 0.1412, 0.0000, 0.1411, 0.1409, 0.1410,
         0.1411],
        [0.1410, 0.1411, 0.1410, 0.1412, 0.1415, 0.1411, 0.0000, 0.1409, 0.1416,
         0.1410],
        [0.1409, 0.1408, 0.1410, 0.1407, 0.1412, 0.1409, 0.1409, 0.0000, 0.1409,
         0.1411],
        [0.1408, 0.1412, 0.1413, 0.1413, 0.1413, 0.1410, 0.1416, 0.1409, 0.0000,
         0.1409],
        [0.1410, 0.1409, 0.1410, 0.1410, 0.1413, 0.1411, 0.1410, 0.1411, 0.1409,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0089, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28718793
Epoch238: train_loss: 4.3304 recon_acc: 0.1733 val_roc: 0.7054 val_ap: 0.7516 f1: 0.6825 time: 0.2637
thresh 0.043580145
          test_roc: 0.6898 test_ap: 0.7208 test_f1: 0.6676 test_recon_acc: 0.0034
difference_matrix tensor([[0.0000, 0.1406, 0.1411, 0.1409, 0.1410, 0.1408, 0.1408, 0.1408, 0.1407,
         0.1408],
        [0.1406, 0.0000, 0.1407, 0.1407, 0.1410, 0.1405, 0.1409, 0.1406, 0.1410,
         0.1407],
        [0.1411, 0.1407, 0.0000, 0.1408, 0.1417, 0.1409, 0.1408, 0.1408, 0.1411,
         0.1408],
        [0.1409, 0.1407, 0.1408, 0.0000, 0.1411, 0.1410, 0.1410, 0.1405, 0.1411,
         0.1408],
        [0.1410, 0.1410, 0.1417, 0.1411, 0.0000, 0.1410, 0.1413, 0.1410, 0.1411,
         0.1411],
        [0.1408, 0.1405, 0.1409, 0.1410, 0.1410, 0.0000, 0.1410, 0.1407, 0.1408,
         0.1409],
        [0.1408, 0.1409, 0.1408, 0.1410, 0.1413, 0.1410, 0.0000, 0.1407, 0.1414,
         0.1408],
        [0.1408, 0.1406, 0.1408, 0.1405, 0.1410, 0.1407, 0.1407, 0.0000, 0.1407,
         0.1409],
        [0.1407, 0.1410, 0.1411, 0.1411, 0.1411, 0.1408, 0.1414, 0.1407, 0.0000,
         0.1408],
        [0.1408, 0.1407, 0.1408, 0.1408, 0.1411, 0.1409, 0.1408, 0.1409, 0.1408,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0091, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28687084
Epoch239: train_loss: 4.3282 recon_acc: 0.1727 val_roc: 0.7056 val_ap: 0.7518 f1: 0.6825 time: 0.2499
thresh 0.043578584
          test_roc: 0.6902 test_ap: 0.7212 test_f1: 0.6676 test_recon_acc: 0.0033
difference_matrix tensor([[0.0000, 0.1405, 0.1409, 0.1408, 0.1408, 0.1406, 0.1406, 0.1406, 0.1405,
         0.1406],
        [0.1405, 0.0000, 0.1405, 0.1405, 0.1408, 0.1403, 0.1407, 0.1404, 0.1409,
         0.1405],
        [0.1409, 0.1405, 0.0000, 0.1406, 0.1415, 0.1408, 0.1407, 0.1406, 0.1409,
         0.1406],
        [0.1408, 0.1405, 0.1406, 0.0000, 0.1410, 0.1408, 0.1408, 0.1404, 0.1409,
         0.1406],
        [0.1408, 0.1408, 0.1415, 0.1410, 0.0000, 0.1408, 0.1411, 0.1408, 0.1410,
         0.1409],
        [0.1406, 0.1403, 0.1408, 0.1408, 0.1408, 0.0000, 0.1408, 0.1405, 0.1406,
         0.1407],
        [0.1406, 0.1407, 0.1407, 0.1408, 0.1411, 0.1408, 0.0000, 0.1405, 0.1412,
         0.1406],
        [0.1406, 0.1404, 0.1406, 0.1404, 0.1408, 0.1405, 0.1405, 0.0000, 0.1405,
         0.1407],
        [0.1405, 0.1409, 0.1409, 0.1409, 0.1410, 0.1406, 0.1412, 0.1405, 0.0000,
         0.1406],
        [0.1406, 0.1405, 0.1406, 0.1406, 0.1409, 0.1407, 0.1406, 0.1407, 0.1406,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0093, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28496835
Epoch240: train_loss: 4.3259 recon_acc: 0.1700 val_roc: 0.7059 val_ap: 0.7522 f1: 0.6825 time: 0.2572
thresh 0.043578576
          test_roc: 0.6906 test_ap: 0.7217 test_f1: 0.6676 test_recon_acc: 0.0033
difference_matrix tensor([[0.0000, 0.1403, 0.1407, 0.1406, 0.1406, 0.1404, 0.1404, 0.1404, 0.1403,
         0.1404],
        [0.1403, 0.0000, 0.1404, 0.1404, 0.1406, 0.1401, 0.1405, 0.1402, 0.1407,
         0.1403],
        [0.1407, 0.1404, 0.0000, 0.1405, 0.1413, 0.1406, 0.1405, 0.1404, 0.1407,
         0.1404],
        [0.1406, 0.1404, 0.1405, 0.0000, 0.1408, 0.1407, 0.1406, 0.1402, 0.1407,
         0.1404],
        [0.1406, 0.1406, 0.1413, 0.1408, 0.0000, 0.1406, 0.1409, 0.1406, 0.1408,
         0.1407],
        [0.1404, 0.1401, 0.1406, 0.1407, 0.1406, 0.0000, 0.1406, 0.1404, 0.1404,
         0.1405],
        [0.1404, 0.1405, 0.1405, 0.1406, 0.1409, 0.1406, 0.0000, 0.1403, 0.1410,
         0.1404],
        [0.1404, 0.1402, 0.1404, 0.1402, 0.1406, 0.1404, 0.1403, 0.0000, 0.1403,
         0.1405],
        [0.1403, 0.1407, 0.1407, 0.1407, 0.1408, 0.1404, 0.1410, 0.1403, 0.0000,
         0.1404],
        [0.1404, 0.1403, 0.1404, 0.1404, 0.1407, 0.1405, 0.1404, 0.1405, 0.1404,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0095, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28561252
Epoch241: train_loss: 4.3237 recon_acc: 0.1705 val_roc: 0.7062 val_ap: 0.7526 f1: 0.6835 time: 0.3242
thresh 0.0435806
          test_roc: 0.6909 test_ap: 0.7222 test_f1: 0.6676 test_recon_acc: 0.0033
difference_matrix tensor([[0.0000, 0.1401, 0.1405, 0.1404, 0.1404, 0.1402, 0.1402, 0.1402, 0.1401,
         0.1402],
        [0.1401, 0.0000, 0.1402, 0.1402, 0.1404, 0.1400, 0.1403, 0.1400, 0.1405,
         0.1401],
        [0.1405, 0.1402, 0.0000, 0.1403, 0.1411, 0.1404, 0.1403, 0.1403, 0.1405,
         0.1402],
        [0.1404, 0.1402, 0.1403, 0.0000, 0.1406, 0.1405, 0.1404, 0.1400, 0.1405,
         0.1403],
        [0.1404, 0.1404, 0.1411, 0.1406, 0.0000, 0.1404, 0.1407, 0.1405, 0.1406,
         0.1405],
        [0.1402, 0.1400, 0.1404, 0.1405, 0.1404, 0.0000, 0.1404, 0.1402, 0.1402,
         0.1404],
        [0.1402, 0.1403, 0.1403, 0.1404, 0.1407, 0.1404, 0.0000, 0.1401, 0.1409,
         0.1402],
        [0.1402, 0.1400, 0.1403, 0.1400, 0.1405, 0.1402, 0.1401, 0.0000, 0.1401,
         0.1404],
        [0.1401, 0.1405, 0.1405, 0.1405, 0.1406, 0.1402, 0.1409, 0.1401, 0.0000,
         0.1402],
        [0.1402, 0.1401, 0.1402, 0.1403, 0.1405, 0.1404, 0.1402, 0.1404, 0.1402,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0097, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.286796
Epoch242: train_loss: 4.3214 recon_acc: 0.1718 val_roc: 0.7065 val_ap: 0.7530 f1: 0.6836 time: 0.2803
thresh 0.043584526
          test_roc: 0.6912 test_ap: 0.7226 test_f1: 0.6676 test_recon_acc: 0.0033
difference_matrix tensor([[0.0000, 0.1399, 0.1404, 0.1402, 0.1402, 0.1401, 0.1401, 0.1400, 0.1399,
         0.1400],
        [0.1399, 0.0000, 0.1400, 0.1400, 0.1402, 0.1398, 0.1402, 0.1399, 0.1403,
         0.1400],
        [0.1404, 0.1400, 0.0000, 0.1401, 0.1409, 0.1402, 0.1401, 0.1401, 0.1403,
         0.1401],
        [0.1402, 0.1400, 0.1401, 0.0000, 0.1404, 0.1403, 0.1402, 0.1398, 0.1404,
         0.1401],
        [0.1402, 0.1402, 0.1409, 0.1404, 0.0000, 0.1402, 0.1405, 0.1403, 0.1404,
         0.1403],
        [0.1401, 0.1398, 0.1402, 0.1403, 0.1402, 0.0000, 0.1402, 0.1400, 0.1400,
         0.1402],
        [0.1401, 0.1402, 0.1401, 0.1402, 0.1405, 0.1402, 0.0000, 0.1399, 0.1407,
         0.1401],
        [0.1400, 0.1399, 0.1401, 0.1398, 0.1403, 0.1400, 0.1399, 0.0000, 0.1400,
         0.1402],
        [0.1399, 0.1403, 0.1403, 0.1404, 0.1404, 0.1400, 0.1407, 0.1400, 0.0000,
         0.1400],
        [0.1400, 0.1400, 0.1401, 0.1401, 0.1403, 0.1402, 0.1401, 0.1402, 0.1400,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0098, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28773424
Epoch243: train_loss: 4.3192 recon_acc: 0.1727 val_roc: 0.7068 val_ap: 0.7533 f1: 0.6836 time: 0.2838
thresh 0.043589883
          test_roc: 0.6916 test_ap: 0.7230 test_f1: 0.6676 test_recon_acc: 0.0033
difference_matrix tensor([[0.0000, 0.1397, 0.1402, 0.1400, 0.1401, 0.1399, 0.1399, 0.1398, 0.1397,
         0.1399],
        [0.1397, 0.0000, 0.1398, 0.1398, 0.1400, 0.1396, 0.1400, 0.1397, 0.1401,
         0.1398],
        [0.1402, 0.1398, 0.0000, 0.1399, 0.1408, 0.1400, 0.1399, 0.1399, 0.1402,
         0.1399],
        [0.1400, 0.1398, 0.1399, 0.0000, 0.1402, 0.1401, 0.1400, 0.1396, 0.1402,
         0.1399],
        [0.1401, 0.1400, 0.1408, 0.1402, 0.0000, 0.1401, 0.1404, 0.1401, 0.1402,
         0.1402],
        [0.1399, 0.1396, 0.1400, 0.1401, 0.1401, 0.0000, 0.1400, 0.1398, 0.1399,
         0.1400],
        [0.1399, 0.1400, 0.1399, 0.1400, 0.1404, 0.1400, 0.0000, 0.1398, 0.1405,
         0.1399],
        [0.1398, 0.1397, 0.1399, 0.1396, 0.1401, 0.1398, 0.1398, 0.0000, 0.1398,
         0.1400],
        [0.1397, 0.1401, 0.1402, 0.1402, 0.1402, 0.1399, 0.1405, 0.1398, 0.0000,
         0.1398],
        [0.1399, 0.1398, 0.1399, 0.1399, 0.1402, 0.1400, 0.1399, 0.1400, 0.1398,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0100, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2886942
Epoch244: train_loss: 4.3170 recon_acc: 0.1737 val_roc: 0.7071 val_ap: 0.7536 f1: 0.6836 time: 0.2915
thresh 0.04359688
          test_roc: 0.6918 test_ap: 0.7234 test_f1: 0.6676 test_recon_acc: 0.0033
difference_matrix tensor([[0.0000, 0.1395, 0.1400, 0.1399, 0.1399, 0.1397, 0.1397, 0.1397, 0.1396,
         0.1397],
        [0.1395, 0.0000, 0.1396, 0.1396, 0.1399, 0.1394, 0.1398, 0.1395, 0.1399,
         0.1396],
        [0.1400, 0.1396, 0.0000, 0.1397, 0.1406, 0.1399, 0.1397, 0.1397, 0.1400,
         0.1397],
        [0.1399, 0.1396, 0.1397, 0.0000, 0.1401, 0.1399, 0.1399, 0.1394, 0.1400,
         0.1397],
        [0.1399, 0.1399, 0.1406, 0.1401, 0.0000, 0.1399, 0.1402, 0.1399, 0.1400,
         0.1400],
        [0.1397, 0.1394, 0.1399, 0.1399, 0.1399, 0.0000, 0.1399, 0.1396, 0.1397,
         0.1398],
        [0.1397, 0.1398, 0.1397, 0.1399, 0.1402, 0.1399, 0.0000, 0.1396, 0.1403,
         0.1397],
        [0.1397, 0.1395, 0.1397, 0.1394, 0.1399, 0.1396, 0.1396, 0.0000, 0.1396,
         0.1398],
        [0.1396, 0.1399, 0.1400, 0.1400, 0.1400, 0.1397, 0.1403, 0.1396, 0.0000,
         0.1396],
        [0.1397, 0.1396, 0.1397, 0.1397, 0.1400, 0.1398, 0.1397, 0.1398, 0.1396,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0102, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28891677
Epoch245: train_loss: 4.3148 recon_acc: 0.1738 val_roc: 0.7075 val_ap: 0.7540 f1: 0.6836 time: 0.2596
thresh 0.45949617
          test_roc: 0.6922 test_ap: 0.7240 test_f1: 0.6679 test_recon_acc: 0.4337
difference_matrix tensor([[0.0000, 0.1394, 0.1398, 0.1397, 0.1397, 0.1395, 0.1395, 0.1395, 0.1394,
         0.1395],
        [0.1394, 0.0000, 0.1395, 0.1394, 0.1397, 0.1392, 0.1396, 0.1393, 0.1398,
         0.1394],
        [0.1398, 0.1395, 0.0000, 0.1395, 0.1404, 0.1397, 0.1396, 0.1395, 0.1398,
         0.1395],
        [0.1397, 0.1394, 0.1395, 0.0000, 0.1399, 0.1398, 0.1397, 0.1393, 0.1398,
         0.1395],
        [0.1397, 0.1397, 0.1404, 0.1399, 0.0000, 0.1397, 0.1400, 0.1397, 0.1399,
         0.1398],
        [0.1395, 0.1392, 0.1397, 0.1398, 0.1397, 0.0000, 0.1397, 0.1395, 0.1395,
         0.1396],
        [0.1395, 0.1396, 0.1396, 0.1397, 0.1400, 0.1397, 0.0000, 0.1394, 0.1401,
         0.1395],
        [0.1395, 0.1393, 0.1395, 0.1393, 0.1397, 0.1395, 0.1394, 0.0000, 0.1394,
         0.1396],
        [0.1394, 0.1398, 0.1398, 0.1398, 0.1399, 0.1395, 0.1401, 0.1394, 0.0000,
         0.1395],
        [0.1395, 0.1394, 0.1395, 0.1395, 0.1398, 0.1396, 0.1395, 0.1396, 0.1395,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0104, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28879762
Epoch246: train_loss: 4.3127 recon_acc: 0.1734 val_roc: 0.7076 val_ap: 0.7541 f1: 0.6836 time: 0.2611
thresh 0.45912376
          test_roc: 0.6925 test_ap: 0.7243 test_f1: 0.6679 test_recon_acc: 0.4330
difference_matrix tensor([[0.0000, 0.1392, 0.1396, 0.1395, 0.1395, 0.1393, 0.1393, 0.1393, 0.1392,
         0.1393],
        [0.1392, 0.0000, 0.1393, 0.1393, 0.1395, 0.1391, 0.1394, 0.1391, 0.1396,
         0.1392],
        [0.1396, 0.1393, 0.0000, 0.1394, 0.1402, 0.1395, 0.1394, 0.1394, 0.1396,
         0.1393],
        [0.1395, 0.1393, 0.1394, 0.0000, 0.1397, 0.1396, 0.1395, 0.1391, 0.1396,
         0.1394],
        [0.1395, 0.1395, 0.1402, 0.1397, 0.0000, 0.1395, 0.1398, 0.1395, 0.1397,
         0.1396],
        [0.1393, 0.1391, 0.1395, 0.1396, 0.1395, 0.0000, 0.1395, 0.1393, 0.1393,
         0.1395],
        [0.1393, 0.1394, 0.1394, 0.1395, 0.1398, 0.1395, 0.0000, 0.1392, 0.1400,
         0.1393],
        [0.1393, 0.1391, 0.1394, 0.1391, 0.1395, 0.1393, 0.1392, 0.0000, 0.1392,
         0.1395],
        [0.1392, 0.1396, 0.1396, 0.1396, 0.1397, 0.1393, 0.1400, 0.1392, 0.0000,
         0.1393],
        [0.1393, 0.1392, 0.1393, 0.1394, 0.1396, 0.1395, 0.1393, 0.1395, 0.1393,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0106, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28867573
Epoch247: train_loss: 4.3105 recon_acc: 0.1730 val_roc: 0.7079 val_ap: 0.7545 f1: 0.6825 time: 0.2941
thresh 0.4653524
          test_roc: 0.6928 test_ap: 0.7247 test_f1: 0.6679 test_recon_acc: 0.4434
difference_matrix tensor([[0.0000, 0.1390, 0.1394, 0.1393, 0.1393, 0.1392, 0.1391, 0.1391, 0.1390,
         0.1391],
        [0.1390, 0.0000, 0.1391, 0.1391, 0.1393, 0.1389, 0.1393, 0.1389, 0.1394,
         0.1391],
        [0.1394, 0.1391, 0.0000, 0.1392, 0.1400, 0.1393, 0.1392, 0.1392, 0.1394,
         0.1392],
        [0.1393, 0.1391, 0.1392, 0.0000, 0.1395, 0.1394, 0.1393, 0.1389, 0.1395,
         0.1392],
        [0.1393, 0.1393, 0.1400, 0.1395, 0.0000, 0.1393, 0.1396, 0.1394, 0.1395,
         0.1394],
        [0.1392, 0.1389, 0.1393, 0.1394, 0.1393, 0.0000, 0.1393, 0.1391, 0.1391,
         0.1393],
        [0.1391, 0.1393, 0.1392, 0.1393, 0.1396, 0.1393, 0.0000, 0.1390, 0.1398,
         0.1391],
        [0.1391, 0.1389, 0.1392, 0.1389, 0.1394, 0.1391, 0.1390, 0.0000, 0.1391,
         0.1393],
        [0.1390, 0.1394, 0.1394, 0.1395, 0.1395, 0.1391, 0.1398, 0.1391, 0.0000,
         0.1391],
        [0.1391, 0.1391, 0.1392, 0.1392, 0.1394, 0.1393, 0.1391, 0.1393, 0.1391,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0107, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2885534
Epoch248: train_loss: 4.3083 recon_acc: 0.1725 val_roc: 0.7082 val_ap: 0.7549 f1: 0.6825 time: 0.2825
thresh 0.46641624
          test_roc: 0.6931 test_ap: 0.7251 test_f1: 0.6685 test_recon_acc: 0.4451
difference_matrix tensor([[0.0000, 0.1388, 0.1393, 0.1391, 0.1391, 0.1390, 0.1390, 0.1389, 0.1388,
         0.1390],
        [0.1388, 0.0000, 0.1389, 0.1389, 0.1391, 0.1387, 0.1391, 0.1388, 0.1392,
         0.1389],
        [0.1393, 0.1389, 0.0000, 0.1390, 0.1398, 0.1391, 0.1390, 0.1390, 0.1393,
         0.1390],
        [0.1391, 0.1389, 0.1390, 0.0000, 0.1393, 0.1392, 0.1391, 0.1387, 0.1393,
         0.1390],
        [0.1391, 0.1391, 0.1398, 0.1393, 0.0000, 0.1391, 0.1395, 0.1392, 0.1393,
         0.1393],
        [0.1390, 0.1387, 0.1391, 0.1392, 0.1391, 0.0000, 0.1391, 0.1389, 0.1390,
         0.1391],
        [0.1390, 0.1391, 0.1390, 0.1391, 0.1395, 0.1391, 0.0000, 0.1389, 0.1396,
         0.1390],
        [0.1389, 0.1388, 0.1390, 0.1387, 0.1392, 0.1389, 0.1389, 0.0000, 0.1389,
         0.1391],
        [0.1388, 0.1392, 0.1393, 0.1393, 0.1393, 0.1390, 0.1396, 0.1389, 0.0000,
         0.1389],
        [0.1390, 0.1389, 0.1390, 0.1390, 0.1393, 0.1391, 0.1390, 0.1391, 0.1389,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0109, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28843284
Epoch249: train_loss: 4.3062 recon_acc: 0.1721 val_roc: 0.7087 val_ap: 0.7557 f1: 0.6825 time: 0.2450
thresh 0.46820825
          test_roc: 0.6934 test_ap: 0.7254 test_f1: 0.6685 test_recon_acc: 0.4480
difference_matrix tensor([[0.0000, 0.1386, 0.1391, 0.1389, 0.1390, 0.1388, 0.1388, 0.1388, 0.1387,
         0.1388],
        [0.1386, 0.0000, 0.1387, 0.1387, 0.1389, 0.1385, 0.1389, 0.1386, 0.1390,
         0.1387],
        [0.1391, 0.1387, 0.0000, 0.1388, 0.1397, 0.1390, 0.1388, 0.1388, 0.1391,
         0.1388],
        [0.1389, 0.1387, 0.1388, 0.0000, 0.1391, 0.1391, 0.1390, 0.1385, 0.1391,
         0.1388],
        [0.1390, 0.1389, 0.1397, 0.1391, 0.0000, 0.1390, 0.1393, 0.1390, 0.1391,
         0.1391],
        [0.1388, 0.1385, 0.1390, 0.1391, 0.1390, 0.0000, 0.1390, 0.1387, 0.1388,
         0.1389],
        [0.1388, 0.1389, 0.1388, 0.1390, 0.1393, 0.1390, 0.0000, 0.1387, 0.1394,
         0.1388],
        [0.1388, 0.1386, 0.1388, 0.1385, 0.1390, 0.1387, 0.1387, 0.0000, 0.1387,
         0.1389],
        [0.1387, 0.1390, 0.1391, 0.1391, 0.1391, 0.1388, 0.1394, 0.1387, 0.0000,
         0.1387],
        [0.1388, 0.1387, 0.1388, 0.1388, 0.1391, 0.1389, 0.1388, 0.1389, 0.1387,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0111, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34184706
Epoch250: train_loss: 4.3041 recon_acc: 0.2455 val_roc: 0.7091 val_ap: 0.7561 f1: 0.6824 time: 0.2476
thresh 0.46787956
          test_roc: 0.6938 test_ap: 0.7258 test_f1: 0.6692 test_recon_acc: 0.4474
difference_matrix tensor([[0.0000, 0.1385, 0.1389, 0.1388, 0.1388, 0.1386, 0.1386, 0.1386, 0.1385,
         0.1386],
        [0.1385, 0.0000, 0.1386, 0.1385, 0.1388, 0.1384, 0.1387, 0.1384, 0.1389,
         0.1385],
        [0.1389, 0.1386, 0.0000, 0.1386, 0.1395, 0.1388, 0.1387, 0.1386, 0.1389,
         0.1386],
        [0.1388, 0.1385, 0.1386, 0.0000, 0.1390, 0.1389, 0.1388, 0.1384, 0.1389,
         0.1386],
        [0.1388, 0.1388, 0.1395, 0.1390, 0.0000, 0.1388, 0.1391, 0.1388, 0.1390,
         0.1389],
        [0.1386, 0.1384, 0.1388, 0.1389, 0.1388, 0.0000, 0.1388, 0.1386, 0.1386,
         0.1387],
        [0.1386, 0.1387, 0.1387, 0.1388, 0.1391, 0.1388, 0.0000, 0.1385, 0.1392,
         0.1386],
        [0.1386, 0.1384, 0.1386, 0.1384, 0.1388, 0.1386, 0.1385, 0.0000, 0.1385,
         0.1387],
        [0.1385, 0.1389, 0.1389, 0.1389, 0.1390, 0.1386, 0.1392, 0.1385, 0.0000,
         0.1386],
        [0.1386, 0.1385, 0.1386, 0.1386, 0.1389, 0.1387, 0.1386, 0.1387, 0.1386,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0113, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3422947
Epoch251: train_loss: 4.3020 recon_acc: 0.2460 val_roc: 0.7093 val_ap: 0.7562 f1: 0.6824 time: 0.2795
thresh 0.46861774
          test_roc: 0.6941 test_ap: 0.7262 test_f1: 0.6704 test_recon_acc: 0.4486
difference_matrix tensor([[0.0000, 0.1383, 0.1387, 0.1386, 0.1386, 0.1384, 0.1384, 0.1384, 0.1383,
         0.1384],
        [0.1383, 0.0000, 0.1384, 0.1384, 0.1386, 0.1382, 0.1385, 0.1382, 0.1387,
         0.1383],
        [0.1387, 0.1384, 0.0000, 0.1385, 0.1393, 0.1386, 0.1385, 0.1385, 0.1387,
         0.1384],
        [0.1386, 0.1384, 0.1385, 0.0000, 0.1388, 0.1387, 0.1386, 0.1382, 0.1387,
         0.1385],
        [0.1386, 0.1386, 0.1393, 0.1388, 0.0000, 0.1386, 0.1389, 0.1386, 0.1388,
         0.1387],
        [0.1384, 0.1382, 0.1386, 0.1387, 0.1386, 0.0000, 0.1386, 0.1384, 0.1384,
         0.1386],
        [0.1384, 0.1385, 0.1385, 0.1386, 0.1389, 0.1386, 0.0000, 0.1383, 0.1391,
         0.1384],
        [0.1384, 0.1382, 0.1385, 0.1382, 0.1386, 0.1384, 0.1383, 0.0000, 0.1383,
         0.1385],
        [0.1383, 0.1387, 0.1387, 0.1387, 0.1388, 0.1384, 0.1391, 0.1383, 0.0000,
         0.1384],
        [0.1384, 0.1383, 0.1384, 0.1385, 0.1387, 0.1386, 0.1384, 0.1385, 0.1384,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0115, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34274516
Epoch252: train_loss: 4.2999 recon_acc: 0.2464 val_roc: 0.7098 val_ap: 0.7566 f1: 0.6824 time: 0.2730
thresh 0.4690572
          test_roc: 0.6943 test_ap: 0.7266 test_f1: 0.6704 test_recon_acc: 0.4493
difference_matrix tensor([[0.0000, 0.1381, 0.1385, 0.1384, 0.1384, 0.1383, 0.1382, 0.1382, 0.1381,
         0.1382],
        [0.1381, 0.0000, 0.1382, 0.1382, 0.1384, 0.1380, 0.1383, 0.1380, 0.1385,
         0.1382],
        [0.1385, 0.1382, 0.0000, 0.1383, 0.1391, 0.1384, 0.1383, 0.1383, 0.1385,
         0.1383],
        [0.1384, 0.1382, 0.1383, 0.0000, 0.1386, 0.1385, 0.1384, 0.1380, 0.1386,
         0.1383],
        [0.1384, 0.1384, 0.1391, 0.1386, 0.0000, 0.1384, 0.1387, 0.1385, 0.1386,
         0.1385],
        [0.1383, 0.1380, 0.1384, 0.1385, 0.1384, 0.0000, 0.1384, 0.1382, 0.1382,
         0.1384],
        [0.1382, 0.1383, 0.1383, 0.1384, 0.1387, 0.1384, 0.0000, 0.1381, 0.1389,
         0.1382],
        [0.1382, 0.1380, 0.1383, 0.1380, 0.1385, 0.1382, 0.1381, 0.0000, 0.1382,
         0.1384],
        [0.1381, 0.1385, 0.1385, 0.1386, 0.1386, 0.1382, 0.1389, 0.1382, 0.0000,
         0.1382],
        [0.1382, 0.1382, 0.1383, 0.1383, 0.1385, 0.1384, 0.1382, 0.1384, 0.1382,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0116, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3431995
Epoch253: train_loss: 4.2978 recon_acc: 0.2469 val_roc: 0.7102 val_ap: 0.7571 f1: 0.6824 time: 0.2849
thresh 0.46933764
          test_roc: 0.6946 test_ap: 0.7269 test_f1: 0.6710 test_recon_acc: 0.4498
difference_matrix tensor([[0.0000, 0.1379, 0.1384, 0.1382, 0.1382, 0.1381, 0.1381, 0.1380, 0.1379,
         0.1381],
        [0.1379, 0.0000, 0.1380, 0.1380, 0.1382, 0.1378, 0.1382, 0.1379, 0.1383,
         0.1380],
        [0.1384, 0.1380, 0.0000, 0.1381, 0.1389, 0.1382, 0.1381, 0.1381, 0.1384,
         0.1381],
        [0.1382, 0.1380, 0.1381, 0.0000, 0.1384, 0.1383, 0.1382, 0.1378, 0.1384,
         0.1381],
        [0.1382, 0.1382, 0.1389, 0.1384, 0.0000, 0.1382, 0.1385, 0.1383, 0.1384,
         0.1384],
        [0.1381, 0.1378, 0.1382, 0.1383, 0.1382, 0.0000, 0.1382, 0.1380, 0.1381,
         0.1382],
        [0.1381, 0.1382, 0.1381, 0.1382, 0.1385, 0.1382, 0.0000, 0.1379, 0.1387,
         0.1381],
        [0.1380, 0.1379, 0.1381, 0.1378, 0.1383, 0.1380, 0.1379, 0.0000, 0.1380,
         0.1382],
        [0.1379, 0.1383, 0.1384, 0.1384, 0.1384, 0.1381, 0.1387, 0.1380, 0.0000,
         0.1380],
        [0.1381, 0.1380, 0.1381, 0.1381, 0.1384, 0.1382, 0.1381, 0.1382, 0.1380,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0118, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3436549
Epoch254: train_loss: 4.2958 recon_acc: 0.2473 val_roc: 0.7103 val_ap: 0.7573 f1: 0.6824 time: 0.2461
thresh 0.46961722
          test_roc: 0.6949 test_ap: 0.7273 test_f1: 0.6710 test_recon_acc: 0.4502
difference_matrix tensor([[0.0000, 0.1377, 0.1382, 0.1380, 0.1380, 0.1379, 0.1379, 0.1378, 0.1377,
         0.1379],
        [0.1377, 0.0000, 0.1378, 0.1378, 0.1380, 0.1376, 0.1380, 0.1377, 0.1381,
         0.1378],
        [0.1382, 0.1378, 0.0000, 0.1379, 0.1388, 0.1381, 0.1379, 0.1379, 0.1382,
         0.1379],
        [0.1380, 0.1378, 0.1379, 0.0000, 0.1382, 0.1382, 0.1380, 0.1376, 0.1382,
         0.1379],
        [0.1380, 0.1380, 0.1388, 0.1382, 0.0000, 0.1381, 0.1384, 0.1381, 0.1382,
         0.1382],
        [0.1379, 0.1376, 0.1381, 0.1382, 0.1381, 0.0000, 0.1381, 0.1379, 0.1379,
         0.1380],
        [0.1379, 0.1380, 0.1379, 0.1380, 0.1384, 0.1381, 0.0000, 0.1378, 0.1385,
         0.1379],
        [0.1378, 0.1377, 0.1379, 0.1376, 0.1381, 0.1379, 0.1378, 0.0000, 0.1378,
         0.1380],
        [0.1377, 0.1381, 0.1382, 0.1382, 0.1382, 0.1379, 0.1385, 0.1378, 0.0000,
         0.1378],
        [0.1379, 0.1378, 0.1379, 0.1379, 0.1382, 0.1380, 0.1379, 0.1380, 0.1378,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0120, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34374687
Epoch255: train_loss: 4.2937 recon_acc: 0.2472 val_roc: 0.7104 val_ap: 0.7575 f1: 0.6824 time: 0.2492
thresh 0.46989506
          test_roc: 0.6952 test_ap: 0.7276 test_f1: 0.6710 test_recon_acc: 0.4506
difference_matrix tensor([[0.0000, 0.1375, 0.1380, 0.1379, 0.1379, 0.1377, 0.1377, 0.1377, 0.1376,
         0.1377],
        [0.1375, 0.0000, 0.1377, 0.1376, 0.1378, 0.1375, 0.1378, 0.1375, 0.1379,
         0.1376],
        [0.1380, 0.1377, 0.0000, 0.1377, 0.1386, 0.1379, 0.1377, 0.1377, 0.1380,
         0.1377],
        [0.1379, 0.1376, 0.1377, 0.0000, 0.1381, 0.1380, 0.1379, 0.1375, 0.1380,
         0.1377],
        [0.1379, 0.1378, 0.1386, 0.1381, 0.0000, 0.1379, 0.1382, 0.1379, 0.1381,
         0.1380],
        [0.1377, 0.1375, 0.1379, 0.1380, 0.1379, 0.0000, 0.1379, 0.1377, 0.1377,
         0.1378],
        [0.1377, 0.1378, 0.1377, 0.1379, 0.1382, 0.1379, 0.0000, 0.1376, 0.1383,
         0.1377],
        [0.1377, 0.1375, 0.1377, 0.1375, 0.1379, 0.1377, 0.1376, 0.0000, 0.1376,
         0.1378],
        [0.1376, 0.1379, 0.1380, 0.1380, 0.1381, 0.1377, 0.1383, 0.1376, 0.0000,
         0.1377],
        [0.1377, 0.1376, 0.1377, 0.1377, 0.1380, 0.1378, 0.1377, 0.1378, 0.1377,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0122, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3437231
Epoch256: train_loss: 4.2917 recon_acc: 0.2470 val_roc: 0.7108 val_ap: 0.7579 f1: 0.6824 time: 0.2891
thresh 0.47237217
          test_roc: 0.6954 test_ap: 0.7280 test_f1: 0.6717 test_recon_acc: 0.4548
difference_matrix tensor([[0.0000, 0.1374, 0.1378, 0.1377, 0.1377, 0.1375, 0.1375, 0.1375, 0.1374,
         0.1375],
        [0.1374, 0.0000, 0.1375, 0.1374, 0.1377, 0.1373, 0.1376, 0.1373, 0.1378,
         0.1374],
        [0.1378, 0.1375, 0.0000, 0.1376, 0.1384, 0.1377, 0.1376, 0.1376, 0.1378,
         0.1375],
        [0.1377, 0.1374, 0.1376, 0.0000, 0.1379, 0.1378, 0.1377, 0.1373, 0.1378,
         0.1375],
        [0.1377, 0.1377, 0.1384, 0.1379, 0.0000, 0.1377, 0.1380, 0.1377, 0.1379,
         0.1378],
        [0.1375, 0.1373, 0.1377, 0.1378, 0.1377, 0.0000, 0.1377, 0.1375, 0.1375,
         0.1377],
        [0.1375, 0.1376, 0.1376, 0.1377, 0.1380, 0.1377, 0.0000, 0.1374, 0.1382,
         0.1375],
        [0.1375, 0.1373, 0.1376, 0.1373, 0.1377, 0.1375, 0.1374, 0.0000, 0.1374,
         0.1376],
        [0.1374, 0.1378, 0.1378, 0.1378, 0.1379, 0.1375, 0.1382, 0.1374, 0.0000,
         0.1375],
        [0.1375, 0.1374, 0.1375, 0.1375, 0.1378, 0.1377, 0.1375, 0.1376, 0.1375,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0124, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3436999
Epoch257: train_loss: 4.2897 recon_acc: 0.2467 val_roc: 0.7108 val_ap: 0.7581 f1: 0.6824 time: 0.2942
thresh 0.4731333
          test_roc: 0.6957 test_ap: 0.7283 test_f1: 0.6717 test_recon_acc: 0.4560
difference_matrix tensor([[0.0000, 0.1372, 0.1376, 0.1375, 0.1375, 0.1374, 0.1373, 0.1373, 0.1372,
         0.1373],
        [0.1372, 0.0000, 0.1373, 0.1373, 0.1375, 0.1371, 0.1374, 0.1371, 0.1376,
         0.1372],
        [0.1376, 0.1373, 0.0000, 0.1374, 0.1382, 0.1375, 0.1374, 0.1374, 0.1377,
         0.1374],
        [0.1375, 0.1373, 0.1374, 0.0000, 0.1377, 0.1376, 0.1375, 0.1371, 0.1377,
         0.1374],
        [0.1375, 0.1375, 0.1382, 0.1377, 0.0000, 0.1375, 0.1378, 0.1376, 0.1377,
         0.1376],
        [0.1374, 0.1371, 0.1375, 0.1376, 0.1375, 0.0000, 0.1375, 0.1373, 0.1373,
         0.1375],
        [0.1373, 0.1374, 0.1374, 0.1375, 0.1378, 0.1375, 0.0000, 0.1372, 0.1380,
         0.1373],
        [0.1373, 0.1371, 0.1374, 0.1371, 0.1376, 0.1373, 0.1372, 0.0000, 0.1372,
         0.1375],
        [0.1372, 0.1376, 0.1377, 0.1377, 0.1377, 0.1373, 0.1380, 0.1372, 0.0000,
         0.1373],
        [0.1373, 0.1372, 0.1374, 0.1374, 0.1376, 0.1375, 0.1373, 0.1375, 0.1373,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0126, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34367839
Epoch258: train_loss: 4.2877 recon_acc: 0.2465 val_roc: 0.7110 val_ap: 0.7583 f1: 0.6824 time: 0.2598
thresh 0.47071683
          test_roc: 0.6960 test_ap: 0.7285 test_f1: 0.6723 test_recon_acc: 0.4518
difference_matrix tensor([[0.0000, 0.1370, 0.1375, 0.1373, 0.1373, 0.1372, 0.1371, 0.1371, 0.1370,
         0.1371],
        [0.1370, 0.0000, 0.1371, 0.1371, 0.1373, 0.1369, 0.1372, 0.1369, 0.1374,
         0.1371],
        [0.1375, 0.1371, 0.0000, 0.1372, 0.1380, 0.1373, 0.1372, 0.1372, 0.1375,
         0.1372],
        [0.1373, 0.1371, 0.1372, 0.0000, 0.1375, 0.1374, 0.1373, 0.1369, 0.1375,
         0.1372],
        [0.1373, 0.1373, 0.1380, 0.1375, 0.0000, 0.1373, 0.1376, 0.1374, 0.1375,
         0.1374],
        [0.1372, 0.1369, 0.1373, 0.1374, 0.1373, 0.0000, 0.1373, 0.1371, 0.1372,
         0.1373],
        [0.1371, 0.1372, 0.1372, 0.1373, 0.1376, 0.1373, 0.0000, 0.1370, 0.1378,
         0.1372],
        [0.1371, 0.1369, 0.1372, 0.1369, 0.1374, 0.1371, 0.1370, 0.0000, 0.1371,
         0.1373],
        [0.1370, 0.1374, 0.1375, 0.1375, 0.1375, 0.1372, 0.1378, 0.1371, 0.0000,
         0.1371],
        [0.1371, 0.1371, 0.1372, 0.1372, 0.1374, 0.1373, 0.1372, 0.1373, 0.1371,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0127, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34365943
Epoch259: train_loss: 4.2857 recon_acc: 0.2462 val_roc: 0.7117 val_ap: 0.7589 f1: 0.6824 time: 0.2604
thresh 0.4709881
          test_roc: 0.6963 test_ap: 0.7289 test_f1: 0.6723 test_recon_acc: 0.4523
difference_matrix tensor([[0.0000, 0.1368, 0.1373, 0.1371, 0.1371, 0.1370, 0.1370, 0.1369, 0.1368,
         0.1370],
        [0.1368, 0.0000, 0.1369, 0.1369, 0.1371, 0.1367, 0.1371, 0.1368, 0.1372,
         0.1369],
        [0.1373, 0.1369, 0.0000, 0.1370, 0.1378, 0.1372, 0.1370, 0.1370, 0.1373,
         0.1370],
        [0.1371, 0.1369, 0.1370, 0.0000, 0.1373, 0.1373, 0.1371, 0.1367, 0.1373,
         0.1370],
        [0.1371, 0.1371, 0.1378, 0.1373, 0.0000, 0.1371, 0.1375, 0.1372, 0.1373,
         0.1373],
        [0.1370, 0.1367, 0.1372, 0.1373, 0.1371, 0.0000, 0.1372, 0.1370, 0.1370,
         0.1371],
        [0.1370, 0.1371, 0.1370, 0.1371, 0.1375, 0.1372, 0.0000, 0.1368, 0.1376,
         0.1370],
        [0.1369, 0.1368, 0.1370, 0.1367, 0.1372, 0.1370, 0.1368, 0.0000, 0.1369,
         0.1371],
        [0.1368, 0.1372, 0.1373, 0.1373, 0.1373, 0.1370, 0.1376, 0.1369, 0.0000,
         0.1369],
        [0.1370, 0.1369, 0.1370, 0.1370, 0.1373, 0.1371, 0.1370, 0.1371, 0.1369,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0129, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34364247
Epoch260: train_loss: 4.2837 recon_acc: 0.2460 val_roc: 0.7120 val_ap: 0.7591 f1: 0.6824 time: 0.2950
thresh 0.46599743
          test_roc: 0.6965 test_ap: 0.7291 test_f1: 0.6729 test_recon_acc: 0.4438
difference_matrix tensor([[0.0000, 0.1366, 0.1371, 0.1369, 0.1370, 0.1368, 0.1368, 0.1368, 0.1367,
         0.1368],
        [0.1366, 0.0000, 0.1368, 0.1367, 0.1369, 0.1366, 0.1369, 0.1366, 0.1370,
         0.1367],
        [0.1371, 0.1368, 0.0000, 0.1368, 0.1377, 0.1370, 0.1368, 0.1368, 0.1371,
         0.1368],
        [0.1369, 0.1367, 0.1368, 0.0000, 0.1372, 0.1371, 0.1369, 0.1365, 0.1371,
         0.1368],
        [0.1370, 0.1369, 0.1377, 0.1372, 0.0000, 0.1370, 0.1373, 0.1370, 0.1372,
         0.1371],
        [0.1368, 0.1366, 0.1370, 0.1371, 0.1370, 0.0000, 0.1370, 0.1368, 0.1368,
         0.1369],
        [0.1368, 0.1369, 0.1368, 0.1369, 0.1373, 0.1370, 0.0000, 0.1367, 0.1374,
         0.1368],
        [0.1368, 0.1366, 0.1368, 0.1365, 0.1370, 0.1368, 0.1367, 0.0000, 0.1367,
         0.1369],
        [0.1367, 0.1370, 0.1371, 0.1371, 0.1372, 0.1368, 0.1374, 0.1367, 0.0000,
         0.1368],
        [0.1368, 0.1367, 0.1368, 0.1368, 0.1371, 0.1369, 0.1368, 0.1369, 0.1368,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0131, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.27466226
Epoch261: train_loss: 4.2818 recon_acc: 0.1517 val_roc: 0.7120 val_ap: 0.7593 f1: 0.6824 time: 0.2968
thresh 0.4661784
          test_roc: 0.6967 test_ap: 0.7294 test_f1: 0.6729 test_recon_acc: 0.4440
difference_matrix tensor([[0.0000, 0.1365, 0.1369, 0.1368, 0.1368, 0.1367, 0.1366, 0.1366, 0.1365,
         0.1366],
        [0.1365, 0.0000, 0.1366, 0.1365, 0.1368, 0.1364, 0.1367, 0.1364, 0.1369,
         0.1365],
        [0.1369, 0.1366, 0.0000, 0.1367, 0.1375, 0.1368, 0.1367, 0.1367, 0.1369,
         0.1366],
        [0.1368, 0.1365, 0.1367, 0.0000, 0.1370, 0.1369, 0.1368, 0.1364, 0.1369,
         0.1366],
        [0.1368, 0.1368, 0.1375, 0.1370, 0.0000, 0.1368, 0.1371, 0.1368, 0.1370,
         0.1369],
        [0.1367, 0.1364, 0.1368, 0.1369, 0.1368, 0.0000, 0.1368, 0.1366, 0.1366,
         0.1368],
        [0.1366, 0.1367, 0.1367, 0.1368, 0.1371, 0.1368, 0.0000, 0.1365, 0.1373,
         0.1366],
        [0.1366, 0.1364, 0.1367, 0.1364, 0.1368, 0.1366, 0.1365, 0.0000, 0.1365,
         0.1367],
        [0.1365, 0.1369, 0.1369, 0.1369, 0.1370, 0.1366, 0.1373, 0.1365, 0.0000,
         0.1366],
        [0.1366, 0.1365, 0.1366, 0.1366, 0.1369, 0.1368, 0.1366, 0.1367, 0.1366,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0133, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.27419317
Epoch262: train_loss: 4.2798 recon_acc: 0.1509 val_roc: 0.7125 val_ap: 0.7599 f1: 0.6813 time: 0.2717
thresh 0.46633735
          test_roc: 0.6971 test_ap: 0.7298 test_f1: 0.6729 test_recon_acc: 0.4442
difference_matrix tensor([[0.0000, 0.1363, 0.1367, 0.1366, 0.1366, 0.1365, 0.1364, 0.1364, 0.1363,
         0.1364],
        [0.1363, 0.0000, 0.1364, 0.1364, 0.1366, 0.1362, 0.1365, 0.1362, 0.1367,
         0.1363],
        [0.1367, 0.1364, 0.0000, 0.1365, 0.1373, 0.1366, 0.1365, 0.1365, 0.1368,
         0.1365],
        [0.1366, 0.1364, 0.1365, 0.0000, 0.1368, 0.1367, 0.1366, 0.1362, 0.1368,
         0.1365],
        [0.1366, 0.1366, 0.1373, 0.1368, 0.0000, 0.1366, 0.1369, 0.1367, 0.1368,
         0.1367],
        [0.1365, 0.1362, 0.1366, 0.1367, 0.1366, 0.0000, 0.1366, 0.1364, 0.1364,
         0.1366],
        [0.1364, 0.1365, 0.1365, 0.1366, 0.1369, 0.1366, 0.0000, 0.1363, 0.1371,
         0.1364],
        [0.1364, 0.1362, 0.1365, 0.1362, 0.1367, 0.1364, 0.1363, 0.0000, 0.1364,
         0.1366],
        [0.1363, 0.1367, 0.1368, 0.1368, 0.1368, 0.1364, 0.1371, 0.1364, 0.0000,
         0.1364],
        [0.1364, 0.1363, 0.1365, 0.1365, 0.1367, 0.1366, 0.1364, 0.1366, 0.1364,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0135, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28010523
Epoch263: train_loss: 4.2779 recon_acc: 0.1580 val_roc: 0.7127 val_ap: 0.7603 f1: 0.6814 time: 0.2719
thresh 0.46649292
          test_roc: 0.6974 test_ap: 0.7301 test_f1: 0.6729 test_recon_acc: 0.4444
difference_matrix tensor([[0.0000, 0.1361, 0.1366, 0.1364, 0.1364, 0.1363, 0.1362, 0.1362, 0.1361,
         0.1362],
        [0.1361, 0.0000, 0.1362, 0.1362, 0.1364, 0.1360, 0.1363, 0.1360, 0.1365,
         0.1362],
        [0.1366, 0.1362, 0.0000, 0.1363, 0.1371, 0.1365, 0.1363, 0.1363, 0.1366,
         0.1363],
        [0.1364, 0.1362, 0.1363, 0.0000, 0.1366, 0.1366, 0.1364, 0.1360, 0.1366,
         0.1363],
        [0.1364, 0.1364, 0.1371, 0.1366, 0.0000, 0.1364, 0.1367, 0.1365, 0.1366,
         0.1366],
        [0.1363, 0.1360, 0.1365, 0.1366, 0.1364, 0.0000, 0.1364, 0.1362, 0.1363,
         0.1364],
        [0.1362, 0.1363, 0.1363, 0.1364, 0.1367, 0.1364, 0.0000, 0.1361, 0.1369,
         0.1363],
        [0.1362, 0.1360, 0.1363, 0.1360, 0.1365, 0.1362, 0.1361, 0.0000, 0.1362,
         0.1364],
        [0.1361, 0.1365, 0.1366, 0.1366, 0.1366, 0.1363, 0.1369, 0.1362, 0.0000,
         0.1362],
        [0.1362, 0.1362, 0.1363, 0.1363, 0.1366, 0.1364, 0.1363, 0.1364, 0.1362,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0136, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2805216
Epoch264: train_loss: 4.2760 recon_acc: 0.1582 val_roc: 0.7130 val_ap: 0.7606 f1: 0.6814 time: 0.2820
thresh 0.46931717
          test_roc: 0.6975 test_ap: 0.7303 test_f1: 0.6735 test_recon_acc: 0.4492
difference_matrix tensor([[0.0000, 0.1359, 0.1364, 0.1362, 0.1362, 0.1361, 0.1361, 0.1360, 0.1359,
         0.1361],
        [0.1359, 0.0000, 0.1360, 0.1360, 0.1362, 0.1358, 0.1362, 0.1359, 0.1363,
         0.1360],
        [0.1364, 0.1360, 0.0000, 0.1361, 0.1370, 0.1363, 0.1361, 0.1361, 0.1364,
         0.1361],
        [0.1362, 0.1360, 0.1361, 0.0000, 0.1364, 0.1364, 0.1362, 0.1358, 0.1364,
         0.1361],
        [0.1362, 0.1362, 0.1370, 0.1364, 0.0000, 0.1363, 0.1366, 0.1363, 0.1364,
         0.1364],
        [0.1361, 0.1358, 0.1363, 0.1364, 0.1363, 0.0000, 0.1363, 0.1361, 0.1361,
         0.1362],
        [0.1361, 0.1362, 0.1361, 0.1362, 0.1366, 0.1363, 0.0000, 0.1359, 0.1367,
         0.1361],
        [0.1360, 0.1359, 0.1361, 0.1358, 0.1363, 0.1361, 0.1359, 0.0000, 0.1360,
         0.1362],
        [0.1359, 0.1363, 0.1364, 0.1364, 0.1364, 0.1361, 0.1367, 0.1360, 0.0000,
         0.1360],
        [0.1361, 0.1360, 0.1361, 0.1361, 0.1364, 0.1362, 0.1361, 0.1362, 0.1360,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0138, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28094333
Epoch265: train_loss: 4.2741 recon_acc: 0.1585 val_roc: 0.7133 val_ap: 0.7610 f1: 0.6814 time: 0.2754
thresh 0.47007734
          test_roc: 0.6978 test_ap: 0.7308 test_f1: 0.6735 test_recon_acc: 0.4505
difference_matrix tensor([[0.0000, 0.1357, 0.1362, 0.1361, 0.1361, 0.1359, 0.1359, 0.1359, 0.1358,
         0.1359],
        [0.1357, 0.0000, 0.1359, 0.1358, 0.1360, 0.1357, 0.1360, 0.1357, 0.1361,
         0.1358],
        [0.1362, 0.1359, 0.0000, 0.1359, 0.1368, 0.1361, 0.1360, 0.1360, 0.1362,
         0.1359],
        [0.1361, 0.1358, 0.1359, 0.0000, 0.1363, 0.1362, 0.1361, 0.1357, 0.1362,
         0.1359],
        [0.1361, 0.1360, 0.1368, 0.1363, 0.0000, 0.1361, 0.1364, 0.1361, 0.1363,
         0.1362],
        [0.1359, 0.1357, 0.1361, 0.1362, 0.1361, 0.0000, 0.1361, 0.1359, 0.1359,
         0.1361],
        [0.1359, 0.1360, 0.1360, 0.1361, 0.1364, 0.1361, 0.0000, 0.1358, 0.1365,
         0.1359],
        [0.1359, 0.1357, 0.1360, 0.1357, 0.1361, 0.1359, 0.1358, 0.0000, 0.1358,
         0.1360],
        [0.1358, 0.1361, 0.1362, 0.1362, 0.1363, 0.1359, 0.1365, 0.1358, 0.0000,
         0.1359],
        [0.1359, 0.1358, 0.1359, 0.1359, 0.1362, 0.1361, 0.1359, 0.1360, 0.1359,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0140, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28137007
Epoch266: train_loss: 4.2722 recon_acc: 0.1588 val_roc: 0.7132 val_ap: 0.7610 f1: 0.6814 time: 0.2655
difference_matrix tensor([[0.0000, 0.1356, 0.1360, 0.1359, 0.1359, 0.1358, 0.1357, 0.1357, 0.1356,
         0.1357],
        [0.1356, 0.0000, 0.1357, 0.1356, 0.1359, 0.1355, 0.1358, 0.1355, 0.1360,
         0.1356],
        [0.1360, 0.1357, 0.0000, 0.1358, 0.1366, 0.1359, 0.1358, 0.1358, 0.1361,
         0.1358],
        [0.1359, 0.1356, 0.1358, 0.0000, 0.1361, 0.1360, 0.1359, 0.1355, 0.1361,
         0.1358],
        [0.1359, 0.1359, 0.1366, 0.1361, 0.0000, 0.1359, 0.1362, 0.1360, 0.1361,
         0.1360],
        [0.1358, 0.1355, 0.1359, 0.1360, 0.1359, 0.0000, 0.1359, 0.1357, 0.1357,
         0.1359],
        [0.1357, 0.1358, 0.1358, 0.1359, 0.1362, 0.1359, 0.0000, 0.1356, 0.1364,
         0.1357],
        [0.1357, 0.1355, 0.1358, 0.1355, 0.1360, 0.1357, 0.1356, 0.0000, 0.1357,
         0.1358],
        [0.1356, 0.1360, 0.1361, 0.1361, 0.1361, 0.1357, 0.1364, 0.1357, 0.0000,
         0.1357],
        [0.1357, 0.1356, 0.1358, 0.1358, 0.1360, 0.1359, 0.1357, 0.1358, 0.1357,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0142, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28180236
Epoch267: train_loss: 4.2703 recon_acc: 0.1591 val_roc: 0.7136 val_ap: 0.7616 f1: 0.6814 time: 0.2721
thresh 0.4702433
          test_roc: 0.6985 test_ap: 0.7316 test_f1: 0.6741 test_recon_acc: 0.4506
difference_matrix tensor([[0.0000, 0.1354, 0.1359, 0.1357, 0.1357, 0.1356, 0.1355, 0.1355, 0.1354,
         0.1355],
        [0.1354, 0.0000, 0.1355, 0.1355, 0.1357, 0.1353, 0.1356, 0.1353, 0.1358,
         0.1355],
        [0.1359, 0.1355, 0.0000, 0.1356, 0.1364, 0.1358, 0.1356, 0.1356, 0.1359,
         0.1356],
        [0.1357, 0.1355, 0.1356, 0.0000, 0.1359, 0.1359, 0.1357, 0.1353, 0.1359,
         0.1356],
        [0.1357, 0.1357, 0.1364, 0.1359, 0.0000, 0.1357, 0.1360, 0.1358, 0.1359,
         0.1359],
        [0.1356, 0.1353, 0.1358, 0.1359, 0.1357, 0.0000, 0.1357, 0.1355, 0.1356,
         0.1357],
        [0.1355, 0.1356, 0.1356, 0.1357, 0.1360, 0.1357, 0.0000, 0.1354, 0.1362,
         0.1356],
        [0.1355, 0.1353, 0.1356, 0.1353, 0.1358, 0.1355, 0.1354, 0.0000, 0.1355,
         0.1357],
        [0.1354, 0.1358, 0.1359, 0.1359, 0.1359, 0.1356, 0.1362, 0.1355, 0.0000,
         0.1355],
        [0.1355, 0.1355, 0.1356, 0.1356, 0.1359, 0.1357, 0.1356, 0.1357, 0.1355,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0143, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2822406
Epoch268: train_loss: 4.2685 recon_acc: 0.1594 val_roc: 0.7139 val_ap: 0.7618 f1: 0.6814 time: 0.2856
thresh 0.4725199
          test_roc: 0.6988 test_ap: 0.7320 test_f1: 0.6742 test_recon_acc: 0.4545
difference_matrix tensor([[0.0000, 0.1352, 0.1357, 0.1355, 0.1355, 0.1354, 0.1354, 0.1353, 0.1352,
         0.1354],
        [0.1352, 0.0000, 0.1354, 0.1353, 0.1355, 0.1352, 0.1355, 0.1352, 0.1356,
         0.1353],
        [0.1357, 0.1354, 0.0000, 0.1354, 0.1363, 0.1356, 0.1354, 0.1354, 0.1357,
         0.1354],
        [0.1355, 0.1353, 0.1354, 0.0000, 0.1357, 0.1357, 0.1355, 0.1351, 0.1357,
         0.1354],
        [0.1355, 0.1355, 0.1363, 0.1357, 0.0000, 0.1356, 0.1359, 0.1356, 0.1357,
         0.1357],
        [0.1354, 0.1352, 0.1356, 0.1357, 0.1356, 0.0000, 0.1356, 0.1354, 0.1354,
         0.1355],
        [0.1354, 0.1355, 0.1354, 0.1355, 0.1359, 0.1356, 0.0000, 0.1352, 0.1360,
         0.1354],
        [0.1353, 0.1352, 0.1354, 0.1351, 0.1356, 0.1354, 0.1352, 0.0000, 0.1353,
         0.1355],
        [0.1352, 0.1356, 0.1357, 0.1357, 0.1357, 0.1354, 0.1360, 0.1353, 0.0000,
         0.1353],
        [0.1354, 0.1353, 0.1354, 0.1354, 0.1357, 0.1355, 0.1354, 0.1355, 0.1353,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0145, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2822802
Epoch269: train_loss: 4.2666 recon_acc: 0.1592 val_roc: 0.7142 val_ap: 0.7623 f1: 0.6814 time: 0.2668
thresh 0.47338715
          test_roc: 0.6990 test_ap: 0.7326 test_f1: 0.6742 test_recon_acc: 0.4559
difference_matrix tensor([[0.0000, 0.1350, 0.1355, 0.1353, 0.1354, 0.1353, 0.1352, 0.1352, 0.1351,
         0.1352],
        [0.1350, 0.0000, 0.1352, 0.1351, 0.1353, 0.1350, 0.1353, 0.1350, 0.1354,
         0.1351],
        [0.1355, 0.1352, 0.0000, 0.1353, 0.1361, 0.1354, 0.1353, 0.1353, 0.1356,
         0.1353],
        [0.1353, 0.1351, 0.1353, 0.0000, 0.1356, 0.1355, 0.1353, 0.1350, 0.1355,
         0.1352],
        [0.1354, 0.1353, 0.1361, 0.1356, 0.0000, 0.1354, 0.1357, 0.1354, 0.1356,
         0.1355],
        [0.1353, 0.1350, 0.1354, 0.1355, 0.1354, 0.0000, 0.1354, 0.1352, 0.1352,
         0.1354],
        [0.1352, 0.1353, 0.1353, 0.1353, 0.1357, 0.1354, 0.0000, 0.1351, 0.1359,
         0.1352],
        [0.1352, 0.1350, 0.1353, 0.1350, 0.1354, 0.1352, 0.1351, 0.0000, 0.1351,
         0.1353],
        [0.1351, 0.1354, 0.1356, 0.1355, 0.1356, 0.1352, 0.1359, 0.1351, 0.0000,
         0.1352],
        [0.1352, 0.1351, 0.1353, 0.1352, 0.1355, 0.1354, 0.1352, 0.1353, 0.1352,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0147, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28195304
Epoch270: train_loss: 4.2648 recon_acc: 0.1586 val_roc: 0.7146 val_ap: 0.7628 f1: 0.6814 time: 0.2665
thresh 0.4738579
          test_roc: 0.6993 test_ap: 0.7331 test_f1: 0.6748 test_recon_acc: 0.4567
difference_matrix tensor([[0.0000, 0.1349, 0.1353, 0.1352, 0.1352, 0.1351, 0.1350, 0.1350, 0.1349,
         0.1350],
        [0.1349, 0.0000, 0.1350, 0.1349, 0.1352, 0.1348, 0.1351, 0.1348, 0.1353,
         0.1349],
        [0.1353, 0.1350, 0.0000, 0.1351, 0.1359, 0.1352, 0.1351, 0.1351, 0.1354,
         0.1351],
        [0.1352, 0.1349, 0.1351, 0.0000, 0.1354, 0.1353, 0.1352, 0.1348, 0.1354,
         0.1351],
        [0.1352, 0.1352, 0.1359, 0.1354, 0.0000, 0.1352, 0.1355, 0.1353, 0.1354,
         0.1353],
        [0.1351, 0.1348, 0.1352, 0.1353, 0.1352, 0.0000, 0.1352, 0.1350, 0.1351,
         0.1352],
        [0.1350, 0.1351, 0.1351, 0.1352, 0.1355, 0.1352, 0.0000, 0.1349, 0.1357,
         0.1350],
        [0.1350, 0.1348, 0.1351, 0.1348, 0.1353, 0.1350, 0.1349, 0.0000, 0.1350,
         0.1352],
        [0.1349, 0.1353, 0.1354, 0.1354, 0.1354, 0.1351, 0.1357, 0.1350, 0.0000,
         0.1350],
        [0.1350, 0.1349, 0.1351, 0.1351, 0.1353, 0.1352, 0.1350, 0.1352, 0.1350,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0149, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2816284
Epoch271: train_loss: 4.2630 recon_acc: 0.1579 val_roc: 0.7150 val_ap: 0.7635 f1: 0.6814 time: 0.2849
thresh 0.47410956
          test_roc: 0.6995 test_ap: 0.7335 test_f1: 0.6748 test_recon_acc: 0.4571
difference_matrix tensor([[0.0000, 0.1347, 0.1352, 0.1350, 0.1350, 0.1349, 0.1348, 0.1348, 0.1347,
         0.1349],
        [0.1347, 0.0000, 0.1348, 0.1348, 0.1350, 0.1346, 0.1349, 0.1346, 0.1351,
         0.1348],
        [0.1352, 0.1348, 0.0000, 0.1349, 0.1357, 0.1351, 0.1349, 0.1349, 0.1352,
         0.1349],
        [0.1350, 0.1348, 0.1349, 0.0000, 0.1352, 0.1352, 0.1350, 0.1346, 0.1352,
         0.1349],
        [0.1350, 0.1350, 0.1357, 0.1352, 0.0000, 0.1350, 0.1354, 0.1351, 0.1352,
         0.1352],
        [0.1349, 0.1346, 0.1351, 0.1352, 0.1350, 0.0000, 0.1351, 0.1349, 0.1349,
         0.1350],
        [0.1348, 0.1349, 0.1349, 0.1350, 0.1354, 0.1351, 0.0000, 0.1347, 0.1355,
         0.1349],
        [0.1348, 0.1346, 0.1349, 0.1346, 0.1351, 0.1349, 0.1347, 0.0000, 0.1348,
         0.1350],
        [0.1347, 0.1351, 0.1352, 0.1352, 0.1352, 0.1349, 0.1355, 0.1348, 0.0000,
         0.1348],
        [0.1349, 0.1348, 0.1349, 0.1349, 0.1352, 0.1350, 0.1349, 0.1350, 0.1348,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0150, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28130654
Epoch272: train_loss: 4.2612 recon_acc: 0.1573 val_roc: 0.7155 val_ap: 0.7640 f1: 0.6814 time: 0.2674
thresh 0.4743599
          test_roc: 0.6998 test_ap: 0.7338 test_f1: 0.6748 test_recon_acc: 0.4575
difference_matrix tensor([[0.0000, 0.1345, 0.1350, 0.1348, 0.1348, 0.1347, 0.1347, 0.1346, 0.1346,
         0.1347],
        [0.1345, 0.0000, 0.1347, 0.1346, 0.1348, 0.1345, 0.1348, 0.1345, 0.1349,
         0.1346],
        [0.1350, 0.1347, 0.0000, 0.1347, 0.1356, 0.1349, 0.1348, 0.1348, 0.1351,
         0.1347],
        [0.1348, 0.1346, 0.1347, 0.0000, 0.1351, 0.1350, 0.1348, 0.1344, 0.1350,
         0.1347],
        [0.1348, 0.1348, 0.1356, 0.1351, 0.0000, 0.1349, 0.1352, 0.1349, 0.1351,
         0.1350],
        [0.1347, 0.1345, 0.1349, 0.1350, 0.1349, 0.0000, 0.1349, 0.1347, 0.1347,
         0.1348],
        [0.1347, 0.1348, 0.1348, 0.1348, 0.1352, 0.1349, 0.0000, 0.1345, 0.1353,
         0.1347],
        [0.1346, 0.1345, 0.1348, 0.1344, 0.1349, 0.1347, 0.1345, 0.0000, 0.1346,
         0.1348],
        [0.1346, 0.1349, 0.1351, 0.1350, 0.1351, 0.1347, 0.1353, 0.1346, 0.0000,
         0.1347],
        [0.1347, 0.1346, 0.1347, 0.1347, 0.1350, 0.1348, 0.1347, 0.1348, 0.1347,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0152, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.2809873
Epoch273: train_loss: 4.2594 recon_acc: 0.1567 val_roc: 0.7158 val_ap: 0.7645 f1: 0.6814 time: 0.2585
thresh 0.47450218
          test_roc: 0.7001 test_ap: 0.7342 test_f1: 0.6742 test_recon_acc: 0.4577
difference_matrix tensor([[0.0000, 0.1344, 0.1348, 0.1347, 0.1347, 0.1346, 0.1345, 0.1345, 0.1344,
         0.1345],
        [0.1344, 0.0000, 0.1345, 0.1344, 0.1346, 0.1343, 0.1346, 0.1343, 0.1348,
         0.1344],
        [0.1348, 0.1345, 0.0000, 0.1346, 0.1354, 0.1347, 0.1346, 0.1346, 0.1349,
         0.1346],
        [0.1347, 0.1344, 0.1346, 0.0000, 0.1349, 0.1348, 0.1347, 0.1343, 0.1349,
         0.1346],
        [0.1347, 0.1346, 0.1354, 0.1349, 0.0000, 0.1347, 0.1350, 0.1347, 0.1349,
         0.1348],
        [0.1346, 0.1343, 0.1347, 0.1348, 0.1347, 0.0000, 0.1347, 0.1345, 0.1345,
         0.1347],
        [0.1345, 0.1346, 0.1346, 0.1347, 0.1350, 0.1347, 0.0000, 0.1344, 0.1352,
         0.1345],
        [0.1345, 0.1343, 0.1346, 0.1343, 0.1347, 0.1345, 0.1344, 0.0000, 0.1344,
         0.1346],
        [0.1344, 0.1348, 0.1349, 0.1349, 0.1349, 0.1345, 0.1352, 0.1344, 0.0000,
         0.1345],
        [0.1345, 0.1344, 0.1346, 0.1346, 0.1348, 0.1347, 0.1345, 0.1346, 0.1345,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0154, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28067014
Epoch274: train_loss: 4.2576 recon_acc: 0.1560 val_roc: 0.7162 val_ap: 0.7650 f1: 0.6814 time: 0.2990
thresh 0.47455665
          test_roc: 0.7003 test_ap: 0.7348 test_f1: 0.6742 test_recon_acc: 0.4578
difference_matrix tensor([[0.0000, 0.1342, 0.1347, 0.1345, 0.1345, 0.1344, 0.1343, 0.1343, 0.1342,
         0.1343],
        [0.1342, 0.0000, 0.1343, 0.1343, 0.1345, 0.1341, 0.1344, 0.1341, 0.1346,
         0.1343],
        [0.1347, 0.1343, 0.0000, 0.1344, 0.1352, 0.1346, 0.1344, 0.1344, 0.1347,
         0.1344],
        [0.1345, 0.1343, 0.1344, 0.0000, 0.1347, 0.1347, 0.1345, 0.1341, 0.1347,
         0.1344],
        [0.1345, 0.1345, 0.1352, 0.1347, 0.0000, 0.1345, 0.1348, 0.1346, 0.1347,
         0.1347],
        [0.1344, 0.1341, 0.1346, 0.1347, 0.1345, 0.0000, 0.1345, 0.1344, 0.1344,
         0.1345],
        [0.1343, 0.1344, 0.1344, 0.1345, 0.1348, 0.1345, 0.0000, 0.1342, 0.1350,
         0.1343],
        [0.1343, 0.1341, 0.1344, 0.1341, 0.1346, 0.1344, 0.1342, 0.0000, 0.1343,
         0.1345],
        [0.1342, 0.1346, 0.1347, 0.1347, 0.1347, 0.1344, 0.1350, 0.1343, 0.0000,
         0.1343],
        [0.1343, 0.1343, 0.1344, 0.1344, 0.1347, 0.1345, 0.1343, 0.1345, 0.1343,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0155, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.280355
Epoch275: train_loss: 4.2558 recon_acc: 0.1554 val_roc: 0.7166 val_ap: 0.7656 f1: 0.6814 time: 0.2569
thresh 0.4746089
          test_roc: 0.7006 test_ap: 0.7352 test_f1: 0.6742 test_recon_acc: 0.4578
difference_matrix tensor([[0.0000, 0.1340, 0.1345, 0.1343, 0.1343, 0.1342, 0.1341, 0.1341, 0.1340,
         0.1342],
        [0.1340, 0.0000, 0.1342, 0.1341, 0.1343, 0.1340, 0.1342, 0.1340, 0.1344,
         0.1341],
        [0.1345, 0.1342, 0.0000, 0.1342, 0.1351, 0.1344, 0.1342, 0.1343, 0.1345,
         0.1342],
        [0.1343, 0.1341, 0.1342, 0.0000, 0.1345, 0.1345, 0.1343, 0.1339, 0.1345,
         0.1342],
        [0.1343, 0.1343, 0.1351, 0.1345, 0.0000, 0.1344, 0.1347, 0.1344, 0.1346,
         0.1345],
        [0.1342, 0.1340, 0.1344, 0.1345, 0.1344, 0.0000, 0.1344, 0.1342, 0.1342,
         0.1343],
        [0.1341, 0.1342, 0.1342, 0.1343, 0.1347, 0.1344, 0.0000, 0.1340, 0.1348,
         0.1342],
        [0.1341, 0.1340, 0.1343, 0.1339, 0.1344, 0.1342, 0.1340, 0.0000, 0.1341,
         0.1343],
        [0.1340, 0.1344, 0.1345, 0.1345, 0.1346, 0.1342, 0.1348, 0.1341, 0.0000,
         0.1341],
        [0.1342, 0.1341, 0.1342, 0.1342, 0.1345, 0.1343, 0.1342, 0.1343, 0.1341,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0157, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.28004214
Epoch276: train_loss: 4.2541 recon_acc: 0.1548 val_roc: 0.7167 val_ap: 0.7659 f1: 0.6814 time: 0.2620
thresh 0.47465903
          test_roc: 0.7010 test_ap: 0.7356 test_f1: 0.6735 test_recon_acc: 0.4579
difference_matrix tensor([[0.0000, 0.1338, 0.1343, 0.1341, 0.1341, 0.1341, 0.1340, 0.1340, 0.1339,
         0.1340],
        [0.1338, 0.0000, 0.1340, 0.1339, 0.1341, 0.1338, 0.1341, 0.1338, 0.1342,
         0.1339],
        [0.1343, 0.1340, 0.0000, 0.1341, 0.1349, 0.1342, 0.1341, 0.1341, 0.1344,
         0.1341],
        [0.1341, 0.1339, 0.1341, 0.0000, 0.1344, 0.1343, 0.1341, 0.1338, 0.1344,
         0.1340],
        [0.1341, 0.1341, 0.1349, 0.1344, 0.0000, 0.1342, 0.1345, 0.1342, 0.1344,
         0.1343],
        [0.1341, 0.1338, 0.1342, 0.1343, 0.1342, 0.0000, 0.1342, 0.1340, 0.1340,
         0.1342],
        [0.1340, 0.1341, 0.1341, 0.1341, 0.1345, 0.1342, 0.0000, 0.1338, 0.1347,
         0.1340],
        [0.1340, 0.1338, 0.1341, 0.1338, 0.1342, 0.1340, 0.1338, 0.0000, 0.1339,
         0.1341],
        [0.1339, 0.1342, 0.1344, 0.1344, 0.1344, 0.1340, 0.1347, 0.1339, 0.0000,
         0.1340],
        [0.1340, 0.1339, 0.1341, 0.1340, 0.1343, 0.1342, 0.1340, 0.1341, 0.1340,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0159, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.279732
Epoch277: train_loss: 4.2523 recon_acc: 0.1542 val_roc: 0.7174 val_ap: 0.7668 f1: 0.6814 time: 0.2600
thresh 0.46540594
          test_roc: 0.7013 test_ap: 0.7360 test_f1: 0.6741 test_recon_acc: 0.4418
difference_matrix tensor([[0.0000, 0.1337, 0.1341, 0.1340, 0.1340, 0.1339, 0.1338, 0.1338, 0.1337,
         0.1338],
        [0.1337, 0.0000, 0.1338, 0.1337, 0.1340, 0.1336, 0.1339, 0.1336, 0.1341,
         0.1337],
        [0.1341, 0.1338, 0.0000, 0.1339, 0.1347, 0.1341, 0.1339, 0.1339, 0.1342,
         0.1339],
        [0.1340, 0.1337, 0.1339, 0.0000, 0.1342, 0.1342, 0.1340, 0.1336, 0.1342,
         0.1339],
        [0.1340, 0.1340, 0.1347, 0.1342, 0.0000, 0.1340, 0.1343, 0.1341, 0.1342,
         0.1341],
        [0.1339, 0.1336, 0.1341, 0.1342, 0.1340, 0.0000, 0.1340, 0.1339, 0.1339,
         0.1340],
        [0.1338, 0.1339, 0.1339, 0.1340, 0.1343, 0.1340, 0.0000, 0.1337, 0.1345,
         0.1338],
        [0.1338, 0.1336, 0.1339, 0.1336, 0.1341, 0.1339, 0.1337, 0.0000, 0.1338,
         0.1340],
        [0.1337, 0.1341, 0.1342, 0.1342, 0.1342, 0.1339, 0.1345, 0.1338, 0.0000,
         0.1338],
        [0.1338, 0.1337, 0.1339, 0.1339, 0.1341, 0.1340, 0.1338, 0.1340, 0.1338,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0160, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33010247
Epoch278: train_loss: 4.2506 recon_acc: 0.2223 val_roc: 0.7178 val_ap: 0.7672 f1: 0.6810 time: 0.2815
thresh 0.46654728
          test_roc: 0.7016 test_ap: 0.7364 test_f1: 0.6741 test_recon_acc: 0.4438
difference_matrix tensor([[0.0000, 0.1335, 0.1340, 0.1338, 0.1338, 0.1337, 0.1336, 0.1336, 0.1335,
         0.1337],
        [0.1335, 0.0000, 0.1337, 0.1336, 0.1338, 0.1335, 0.1337, 0.1334, 0.1339,
         0.1336],
        [0.1340, 0.1337, 0.0000, 0.1337, 0.1345, 0.1339, 0.1337, 0.1338, 0.1341,
         0.1337],
        [0.1338, 0.1336, 0.1337, 0.0000, 0.1340, 0.1340, 0.1338, 0.1334, 0.1340,
         0.1337],
        [0.1338, 0.1338, 0.1345, 0.1340, 0.0000, 0.1338, 0.1342, 0.1339, 0.1340,
         0.1340],
        [0.1337, 0.1335, 0.1339, 0.1340, 0.1338, 0.0000, 0.1339, 0.1337, 0.1337,
         0.1338],
        [0.1336, 0.1337, 0.1337, 0.1338, 0.1342, 0.1339, 0.0000, 0.1335, 0.1343,
         0.1337],
        [0.1336, 0.1334, 0.1338, 0.1334, 0.1339, 0.1337, 0.1335, 0.0000, 0.1336,
         0.1338],
        [0.1335, 0.1339, 0.1341, 0.1340, 0.1340, 0.1337, 0.1343, 0.1336, 0.0000,
         0.1336],
        [0.1337, 0.1336, 0.1337, 0.1337, 0.1340, 0.1338, 0.1337, 0.1338, 0.1336,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0162, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3300774
Epoch279: train_loss: 4.2489 recon_acc: 0.2220 val_roc: 0.7180 val_ap: 0.7676 f1: 0.6810 time: 0.2974
thresh 0.46701357
          test_roc: 0.7019 test_ap: 0.7370 test_f1: 0.6747 test_recon_acc: 0.4445
difference_matrix tensor([[0.0000, 0.1333, 0.1338, 0.1336, 0.1336, 0.1336, 0.1335, 0.1334, 0.1334,
         0.1335],
        [0.1333, 0.0000, 0.1335, 0.1334, 0.1336, 0.1333, 0.1336, 0.1333, 0.1337,
         0.1334],
        [0.1338, 0.1335, 0.0000, 0.1336, 0.1344, 0.1337, 0.1336, 0.1336, 0.1339,
         0.1336],
        [0.1336, 0.1334, 0.1336, 0.0000, 0.1339, 0.1338, 0.1336, 0.1332, 0.1338,
         0.1335],
        [0.1336, 0.1336, 0.1344, 0.1339, 0.0000, 0.1337, 0.1340, 0.1337, 0.1339,
         0.1338],
        [0.1336, 0.1333, 0.1337, 0.1338, 0.1337, 0.0000, 0.1337, 0.1335, 0.1335,
         0.1337],
        [0.1335, 0.1336, 0.1336, 0.1336, 0.1340, 0.1337, 0.0000, 0.1333, 0.1342,
         0.1335],
        [0.1334, 0.1333, 0.1336, 0.1332, 0.1337, 0.1335, 0.1333, 0.0000, 0.1334,
         0.1336],
        [0.1334, 0.1337, 0.1339, 0.1338, 0.1339, 0.1335, 0.1342, 0.1334, 0.0000,
         0.1335],
        [0.1335, 0.1334, 0.1336, 0.1335, 0.1338, 0.1337, 0.1335, 0.1336, 0.1335,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0164, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33005506
Epoch280: train_loss: 4.2472 recon_acc: 0.2218 val_roc: 0.7184 val_ap: 0.7680 f1: 0.6810 time: 0.2516
thresh 0.46676204
          test_roc: 0.7021 test_ap: 0.7372 test_f1: 0.6747 test_recon_acc: 0.4440
difference_matrix tensor([[0.0000, 0.1332, 0.1336, 0.1335, 0.1335, 0.1334, 0.1333, 0.1333, 0.1332,
         0.1333],
        [0.1332, 0.0000, 0.1333, 0.1332, 0.1334, 0.1331, 0.1334, 0.1331, 0.1336,
         0.1332],
        [0.1336, 0.1333, 0.0000, 0.1334, 0.1342, 0.1336, 0.1334, 0.1334, 0.1337,
         0.1334],
        [0.1335, 0.1332, 0.1334, 0.0000, 0.1337, 0.1337, 0.1335, 0.1331, 0.1337,
         0.1334],
        [0.1335, 0.1334, 0.1342, 0.1337, 0.0000, 0.1335, 0.1338, 0.1336, 0.1337,
         0.1336],
        [0.1334, 0.1331, 0.1336, 0.1337, 0.1335, 0.0000, 0.1335, 0.1334, 0.1334,
         0.1335],
        [0.1333, 0.1334, 0.1334, 0.1335, 0.1338, 0.1335, 0.0000, 0.1332, 0.1340,
         0.1333],
        [0.1333, 0.1331, 0.1334, 0.1331, 0.1336, 0.1334, 0.1332, 0.0000, 0.1333,
         0.1334],
        [0.1332, 0.1336, 0.1337, 0.1337, 0.1337, 0.1334, 0.1340, 0.1333, 0.0000,
         0.1333],
        [0.1333, 0.1332, 0.1334, 0.1334, 0.1336, 0.1335, 0.1333, 0.1334, 0.1333,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0166, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33003515
Epoch281: train_loss: 4.2455 recon_acc: 0.2215 val_roc: 0.7187 val_ap: 0.7683 f1: 0.6810 time: 0.2591
thresh 0.46651345
          test_roc: 0.7024 test_ap: 0.7376 test_f1: 0.6747 test_recon_acc: 0.4435
difference_matrix tensor([[0.0000, 0.1330, 0.1335, 0.1333, 0.1333, 0.1332, 0.1331, 0.1331, 0.1330,
         0.1332],
        [0.1330, 0.0000, 0.1332, 0.1331, 0.1333, 0.1330, 0.1332, 0.1329, 0.1334,
         0.1331],
        [0.1335, 0.1332, 0.0000, 0.1332, 0.1340, 0.1334, 0.1332, 0.1333, 0.1336,
         0.1332],
        [0.1333, 0.1331, 0.1332, 0.0000, 0.1335, 0.1335, 0.1333, 0.1329, 0.1335,
         0.1332],
        [0.1333, 0.1333, 0.1340, 0.1335, 0.0000, 0.1333, 0.1337, 0.1334, 0.1335,
         0.1335],
        [0.1332, 0.1330, 0.1334, 0.1335, 0.1333, 0.0000, 0.1334, 0.1332, 0.1332,
         0.1333],
        [0.1331, 0.1332, 0.1332, 0.1333, 0.1337, 0.1334, 0.0000, 0.1330, 0.1338,
         0.1332],
        [0.1331, 0.1329, 0.1333, 0.1329, 0.1334, 0.1332, 0.1330, 0.0000, 0.1331,
         0.1333],
        [0.1330, 0.1334, 0.1336, 0.1335, 0.1335, 0.1332, 0.1338, 0.1331, 0.0000,
         0.1331],
        [0.1332, 0.1331, 0.1332, 0.1332, 0.1335, 0.1333, 0.1332, 0.1333, 0.1331,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0167, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34382308
Epoch282: train_loss: 4.2439 recon_acc: 0.2417 val_roc: 0.7191 val_ap: 0.7687 f1: 0.6811 time: 0.2962
thresh 0.47110125
          test_roc: 0.7026 test_ap: 0.7378 test_f1: 0.6735 test_recon_acc: 0.4515
difference_matrix tensor([[0.0000, 0.1328, 0.1333, 0.1331, 0.1331, 0.1331, 0.1330, 0.1329, 0.1329,
         0.1330],
        [0.1328, 0.0000, 0.1330, 0.1329, 0.1331, 0.1328, 0.1330, 0.1328, 0.1332,
         0.1329],
        [0.1333, 0.1330, 0.0000, 0.1331, 0.1339, 0.1332, 0.1331, 0.1331, 0.1334,
         0.1331],
        [0.1331, 0.1329, 0.1331, 0.0000, 0.1334, 0.1333, 0.1331, 0.1327, 0.1334,
         0.1330],
        [0.1331, 0.1331, 0.1339, 0.1334, 0.0000, 0.1332, 0.1335, 0.1332, 0.1334,
         0.1333],
        [0.1331, 0.1328, 0.1332, 0.1333, 0.1332, 0.0000, 0.1332, 0.1330, 0.1330,
         0.1332],
        [0.1330, 0.1330, 0.1331, 0.1331, 0.1335, 0.1332, 0.0000, 0.1328, 0.1336,
         0.1330],
        [0.1329, 0.1328, 0.1331, 0.1327, 0.1332, 0.1330, 0.1328, 0.0000, 0.1329,
         0.1331],
        [0.1329, 0.1332, 0.1334, 0.1334, 0.1334, 0.1330, 0.1336, 0.1329, 0.0000,
         0.1330],
        [0.1330, 0.1329, 0.1331, 0.1330, 0.1333, 0.1332, 0.1330, 0.1331, 0.1330,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0169, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34385997
Epoch283: train_loss: 4.2422 recon_acc: 0.2415 val_roc: 0.7193 val_ap: 0.7691 f1: 0.6811 time: 0.2648
thresh 0.47223625
          test_roc: 0.7030 test_ap: 0.7383 test_f1: 0.6735 test_recon_acc: 0.4534
difference_matrix tensor([[0.0000, 0.1327, 0.1331, 0.1330, 0.1330, 0.1329, 0.1328, 0.1328, 0.1327,
         0.1328],
        [0.1327, 0.0000, 0.1328, 0.1327, 0.1329, 0.1326, 0.1329, 0.1326, 0.1331,
         0.1327],
        [0.1331, 0.1328, 0.0000, 0.1329, 0.1337, 0.1331, 0.1329, 0.1329, 0.1332,
         0.1329],
        [0.1330, 0.1327, 0.1329, 0.0000, 0.1332, 0.1332, 0.1330, 0.1326, 0.1332,
         0.1329],
        [0.1330, 0.1329, 0.1337, 0.1332, 0.0000, 0.1330, 0.1333, 0.1331, 0.1332,
         0.1331],
        [0.1329, 0.1326, 0.1331, 0.1332, 0.1330, 0.0000, 0.1330, 0.1329, 0.1329,
         0.1330],
        [0.1328, 0.1329, 0.1329, 0.1330, 0.1333, 0.1330, 0.0000, 0.1327, 0.1335,
         0.1328],
        [0.1328, 0.1326, 0.1329, 0.1326, 0.1331, 0.1329, 0.1327, 0.0000, 0.1328,
         0.1329],
        [0.1327, 0.1331, 0.1332, 0.1332, 0.1332, 0.1329, 0.1335, 0.1328, 0.0000,
         0.1328],
        [0.1328, 0.1327, 0.1329, 0.1329, 0.1331, 0.1330, 0.1328, 0.1329, 0.1328,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0171, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32798713
Epoch284: train_loss: 4.2406 recon_acc: 0.2179 val_roc: 0.7198 val_ap: 0.7695 f1: 0.6820 time: 0.2777
thresh 0.473369
          test_roc: 0.7035 test_ap: 0.7388 test_f1: 0.6735 test_recon_acc: 0.4554
difference_matrix tensor([[0.0000, 0.1325, 0.1330, 0.1328, 0.1328, 0.1327, 0.1326, 0.1326, 0.1325,
         0.1327],
        [0.1325, 0.0000, 0.1327, 0.1326, 0.1328, 0.1325, 0.1327, 0.1324, 0.1329,
         0.1326],
        [0.1330, 0.1327, 0.0000, 0.1327, 0.1335, 0.1329, 0.1327, 0.1328, 0.1331,
         0.1327],
        [0.1328, 0.1326, 0.1327, 0.0000, 0.1330, 0.1330, 0.1328, 0.1324, 0.1330,
         0.1327],
        [0.1328, 0.1328, 0.1335, 0.1330, 0.0000, 0.1328, 0.1332, 0.1329, 0.1331,
         0.1330],
        [0.1327, 0.1325, 0.1329, 0.1330, 0.1328, 0.0000, 0.1329, 0.1327, 0.1327,
         0.1328],
        [0.1326, 0.1327, 0.1327, 0.1328, 0.1332, 0.1329, 0.0000, 0.1325, 0.1333,
         0.1327],
        [0.1326, 0.1324, 0.1328, 0.1324, 0.1329, 0.1327, 0.1325, 0.0000, 0.1326,
         0.1328],
        [0.1325, 0.1329, 0.1331, 0.1330, 0.1331, 0.1327, 0.1333, 0.1326, 0.0000,
         0.1326],
        [0.1327, 0.1326, 0.1327, 0.1327, 0.1330, 0.1328, 0.1327, 0.1328, 0.1326,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0172, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3285058
Epoch285: train_loss: 4.2389 recon_acc: 0.2185 val_roc: 0.7201 val_ap: 0.7699 f1: 0.6820 time: 0.2844
thresh 0.474212
          test_roc: 0.7038 test_ap: 0.7392 test_f1: 0.6735 test_recon_acc: 0.4568
difference_matrix tensor([[0.0000, 0.1323, 0.1328, 0.1326, 0.1326, 0.1326, 0.1325, 0.1324, 0.1324,
         0.1325],
        [0.1323, 0.0000, 0.1325, 0.1324, 0.1326, 0.1323, 0.1325, 0.1323, 0.1327,
         0.1324],
        [0.1328, 0.1325, 0.0000, 0.1326, 0.1334, 0.1327, 0.1326, 0.1326, 0.1329,
         0.1326],
        [0.1326, 0.1324, 0.1326, 0.0000, 0.1329, 0.1328, 0.1326, 0.1322, 0.1329,
         0.1325],
        [0.1326, 0.1326, 0.1334, 0.1329, 0.0000, 0.1327, 0.1330, 0.1327, 0.1329,
         0.1328],
        [0.1326, 0.1323, 0.1327, 0.1328, 0.1327, 0.0000, 0.1327, 0.1325, 0.1326,
         0.1327],
        [0.1325, 0.1325, 0.1326, 0.1326, 0.1330, 0.1327, 0.0000, 0.1323, 0.1332,
         0.1325],
        [0.1324, 0.1323, 0.1326, 0.1322, 0.1327, 0.1325, 0.1323, 0.0000, 0.1324,
         0.1326],
        [0.1324, 0.1327, 0.1329, 0.1329, 0.1329, 0.1326, 0.1332, 0.1324, 0.0000,
         0.1325],
        [0.1325, 0.1324, 0.1326, 0.1325, 0.1328, 0.1327, 0.1325, 0.1326, 0.1325,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0174, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3290238
Epoch286: train_loss: 4.2373 recon_acc: 0.2190 val_roc: 0.7204 val_ap: 0.7701 f1: 0.6820 time: 0.2679
thresh 0.4741252
          test_roc: 0.7041 test_ap: 0.7395 test_f1: 0.6735 test_recon_acc: 0.4566
difference_matrix tensor([[0.0000, 0.1322, 0.1326, 0.1325, 0.1325, 0.1324, 0.1323, 0.1323, 0.1322,
         0.1323],
        [0.1322, 0.0000, 0.1323, 0.1322, 0.1324, 0.1321, 0.1324, 0.1321, 0.1326,
         0.1322],
        [0.1326, 0.1323, 0.0000, 0.1324, 0.1332, 0.1326, 0.1324, 0.1324, 0.1327,
         0.1324],
        [0.1325, 0.1322, 0.1324, 0.0000, 0.1327, 0.1327, 0.1325, 0.1321, 0.1327,
         0.1324],
        [0.1325, 0.1324, 0.1332, 0.1327, 0.0000, 0.1325, 0.1328, 0.1326, 0.1327,
         0.1327],
        [0.1324, 0.1321, 0.1326, 0.1327, 0.1325, 0.0000, 0.1326, 0.1324, 0.1324,
         0.1325],
        [0.1323, 0.1324, 0.1324, 0.1325, 0.1328, 0.1326, 0.0000, 0.1322, 0.1330,
         0.1323],
        [0.1323, 0.1321, 0.1324, 0.1321, 0.1326, 0.1324, 0.1322, 0.0000, 0.1323,
         0.1325],
        [0.1322, 0.1326, 0.1327, 0.1327, 0.1327, 0.1324, 0.1330, 0.1323, 0.0000,
         0.1323],
        [0.1323, 0.1322, 0.1324, 0.1324, 0.1327, 0.1325, 0.1323, 0.1325, 0.1323,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0175, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32954097
Epoch287: train_loss: 4.2357 recon_acc: 0.2195 val_roc: 0.7209 val_ap: 0.7705 f1: 0.6832 time: 0.2598
thresh 0.47403786
          test_roc: 0.7044 test_ap: 0.7399 test_f1: 0.6729 test_recon_acc: 0.4564
difference_matrix tensor([[0.0000, 0.1320, 0.1325, 0.1323, 0.1323, 0.1323, 0.1321, 0.1321, 0.1320,
         0.1322],
        [0.1320, 0.0000, 0.1322, 0.1321, 0.1323, 0.1320, 0.1322, 0.1319, 0.1324,
         0.1321],
        [0.1325, 0.1322, 0.0000, 0.1322, 0.1331, 0.1324, 0.1322, 0.1323, 0.1326,
         0.1322],
        [0.1323, 0.1321, 0.1322, 0.0000, 0.1325, 0.1325, 0.1323, 0.1319, 0.1325,
         0.1322],
        [0.1323, 0.1323, 0.1331, 0.1325, 0.0000, 0.1324, 0.1327, 0.1324, 0.1326,
         0.1325],
        [0.1323, 0.1320, 0.1324, 0.1325, 0.1324, 0.0000, 0.1324, 0.1322, 0.1322,
         0.1323],
        [0.1321, 0.1322, 0.1322, 0.1323, 0.1327, 0.1324, 0.0000, 0.1320, 0.1328,
         0.1322],
        [0.1321, 0.1319, 0.1323, 0.1319, 0.1324, 0.1322, 0.1320, 0.0000, 0.1321,
         0.1323],
        [0.1320, 0.1324, 0.1326, 0.1325, 0.1326, 0.1322, 0.1328, 0.1321, 0.0000,
         0.1321],
        [0.1322, 0.1321, 0.1322, 0.1322, 0.1325, 0.1323, 0.1322, 0.1323, 0.1321,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0177, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3299689
Epoch288: train_loss: 4.2341 recon_acc: 0.2200 val_roc: 0.7212 val_ap: 0.7708 f1: 0.6832 time: 0.2729
thresh 0.47395012
          test_roc: 0.7047 test_ap: 0.7403 test_f1: 0.6729 test_recon_acc: 0.4562
difference_matrix tensor([[0.0000, 0.1318, 0.1323, 0.1321, 0.1321, 0.1321, 0.1320, 0.1320, 0.1319,
         0.1320],
        [0.1318, 0.0000, 0.1320, 0.1319, 0.1321, 0.1318, 0.1321, 0.1318, 0.1322,
         0.1319],
        [0.1323, 0.1320, 0.0000, 0.1321, 0.1329, 0.1323, 0.1321, 0.1321, 0.1324,
         0.1321],
        [0.1321, 0.1319, 0.1321, 0.0000, 0.1324, 0.1324, 0.1321, 0.1318, 0.1324,
         0.1320],
        [0.1321, 0.1321, 0.1329, 0.1324, 0.0000, 0.1322, 0.1325, 0.1322, 0.1324,
         0.1323],
        [0.1321, 0.1318, 0.1323, 0.1324, 0.1322, 0.0000, 0.1322, 0.1320, 0.1321,
         0.1322],
        [0.1320, 0.1321, 0.1321, 0.1321, 0.1325, 0.1322, 0.0000, 0.1318, 0.1327,
         0.1320],
        [0.1320, 0.1318, 0.1321, 0.1318, 0.1322, 0.1320, 0.1318, 0.0000, 0.1320,
         0.1321],
        [0.1319, 0.1322, 0.1324, 0.1324, 0.1324, 0.1321, 0.1327, 0.1320, 0.0000,
         0.1320],
        [0.1320, 0.1319, 0.1321, 0.1320, 0.1323, 0.1322, 0.1320, 0.1321, 0.1320,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0179, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32997015
Epoch289: train_loss: 4.2325 recon_acc: 0.2198 val_roc: 0.7215 val_ap: 0.7711 f1: 0.6832 time: 0.2997
thresh 0.47386155
          test_roc: 0.7049 test_ap: 0.7405 test_f1: 0.6729 test_recon_acc: 0.4561
difference_matrix tensor([[0.0000, 0.1317, 0.1322, 0.1320, 0.1320, 0.1319, 0.1318, 0.1318, 0.1317,
         0.1318],
        [0.1317, 0.0000, 0.1319, 0.1317, 0.1319, 0.1317, 0.1319, 0.1316, 0.1321,
         0.1318],
        [0.1322, 0.1319, 0.0000, 0.1319, 0.1327, 0.1321, 0.1319, 0.1320, 0.1323,
         0.1319],
        [0.1320, 0.1317, 0.1319, 0.0000, 0.1322, 0.1322, 0.1320, 0.1316, 0.1322,
         0.1319],
        [0.1320, 0.1319, 0.1327, 0.1322, 0.0000, 0.1320, 0.1324, 0.1321, 0.1322,
         0.1322],
        [0.1319, 0.1317, 0.1321, 0.1322, 0.1320, 0.0000, 0.1321, 0.1319, 0.1319,
         0.1320],
        [0.1318, 0.1319, 0.1319, 0.1320, 0.1324, 0.1321, 0.0000, 0.1317, 0.1325,
         0.1319],
        [0.1318, 0.1316, 0.1320, 0.1316, 0.1321, 0.1319, 0.1317, 0.0000, 0.1318,
         0.1320],
        [0.1317, 0.1321, 0.1323, 0.1322, 0.1322, 0.1319, 0.1325, 0.1318, 0.0000,
         0.1318],
        [0.1318, 0.1318, 0.1319, 0.1319, 0.1322, 0.1320, 0.1319, 0.1320, 0.1318,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0180, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32997414
Epoch290: train_loss: 4.2310 recon_acc: 0.2196 val_roc: 0.7218 val_ap: 0.7714 f1: 0.6820 time: 0.2493
thresh 0.47377223
          test_roc: 0.7052 test_ap: 0.7409 test_f1: 0.6729 test_recon_acc: 0.4559
difference_matrix tensor([[0.0000, 0.1315, 0.1320, 0.1318, 0.1318, 0.1318, 0.1316, 0.1316, 0.1316,
         0.1317],
        [0.1315, 0.0000, 0.1317, 0.1316, 0.1318, 0.1315, 0.1317, 0.1315, 0.1319,
         0.1316],
        [0.1320, 0.1317, 0.0000, 0.1317, 0.1326, 0.1319, 0.1318, 0.1318, 0.1321,
         0.1318],
        [0.1318, 0.1316, 0.1317, 0.0000, 0.1321, 0.1320, 0.1318, 0.1314, 0.1321,
         0.1317],
        [0.1318, 0.1318, 0.1326, 0.1321, 0.0000, 0.1319, 0.1322, 0.1319, 0.1321,
         0.1320],
        [0.1318, 0.1315, 0.1319, 0.1320, 0.1319, 0.0000, 0.1319, 0.1317, 0.1318,
         0.1319],
        [0.1316, 0.1317, 0.1318, 0.1318, 0.1322, 0.1319, 0.0000, 0.1315, 0.1323,
         0.1317],
        [0.1316, 0.1315, 0.1318, 0.1314, 0.1319, 0.1317, 0.1315, 0.0000, 0.1316,
         0.1318],
        [0.1316, 0.1319, 0.1321, 0.1321, 0.1321, 0.1318, 0.1323, 0.1316, 0.0000,
         0.1317],
        [0.1317, 0.1316, 0.1318, 0.1317, 0.1320, 0.1319, 0.1317, 0.1318, 0.1317,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0182, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32998088
Epoch291: train_loss: 4.2294 recon_acc: 0.2194 val_roc: 0.7223 val_ap: 0.7719 f1: 0.6820 time: 0.2866
thresh 0.47368228
          test_roc: 0.7055 test_ap: 0.7413 test_f1: 0.6729 test_recon_acc: 0.4557
difference_matrix tensor([[0.0000, 0.1314, 0.1318, 0.1316, 0.1316, 0.1316, 0.1315, 0.1315, 0.1314,
         0.1315],
        [0.1314, 0.0000, 0.1315, 0.1314, 0.1316, 0.1313, 0.1316, 0.1313, 0.1318,
         0.1314],
        [0.1318, 0.1315, 0.0000, 0.1316, 0.1324, 0.1318, 0.1316, 0.1316, 0.1319,
         0.1316],
        [0.1316, 0.1314, 0.1316, 0.0000, 0.1319, 0.1319, 0.1316, 0.1313, 0.1319,
         0.1316],
        [0.1316, 0.1316, 0.1324, 0.1319, 0.0000, 0.1317, 0.1320, 0.1318, 0.1319,
         0.1318],
        [0.1316, 0.1313, 0.1318, 0.1319, 0.1317, 0.0000, 0.1317, 0.1316, 0.1316,
         0.1317],
        [0.1315, 0.1316, 0.1316, 0.1316, 0.1320, 0.1317, 0.0000, 0.1313, 0.1322,
         0.1315],
        [0.1315, 0.1313, 0.1316, 0.1313, 0.1318, 0.1316, 0.1313, 0.0000, 0.1315,
         0.1316],
        [0.1314, 0.1318, 0.1319, 0.1319, 0.1319, 0.1316, 0.1322, 0.1315, 0.0000,
         0.1315],
        [0.1315, 0.1314, 0.1316, 0.1316, 0.1318, 0.1317, 0.1315, 0.1316, 0.1315,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0184, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32999042
Epoch292: train_loss: 4.2279 recon_acc: 0.2192 val_roc: 0.7225 val_ap: 0.7722 f1: 0.6820 time: 0.2900
thresh 0.47359192
          test_roc: 0.7058 test_ap: 0.7416 test_f1: 0.6723 test_recon_acc: 0.4555
difference_matrix tensor([[0.0000, 0.1312, 0.1317, 0.1315, 0.1315, 0.1315, 0.1313, 0.1313, 0.1312,
         0.1314],
        [0.1312, 0.0000, 0.1314, 0.1313, 0.1315, 0.1312, 0.1314, 0.1311, 0.1316,
         0.1313],
        [0.1317, 0.1314, 0.0000, 0.1314, 0.1322, 0.1316, 0.1314, 0.1315, 0.1318,
         0.1315],
        [0.1315, 0.1313, 0.1314, 0.0000, 0.1317, 0.1317, 0.1315, 0.1311, 0.1317,
         0.1314],
        [0.1315, 0.1315, 0.1322, 0.1317, 0.0000, 0.1315, 0.1319, 0.1316, 0.1318,
         0.1317],
        [0.1315, 0.1312, 0.1316, 0.1317, 0.1315, 0.0000, 0.1316, 0.1314, 0.1314,
         0.1315],
        [0.1313, 0.1314, 0.1314, 0.1315, 0.1319, 0.1316, 0.0000, 0.1312, 0.1320,
         0.1314],
        [0.1313, 0.1311, 0.1315, 0.1311, 0.1316, 0.1314, 0.1312, 0.0000, 0.1313,
         0.1315],
        [0.1312, 0.1316, 0.1318, 0.1317, 0.1318, 0.1314, 0.1320, 0.1313, 0.0000,
         0.1313],
        [0.1314, 0.1313, 0.1315, 0.1314, 0.1317, 0.1315, 0.1314, 0.1315, 0.1313,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0185, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33000284
Epoch293: train_loss: 4.2263 recon_acc: 0.2190 val_roc: 0.7229 val_ap: 0.7726 f1: 0.6820 time: 0.3008
thresh 0.473501
          test_roc: 0.7061 test_ap: 0.7421 test_f1: 0.6723 test_recon_acc: 0.4553
difference_matrix tensor([[0.0000, 0.1310, 0.1315, 0.1313, 0.1313, 0.1313, 0.1312, 0.1312, 0.1311,
         0.1312],
        [0.1310, 0.0000, 0.1312, 0.1311, 0.1313, 0.1310, 0.1312, 0.1310, 0.1314,
         0.1311],
        [0.1315, 0.1312, 0.0000, 0.1313, 0.1321, 0.1315, 0.1313, 0.1313, 0.1316,
         0.1313],
        [0.1313, 0.1311, 0.1313, 0.0000, 0.1316, 0.1316, 0.1313, 0.1310, 0.1316,
         0.1312],
        [0.1313, 0.1313, 0.1321, 0.1316, 0.0000, 0.1314, 0.1317, 0.1314, 0.1316,
         0.1315],
        [0.1313, 0.1310, 0.1315, 0.1316, 0.1314, 0.0000, 0.1314, 0.1313, 0.1313,
         0.1314],
        [0.1312, 0.1312, 0.1313, 0.1313, 0.1317, 0.1314, 0.0000, 0.1310, 0.1319,
         0.1312],
        [0.1312, 0.1310, 0.1313, 0.1310, 0.1314, 0.1313, 0.1310, 0.0000, 0.1312,
         0.1313],
        [0.1311, 0.1314, 0.1316, 0.1316, 0.1316, 0.1313, 0.1319, 0.1312, 0.0000,
         0.1312],
        [0.1312, 0.1311, 0.1313, 0.1312, 0.1315, 0.1314, 0.1312, 0.1313, 0.1312,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0187, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3300182
Epoch294: train_loss: 4.2248 recon_acc: 0.2188 val_roc: 0.7233 val_ap: 0.7731 f1: 0.6820 time: 0.2590
thresh 0.45675576
          test_roc: 0.7064 test_ap: 0.7425 test_f1: 0.6728 test_recon_acc: 0.4259
difference_matrix tensor([[0.0000, 0.1309, 0.1314, 0.1312, 0.1312, 0.1311, 0.1310, 0.1310, 0.1309,
         0.1310],
        [0.1309, 0.0000, 0.1311, 0.1309, 0.1311, 0.1309, 0.1311, 0.1308, 0.1313,
         0.1310],
        [0.1314, 0.1311, 0.0000, 0.1311, 0.1319, 0.1313, 0.1311, 0.1312, 0.1315,
         0.1311],
        [0.1312, 0.1309, 0.1311, 0.0000, 0.1314, 0.1314, 0.1312, 0.1308, 0.1314,
         0.1311],
        [0.1312, 0.1311, 0.1319, 0.1314, 0.0000, 0.1312, 0.1316, 0.1313, 0.1314,
         0.1314],
        [0.1311, 0.1309, 0.1313, 0.1314, 0.1312, 0.0000, 0.1313, 0.1311, 0.1311,
         0.1312],
        [0.1310, 0.1311, 0.1311, 0.1312, 0.1316, 0.1313, 0.0000, 0.1309, 0.1317,
         0.1311],
        [0.1310, 0.1308, 0.1312, 0.1308, 0.1313, 0.1311, 0.1309, 0.0000, 0.1310,
         0.1312],
        [0.1309, 0.1313, 0.1315, 0.1314, 0.1314, 0.1311, 0.1317, 0.1310, 0.0000,
         0.1310],
        [0.1310, 0.1310, 0.1311, 0.1311, 0.1314, 0.1312, 0.1311, 0.1312, 0.1310,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0188, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33003634
Epoch295: train_loss: 4.2233 recon_acc: 0.2187 val_roc: 0.7235 val_ap: 0.7732 f1: 0.6820 time: 0.2811
thresh 0.46322232
          test_roc: 0.7067 test_ap: 0.7428 test_f1: 0.6728 test_recon_acc: 0.4371
difference_matrix tensor([[0.0000, 0.1307, 0.1312, 0.1310, 0.1310, 0.1310, 0.1308, 0.1308, 0.1308,
         0.1309],
        [0.1307, 0.0000, 0.1309, 0.1308, 0.1310, 0.1307, 0.1309, 0.1307, 0.1311,
         0.1308],
        [0.1312, 0.1309, 0.0000, 0.1310, 0.1318, 0.1312, 0.1310, 0.1310, 0.1313,
         0.1310],
        [0.1310, 0.1308, 0.1310, 0.0000, 0.1313, 0.1313, 0.1310, 0.1306, 0.1313,
         0.1309],
        [0.1310, 0.1310, 0.1318, 0.1313, 0.0000, 0.1311, 0.1314, 0.1311, 0.1313,
         0.1312],
        [0.1310, 0.1307, 0.1312, 0.1313, 0.1311, 0.0000, 0.1311, 0.1309, 0.1310,
         0.1311],
        [0.1308, 0.1309, 0.1310, 0.1310, 0.1314, 0.1311, 0.0000, 0.1307, 0.1315,
         0.1309],
        [0.1308, 0.1307, 0.1310, 0.1306, 0.1311, 0.1309, 0.1307, 0.0000, 0.1309,
         0.1310],
        [0.1308, 0.1311, 0.1313, 0.1313, 0.1313, 0.1310, 0.1315, 0.1309, 0.0000,
         0.1309],
        [0.1309, 0.1308, 0.1310, 0.1309, 0.1312, 0.1311, 0.1309, 0.1310, 0.1309,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0190, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3409242
Epoch296: train_loss: 4.2218 recon_acc: 0.2346 val_roc: 0.7238 val_ap: 0.7736 f1: 0.6811 time: 0.2781
thresh 0.4631437
          test_roc: 0.7071 test_ap: 0.7432 test_f1: 0.6728 test_recon_acc: 0.4369
difference_matrix tensor([[0.0000, 0.1306, 0.1310, 0.1308, 0.1309, 0.1308, 0.1307, 0.1307, 0.1306,
         0.1307],
        [0.1306, 0.0000, 0.1308, 0.1306, 0.1308, 0.1306, 0.1308, 0.1305, 0.1310,
         0.1306],
        [0.1310, 0.1308, 0.0000, 0.1308, 0.1316, 0.1310, 0.1308, 0.1309, 0.1312,
         0.1308],
        [0.1308, 0.1306, 0.1308, 0.0000, 0.1311, 0.1311, 0.1308, 0.1305, 0.1311,
         0.1308],
        [0.1309, 0.1308, 0.1316, 0.1311, 0.0000, 0.1309, 0.1312, 0.1310, 0.1311,
         0.1311],
        [0.1308, 0.1306, 0.1310, 0.1311, 0.1309, 0.0000, 0.1310, 0.1308, 0.1308,
         0.1309],
        [0.1307, 0.1308, 0.1308, 0.1308, 0.1312, 0.1310, 0.0000, 0.1305, 0.1314,
         0.1307],
        [0.1307, 0.1305, 0.1309, 0.1305, 0.1310, 0.1308, 0.1305, 0.0000, 0.1307,
         0.1308],
        [0.1306, 0.1310, 0.1312, 0.1311, 0.1311, 0.1308, 0.1314, 0.1307, 0.0000,
         0.1307],
        [0.1307, 0.1306, 0.1308, 0.1308, 0.1311, 0.1309, 0.1307, 0.1308, 0.1307,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0191, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34134012
Epoch297: train_loss: 4.2203 recon_acc: 0.2351 val_roc: 0.7243 val_ap: 0.7740 f1: 0.6811 time: 0.2497
thresh 0.46294308
          test_roc: 0.7073 test_ap: 0.7436 test_f1: 0.6728 test_recon_acc: 0.4366
difference_matrix tensor([[0.0000, 0.1304, 0.1309, 0.1307, 0.1307, 0.1307, 0.1305, 0.1305, 0.1304,
         0.1306],
        [0.1304, 0.0000, 0.1306, 0.1305, 0.1307, 0.1304, 0.1306, 0.1303, 0.1308,
         0.1305],
        [0.1309, 0.1306, 0.0000, 0.1306, 0.1315, 0.1309, 0.1307, 0.1307, 0.1310,
         0.1307],
        [0.1307, 0.1305, 0.1306, 0.0000, 0.1310, 0.1309, 0.1307, 0.1303, 0.1310,
         0.1306],
        [0.1307, 0.1307, 0.1315, 0.1310, 0.0000, 0.1308, 0.1311, 0.1308, 0.1310,
         0.1309],
        [0.1307, 0.1304, 0.1309, 0.1309, 0.1308, 0.0000, 0.1308, 0.1306, 0.1307,
         0.1308],
        [0.1305, 0.1306, 0.1307, 0.1307, 0.1311, 0.1308, 0.0000, 0.1304, 0.1312,
         0.1306],
        [0.1305, 0.1303, 0.1307, 0.1303, 0.1308, 0.1306, 0.1304, 0.0000, 0.1305,
         0.1307],
        [0.1304, 0.1308, 0.1310, 0.1310, 0.1310, 0.1307, 0.1312, 0.1305, 0.0000,
         0.1306],
        [0.1306, 0.1305, 0.1307, 0.1306, 0.1309, 0.1308, 0.1306, 0.1307, 0.1306,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0193, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3417649
Epoch298: train_loss: 4.2189 recon_acc: 0.2355 val_roc: 0.7245 val_ap: 0.7742 f1: 0.6811 time: 0.2653
thresh 0.46175063
          test_roc: 0.7076 test_ap: 0.7439 test_f1: 0.6728 test_recon_acc: 0.4344
difference_matrix tensor([[0.0000, 0.1303, 0.1307, 0.1305, 0.1305, 0.1305, 0.1304, 0.1304, 0.1303,
         0.1304],
        [0.1303, 0.0000, 0.1304, 0.1303, 0.1305, 0.1303, 0.1305, 0.1302, 0.1307,
         0.1303],
        [0.1307, 0.1304, 0.0000, 0.1305, 0.1313, 0.1307, 0.1305, 0.1306, 0.1309,
         0.1305],
        [0.1305, 0.1303, 0.1305, 0.0000, 0.1308, 0.1308, 0.1305, 0.1302, 0.1308,
         0.1305],
        [0.1305, 0.1305, 0.1313, 0.1308, 0.0000, 0.1306, 0.1309, 0.1307, 0.1308,
         0.1307],
        [0.1305, 0.1303, 0.1307, 0.1308, 0.1306, 0.0000, 0.1307, 0.1305, 0.1305,
         0.1306],
        [0.1304, 0.1305, 0.1305, 0.1305, 0.1309, 0.1307, 0.0000, 0.1302, 0.1311,
         0.1304],
        [0.1304, 0.1302, 0.1306, 0.1302, 0.1307, 0.1305, 0.1302, 0.0000, 0.1304,
         0.1305],
        [0.1303, 0.1307, 0.1309, 0.1308, 0.1308, 0.1305, 0.1311, 0.1304, 0.0000,
         0.1304],
        [0.1304, 0.1303, 0.1305, 0.1305, 0.1307, 0.1306, 0.1304, 0.1305, 0.1304,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0194, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3356679
Epoch299: train_loss: 4.2174 recon_acc: 0.2262 val_roc: 0.7249 val_ap: 0.7747 f1: 0.6821 time: 0.3038
thresh 0.46255025
          test_roc: 0.7079 test_ap: 0.7442 test_f1: 0.6734 test_recon_acc: 0.4358
difference_matrix tensor([[0.0000, 0.1301, 0.1306, 0.1304, 0.1304, 0.1304, 0.1302, 0.1302, 0.1301,
         0.1303],
        [0.1301, 0.0000, 0.1303, 0.1302, 0.1304, 0.1301, 0.1303, 0.1300, 0.1305,
         0.1302],
        [0.1306, 0.1303, 0.0000, 0.1303, 0.1311, 0.1305, 0.1304, 0.1304, 0.1307,
         0.1304],
        [0.1304, 0.1302, 0.1303, 0.0000, 0.1306, 0.1306, 0.1304, 0.1300, 0.1306,
         0.1303],
        [0.1304, 0.1304, 0.1311, 0.1306, 0.0000, 0.1305, 0.1308, 0.1305, 0.1307,
         0.1306],
        [0.1304, 0.1301, 0.1305, 0.1306, 0.1305, 0.0000, 0.1305, 0.1303, 0.1304,
         0.1305],
        [0.1302, 0.1303, 0.1304, 0.1304, 0.1308, 0.1305, 0.0000, 0.1301, 0.1309,
         0.1303],
        [0.1302, 0.1300, 0.1304, 0.1300, 0.1305, 0.1303, 0.1301, 0.0000, 0.1302,
         0.1304],
        [0.1301, 0.1305, 0.1307, 0.1306, 0.1307, 0.1304, 0.1309, 0.1302, 0.0000,
         0.1302],
        [0.1303, 0.1302, 0.1304, 0.1303, 0.1306, 0.1305, 0.1303, 0.1304, 0.1302,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0196, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33617225
Epoch300: train_loss: 4.2160 recon_acc: 0.2268 val_roc: 0.7253 val_ap: 0.7750 f1: 0.6821 time: 0.3081
thresh 0.46430564
          test_roc: 0.7082 test_ap: 0.7446 test_f1: 0.6728 test_recon_acc: 0.4389
difference_matrix tensor([[0.0000, 0.1299, 0.1304, 0.1302, 0.1302, 0.1302, 0.1301, 0.1301, 0.1300,
         0.1301],
        [0.1299, 0.0000, 0.1301, 0.1300, 0.1302, 0.1300, 0.1301, 0.1299, 0.1303,
         0.1300],
        [0.1304, 0.1301, 0.0000, 0.1302, 0.1310, 0.1304, 0.1302, 0.1303, 0.1306,
         0.1302],
        [0.1302, 0.1300, 0.1302, 0.0000, 0.1305, 0.1305, 0.1302, 0.1299, 0.1305,
         0.1302],
        [0.1302, 0.1302, 0.1310, 0.1305, 0.0000, 0.1303, 0.1306, 0.1304, 0.1305,
         0.1304],
        [0.1302, 0.1300, 0.1304, 0.1305, 0.1303, 0.0000, 0.1303, 0.1302, 0.1302,
         0.1303],
        [0.1301, 0.1301, 0.1302, 0.1302, 0.1306, 0.1303, 0.0000, 0.1299, 0.1308,
         0.1301],
        [0.1301, 0.1299, 0.1303, 0.1299, 0.1304, 0.1302, 0.1299, 0.0000, 0.1301,
         0.1302],
        [0.1300, 0.1303, 0.1306, 0.1305, 0.1305, 0.1302, 0.1308, 0.1301, 0.0000,
         0.1301],
        [0.1301, 0.1300, 0.1302, 0.1302, 0.1304, 0.1303, 0.1301, 0.1302, 0.1301,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0198, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33667552
Epoch301: train_loss: 4.2146 recon_acc: 0.2273 val_roc: 0.7256 val_ap: 0.7754 f1: 0.6821 time: 0.2554
thresh 0.45920596
          test_roc: 0.7085 test_ap: 0.7449 test_f1: 0.6734 test_recon_acc: 0.4298
difference_matrix tensor([[0.0000, 0.1298, 0.1303, 0.1301, 0.1301, 0.1301, 0.1299, 0.1299, 0.1298,
         0.1300],
        [0.1298, 0.0000, 0.1300, 0.1298, 0.1300, 0.1298, 0.1300, 0.1297, 0.1302,
         0.1299],
        [0.1303, 0.1300, 0.0000, 0.1300, 0.1308, 0.1302, 0.1300, 0.1301, 0.1304,
         0.1301],
        [0.1301, 0.1298, 0.1300, 0.0000, 0.1303, 0.1303, 0.1301, 0.1297, 0.1303,
         0.1300],
        [0.1301, 0.1300, 0.1308, 0.1303, 0.0000, 0.1301, 0.1305, 0.1302, 0.1304,
         0.1303],
        [0.1301, 0.1298, 0.1302, 0.1303, 0.1301, 0.0000, 0.1302, 0.1300, 0.1300,
         0.1301],
        [0.1299, 0.1300, 0.1300, 0.1301, 0.1305, 0.1302, 0.0000, 0.1298, 0.1306,
         0.1300],
        [0.1299, 0.1297, 0.1301, 0.1297, 0.1302, 0.1300, 0.1298, 0.0000, 0.1299,
         0.1301],
        [0.1298, 0.1302, 0.1304, 0.1303, 0.1304, 0.1300, 0.1306, 0.1299, 0.0000,
         0.1299],
        [0.1300, 0.1299, 0.1301, 0.1300, 0.1303, 0.1301, 0.1300, 0.1301, 0.1299,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0199, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33717787
Epoch302: train_loss: 4.2131 recon_acc: 0.2279 val_roc: 0.7260 val_ap: 0.7758 f1: 0.6821 time: 0.2706
thresh 0.4594516
          test_roc: 0.7087 test_ap: 0.7454 test_f1: 0.6734 test_recon_acc: 0.4302
difference_matrix tensor([[0.0000, 0.1296, 0.1301, 0.1299, 0.1299, 0.1299, 0.1298, 0.1298, 0.1297,
         0.1298],
        [0.1296, 0.0000, 0.1298, 0.1297, 0.1299, 0.1297, 0.1298, 0.1296, 0.1300,
         0.1297],
        [0.1301, 0.1298, 0.0000, 0.1299, 0.1307, 0.1301, 0.1299, 0.1300, 0.1303,
         0.1299],
        [0.1299, 0.1297, 0.1299, 0.0000, 0.1302, 0.1302, 0.1299, 0.1296, 0.1302,
         0.1299],
        [0.1299, 0.1299, 0.1307, 0.1302, 0.0000, 0.1300, 0.1303, 0.1301, 0.1302,
         0.1301],
        [0.1299, 0.1297, 0.1301, 0.1302, 0.1300, 0.0000, 0.1300, 0.1299, 0.1299,
         0.1300],
        [0.1298, 0.1298, 0.1299, 0.1299, 0.1303, 0.1300, 0.0000, 0.1296, 0.1305,
         0.1298],
        [0.1298, 0.1296, 0.1300, 0.1296, 0.1301, 0.1299, 0.1296, 0.0000, 0.1298,
         0.1299],
        [0.1297, 0.1300, 0.1303, 0.1302, 0.1302, 0.1299, 0.1305, 0.1298, 0.0000,
         0.1298],
        [0.1298, 0.1297, 0.1299, 0.1299, 0.1301, 0.1300, 0.1298, 0.1299, 0.1298,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0201, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3376794
Epoch303: train_loss: 4.2117 recon_acc: 0.2285 val_roc: 0.7263 val_ap: 0.7763 f1: 0.6821 time: 0.2903
thresh 0.45970315
          test_roc: 0.7090 test_ap: 0.7458 test_f1: 0.6734 test_recon_acc: 0.4306
difference_matrix tensor([[0.0000, 0.1295, 0.1300, 0.1298, 0.1298, 0.1298, 0.1296, 0.1296, 0.1295,
         0.1297],
        [0.1295, 0.0000, 0.1297, 0.1295, 0.1297, 0.1295, 0.1297, 0.1294, 0.1299,
         0.1296],
        [0.1300, 0.1297, 0.0000, 0.1297, 0.1305, 0.1299, 0.1297, 0.1298, 0.1301,
         0.1298],
        [0.1298, 0.1295, 0.1297, 0.0000, 0.1300, 0.1300, 0.1298, 0.1294, 0.1300,
         0.1297],
        [0.1298, 0.1297, 0.1305, 0.1300, 0.0000, 0.1298, 0.1302, 0.1299, 0.1301,
         0.1300],
        [0.1298, 0.1295, 0.1299, 0.1300, 0.1298, 0.0000, 0.1299, 0.1297, 0.1297,
         0.1298],
        [0.1296, 0.1297, 0.1297, 0.1298, 0.1302, 0.1299, 0.0000, 0.1295, 0.1303,
         0.1297],
        [0.1296, 0.1294, 0.1298, 0.1294, 0.1299, 0.1297, 0.1295, 0.0000, 0.1296,
         0.1298],
        [0.1295, 0.1299, 0.1301, 0.1300, 0.1301, 0.1297, 0.1303, 0.1296, 0.0000,
         0.1296],
        [0.1297, 0.1296, 0.1298, 0.1297, 0.1300, 0.1298, 0.1297, 0.1298, 0.1296,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0202, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33817992
Epoch304: train_loss: 4.2103 recon_acc: 0.2290 val_roc: 0.7266 val_ap: 0.7765 f1: 0.6821 time: 0.2849
thresh 0.45996046
          test_roc: 0.7093 test_ap: 0.7462 test_f1: 0.6734 test_recon_acc: 0.4310
difference_matrix tensor([[0.0000, 0.1293, 0.1298, 0.1296, 0.1296, 0.1296, 0.1295, 0.1295, 0.1294,
         0.1295],
        [0.1293, 0.0000, 0.1295, 0.1294, 0.1296, 0.1294, 0.1295, 0.1293, 0.1297,
         0.1294],
        [0.1298, 0.1295, 0.0000, 0.1296, 0.1304, 0.1298, 0.1296, 0.1297, 0.1300,
         0.1296],
        [0.1296, 0.1294, 0.1296, 0.0000, 0.1299, 0.1299, 0.1296, 0.1293, 0.1299,
         0.1295],
        [0.1296, 0.1296, 0.1304, 0.1299, 0.0000, 0.1297, 0.1300, 0.1298, 0.1299,
         0.1298],
        [0.1296, 0.1294, 0.1298, 0.1299, 0.1297, 0.0000, 0.1297, 0.1296, 0.1296,
         0.1297],
        [0.1295, 0.1295, 0.1296, 0.1296, 0.1300, 0.1297, 0.0000, 0.1293, 0.1302,
         0.1295],
        [0.1295, 0.1293, 0.1297, 0.1293, 0.1298, 0.1296, 0.1293, 0.0000, 0.1295,
         0.1296],
        [0.1294, 0.1297, 0.1300, 0.1299, 0.1299, 0.1296, 0.1302, 0.1295, 0.0000,
         0.1295],
        [0.1295, 0.1294, 0.1296, 0.1295, 0.1298, 0.1297, 0.1295, 0.1296, 0.1295,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0204, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3381075
Epoch305: train_loss: 4.2090 recon_acc: 0.2287 val_roc: 0.7270 val_ap: 0.7770 f1: 0.6821 time: 0.2722
thresh 0.4602235
          test_roc: 0.7095 test_ap: 0.7465 test_f1: 0.6734 test_recon_acc: 0.4314
difference_matrix tensor([[0.0000, 0.1292, 0.1297, 0.1295, 0.1295, 0.1295, 0.1293, 0.1293, 0.1292,
         0.1294],
        [0.1292, 0.0000, 0.1294, 0.1292, 0.1294, 0.1292, 0.1294, 0.1291, 0.1296,
         0.1293],
        [0.1297, 0.1294, 0.0000, 0.1294, 0.1302, 0.1296, 0.1294, 0.1295, 0.1298,
         0.1295],
        [0.1295, 0.1292, 0.1294, 0.0000, 0.1297, 0.1297, 0.1295, 0.1291, 0.1297,
         0.1294],
        [0.1295, 0.1294, 0.1302, 0.1297, 0.0000, 0.1295, 0.1299, 0.1296, 0.1298,
         0.1297],
        [0.1295, 0.1292, 0.1296, 0.1297, 0.1295, 0.0000, 0.1296, 0.1294, 0.1295,
         0.1295],
        [0.1293, 0.1294, 0.1294, 0.1295, 0.1299, 0.1296, 0.0000, 0.1292, 0.1300,
         0.1294],
        [0.1293, 0.1291, 0.1295, 0.1291, 0.1296, 0.1294, 0.1292, 0.0000, 0.1293,
         0.1295],
        [0.1292, 0.1296, 0.1298, 0.1297, 0.1298, 0.1294, 0.1300, 0.1293, 0.0000,
         0.1293],
        [0.1294, 0.1293, 0.1295, 0.1294, 0.1297, 0.1295, 0.1294, 0.1295, 0.1293,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0205, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33707926
Epoch306: train_loss: 4.2076 recon_acc: 0.2270 val_roc: 0.7272 val_ap: 0.7772 f1: 0.6821 time: 0.3121
thresh 0.45130402
          test_roc: 0.7099 test_ap: 0.7470 test_f1: 0.6734 test_recon_acc: 0.4156
difference_matrix tensor([[0.0000, 0.1290, 0.1295, 0.1293, 0.1293, 0.1293, 0.1292, 0.1292, 0.1291,
         0.1292],
        [0.1290, 0.0000, 0.1292, 0.1291, 0.1293, 0.1291, 0.1292, 0.1290, 0.1294,
         0.1291],
        [0.1295, 0.1292, 0.0000, 0.1293, 0.1301, 0.1295, 0.1293, 0.1294, 0.1297,
         0.1293],
        [0.1293, 0.1291, 0.1293, 0.0000, 0.1296, 0.1296, 0.1293, 0.1290, 0.1296,
         0.1292],
        [0.1293, 0.1293, 0.1301, 0.1296, 0.0000, 0.1294, 0.1297, 0.1295, 0.1296,
         0.1295],
        [0.1293, 0.1291, 0.1295, 0.1296, 0.1294, 0.0000, 0.1294, 0.1293, 0.1293,
         0.1294],
        [0.1292, 0.1292, 0.1293, 0.1293, 0.1297, 0.1294, 0.0000, 0.1290, 0.1299,
         0.1292],
        [0.1292, 0.1290, 0.1294, 0.1290, 0.1295, 0.1293, 0.1290, 0.0000, 0.1292,
         0.1293],
        [0.1291, 0.1294, 0.1297, 0.1296, 0.1296, 0.1293, 0.1299, 0.1292, 0.0000,
         0.1292],
        [0.1292, 0.1291, 0.1293, 0.1292, 0.1295, 0.1294, 0.1292, 0.1293, 0.1292,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0207, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33606443
Epoch307: train_loss: 4.2062 recon_acc: 0.2253 val_roc: 0.7274 val_ap: 0.7775 f1: 0.6821 time: 0.3134
thresh 0.45189753
          test_roc: 0.7100 test_ap: 0.7473 test_f1: 0.6734 test_recon_acc: 0.4166
difference_matrix tensor([[0.0000, 0.1289, 0.1294, 0.1292, 0.1292, 0.1292, 0.1290, 0.1290, 0.1289,
         0.1291],
        [0.1289, 0.0000, 0.1291, 0.1289, 0.1291, 0.1289, 0.1291, 0.1288, 0.1293,
         0.1290],
        [0.1294, 0.1291, 0.0000, 0.1291, 0.1299, 0.1294, 0.1291, 0.1292, 0.1295,
         0.1292],
        [0.1292, 0.1289, 0.1291, 0.0000, 0.1294, 0.1294, 0.1292, 0.1288, 0.1294,
         0.1291],
        [0.1292, 0.1291, 0.1299, 0.1294, 0.0000, 0.1292, 0.1296, 0.1293, 0.1295,
         0.1294],
        [0.1292, 0.1289, 0.1294, 0.1294, 0.1292, 0.0000, 0.1293, 0.1291, 0.1292,
         0.1293],
        [0.1290, 0.1291, 0.1291, 0.1292, 0.1296, 0.1293, 0.0000, 0.1289, 0.1297,
         0.1291],
        [0.1290, 0.1288, 0.1292, 0.1288, 0.1293, 0.1291, 0.1289, 0.0000, 0.1290,
         0.1292],
        [0.1289, 0.1293, 0.1295, 0.1294, 0.1295, 0.1292, 0.1297, 0.1290, 0.0000,
         0.1290],
        [0.1291, 0.1290, 0.1292, 0.1291, 0.1294, 0.1293, 0.1291, 0.1292, 0.1290,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0208, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33506328
Epoch308: train_loss: 4.2049 recon_acc: 0.2237 val_roc: 0.7277 val_ap: 0.7778 f1: 0.6810 time: 0.2661
thresh 0.45249048
          test_roc: 0.7103 test_ap: 0.7478 test_f1: 0.6734 test_recon_acc: 0.4176
difference_matrix tensor([[0.0000, 0.1287, 0.1292, 0.1290, 0.1290, 0.1290, 0.1289, 0.1289, 0.1288,
         0.1289],
        [0.1287, 0.0000, 0.1289, 0.1288, 0.1290, 0.1288, 0.1289, 0.1287, 0.1291,
         0.1288],
        [0.1292, 0.1289, 0.0000, 0.1290, 0.1298, 0.1292, 0.1290, 0.1291, 0.1294,
         0.1290],
        [0.1290, 0.1288, 0.1290, 0.0000, 0.1293, 0.1293, 0.1290, 0.1287, 0.1293,
         0.1290],
        [0.1290, 0.1290, 0.1298, 0.1293, 0.0000, 0.1291, 0.1294, 0.1292, 0.1293,
         0.1292],
        [0.1290, 0.1288, 0.1292, 0.1293, 0.1291, 0.0000, 0.1292, 0.1290, 0.1290,
         0.1291],
        [0.1289, 0.1289, 0.1290, 0.1290, 0.1294, 0.1292, 0.0000, 0.1287, 0.1296,
         0.1289],
        [0.1289, 0.1287, 0.1291, 0.1287, 0.1292, 0.1290, 0.1287, 0.0000, 0.1289,
         0.1290],
        [0.1288, 0.1291, 0.1294, 0.1293, 0.1293, 0.1290, 0.1296, 0.1289, 0.0000,
         0.1289],
        [0.1289, 0.1288, 0.1290, 0.1290, 0.1292, 0.1291, 0.1289, 0.1290, 0.1289,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0210, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.33407578
Epoch309: train_loss: 4.2036 recon_acc: 0.2221 val_roc: 0.7280 val_ap: 0.7782 f1: 0.6810 time: 0.2692
thresh 0.45308325
          test_roc: 0.7106 test_ap: 0.7480 test_f1: 0.6734 test_recon_acc: 0.4186
difference_matrix tensor([[0.0000, 0.1286, 0.1291, 0.1289, 0.1289, 0.1289, 0.1287, 0.1287, 0.1286,
         0.1288],
        [0.1286, 0.0000, 0.1288, 0.1286, 0.1288, 0.1286, 0.1288, 0.1285, 0.1290,
         0.1287],
        [0.1291, 0.1288, 0.0000, 0.1288, 0.1296, 0.1291, 0.1288, 0.1289, 0.1292,
         0.1289],
        [0.1289, 0.1286, 0.1288, 0.0000, 0.1291, 0.1292, 0.1289, 0.1285, 0.1291,
         0.1288],
        [0.1289, 0.1288, 0.1296, 0.1291, 0.0000, 0.1289, 0.1293, 0.1290, 0.1292,
         0.1291],
        [0.1289, 0.1286, 0.1291, 0.1292, 0.1289, 0.0000, 0.1290, 0.1288, 0.1289,
         0.1290],
        [0.1287, 0.1288, 0.1288, 0.1289, 0.1293, 0.1290, 0.0000, 0.1286, 0.1294,
         0.1288],
        [0.1287, 0.1285, 0.1289, 0.1285, 0.1290, 0.1288, 0.1286, 0.0000, 0.1287,
         0.1289],
        [0.1286, 0.1290, 0.1292, 0.1291, 0.1292, 0.1289, 0.1294, 0.1287, 0.0000,
         0.1287],
        [0.1288, 0.1287, 0.1289, 0.1288, 0.1291, 0.1290, 0.1288, 0.1289, 0.1287,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0211, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3331019
Epoch310: train_loss: 4.2022 recon_acc: 0.2204 val_roc: 0.7284 val_ap: 0.7786 f1: 0.6810 time: 0.2810
thresh 0.4536758
          test_roc: 0.7110 test_ap: 0.7486 test_f1: 0.6734 test_recon_acc: 0.4195
difference_matrix tensor([[0.0000, 0.1284, 0.1289, 0.1287, 0.1287, 0.1287, 0.1286, 0.1286, 0.1285,
         0.1286],
        [0.1284, 0.0000, 0.1287, 0.1285, 0.1287, 0.1285, 0.1286, 0.1284, 0.1288,
         0.1285],
        [0.1289, 0.1287, 0.0000, 0.1287, 0.1295, 0.1289, 0.1287, 0.1288, 0.1291,
         0.1287],
        [0.1287, 0.1285, 0.1287, 0.0000, 0.1290, 0.1290, 0.1287, 0.1284, 0.1290,
         0.1287],
        [0.1287, 0.1287, 0.1295, 0.1290, 0.0000, 0.1288, 0.1291, 0.1289, 0.1290,
         0.1289],
        [0.1287, 0.1285, 0.1289, 0.1290, 0.1288, 0.0000, 0.1289, 0.1287, 0.1287,
         0.1288],
        [0.1286, 0.1286, 0.1287, 0.1287, 0.1291, 0.1289, 0.0000, 0.1284, 0.1293,
         0.1286],
        [0.1286, 0.1284, 0.1288, 0.1284, 0.1289, 0.1287, 0.1284, 0.0000, 0.1286,
         0.1287],
        [0.1285, 0.1288, 0.1291, 0.1290, 0.1290, 0.1287, 0.1293, 0.1286, 0.0000,
         0.1286],
        [0.1286, 0.1285, 0.1287, 0.1287, 0.1289, 0.1288, 0.1286, 0.1287, 0.1286,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0213, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.36533663
Epoch311: train_loss: 4.2009 recon_acc: 0.2698 val_roc: 0.7287 val_ap: 0.7789 f1: 0.6803 time: 0.2582
thresh 0.4542679
          test_roc: 0.7113 test_ap: 0.7490 test_f1: 0.6734 test_recon_acc: 0.4205
difference_matrix tensor([[0.0000, 0.1283, 0.1288, 0.1286, 0.1286, 0.1286, 0.1284, 0.1284, 0.1283,
         0.1285],
        [0.1283, 0.0000, 0.1285, 0.1283, 0.1285, 0.1283, 0.1285, 0.1282, 0.1287,
         0.1284],
        [0.1288, 0.1285, 0.0000, 0.1285, 0.1293, 0.1288, 0.1286, 0.1286, 0.1289,
         0.1286],
        [0.1286, 0.1283, 0.1285, 0.0000, 0.1288, 0.1289, 0.1286, 0.1282, 0.1289,
         0.1285],
        [0.1286, 0.1285, 0.1293, 0.1288, 0.0000, 0.1287, 0.1290, 0.1287, 0.1289,
         0.1288],
        [0.1286, 0.1283, 0.1288, 0.1289, 0.1287, 0.0000, 0.1287, 0.1286, 0.1286,
         0.1287],
        [0.1284, 0.1285, 0.1286, 0.1286, 0.1290, 0.1287, 0.0000, 0.1283, 0.1291,
         0.1285],
        [0.1284, 0.1282, 0.1286, 0.1282, 0.1287, 0.1286, 0.1283, 0.0000, 0.1284,
         0.1286],
        [0.1283, 0.1287, 0.1289, 0.1289, 0.1289, 0.1286, 0.1291, 0.1284, 0.0000,
         0.1284],
        [0.1285, 0.1284, 0.1286, 0.1285, 0.1288, 0.1287, 0.1285, 0.1286, 0.1284,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0214, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34214866
Epoch312: train_loss: 4.1996 recon_acc: 0.2336 val_roc: 0.7292 val_ap: 0.7795 f1: 0.6822 time: 0.2755
thresh 0.4496101
          test_roc: 0.7115 test_ap: 0.7493 test_f1: 0.6745 test_recon_acc: 0.4123
difference_matrix tensor([[0.0000, 0.1282, 0.1286, 0.1284, 0.1284, 0.1285, 0.1283, 0.1283, 0.1282,
         0.1283],
        [0.1282, 0.0000, 0.1284, 0.1282, 0.1284, 0.1282, 0.1283, 0.1281, 0.1286,
         0.1282],
        [0.1286, 0.1284, 0.0000, 0.1284, 0.1292, 0.1286, 0.1284, 0.1285, 0.1288,
         0.1284],
        [0.1284, 0.1282, 0.1284, 0.0000, 0.1287, 0.1287, 0.1284, 0.1281, 0.1287,
         0.1284],
        [0.1284, 0.1284, 0.1292, 0.1287, 0.0000, 0.1285, 0.1288, 0.1286, 0.1287,
         0.1287],
        [0.1285, 0.1282, 0.1286, 0.1287, 0.1285, 0.0000, 0.1286, 0.1284, 0.1284,
         0.1285],
        [0.1283, 0.1283, 0.1284, 0.1284, 0.1288, 0.1286, 0.0000, 0.1281, 0.1290,
         0.1283],
        [0.1283, 0.1281, 0.1285, 0.1281, 0.1286, 0.1284, 0.1281, 0.0000, 0.1283,
         0.1284],
        [0.1282, 0.1286, 0.1288, 0.1287, 0.1287, 0.1284, 0.1290, 0.1283, 0.0000,
         0.1283],
        [0.1283, 0.1282, 0.1284, 0.1284, 0.1287, 0.1285, 0.1283, 0.1284, 0.1283,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0215, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34218043
Epoch313: train_loss: 4.1983 recon_acc: 0.2335 val_roc: 0.7293 val_ap: 0.7796 f1: 0.6822 time: 0.2992
thresh 0.45087117
          test_roc: 0.7119 test_ap: 0.7498 test_f1: 0.6752 test_recon_acc: 0.4144
difference_matrix tensor([[0.0000, 0.1280, 0.1285, 0.1283, 0.1283, 0.1283, 0.1281, 0.1281, 0.1280,
         0.1282],
        [0.1280, 0.0000, 0.1282, 0.1281, 0.1282, 0.1280, 0.1282, 0.1279, 0.1284,
         0.1281],
        [0.1285, 0.1282, 0.0000, 0.1283, 0.1291, 0.1285, 0.1283, 0.1283, 0.1287,
         0.1283],
        [0.1283, 0.1281, 0.1283, 0.0000, 0.1286, 0.1286, 0.1283, 0.1279, 0.1286,
         0.1282],
        [0.1283, 0.1282, 0.1291, 0.1286, 0.0000, 0.1284, 0.1287, 0.1284, 0.1286,
         0.1285],
        [0.1283, 0.1280, 0.1285, 0.1286, 0.1284, 0.0000, 0.1284, 0.1283, 0.1283,
         0.1284],
        [0.1281, 0.1282, 0.1283, 0.1283, 0.1287, 0.1284, 0.0000, 0.1280, 0.1288,
         0.1282],
        [0.1281, 0.1279, 0.1283, 0.1279, 0.1284, 0.1283, 0.1280, 0.0000, 0.1282,
         0.1283],
        [0.1280, 0.1284, 0.1287, 0.1286, 0.1286, 0.1283, 0.1288, 0.1282, 0.0000,
         0.1282],
        [0.1282, 0.1281, 0.1283, 0.1282, 0.1285, 0.1284, 0.1282, 0.1283, 0.1282,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0217, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34218305
Epoch314: train_loss: 4.1971 recon_acc: 0.2333 val_roc: 0.7298 val_ap: 0.7800 f1: 0.6822 time: 0.3098
thresh 0.4519424
          test_roc: 0.7122 test_ap: 0.7502 test_f1: 0.6752 test_recon_acc: 0.4163
difference_matrix tensor([[0.0000, 0.1279, 0.1284, 0.1281, 0.1281, 0.1282, 0.1280, 0.1280, 0.1279,
         0.1280],
        [0.1279, 0.0000, 0.1281, 0.1279, 0.1281, 0.1279, 0.1280, 0.1278, 0.1283,
         0.1279],
        [0.1284, 0.1281, 0.0000, 0.1281, 0.1289, 0.1283, 0.1281, 0.1282, 0.1285,
         0.1282],
        [0.1281, 0.1279, 0.1281, 0.0000, 0.1284, 0.1284, 0.1281, 0.1278, 0.1284,
         0.1281],
        [0.1281, 0.1281, 0.1289, 0.1284, 0.0000, 0.1282, 0.1285, 0.1283, 0.1284,
         0.1284],
        [0.1282, 0.1279, 0.1283, 0.1284, 0.1282, 0.0000, 0.1283, 0.1281, 0.1281,
         0.1282],
        [0.1280, 0.1280, 0.1281, 0.1281, 0.1285, 0.1283, 0.0000, 0.1278, 0.1287,
         0.1281],
        [0.1280, 0.1278, 0.1282, 0.1278, 0.1283, 0.1281, 0.1278, 0.0000, 0.1280,
         0.1281],
        [0.1279, 0.1283, 0.1285, 0.1284, 0.1284, 0.1281, 0.1287, 0.1280, 0.0000,
         0.1280],
        [0.1280, 0.1279, 0.1282, 0.1281, 0.1284, 0.1282, 0.1281, 0.1281, 0.1280,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0218, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3421943
Epoch315: train_loss: 4.1958 recon_acc: 0.2332 val_roc: 0.7301 val_ap: 0.7803 f1: 0.6822 time: 0.2842
thresh 0.45269468
          test_roc: 0.7125 test_ap: 0.7508 test_f1: 0.6752 test_recon_acc: 0.4175
difference_matrix tensor([[0.0000, 0.1277, 0.1282, 0.1280, 0.1280, 0.1280, 0.1278, 0.1278, 0.1278,
         0.1279],
        [0.1277, 0.0000, 0.1279, 0.1278, 0.1280, 0.1278, 0.1279, 0.1277, 0.1281,
         0.1278],
        [0.1282, 0.1279, 0.0000, 0.1280, 0.1288, 0.1282, 0.1280, 0.1281, 0.1284,
         0.1280],
        [0.1280, 0.1278, 0.1280, 0.0000, 0.1283, 0.1283, 0.1280, 0.1276, 0.1283,
         0.1279],
        [0.1280, 0.1280, 0.1288, 0.1283, 0.0000, 0.1281, 0.1284, 0.1281, 0.1283,
         0.1282],
        [0.1280, 0.1278, 0.1282, 0.1283, 0.1281, 0.0000, 0.1281, 0.1280, 0.1280,
         0.1281],
        [0.1278, 0.1279, 0.1280, 0.1280, 0.1284, 0.1281, 0.0000, 0.1277, 0.1285,
         0.1279],
        [0.1278, 0.1277, 0.1281, 0.1276, 0.1281, 0.1280, 0.1277, 0.0000, 0.1279,
         0.1280],
        [0.1278, 0.1281, 0.1284, 0.1283, 0.1283, 0.1280, 0.1285, 0.1279, 0.0000,
         0.1279],
        [0.1279, 0.1278, 0.1280, 0.1279, 0.1282, 0.1281, 0.1279, 0.1280, 0.1279,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0220, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34221417
Epoch316: train_loss: 4.1945 recon_acc: 0.2330 val_roc: 0.7307 val_ap: 0.7810 f1: 0.6822 time: 0.2916
thresh 0.45413247
          test_roc: 0.7128 test_ap: 0.7513 test_f1: 0.6746 test_recon_acc: 0.4201
difference_matrix tensor([[0.0000, 0.1276, 0.1281, 0.1278, 0.1279, 0.1279, 0.1277, 0.1277, 0.1276,
         0.1278],
        [0.1276, 0.0000, 0.1278, 0.1276, 0.1278, 0.1276, 0.1278, 0.1275, 0.1280,
         0.1277],
        [0.1281, 0.1278, 0.0000, 0.1278, 0.1286, 0.1281, 0.1278, 0.1279, 0.1282,
         0.1279],
        [0.1278, 0.1276, 0.1278, 0.0000, 0.1281, 0.1282, 0.1278, 0.1275, 0.1281,
         0.1278],
        [0.1279, 0.1278, 0.1286, 0.1281, 0.0000, 0.1279, 0.1283, 0.1280, 0.1282,
         0.1281],
        [0.1279, 0.1276, 0.1281, 0.1282, 0.1279, 0.0000, 0.1280, 0.1279, 0.1279,
         0.1280],
        [0.1277, 0.1278, 0.1278, 0.1278, 0.1283, 0.1280, 0.0000, 0.1275, 0.1284,
         0.1278],
        [0.1277, 0.1275, 0.1279, 0.1275, 0.1280, 0.1279, 0.1275, 0.0000, 0.1277,
         0.1279],
        [0.1276, 0.1280, 0.1282, 0.1281, 0.1282, 0.1279, 0.1284, 0.1277, 0.0000,
         0.1277],
        [0.1278, 0.1277, 0.1279, 0.1278, 0.1281, 0.1280, 0.1278, 0.1279, 0.1277,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0221, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3422426
Epoch317: train_loss: 4.1933 recon_acc: 0.2329 val_roc: 0.7311 val_ap: 0.7815 f1: 0.6822 time: 0.2772
thresh 0.45781448
          test_roc: 0.7132 test_ap: 0.7517 test_f1: 0.6752 test_recon_acc: 0.4265
difference_matrix tensor([[0.0000, 0.1274, 0.1279, 0.1277, 0.1277, 0.1278, 0.1276, 0.1276, 0.1275,
         0.1276],
        [0.1274, 0.0000, 0.1277, 0.1275, 0.1277, 0.1275, 0.1276, 0.1274, 0.1278,
         0.1275],
        [0.1279, 0.1277, 0.0000, 0.1277, 0.1285, 0.1279, 0.1277, 0.1278, 0.1281,
         0.1277],
        [0.1277, 0.1275, 0.1277, 0.0000, 0.1280, 0.1280, 0.1277, 0.1274, 0.1280,
         0.1277],
        [0.1277, 0.1277, 0.1285, 0.1280, 0.0000, 0.1278, 0.1281, 0.1279, 0.1280,
         0.1279],
        [0.1278, 0.1275, 0.1279, 0.1280, 0.1278, 0.0000, 0.1279, 0.1277, 0.1277,
         0.1278],
        [0.1276, 0.1276, 0.1277, 0.1277, 0.1281, 0.1279, 0.0000, 0.1274, 0.1283,
         0.1276],
        [0.1276, 0.1274, 0.1278, 0.1274, 0.1279, 0.1277, 0.1274, 0.0000, 0.1276,
         0.1277],
        [0.1275, 0.1278, 0.1281, 0.1280, 0.1280, 0.1277, 0.1283, 0.1276, 0.0000,
         0.1276],
        [0.1276, 0.1275, 0.1277, 0.1277, 0.1279, 0.1278, 0.1276, 0.1277, 0.1276,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0223, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3422796
Epoch318: train_loss: 4.1921 recon_acc: 0.2328 val_roc: 0.7317 val_ap: 0.7822 f1: 0.6822 time: 0.2622
thresh 0.4584049
          test_roc: 0.7135 test_ap: 0.7522 test_f1: 0.6752 test_recon_acc: 0.4276
difference_matrix tensor([[0.0000, 0.1273, 0.1278, 0.1276, 0.1276, 0.1276, 0.1274, 0.1274, 0.1273,
         0.1275],
        [0.1273, 0.0000, 0.1275, 0.1273, 0.1275, 0.1273, 0.1275, 0.1272, 0.1277,
         0.1274],
        [0.1278, 0.1275, 0.0000, 0.1276, 0.1283, 0.1278, 0.1276, 0.1276, 0.1280,
         0.1276],
        [0.1276, 0.1273, 0.1276, 0.0000, 0.1279, 0.1279, 0.1276, 0.1272, 0.1279,
         0.1275],
        [0.1276, 0.1275, 0.1283, 0.1279, 0.0000, 0.1277, 0.1280, 0.1277, 0.1279,
         0.1278],
        [0.1276, 0.1273, 0.1278, 0.1279, 0.1277, 0.0000, 0.1277, 0.1276, 0.1276,
         0.1277],
        [0.1274, 0.1275, 0.1276, 0.1276, 0.1280, 0.1277, 0.0000, 0.1273, 0.1281,
         0.1275],
        [0.1274, 0.1272, 0.1276, 0.1272, 0.1277, 0.1276, 0.1273, 0.0000, 0.1275,
         0.1276],
        [0.1273, 0.1277, 0.1280, 0.1279, 0.1279, 0.1276, 0.1281, 0.1275, 0.0000,
         0.1274],
        [0.1275, 0.1274, 0.1276, 0.1275, 0.1278, 0.1277, 0.1275, 0.1276, 0.1274,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0224, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3455659
Epoch319: train_loss: 4.1908 recon_acc: 0.2377 val_roc: 0.7319 val_ap: 0.7825 f1: 0.6823 time: 0.2822
thresh 0.45753485
          test_roc: 0.7138 test_ap: 0.7525 test_f1: 0.6758 test_recon_acc: 0.4260
difference_matrix tensor([[0.0000, 0.1272, 0.1276, 0.1274, 0.1274, 0.1275, 0.1273, 0.1273, 0.1272,
         0.1273],
        [0.1272, 0.0000, 0.1274, 0.1272, 0.1274, 0.1272, 0.1273, 0.1271, 0.1276,
         0.1272],
        [0.1276, 0.1274, 0.0000, 0.1274, 0.1282, 0.1276, 0.1274, 0.1275, 0.1278,
         0.1275],
        [0.1274, 0.1272, 0.1274, 0.0000, 0.1277, 0.1277, 0.1274, 0.1271, 0.1277,
         0.1274],
        [0.1274, 0.1274, 0.1282, 0.1277, 0.0000, 0.1275, 0.1278, 0.1276, 0.1277,
         0.1277],
        [0.1275, 0.1272, 0.1276, 0.1277, 0.1275, 0.0000, 0.1276, 0.1274, 0.1274,
         0.1275],
        [0.1273, 0.1273, 0.1274, 0.1274, 0.1278, 0.1276, 0.0000, 0.1271, 0.1280,
         0.1274],
        [0.1273, 0.1271, 0.1275, 0.1271, 0.1276, 0.1274, 0.1271, 0.0000, 0.1273,
         0.1274],
        [0.1272, 0.1276, 0.1278, 0.1277, 0.1277, 0.1274, 0.1280, 0.1273, 0.0000,
         0.1273],
        [0.1273, 0.1272, 0.1275, 0.1274, 0.1277, 0.1275, 0.1274, 0.1274, 0.1273,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0225, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3460496
Epoch320: train_loss: 4.1896 recon_acc: 0.2382 val_roc: 0.7322 val_ap: 0.7828 f1: 0.6823 time: 0.2967
thresh 0.4586998
          test_roc: 0.7141 test_ap: 0.7528 test_f1: 0.6764 test_recon_acc: 0.4280
difference_matrix tensor([[0.0000, 0.1270, 0.1275, 0.1273, 0.1273, 0.1273, 0.1271, 0.1271, 0.1271,
         0.1272],
        [0.1270, 0.0000, 0.1272, 0.1271, 0.1272, 0.1271, 0.1272, 0.1270, 0.1274,
         0.1271],
        [0.1275, 0.1272, 0.0000, 0.1273, 0.1281, 0.1275, 0.1273, 0.1274, 0.1277,
         0.1273],
        [0.1273, 0.1271, 0.1273, 0.0000, 0.1276, 0.1276, 0.1273, 0.1269, 0.1276,
         0.1272],
        [0.1273, 0.1272, 0.1281, 0.1276, 0.0000, 0.1274, 0.1277, 0.1274, 0.1276,
         0.1275],
        [0.1273, 0.1271, 0.1275, 0.1276, 0.1274, 0.0000, 0.1275, 0.1273, 0.1273,
         0.1274],
        [0.1271, 0.1272, 0.1273, 0.1273, 0.1277, 0.1275, 0.0000, 0.1270, 0.1278,
         0.1272],
        [0.1271, 0.1270, 0.1274, 0.1269, 0.1274, 0.1273, 0.1270, 0.0000, 0.1272,
         0.1273],
        [0.1271, 0.1274, 0.1277, 0.1276, 0.1276, 0.1273, 0.1278, 0.1272, 0.0000,
         0.1272],
        [0.1272, 0.1271, 0.1273, 0.1272, 0.1275, 0.1274, 0.1272, 0.1273, 0.1272,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0227, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3465323
Epoch321: train_loss: 4.1884 recon_acc: 0.2388 val_roc: 0.7324 val_ap: 0.7831 f1: 0.6823 time: 0.2391
thresh 0.45885804
          test_roc: 0.7142 test_ap: 0.7533 test_f1: 0.6758 test_recon_acc: 0.4283
difference_matrix tensor([[0.0000, 0.1269, 0.1274, 0.1271, 0.1272, 0.1272, 0.1270, 0.1270, 0.1269,
         0.1271],
        [0.1269, 0.0000, 0.1271, 0.1269, 0.1271, 0.1269, 0.1271, 0.1268, 0.1273,
         0.1270],
        [0.1274, 0.1271, 0.0000, 0.1271, 0.1279, 0.1274, 0.1271, 0.1272, 0.1276,
         0.1272],
        [0.1271, 0.1269, 0.1271, 0.0000, 0.1274, 0.1275, 0.1271, 0.1268, 0.1274,
         0.1271],
        [0.1272, 0.1271, 0.1279, 0.1274, 0.0000, 0.1272, 0.1276, 0.1273, 0.1275,
         0.1274],
        [0.1272, 0.1269, 0.1274, 0.1275, 0.1272, 0.0000, 0.1273, 0.1272, 0.1272,
         0.1273],
        [0.1270, 0.1271, 0.1271, 0.1271, 0.1276, 0.1273, 0.0000, 0.1268, 0.1277,
         0.1271],
        [0.1270, 0.1268, 0.1272, 0.1268, 0.1273, 0.1272, 0.1268, 0.0000, 0.1270,
         0.1272],
        [0.1269, 0.1273, 0.1276, 0.1274, 0.1275, 0.1272, 0.1277, 0.1270, 0.0000,
         0.1270],
        [0.1271, 0.1270, 0.1272, 0.1271, 0.1274, 0.1273, 0.1271, 0.1272, 0.1270,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0228, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34663534
Epoch322: train_loss: 4.1872 recon_acc: 0.2388 val_roc: 0.7329 val_ap: 0.7836 f1: 0.6823 time: 0.2679
thresh 0.45871437
          test_roc: 0.7145 test_ap: 0.7537 test_f1: 0.6758 test_recon_acc: 0.4280
difference_matrix tensor([[0.0000, 0.1267, 0.1272, 0.1270, 0.1270, 0.1271, 0.1269, 0.1269, 0.1268,
         0.1269],
        [0.1267, 0.0000, 0.1270, 0.1268, 0.1270, 0.1268, 0.1269, 0.1267, 0.1271,
         0.1268],
        [0.1272, 0.1270, 0.0000, 0.1270, 0.1278, 0.1272, 0.1270, 0.1271, 0.1274,
         0.1270],
        [0.1270, 0.1268, 0.1270, 0.0000, 0.1273, 0.1273, 0.1270, 0.1267, 0.1273,
         0.1270],
        [0.1270, 0.1270, 0.1278, 0.1273, 0.0000, 0.1271, 0.1274, 0.1272, 0.1273,
         0.1273],
        [0.1271, 0.1268, 0.1272, 0.1273, 0.1271, 0.0000, 0.1272, 0.1270, 0.1270,
         0.1271],
        [0.1269, 0.1269, 0.1270, 0.1270, 0.1274, 0.1272, 0.0000, 0.1267, 0.1276,
         0.1269],
        [0.1269, 0.1267, 0.1271, 0.1267, 0.1272, 0.1270, 0.1267, 0.0000, 0.1269,
         0.1270],
        [0.1268, 0.1271, 0.1274, 0.1273, 0.1273, 0.1270, 0.1276, 0.1269, 0.0000,
         0.1269],
        [0.1269, 0.1268, 0.1270, 0.1270, 0.1273, 0.1271, 0.1269, 0.1270, 0.1269,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0229, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34672967
Epoch323: train_loss: 4.1861 recon_acc: 0.2388 val_roc: 0.7332 val_ap: 0.7841 f1: 0.6823 time: 0.2744
thresh 0.45857254
          test_roc: 0.7148 test_ap: 0.7541 test_f1: 0.6758 test_recon_acc: 0.4277
difference_matrix tensor([[0.0000, 0.1266, 0.1271, 0.1269, 0.1269, 0.1269, 0.1267, 0.1267, 0.1267,
         0.1268],
        [0.1266, 0.0000, 0.1268, 0.1266, 0.1268, 0.1267, 0.1268, 0.1265, 0.1270,
         0.1267],
        [0.1271, 0.1268, 0.0000, 0.1269, 0.1276, 0.1271, 0.1269, 0.1270, 0.1273,
         0.1269],
        [0.1269, 0.1266, 0.1269, 0.0000, 0.1272, 0.1272, 0.1269, 0.1265, 0.1272,
         0.1268],
        [0.1269, 0.1268, 0.1276, 0.1272, 0.0000, 0.1270, 0.1273, 0.1270, 0.1272,
         0.1271],
        [0.1269, 0.1267, 0.1271, 0.1272, 0.1270, 0.0000, 0.1270, 0.1269, 0.1269,
         0.1270],
        [0.1267, 0.1268, 0.1269, 0.1269, 0.1273, 0.1270, 0.0000, 0.1266, 0.1274,
         0.1268],
        [0.1267, 0.1265, 0.1270, 0.1265, 0.1270, 0.1269, 0.1266, 0.0000, 0.1268,
         0.1269],
        [0.1267, 0.1270, 0.1273, 0.1272, 0.1272, 0.1269, 0.1274, 0.1268, 0.0000,
         0.1268],
        [0.1268, 0.1267, 0.1269, 0.1268, 0.1271, 0.1270, 0.1268, 0.1269, 0.1268,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0231, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34682465
Epoch324: train_loss: 4.1849 recon_acc: 0.2388 val_roc: 0.7337 val_ap: 0.7845 f1: 0.6823 time: 0.2965
thresh 0.4584326
          test_roc: 0.7150 test_ap: 0.7544 test_f1: 0.6758 test_recon_acc: 0.4274
difference_matrix tensor([[0.0000, 0.1265, 0.1270, 0.1267, 0.1267, 0.1268, 0.1266, 0.1266, 0.1265,
         0.1267],
        [0.1265, 0.0000, 0.1267, 0.1265, 0.1267, 0.1265, 0.1266, 0.1264, 0.1269,
         0.1266],
        [0.1270, 0.1267, 0.0000, 0.1267, 0.1275, 0.1270, 0.1267, 0.1268, 0.1272,
         0.1268],
        [0.1267, 0.1265, 0.1267, 0.0000, 0.1270, 0.1271, 0.1267, 0.1264, 0.1270,
         0.1267],
        [0.1267, 0.1267, 0.1275, 0.1270, 0.0000, 0.1268, 0.1272, 0.1269, 0.1271,
         0.1270],
        [0.1268, 0.1265, 0.1270, 0.1271, 0.1268, 0.0000, 0.1269, 0.1268, 0.1268,
         0.1269],
        [0.1266, 0.1266, 0.1267, 0.1267, 0.1272, 0.1269, 0.0000, 0.1264, 0.1273,
         0.1267],
        [0.1266, 0.1264, 0.1268, 0.1264, 0.1269, 0.1268, 0.1264, 0.0000, 0.1266,
         0.1268],
        [0.1265, 0.1269, 0.1272, 0.1270, 0.1271, 0.1268, 0.1273, 0.1266, 0.0000,
         0.1266],
        [0.1267, 0.1266, 0.1268, 0.1267, 0.1270, 0.1269, 0.1267, 0.1268, 0.1266,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0232, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3469201
Epoch325: train_loss: 4.1837 recon_acc: 0.2388 val_roc: 0.7341 val_ap: 0.7850 f1: 0.6823 time: 0.2605
thresh 0.46253607
          test_roc: 0.7153 test_ap: 0.7548 test_f1: 0.6758 test_recon_acc: 0.4347
difference_matrix tensor([[0.0000, 0.1263, 0.1268, 0.1266, 0.1266, 0.1267, 0.1264, 0.1265, 0.1264,
         0.1265],
        [0.1263, 0.0000, 0.1266, 0.1264, 0.1266, 0.1264, 0.1265, 0.1263, 0.1267,
         0.1264],
        [0.1268, 0.1266, 0.0000, 0.1266, 0.1274, 0.1268, 0.1266, 0.1267, 0.1270,
         0.1266],
        [0.1266, 0.1264, 0.1266, 0.0000, 0.1269, 0.1269, 0.1266, 0.1263, 0.1269,
         0.1266],
        [0.1266, 0.1266, 0.1274, 0.1269, 0.0000, 0.1267, 0.1270, 0.1268, 0.1269,
         0.1269],
        [0.1267, 0.1264, 0.1268, 0.1269, 0.1267, 0.0000, 0.1268, 0.1266, 0.1266,
         0.1267],
        [0.1264, 0.1265, 0.1266, 0.1266, 0.1270, 0.1268, 0.0000, 0.1263, 0.1272,
         0.1265],
        [0.1265, 0.1263, 0.1267, 0.1263, 0.1268, 0.1266, 0.1263, 0.0000, 0.1265,
         0.1266],
        [0.1264, 0.1267, 0.1270, 0.1269, 0.1269, 0.1266, 0.1272, 0.1265, 0.0000,
         0.1265],
        [0.1265, 0.1264, 0.1266, 0.1266, 0.1269, 0.1267, 0.1265, 0.1266, 0.1265,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0233, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34701598
Epoch326: train_loss: 4.1826 recon_acc: 0.2388 val_roc: 0.7344 val_ap: 0.7855 f1: 0.6823 time: 0.2892
thresh 0.46312627
          test_roc: 0.7156 test_ap: 0.7553 test_f1: 0.6758 test_recon_acc: 0.4358
difference_matrix tensor([[0.0000, 0.1262, 0.1267, 0.1265, 0.1265, 0.1265, 0.1263, 0.1263, 0.1262,
         0.1264],
        [0.1262, 0.0000, 0.1264, 0.1262, 0.1264, 0.1263, 0.1264, 0.1261, 0.1266,
         0.1263],
        [0.1267, 0.1264, 0.0000, 0.1265, 0.1272, 0.1267, 0.1265, 0.1266, 0.1269,
         0.1265],
        [0.1265, 0.1262, 0.1265, 0.0000, 0.1268, 0.1268, 0.1265, 0.1261, 0.1268,
         0.1264],
        [0.1265, 0.1264, 0.1272, 0.1268, 0.0000, 0.1266, 0.1269, 0.1266, 0.1268,
         0.1267],
        [0.1265, 0.1263, 0.1267, 0.1268, 0.1266, 0.0000, 0.1266, 0.1265, 0.1265,
         0.1266],
        [0.1263, 0.1264, 0.1265, 0.1265, 0.1269, 0.1266, 0.0000, 0.1262, 0.1270,
         0.1264],
        [0.1263, 0.1261, 0.1266, 0.1261, 0.1266, 0.1265, 0.1262, 0.0000, 0.1264,
         0.1265],
        [0.1262, 0.1266, 0.1269, 0.1268, 0.1268, 0.1265, 0.1270, 0.1264, 0.0000,
         0.1264],
        [0.1264, 0.1263, 0.1265, 0.1264, 0.1267, 0.1266, 0.1264, 0.1265, 0.1264,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0235, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3471123
Epoch327: train_loss: 4.1814 recon_acc: 0.2388 val_roc: 0.7346 val_ap: 0.7858 f1: 0.6823 time: 0.2778
thresh 0.46371663
          test_roc: 0.7160 test_ap: 0.7557 test_f1: 0.6758 test_recon_acc: 0.4368
difference_matrix tensor([[0.0000, 0.1261, 0.1266, 0.1263, 0.1263, 0.1264, 0.1262, 0.1262, 0.1261,
         0.1263],
        [0.1261, 0.0000, 0.1263, 0.1261, 0.1263, 0.1261, 0.1262, 0.1260, 0.1265,
         0.1262],
        [0.1266, 0.1263, 0.0000, 0.1263, 0.1271, 0.1266, 0.1263, 0.1264, 0.1268,
         0.1264],
        [0.1263, 0.1261, 0.1263, 0.0000, 0.1266, 0.1267, 0.1263, 0.1260, 0.1266,
         0.1263],
        [0.1263, 0.1263, 0.1271, 0.1266, 0.0000, 0.1264, 0.1268, 0.1265, 0.1267,
         0.1266],
        [0.1264, 0.1261, 0.1266, 0.1267, 0.1264, 0.0000, 0.1265, 0.1264, 0.1264,
         0.1265],
        [0.1262, 0.1262, 0.1263, 0.1263, 0.1268, 0.1265, 0.0000, 0.1260, 0.1269,
         0.1263],
        [0.1262, 0.1260, 0.1264, 0.1260, 0.1265, 0.1264, 0.1260, 0.0000, 0.1262,
         0.1264],
        [0.1261, 0.1265, 0.1268, 0.1266, 0.1267, 0.1264, 0.1269, 0.1262, 0.0000,
         0.1262],
        [0.1263, 0.1262, 0.1264, 0.1263, 0.1266, 0.1265, 0.1263, 0.1264, 0.1262,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0236, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3472089
Epoch328: train_loss: 4.1803 recon_acc: 0.2388 val_roc: 0.7347 val_ap: 0.7860 f1: 0.6823 time: 0.2509
thresh 0.46430728
          test_roc: 0.7162 test_ap: 0.7560 test_f1: 0.6758 test_recon_acc: 0.4378
difference_matrix tensor([[0.0000, 0.1259, 0.1264, 0.1262, 0.1262, 0.1263, 0.1260, 0.1261, 0.1260,
         0.1261],
        [0.1259, 0.0000, 0.1262, 0.1260, 0.1262, 0.1260, 0.1261, 0.1259, 0.1263,
         0.1260],
        [0.1264, 0.1262, 0.0000, 0.1262, 0.1270, 0.1264, 0.1262, 0.1263, 0.1266,
         0.1263],
        [0.1262, 0.1260, 0.1262, 0.0000, 0.1265, 0.1265, 0.1262, 0.1259, 0.1265,
         0.1262],
        [0.1262, 0.1262, 0.1270, 0.1265, 0.0000, 0.1263, 0.1266, 0.1264, 0.1265,
         0.1265],
        [0.1263, 0.1260, 0.1264, 0.1265, 0.1263, 0.0000, 0.1264, 0.1262, 0.1262,
         0.1263],
        [0.1260, 0.1261, 0.1262, 0.1262, 0.1266, 0.1264, 0.0000, 0.1259, 0.1268,
         0.1261],
        [0.1261, 0.1259, 0.1263, 0.1259, 0.1264, 0.1262, 0.1259, 0.0000, 0.1261,
         0.1262],
        [0.1260, 0.1263, 0.1266, 0.1265, 0.1265, 0.1262, 0.1268, 0.1261, 0.0000,
         0.1261],
        [0.1261, 0.1260, 0.1263, 0.1262, 0.1265, 0.1263, 0.1261, 0.1262, 0.1261,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0237, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34730583
Epoch329: train_loss: 4.1792 recon_acc: 0.2388 val_roc: 0.7352 val_ap: 0.7865 f1: 0.6823 time: 0.2766
thresh 0.46451598
          test_roc: 0.7166 test_ap: 0.7564 test_f1: 0.6758 test_recon_acc: 0.4381
difference_matrix tensor([[0.0000, 0.1258, 0.1263, 0.1261, 0.1261, 0.1261, 0.1259, 0.1259, 0.1259,
         0.1260],
        [0.1258, 0.0000, 0.1260, 0.1258, 0.1260, 0.1259, 0.1260, 0.1257, 0.1262,
         0.1259],
        [0.1263, 0.1260, 0.0000, 0.1261, 0.1268, 0.1263, 0.1261, 0.1262, 0.1265,
         0.1261],
        [0.1261, 0.1258, 0.1261, 0.0000, 0.1264, 0.1264, 0.1261, 0.1257, 0.1264,
         0.1260],
        [0.1261, 0.1260, 0.1268, 0.1264, 0.0000, 0.1262, 0.1265, 0.1262, 0.1264,
         0.1263],
        [0.1261, 0.1259, 0.1263, 0.1264, 0.1262, 0.0000, 0.1263, 0.1261, 0.1261,
         0.1262],
        [0.1259, 0.1260, 0.1261, 0.1261, 0.1265, 0.1263, 0.0000, 0.1258, 0.1266,
         0.1260],
        [0.1259, 0.1257, 0.1262, 0.1257, 0.1262, 0.1261, 0.1258, 0.0000, 0.1260,
         0.1261],
        [0.1259, 0.1262, 0.1265, 0.1264, 0.1264, 0.1261, 0.1266, 0.1260, 0.0000,
         0.1260],
        [0.1260, 0.1259, 0.1261, 0.1260, 0.1263, 0.1262, 0.1260, 0.1261, 0.1260,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0239, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3474031
Epoch330: train_loss: 4.1781 recon_acc: 0.2388 val_roc: 0.7355 val_ap: 0.7867 f1: 0.6823 time: 0.2751
thresh 0.4639337
          test_roc: 0.7167 test_ap: 0.7567 test_f1: 0.6758 test_recon_acc: 0.4370
difference_matrix tensor([[0.0000, 0.1257, 0.1262, 0.1259, 0.1259, 0.1260, 0.1258, 0.1258, 0.1257,
         0.1259],
        [0.1257, 0.0000, 0.1259, 0.1257, 0.1259, 0.1258, 0.1258, 0.1256, 0.1261,
         0.1258],
        [0.1262, 0.1259, 0.0000, 0.1259, 0.1267, 0.1262, 0.1259, 0.1260, 0.1264,
         0.1260],
        [0.1259, 0.1257, 0.1259, 0.0000, 0.1262, 0.1263, 0.1259, 0.1256, 0.1263,
         0.1259],
        [0.1259, 0.1259, 0.1267, 0.1262, 0.0000, 0.1260, 0.1264, 0.1261, 0.1263,
         0.1262],
        [0.1260, 0.1258, 0.1262, 0.1263, 0.1260, 0.0000, 0.1261, 0.1260, 0.1260,
         0.1261],
        [0.1258, 0.1258, 0.1259, 0.1259, 0.1264, 0.1261, 0.0000, 0.1256, 0.1265,
         0.1259],
        [0.1258, 0.1256, 0.1260, 0.1256, 0.1261, 0.1260, 0.1256, 0.0000, 0.1258,
         0.1260],
        [0.1257, 0.1261, 0.1264, 0.1263, 0.1263, 0.1260, 0.1265, 0.1258, 0.0000,
         0.1258],
        [0.1259, 0.1258, 0.1260, 0.1259, 0.1262, 0.1261, 0.1259, 0.1260, 0.1258,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0240, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34750062
Epoch331: train_loss: 4.1770 recon_acc: 0.2388 val_roc: 0.7357 val_ap: 0.7870 f1: 0.6823 time: 0.2693
thresh 0.46335676
          test_roc: 0.7170 test_ap: 0.7574 test_f1: 0.6752 test_recon_acc: 0.4360
difference_matrix tensor([[0.0000, 0.1255, 0.1260, 0.1258, 0.1258, 0.1259, 0.1257, 0.1257, 0.1256,
         0.1257],
        [0.1255, 0.0000, 0.1258, 0.1256, 0.1258, 0.1256, 0.1257, 0.1255, 0.1259,
         0.1256],
        [0.1260, 0.1258, 0.0000, 0.1258, 0.1266, 0.1261, 0.1258, 0.1259, 0.1262,
         0.1259],
        [0.1258, 0.1256, 0.1258, 0.0000, 0.1261, 0.1262, 0.1258, 0.1255, 0.1261,
         0.1258],
        [0.1258, 0.1258, 0.1266, 0.1261, 0.0000, 0.1259, 0.1262, 0.1260, 0.1261,
         0.1261],
        [0.1259, 0.1256, 0.1261, 0.1262, 0.1259, 0.0000, 0.1260, 0.1259, 0.1259,
         0.1259],
        [0.1257, 0.1257, 0.1258, 0.1258, 0.1262, 0.1260, 0.0000, 0.1255, 0.1264,
         0.1257],
        [0.1257, 0.1255, 0.1259, 0.1255, 0.1260, 0.1259, 0.1255, 0.0000, 0.1257,
         0.1258],
        [0.1256, 0.1259, 0.1262, 0.1261, 0.1261, 0.1259, 0.1264, 0.1257, 0.0000,
         0.1257],
        [0.1257, 0.1256, 0.1259, 0.1258, 0.1261, 0.1259, 0.1257, 0.1258, 0.1257,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0241, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34759828
Epoch332: train_loss: 4.1759 recon_acc: 0.2388 val_roc: 0.7360 val_ap: 0.7874 f1: 0.6823 time: 0.2529
thresh 0.46667197
          test_roc: 0.7173 test_ap: 0.7579 test_f1: 0.6746 test_recon_acc: 0.4419
difference_matrix tensor([[0.0000, 0.1254, 0.1259, 0.1257, 0.1257, 0.1258, 0.1255, 0.1255, 0.1255,
         0.1256],
        [0.1254, 0.0000, 0.1257, 0.1255, 0.1256, 0.1255, 0.1256, 0.1253, 0.1258,
         0.1255],
        [0.1259, 0.1257, 0.0000, 0.1257, 0.1265, 0.1259, 0.1257, 0.1258, 0.1261,
         0.1257],
        [0.1257, 0.1255, 0.1257, 0.0000, 0.1260, 0.1260, 0.1257, 0.1253, 0.1260,
         0.1256],
        [0.1257, 0.1256, 0.1265, 0.1260, 0.0000, 0.1258, 0.1261, 0.1258, 0.1260,
         0.1259],
        [0.1258, 0.1255, 0.1259, 0.1260, 0.1258, 0.0000, 0.1259, 0.1257, 0.1257,
         0.1258],
        [0.1255, 0.1256, 0.1257, 0.1257, 0.1261, 0.1259, 0.0000, 0.1254, 0.1262,
         0.1256],
        [0.1255, 0.1253, 0.1258, 0.1253, 0.1258, 0.1257, 0.1254, 0.0000, 0.1256,
         0.1257],
        [0.1255, 0.1258, 0.1261, 0.1260, 0.1260, 0.1257, 0.1262, 0.1256, 0.0000,
         0.1256],
        [0.1256, 0.1255, 0.1257, 0.1256, 0.1259, 0.1258, 0.1256, 0.1257, 0.1256,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0243, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34769613
Epoch333: train_loss: 4.1748 recon_acc: 0.2388 val_roc: 0.7363 val_ap: 0.7878 f1: 0.6823 time: 0.2836
thresh 0.46701434
          test_roc: 0.7177 test_ap: 0.7584 test_f1: 0.6746 test_recon_acc: 0.4425
difference_matrix tensor([[0.0000, 0.1253, 0.1258, 0.1255, 0.1256, 0.1256, 0.1254, 0.1254, 0.1253,
         0.1255],
        [0.1253, 0.0000, 0.1255, 0.1253, 0.1255, 0.1254, 0.1254, 0.1252, 0.1257,
         0.1254],
        [0.1258, 0.1255, 0.0000, 0.1256, 0.1263, 0.1258, 0.1256, 0.1257, 0.1260,
         0.1256],
        [0.1255, 0.1253, 0.1256, 0.0000, 0.1258, 0.1259, 0.1255, 0.1252, 0.1259,
         0.1255],
        [0.1256, 0.1255, 0.1263, 0.1258, 0.0000, 0.1256, 0.1260, 0.1257, 0.1259,
         0.1258],
        [0.1256, 0.1254, 0.1258, 0.1259, 0.1256, 0.0000, 0.1257, 0.1256, 0.1256,
         0.1257],
        [0.1254, 0.1254, 0.1256, 0.1255, 0.1260, 0.1257, 0.0000, 0.1252, 0.1261,
         0.1255],
        [0.1254, 0.1252, 0.1257, 0.1252, 0.1257, 0.1256, 0.1252, 0.0000, 0.1255,
         0.1256],
        [0.1253, 0.1257, 0.1260, 0.1259, 0.1259, 0.1256, 0.1261, 0.1255, 0.0000,
         0.1254],
        [0.1255, 0.1254, 0.1256, 0.1255, 0.1258, 0.1257, 0.1255, 0.1256, 0.1254,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0244, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3577081
Epoch334: train_loss: 4.1738 recon_acc: 0.2543 val_roc: 0.7368 val_ap: 0.7882 f1: 0.6824 time: 0.2804
thresh 0.46620235
          test_roc: 0.7180 test_ap: 0.7589 test_f1: 0.6746 test_recon_acc: 0.4410
difference_matrix tensor([[0.0000, 0.1252, 0.1256, 0.1254, 0.1254, 0.1255, 0.1253, 0.1253, 0.1252,
         0.1254],
        [0.1252, 0.0000, 0.1254, 0.1252, 0.1254, 0.1252, 0.1253, 0.1251, 0.1256,
         0.1252],
        [0.1256, 0.1254, 0.0000, 0.1254, 0.1262, 0.1257, 0.1254, 0.1255, 0.1259,
         0.1255],
        [0.1254, 0.1252, 0.1254, 0.0000, 0.1257, 0.1258, 0.1254, 0.1251, 0.1257,
         0.1254],
        [0.1254, 0.1254, 0.1262, 0.1257, 0.0000, 0.1255, 0.1259, 0.1256, 0.1258,
         0.1257],
        [0.1255, 0.1252, 0.1257, 0.1258, 0.1255, 0.0000, 0.1256, 0.1255, 0.1255,
         0.1256],
        [0.1253, 0.1253, 0.1254, 0.1254, 0.1259, 0.1256, 0.0000, 0.1251, 0.1260,
         0.1254],
        [0.1253, 0.1251, 0.1255, 0.1251, 0.1256, 0.1255, 0.1251, 0.0000, 0.1253,
         0.1254],
        [0.1252, 0.1256, 0.1259, 0.1257, 0.1258, 0.1255, 0.1260, 0.1253, 0.0000,
         0.1253],
        [0.1254, 0.1252, 0.1255, 0.1254, 0.1257, 0.1256, 0.1254, 0.1254, 0.1253,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0245, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35317516
Epoch335: train_loss: 4.1727 recon_acc: 0.2471 val_roc: 0.7373 val_ap: 0.7888 f1: 0.6824 time: 0.2607
thresh 0.4684492
          test_roc: 0.7183 test_ap: 0.7592 test_f1: 0.6740 test_recon_acc: 0.4450
difference_matrix tensor([[0.0000, 0.1250, 0.1255, 0.1253, 0.1253, 0.1254, 0.1251, 0.1252, 0.1251,
         0.1252],
        [0.1250, 0.0000, 0.1253, 0.1251, 0.1252, 0.1251, 0.1252, 0.1250, 0.1254,
         0.1251],
        [0.1255, 0.1253, 0.0000, 0.1253, 0.1261, 0.1255, 0.1253, 0.1254, 0.1257,
         0.1254],
        [0.1253, 0.1251, 0.1253, 0.0000, 0.1256, 0.1257, 0.1253, 0.1250, 0.1256,
         0.1253],
        [0.1253, 0.1252, 0.1261, 0.1256, 0.0000, 0.1254, 0.1257, 0.1255, 0.1256,
         0.1256],
        [0.1254, 0.1251, 0.1255, 0.1257, 0.1254, 0.0000, 0.1255, 0.1253, 0.1254,
         0.1254],
        [0.1251, 0.1252, 0.1253, 0.1253, 0.1257, 0.1255, 0.0000, 0.1250, 0.1259,
         0.1252],
        [0.1252, 0.1250, 0.1254, 0.1250, 0.1255, 0.1253, 0.1250, 0.0000, 0.1252,
         0.1253],
        [0.1251, 0.1254, 0.1257, 0.1256, 0.1256, 0.1254, 0.1259, 0.1252, 0.0000,
         0.1252],
        [0.1252, 0.1251, 0.1254, 0.1253, 0.1256, 0.1254, 0.1252, 0.1253, 0.1252,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0246, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35364154
Epoch336: train_loss: 4.1717 recon_acc: 0.2476 val_roc: 0.7377 val_ap: 0.7892 f1: 0.6824 time: 0.2590
thresh 0.46904248
          test_roc: 0.7185 test_ap: 0.7595 test_f1: 0.6740 test_recon_acc: 0.4461
difference_matrix tensor([[0.0000, 0.1249, 0.1254, 0.1252, 0.1252, 0.1253, 0.1250, 0.1250, 0.1250,
         0.1251],
        [0.1249, 0.0000, 0.1252, 0.1249, 0.1251, 0.1250, 0.1251, 0.1248, 0.1253,
         0.1250],
        [0.1254, 0.1252, 0.0000, 0.1252, 0.1259, 0.1254, 0.1252, 0.1253, 0.1256,
         0.1252],
        [0.1252, 0.1249, 0.1252, 0.0000, 0.1255, 0.1255, 0.1252, 0.1248, 0.1255,
         0.1251],
        [0.1252, 0.1251, 0.1259, 0.1255, 0.0000, 0.1253, 0.1256, 0.1253, 0.1255,
         0.1254],
        [0.1253, 0.1250, 0.1254, 0.1255, 0.1253, 0.0000, 0.1254, 0.1252, 0.1252,
         0.1253],
        [0.1250, 0.1251, 0.1252, 0.1252, 0.1256, 0.1254, 0.0000, 0.1248, 0.1257,
         0.1251],
        [0.1250, 0.1248, 0.1253, 0.1248, 0.1253, 0.1252, 0.1248, 0.0000, 0.1251,
         0.1252],
        [0.1250, 0.1253, 0.1256, 0.1255, 0.1255, 0.1252, 0.1257, 0.1251, 0.0000,
         0.1251],
        [0.1251, 0.1250, 0.1252, 0.1251, 0.1254, 0.1253, 0.1251, 0.1252, 0.1251,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0248, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3541068
Epoch337: train_loss: 4.1706 recon_acc: 0.2482 val_roc: 0.7381 val_ap: 0.7896 f1: 0.6824 time: 0.2665
thresh 0.46886888
          test_roc: 0.7187 test_ap: 0.7598 test_f1: 0.6740 test_recon_acc: 0.4457
difference_matrix tensor([[0.0000, 0.1248, 0.1253, 0.1250, 0.1250, 0.1251, 0.1249, 0.1249, 0.1248,
         0.1250],
        [0.1248, 0.0000, 0.1250, 0.1248, 0.1250, 0.1249, 0.1249, 0.1247, 0.1252,
         0.1249],
        [0.1253, 0.1250, 0.0000, 0.1251, 0.1258, 0.1253, 0.1251, 0.1252, 0.1255,
         0.1251],
        [0.1250, 0.1248, 0.1251, 0.0000, 0.1253, 0.1254, 0.1250, 0.1247, 0.1254,
         0.1250],
        [0.1250, 0.1250, 0.1258, 0.1253, 0.0000, 0.1251, 0.1255, 0.1252, 0.1254,
         0.1253],
        [0.1251, 0.1249, 0.1253, 0.1254, 0.1251, 0.0000, 0.1252, 0.1251, 0.1251,
         0.1252],
        [0.1249, 0.1249, 0.1251, 0.1250, 0.1255, 0.1252, 0.0000, 0.1247, 0.1256,
         0.1250],
        [0.1249, 0.1247, 0.1252, 0.1247, 0.1252, 0.1251, 0.1247, 0.0000, 0.1250,
         0.1251],
        [0.1248, 0.1252, 0.1255, 0.1254, 0.1254, 0.1251, 0.1256, 0.1250, 0.0000,
         0.1249],
        [0.1250, 0.1249, 0.1251, 0.1250, 0.1253, 0.1252, 0.1250, 0.1251, 0.1249,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0249, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35457104
Epoch338: train_loss: 4.1696 recon_acc: 0.2488 val_roc: 0.7385 val_ap: 0.7900 f1: 0.6835 time: 0.2814
thresh 0.46858507
          test_roc: 0.7190 test_ap: 0.7601 test_f1: 0.6740 test_recon_acc: 0.4452
difference_matrix tensor([[0.0000, 0.1247, 0.1251, 0.1249, 0.1249, 0.1250, 0.1248, 0.1248, 0.1247,
         0.1249],
        [0.1247, 0.0000, 0.1249, 0.1247, 0.1249, 0.1248, 0.1248, 0.1246, 0.1251,
         0.1247],
        [0.1251, 0.1249, 0.0000, 0.1249, 0.1257, 0.1252, 0.1249, 0.1250, 0.1254,
         0.1250],
        [0.1249, 0.1247, 0.1249, 0.0000, 0.1252, 0.1253, 0.1249, 0.1246, 0.1252,
         0.1249],
        [0.1249, 0.1249, 0.1257, 0.1252, 0.0000, 0.1250, 0.1254, 0.1251, 0.1253,
         0.1252],
        [0.1250, 0.1248, 0.1252, 0.1253, 0.1250, 0.0000, 0.1251, 0.1250, 0.1250,
         0.1251],
        [0.1248, 0.1248, 0.1249, 0.1249, 0.1254, 0.1251, 0.0000, 0.1246, 0.1255,
         0.1249],
        [0.1248, 0.1246, 0.1250, 0.1246, 0.1251, 0.1250, 0.1246, 0.0000, 0.1248,
         0.1249],
        [0.1247, 0.1251, 0.1254, 0.1252, 0.1253, 0.1250, 0.1255, 0.1248, 0.0000,
         0.1248],
        [0.1249, 0.1247, 0.1250, 0.1249, 0.1252, 0.1251, 0.1249, 0.1249, 0.1248,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0250, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35503423
Epoch339: train_loss: 4.1686 recon_acc: 0.2494 val_roc: 0.7389 val_ap: 0.7905 f1: 0.6835 time: 0.2768
thresh 0.46830317
          test_roc: 0.7193 test_ap: 0.7606 test_f1: 0.6740 test_recon_acc: 0.4446
difference_matrix tensor([[0.0000, 0.1245, 0.1250, 0.1248, 0.1248, 0.1249, 0.1246, 0.1247, 0.1246,
         0.1247],
        [0.1245, 0.0000, 0.1248, 0.1246, 0.1247, 0.1246, 0.1247, 0.1245, 0.1249,
         0.1246],
        [0.1250, 0.1248, 0.0000, 0.1248, 0.1256, 0.1251, 0.1248, 0.1249, 0.1252,
         0.1249],
        [0.1248, 0.1246, 0.1248, 0.0000, 0.1251, 0.1252, 0.1248, 0.1245, 0.1251,
         0.1248],
        [0.1248, 0.1247, 0.1256, 0.1251, 0.0000, 0.1249, 0.1252, 0.1250, 0.1251,
         0.1251],
        [0.1249, 0.1246, 0.1251, 0.1252, 0.1249, 0.0000, 0.1250, 0.1249, 0.1249,
         0.1249],
        [0.1246, 0.1247, 0.1248, 0.1248, 0.1252, 0.1250, 0.0000, 0.1245, 0.1254,
         0.1247],
        [0.1247, 0.1245, 0.1249, 0.1245, 0.1250, 0.1249, 0.1245, 0.0000, 0.1247,
         0.1248],
        [0.1246, 0.1249, 0.1252, 0.1251, 0.1251, 0.1249, 0.1254, 0.1247, 0.0000,
         0.1247],
        [0.1247, 0.1246, 0.1249, 0.1248, 0.1251, 0.1249, 0.1247, 0.1248, 0.1247,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0251, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3554963
Epoch340: train_loss: 4.1676 recon_acc: 0.2500 val_roc: 0.7392 val_ap: 0.7909 f1: 0.6835 time: 0.2628
thresh 0.46881378
          test_roc: 0.7196 test_ap: 0.7609 test_f1: 0.6728 test_recon_acc: 0.4455
difference_matrix tensor([[0.0000, 0.1244, 0.1249, 0.1247, 0.1247, 0.1248, 0.1245, 0.1245, 0.1245,
         0.1246],
        [0.1244, 0.0000, 0.1247, 0.1244, 0.1246, 0.1245, 0.1246, 0.1243, 0.1248,
         0.1245],
        [0.1249, 0.1247, 0.0000, 0.1247, 0.1254, 0.1249, 0.1247, 0.1248, 0.1251,
         0.1247],
        [0.1247, 0.1244, 0.1247, 0.0000, 0.1250, 0.1250, 0.1247, 0.1243, 0.1250,
         0.1246],
        [0.1247, 0.1246, 0.1254, 0.1250, 0.0000, 0.1248, 0.1251, 0.1248, 0.1250,
         0.1249],
        [0.1248, 0.1245, 0.1249, 0.1250, 0.1248, 0.0000, 0.1249, 0.1247, 0.1247,
         0.1248],
        [0.1245, 0.1246, 0.1247, 0.1247, 0.1251, 0.1249, 0.0000, 0.1243, 0.1252,
         0.1246],
        [0.1245, 0.1243, 0.1248, 0.1243, 0.1248, 0.1247, 0.1243, 0.0000, 0.1246,
         0.1247],
        [0.1245, 0.1248, 0.1251, 0.1250, 0.1250, 0.1247, 0.1252, 0.1246, 0.0000,
         0.1246],
        [0.1246, 0.1245, 0.1247, 0.1246, 0.1249, 0.1248, 0.1246, 0.1247, 0.1246,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0253, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35595733
Epoch341: train_loss: 4.1666 recon_acc: 0.2506 val_roc: 0.7394 val_ap: 0.7910 f1: 0.6835 time: 0.2905
thresh 0.53658396
          test_roc: 0.7199 test_ap: 0.7614 test_f1: 0.6727 test_recon_acc: 0.5689
difference_matrix tensor([[0.0000, 0.1243, 0.1248, 0.1245, 0.1246, 0.1247, 0.1244, 0.1244, 0.1243,
         0.1245],
        [0.1243, 0.0000, 0.1245, 0.1243, 0.1245, 0.1244, 0.1244, 0.1242, 0.1247,
         0.1244],
        [0.1248, 0.1245, 0.0000, 0.1246, 0.1253, 0.1248, 0.1246, 0.1247, 0.1250,
         0.1246],
        [0.1245, 0.1243, 0.1246, 0.0000, 0.1248, 0.1249, 0.1245, 0.1242, 0.1249,
         0.1245],
        [0.1246, 0.1245, 0.1253, 0.1248, 0.0000, 0.1246, 0.1250, 0.1247, 0.1249,
         0.1248],
        [0.1247, 0.1244, 0.1248, 0.1249, 0.1246, 0.0000, 0.1248, 0.1246, 0.1246,
         0.1247],
        [0.1244, 0.1244, 0.1246, 0.1245, 0.1250, 0.1248, 0.0000, 0.1242, 0.1251,
         0.1245],
        [0.1244, 0.1242, 0.1247, 0.1242, 0.1247, 0.1246, 0.1242, 0.0000, 0.1245,
         0.1246],
        [0.1243, 0.1247, 0.1250, 0.1249, 0.1249, 0.1246, 0.1251, 0.1245, 0.0000,
         0.1244],
        [0.1245, 0.1244, 0.1246, 0.1245, 0.1248, 0.1247, 0.1245, 0.1246, 0.1244,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0254, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3564173
Epoch342: train_loss: 4.1656 recon_acc: 0.2512 val_roc: 0.7396 val_ap: 0.7914 f1: 0.6835 time: 0.2909
thresh 0.45554134
          test_roc: 0.7201 test_ap: 0.7616 test_f1: 0.6727 test_recon_acc: 0.4215
difference_matrix tensor([[0.0000, 0.1242, 0.1247, 0.1244, 0.1244, 0.1245, 0.1243, 0.1243, 0.1242,
         0.1244],
        [0.1242, 0.0000, 0.1244, 0.1242, 0.1244, 0.1243, 0.1243, 0.1241, 0.1246,
         0.1243],
        [0.1247, 0.1244, 0.0000, 0.1244, 0.1252, 0.1247, 0.1244, 0.1246, 0.1249,
         0.1245],
        [0.1244, 0.1242, 0.1244, 0.0000, 0.1247, 0.1248, 0.1244, 0.1241, 0.1248,
         0.1244],
        [0.1244, 0.1244, 0.1252, 0.1247, 0.0000, 0.1245, 0.1249, 0.1246, 0.1248,
         0.1247],
        [0.1245, 0.1243, 0.1247, 0.1248, 0.1245, 0.0000, 0.1246, 0.1245, 0.1245,
         0.1246],
        [0.1243, 0.1243, 0.1244, 0.1244, 0.1249, 0.1246, 0.0000, 0.1241, 0.1250,
         0.1244],
        [0.1243, 0.1241, 0.1246, 0.1241, 0.1246, 0.1245, 0.1241, 0.0000, 0.1244,
         0.1245],
        [0.1242, 0.1246, 0.1249, 0.1248, 0.1248, 0.1245, 0.1250, 0.1244, 0.0000,
         0.1243],
        [0.1244, 0.1243, 0.1245, 0.1244, 0.1247, 0.1246, 0.1244, 0.1245, 0.1243,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0255, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35687622
Epoch343: train_loss: 4.1646 recon_acc: 0.2518 val_roc: 0.7400 val_ap: 0.7918 f1: 0.6835 time: 0.2493
thresh 0.5467472
          test_roc: 0.7205 test_ap: 0.7621 test_f1: 0.6728 test_recon_acc: 0.5873
difference_matrix tensor([[0.0000, 0.1241, 0.1245, 0.1243, 0.1243, 0.1244, 0.1241, 0.1242, 0.1241,
         0.1242],
        [0.1241, 0.0000, 0.1243, 0.1241, 0.1242, 0.1241, 0.1242, 0.1240, 0.1244,
         0.1241],
        [0.1245, 0.1243, 0.0000, 0.1243, 0.1251, 0.1246, 0.1243, 0.1244, 0.1248,
         0.1244],
        [0.1243, 0.1241, 0.1243, 0.0000, 0.1246, 0.1247, 0.1243, 0.1240, 0.1246,
         0.1243],
        [0.1243, 0.1242, 0.1251, 0.1246, 0.0000, 0.1244, 0.1247, 0.1245, 0.1246,
         0.1246],
        [0.1244, 0.1241, 0.1246, 0.1247, 0.1244, 0.0000, 0.1245, 0.1244, 0.1244,
         0.1244],
        [0.1241, 0.1242, 0.1243, 0.1243, 0.1247, 0.1245, 0.0000, 0.1240, 0.1249,
         0.1243],
        [0.1242, 0.1240, 0.1244, 0.1240, 0.1245, 0.1244, 0.1240, 0.0000, 0.1242,
         0.1243],
        [0.1241, 0.1244, 0.1248, 0.1246, 0.1246, 0.1244, 0.1249, 0.1242, 0.0000,
         0.1242],
        [0.1242, 0.1241, 0.1244, 0.1243, 0.1246, 0.1244, 0.1243, 0.1243, 0.1242,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0256, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32175794
Epoch344: train_loss: 4.1636 recon_acc: 0.1983 val_roc: 0.7404 val_ap: 0.7921 f1: 0.6840 time: 0.2522
thresh 0.5476481
          test_roc: 0.7209 test_ap: 0.7627 test_f1: 0.6728 test_recon_acc: 0.5890
difference_matrix tensor([[0.0000, 0.1239, 0.1244, 0.1242, 0.1242, 0.1243, 0.1240, 0.1241, 0.1240,
         0.1241],
        [0.1239, 0.0000, 0.1242, 0.1240, 0.1241, 0.1240, 0.1241, 0.1239, 0.1243,
         0.1240],
        [0.1244, 0.1242, 0.0000, 0.1242, 0.1250, 0.1244, 0.1242, 0.1243, 0.1247,
         0.1243],
        [0.1242, 0.1240, 0.1242, 0.0000, 0.1245, 0.1246, 0.1242, 0.1239, 0.1245,
         0.1242],
        [0.1242, 0.1241, 0.1250, 0.1245, 0.0000, 0.1243, 0.1246, 0.1244, 0.1245,
         0.1245],
        [0.1243, 0.1240, 0.1244, 0.1246, 0.1243, 0.0000, 0.1244, 0.1243, 0.1243,
         0.1243],
        [0.1240, 0.1241, 0.1242, 0.1242, 0.1246, 0.1244, 0.0000, 0.1239, 0.1247,
         0.1241],
        [0.1241, 0.1239, 0.1243, 0.1238, 0.1244, 0.1243, 0.1239, 0.0000, 0.1241,
         0.1242],
        [0.1240, 0.1243, 0.1247, 0.1245, 0.1245, 0.1243, 0.1247, 0.1241, 0.0000,
         0.1241],
        [0.1241, 0.1240, 0.1243, 0.1242, 0.1245, 0.1243, 0.1241, 0.1242, 0.1241,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0258, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32268173
Epoch345: train_loss: 4.1626 recon_acc: 0.1995 val_roc: 0.7408 val_ap: 0.7928 f1: 0.6840 time: 0.2625
thresh 0.5485488
          test_roc: 0.7212 test_ap: 0.7631 test_f1: 0.6735 test_recon_acc: 0.5907
difference_matrix tensor([[0.0000, 0.1238, 0.1243, 0.1241, 0.1241, 0.1242, 0.1239, 0.1239, 0.1239,
         0.1240],
        [0.1238, 0.0000, 0.1241, 0.1238, 0.1240, 0.1239, 0.1239, 0.1237, 0.1242,
         0.1239],
        [0.1243, 0.1241, 0.0000, 0.1241, 0.1248, 0.1243, 0.1241, 0.1242, 0.1245,
         0.1242],
        [0.1241, 0.1238, 0.1241, 0.0000, 0.1244, 0.1244, 0.1241, 0.1237, 0.1244,
         0.1240],
        [0.1241, 0.1240, 0.1248, 0.1244, 0.0000, 0.1242, 0.1245, 0.1242, 0.1244,
         0.1243],
        [0.1242, 0.1239, 0.1243, 0.1244, 0.1242, 0.0000, 0.1243, 0.1241, 0.1241,
         0.1242],
        [0.1239, 0.1239, 0.1241, 0.1241, 0.1245, 0.1243, 0.0000, 0.1237, 0.1246,
         0.1240],
        [0.1239, 0.1237, 0.1242, 0.1237, 0.1242, 0.1241, 0.1237, 0.0000, 0.1240,
         0.1241],
        [0.1239, 0.1242, 0.1245, 0.1244, 0.1244, 0.1241, 0.1246, 0.1240, 0.0000,
         0.1240],
        [0.1240, 0.1239, 0.1242, 0.1240, 0.1243, 0.1242, 0.1240, 0.1241, 0.1240,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0259, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.32361647
Epoch346: train_loss: 4.1617 recon_acc: 0.2007 val_roc: 0.7411 val_ap: 0.7930 f1: 0.6840 time: 0.2795
thresh 0.5494495
          test_roc: 0.7215 test_ap: 0.7635 test_f1: 0.6742 test_recon_acc: 0.5924
difference_matrix tensor([[0.0000, 0.1237, 0.1242, 0.1239, 0.1239, 0.1241, 0.1238, 0.1238, 0.1237,
         0.1239],
        [0.1237, 0.0000, 0.1239, 0.1237, 0.1239, 0.1238, 0.1238, 0.1236, 0.1241,
         0.1238],
        [0.1242, 0.1239, 0.0000, 0.1240, 0.1247, 0.1242, 0.1240, 0.1241, 0.1244,
         0.1240],
        [0.1239, 0.1237, 0.1240, 0.0000, 0.1243, 0.1243, 0.1239, 0.1236, 0.1243,
         0.1239],
        [0.1239, 0.1239, 0.1247, 0.1243, 0.0000, 0.1240, 0.1244, 0.1241, 0.1243,
         0.1242],
        [0.1241, 0.1238, 0.1242, 0.1243, 0.1240, 0.0000, 0.1242, 0.1240, 0.1240,
         0.1241],
        [0.1238, 0.1238, 0.1240, 0.1239, 0.1244, 0.1242, 0.0000, 0.1236, 0.1245,
         0.1239],
        [0.1238, 0.1236, 0.1241, 0.1236, 0.1241, 0.1240, 0.1236, 0.0000, 0.1239,
         0.1240],
        [0.1237, 0.1241, 0.1244, 0.1243, 0.1243, 0.1240, 0.1245, 0.1239, 0.0000,
         0.1239],
        [0.1239, 0.1238, 0.1240, 0.1239, 0.1242, 0.1241, 0.1239, 0.1240, 0.1239,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0260, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35251597
Epoch347: train_loss: 4.1607 recon_acc: 0.2444 val_roc: 0.7413 val_ap: 0.7931 f1: 0.6846 time: 0.2869
thresh 0.53425485
          test_roc: 0.7218 test_ap: 0.7638 test_f1: 0.6747 test_recon_acc: 0.5650
difference_matrix tensor([[0.0000, 0.1236, 0.1241, 0.1238, 0.1238, 0.1240, 0.1237, 0.1237, 0.1236,
         0.1238],
        [0.1236, 0.0000, 0.1238, 0.1236, 0.1238, 0.1237, 0.1237, 0.1235, 0.1240,
         0.1237],
        [0.1241, 0.1238, 0.0000, 0.1239, 0.1246, 0.1241, 0.1238, 0.1240, 0.1243,
         0.1239],
        [0.1238, 0.1236, 0.1239, 0.0000, 0.1241, 0.1242, 0.1238, 0.1235, 0.1242,
         0.1238],
        [0.1238, 0.1238, 0.1246, 0.1241, 0.0000, 0.1239, 0.1243, 0.1240, 0.1242,
         0.1241],
        [0.1240, 0.1237, 0.1241, 0.1242, 0.1239, 0.0000, 0.1240, 0.1239, 0.1239,
         0.1240],
        [0.1237, 0.1237, 0.1238, 0.1238, 0.1243, 0.1240, 0.0000, 0.1235, 0.1244,
         0.1238],
        [0.1237, 0.1235, 0.1240, 0.1235, 0.1240, 0.1239, 0.1235, 0.0000, 0.1238,
         0.1239],
        [0.1236, 0.1240, 0.1243, 0.1242, 0.1242, 0.1239, 0.1244, 0.1238, 0.0000,
         0.1237],
        [0.1238, 0.1237, 0.1239, 0.1238, 0.1241, 0.1240, 0.1238, 0.1239, 0.1237,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0261, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35428047
Epoch348: train_loss: 4.1598 recon_acc: 0.2471 val_roc: 0.7417 val_ap: 0.7937 f1: 0.6857 time: 0.2438
thresh 0.53388965
          test_roc: 0.7221 test_ap: 0.7642 test_f1: 0.6747 test_recon_acc: 0.5644
difference_matrix tensor([[0.0000, 0.1235, 0.1239, 0.1237, 0.1237, 0.1238, 0.1236, 0.1236, 0.1235,
         0.1237],
        [0.1235, 0.0000, 0.1237, 0.1235, 0.1237, 0.1236, 0.1236, 0.1234, 0.1239,
         0.1235],
        [0.1239, 0.1237, 0.0000, 0.1237, 0.1245, 0.1240, 0.1237, 0.1239, 0.1242,
         0.1238],
        [0.1237, 0.1235, 0.1237, 0.0000, 0.1240, 0.1241, 0.1237, 0.1234, 0.1240,
         0.1237],
        [0.1237, 0.1237, 0.1245, 0.1240, 0.0000, 0.1238, 0.1242, 0.1239, 0.1241,
         0.1240],
        [0.1238, 0.1236, 0.1240, 0.1241, 0.1238, 0.0000, 0.1239, 0.1238, 0.1238,
         0.1239],
        [0.1236, 0.1236, 0.1237, 0.1237, 0.1242, 0.1239, 0.0000, 0.1234, 0.1243,
         0.1237],
        [0.1236, 0.1234, 0.1239, 0.1234, 0.1239, 0.1238, 0.1234, 0.0000, 0.1236,
         0.1237],
        [0.1235, 0.1239, 0.1242, 0.1240, 0.1241, 0.1238, 0.1243, 0.1236, 0.0000,
         0.1236],
        [0.1237, 0.1235, 0.1238, 0.1237, 0.1240, 0.1239, 0.1237, 0.1237, 0.1236,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0262, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3560486
Epoch349: train_loss: 4.1589 recon_acc: 0.2497 val_roc: 0.7420 val_ap: 0.7941 f1: 0.6857 time: 0.2789
thresh 0.53353125
          test_roc: 0.7223 test_ap: 0.7645 test_f1: 0.6747 test_recon_acc: 0.5637
difference_matrix tensor([[0.0000, 0.1233, 0.1238, 0.1236, 0.1236, 0.1237, 0.1234, 0.1235, 0.1234,
         0.1235],
        [0.1233, 0.0000, 0.1236, 0.1234, 0.1235, 0.1235, 0.1235, 0.1233, 0.1237,
         0.1234],
        [0.1238, 0.1236, 0.0000, 0.1236, 0.1244, 0.1239, 0.1236, 0.1237, 0.1241,
         0.1237],
        [0.1236, 0.1234, 0.1236, 0.0000, 0.1239, 0.1240, 0.1236, 0.1233, 0.1239,
         0.1236],
        [0.1236, 0.1235, 0.1244, 0.1239, 0.0000, 0.1237, 0.1240, 0.1238, 0.1239,
         0.1239],
        [0.1237, 0.1235, 0.1239, 0.1240, 0.1237, 0.0000, 0.1238, 0.1237, 0.1237,
         0.1237],
        [0.1234, 0.1235, 0.1236, 0.1236, 0.1240, 0.1238, 0.0000, 0.1233, 0.1242,
         0.1236],
        [0.1235, 0.1233, 0.1237, 0.1233, 0.1238, 0.1237, 0.1233, 0.0000, 0.1235,
         0.1236],
        [0.1234, 0.1237, 0.1241, 0.1239, 0.1239, 0.1237, 0.1242, 0.1235, 0.0000,
         0.1235],
        [0.1235, 0.1234, 0.1237, 0.1236, 0.1239, 0.1237, 0.1236, 0.1236, 0.1235,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0263, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35782015
Epoch350: train_loss: 4.1579 recon_acc: 0.2524 val_roc: 0.7422 val_ap: 0.7943 f1: 0.6857 time: 0.2804
thresh 0.54498786
          test_roc: 0.7225 test_ap: 0.7648 test_f1: 0.6749 test_recon_acc: 0.5846
difference_matrix tensor([[0.0000, 0.1232, 0.1237, 0.1235, 0.1235, 0.1236, 0.1233, 0.1234, 0.1233,
         0.1234],
        [0.1232, 0.0000, 0.1235, 0.1233, 0.1234, 0.1233, 0.1234, 0.1231, 0.1236,
         0.1233],
        [0.1237, 0.1235, 0.0000, 0.1235, 0.1242, 0.1238, 0.1235, 0.1236, 0.1240,
         0.1236],
        [0.1235, 0.1233, 0.1235, 0.0000, 0.1238, 0.1239, 0.1235, 0.1231, 0.1238,
         0.1235],
        [0.1235, 0.1234, 0.1242, 0.1238, 0.0000, 0.1236, 0.1239, 0.1237, 0.1238,
         0.1238],
        [0.1236, 0.1233, 0.1238, 0.1239, 0.1236, 0.0000, 0.1237, 0.1236, 0.1236,
         0.1236],
        [0.1233, 0.1234, 0.1235, 0.1235, 0.1239, 0.1237, 0.0000, 0.1232, 0.1240,
         0.1234],
        [0.1234, 0.1231, 0.1236, 0.1231, 0.1237, 0.1236, 0.1232, 0.0000, 0.1234,
         0.1235],
        [0.1233, 0.1236, 0.1240, 0.1238, 0.1238, 0.1236, 0.1240, 0.1234, 0.0000,
         0.1234],
        [0.1234, 0.1233, 0.1236, 0.1235, 0.1238, 0.1236, 0.1234, 0.1235, 0.1234,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0265, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35773855
Epoch351: train_loss: 4.1570 recon_acc: 0.2522 val_roc: 0.7427 val_ap: 0.7948 f1: 0.6857 time: 0.2767
thresh 0.5396719
          test_roc: 0.7227 test_ap: 0.7652 test_f1: 0.6755 test_recon_acc: 0.5750
difference_matrix tensor([[0.0000, 0.1231, 0.1236, 0.1234, 0.1234, 0.1235, 0.1232, 0.1232, 0.1232,
         0.1233],
        [0.1231, 0.0000, 0.1234, 0.1231, 0.1233, 0.1232, 0.1232, 0.1230, 0.1235,
         0.1232],
        [0.1236, 0.1234, 0.0000, 0.1234, 0.1241, 0.1236, 0.1234, 0.1235, 0.1239,
         0.1235],
        [0.1234, 0.1231, 0.1234, 0.0000, 0.1237, 0.1238, 0.1233, 0.1230, 0.1237,
         0.1233],
        [0.1234, 0.1233, 0.1241, 0.1237, 0.0000, 0.1235, 0.1238, 0.1235, 0.1237,
         0.1236],
        [0.1235, 0.1232, 0.1236, 0.1238, 0.1235, 0.0000, 0.1236, 0.1235, 0.1234,
         0.1235],
        [0.1232, 0.1232, 0.1234, 0.1233, 0.1238, 0.1236, 0.0000, 0.1230, 0.1239,
         0.1233],
        [0.1232, 0.1230, 0.1235, 0.1230, 0.1235, 0.1235, 0.1230, 0.0000, 0.1233,
         0.1234],
        [0.1232, 0.1235, 0.1239, 0.1237, 0.1237, 0.1234, 0.1239, 0.1233, 0.0000,
         0.1233],
        [0.1233, 0.1232, 0.1235, 0.1233, 0.1236, 0.1235, 0.1233, 0.1234, 0.1233,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0266, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35753104
Epoch352: train_loss: 4.1561 recon_acc: 0.2518 val_roc: 0.7429 val_ap: 0.7951 f1: 0.6857 time: 0.2651
thresh 0.53986406
          test_roc: 0.7230 test_ap: 0.7657 test_f1: 0.6762 test_recon_acc: 0.5754
difference_matrix tensor([[0.0000, 0.1230, 0.1235, 0.1232, 0.1233, 0.1234, 0.1231, 0.1231, 0.1230,
         0.1232],
        [0.1230, 0.0000, 0.1233, 0.1230, 0.1232, 0.1231, 0.1231, 0.1229, 0.1234,
         0.1231],
        [0.1235, 0.1233, 0.0000, 0.1233, 0.1240, 0.1235, 0.1233, 0.1234, 0.1237,
         0.1234],
        [0.1232, 0.1230, 0.1233, 0.0000, 0.1236, 0.1236, 0.1232, 0.1229, 0.1236,
         0.1232],
        [0.1233, 0.1232, 0.1240, 0.1236, 0.0000, 0.1234, 0.1237, 0.1234, 0.1236,
         0.1235],
        [0.1234, 0.1231, 0.1235, 0.1236, 0.1234, 0.0000, 0.1235, 0.1233, 0.1233,
         0.1234],
        [0.1231, 0.1231, 0.1233, 0.1232, 0.1237, 0.1235, 0.0000, 0.1229, 0.1238,
         0.1232],
        [0.1231, 0.1229, 0.1234, 0.1229, 0.1234, 0.1233, 0.1229, 0.0000, 0.1232,
         0.1233],
        [0.1230, 0.1234, 0.1237, 0.1236, 0.1236, 0.1233, 0.1238, 0.1232, 0.0000,
         0.1232],
        [0.1232, 0.1231, 0.1234, 0.1232, 0.1235, 0.1234, 0.1232, 0.1233, 0.1232,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0267, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35732552
Epoch353: train_loss: 4.1552 recon_acc: 0.2513 val_roc: 0.7432 val_ap: 0.7955 f1: 0.6857 time: 0.3148
thresh 0.5400599
          test_roc: 0.7233 test_ap: 0.7661 test_f1: 0.6769 test_recon_acc: 0.5758
difference_matrix tensor([[0.0000, 0.1229, 0.1234, 0.1231, 0.1231, 0.1233, 0.1230, 0.1230, 0.1229,
         0.1231],
        [0.1229, 0.0000, 0.1231, 0.1229, 0.1231, 0.1230, 0.1230, 0.1228, 0.1233,
         0.1230],
        [0.1234, 0.1231, 0.0000, 0.1232, 0.1239, 0.1234, 0.1232, 0.1233, 0.1236,
         0.1232],
        [0.1231, 0.1229, 0.1232, 0.0000, 0.1234, 0.1235, 0.1231, 0.1228, 0.1235,
         0.1231],
        [0.1231, 0.1231, 0.1239, 0.1234, 0.0000, 0.1232, 0.1236, 0.1233, 0.1235,
         0.1234],
        [0.1233, 0.1230, 0.1234, 0.1235, 0.1232, 0.0000, 0.1234, 0.1232, 0.1232,
         0.1233],
        [0.1230, 0.1230, 0.1232, 0.1231, 0.1236, 0.1234, 0.0000, 0.1228, 0.1237,
         0.1231],
        [0.1230, 0.1228, 0.1233, 0.1228, 0.1233, 0.1232, 0.1228, 0.0000, 0.1231,
         0.1232],
        [0.1229, 0.1233, 0.1236, 0.1235, 0.1235, 0.1232, 0.1237, 0.1231, 0.0000,
         0.1230],
        [0.1231, 0.1230, 0.1232, 0.1231, 0.1234, 0.1233, 0.1231, 0.1232, 0.1230,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0268, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35712174
Epoch354: train_loss: 4.1543 recon_acc: 0.2509 val_roc: 0.7437 val_ap: 0.7961 f1: 0.6857 time: 0.3108
thresh 0.5431548
          test_roc: 0.7236 test_ap: 0.7664 test_f1: 0.6769 test_recon_acc: 0.5815
difference_matrix tensor([[0.0000, 0.1228, 0.1233, 0.1230, 0.1230, 0.1232, 0.1229, 0.1229, 0.1228,
         0.1230],
        [0.1228, 0.0000, 0.1230, 0.1228, 0.1230, 0.1229, 0.1229, 0.1227, 0.1232,
         0.1229],
        [0.1233, 0.1230, 0.0000, 0.1231, 0.1238, 0.1233, 0.1230, 0.1232, 0.1235,
         0.1231],
        [0.1230, 0.1228, 0.1231, 0.0000, 0.1233, 0.1234, 0.1230, 0.1227, 0.1234,
         0.1230],
        [0.1230, 0.1230, 0.1238, 0.1233, 0.0000, 0.1231, 0.1235, 0.1232, 0.1234,
         0.1233],
        [0.1232, 0.1229, 0.1233, 0.1234, 0.1231, 0.0000, 0.1233, 0.1231, 0.1231,
         0.1232],
        [0.1229, 0.1229, 0.1230, 0.1230, 0.1235, 0.1233, 0.0000, 0.1227, 0.1236,
         0.1230],
        [0.1229, 0.1227, 0.1232, 0.1227, 0.1232, 0.1231, 0.1227, 0.0000, 0.1230,
         0.1231],
        [0.1228, 0.1232, 0.1235, 0.1234, 0.1234, 0.1231, 0.1236, 0.1230, 0.0000,
         0.1229],
        [0.1230, 0.1229, 0.1231, 0.1230, 0.1233, 0.1232, 0.1230, 0.1231, 0.1229,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0269, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3569198
Epoch355: train_loss: 4.1535 recon_acc: 0.2505 val_roc: 0.7441 val_ap: 0.7964 f1: 0.6857 time: 0.2733
thresh 0.54046303
          test_roc: 0.7238 test_ap: 0.7667 test_f1: 0.6776 test_recon_acc: 0.5766
difference_matrix tensor([[0.0000, 0.1227, 0.1232, 0.1229, 0.1229, 0.1231, 0.1228, 0.1228, 0.1227,
         0.1229],
        [0.1227, 0.0000, 0.1229, 0.1227, 0.1228, 0.1228, 0.1228, 0.1226, 0.1231,
         0.1228],
        [0.1232, 0.1229, 0.0000, 0.1229, 0.1237, 0.1232, 0.1229, 0.1231, 0.1234,
         0.1230],
        [0.1229, 0.1227, 0.1229, 0.0000, 0.1232, 0.1233, 0.1229, 0.1226, 0.1233,
         0.1229],
        [0.1229, 0.1228, 0.1237, 0.1232, 0.0000, 0.1230, 0.1234, 0.1231, 0.1233,
         0.1232],
        [0.1231, 0.1228, 0.1232, 0.1233, 0.1230, 0.0000, 0.1231, 0.1230, 0.1230,
         0.1231],
        [0.1228, 0.1228, 0.1229, 0.1229, 0.1234, 0.1231, 0.0000, 0.1226, 0.1235,
         0.1229],
        [0.1228, 0.1226, 0.1231, 0.1226, 0.1231, 0.1230, 0.1226, 0.0000, 0.1229,
         0.1229],
        [0.1227, 0.1231, 0.1234, 0.1233, 0.1233, 0.1230, 0.1235, 0.1229, 0.0000,
         0.1228],
        [0.1229, 0.1228, 0.1230, 0.1229, 0.1232, 0.1231, 0.1229, 0.1229, 0.1228,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0270, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35671967
Epoch356: train_loss: 4.1526 recon_acc: 0.2500 val_roc: 0.7445 val_ap: 0.7967 f1: 0.6857 time: 0.2924
thresh 0.54067016
          test_roc: 0.7242 test_ap: 0.7670 test_f1: 0.6776 test_recon_acc: 0.5770
difference_matrix tensor([[0.0000, 0.1226, 0.1230, 0.1228, 0.1228, 0.1229, 0.1226, 0.1227, 0.1226,
         0.1228],
        [0.1226, 0.0000, 0.1228, 0.1226, 0.1227, 0.1227, 0.1227, 0.1225, 0.1230,
         0.1226],
        [0.1230, 0.1228, 0.0000, 0.1228, 0.1236, 0.1231, 0.1228, 0.1230, 0.1233,
         0.1229],
        [0.1228, 0.1226, 0.1228, 0.0000, 0.1231, 0.1232, 0.1228, 0.1225, 0.1231,
         0.1228],
        [0.1228, 0.1227, 0.1236, 0.1231, 0.0000, 0.1229, 0.1233, 0.1230, 0.1232,
         0.1231],
        [0.1229, 0.1227, 0.1231, 0.1232, 0.1229, 0.0000, 0.1230, 0.1229, 0.1229,
         0.1230],
        [0.1226, 0.1227, 0.1228, 0.1228, 0.1233, 0.1230, 0.0000, 0.1225, 0.1234,
         0.1228],
        [0.1227, 0.1225, 0.1230, 0.1225, 0.1230, 0.1229, 0.1225, 0.0000, 0.1227,
         0.1228],
        [0.1226, 0.1230, 0.1233, 0.1231, 0.1232, 0.1229, 0.1234, 0.1227, 0.0000,
         0.1227],
        [0.1228, 0.1226, 0.1229, 0.1228, 0.1231, 0.1230, 0.1228, 0.1228, 0.1227,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0271, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35652128
Epoch357: train_loss: 4.1517 recon_acc: 0.2496 val_roc: 0.7446 val_ap: 0.7970 f1: 0.6857 time: 0.2998
thresh 0.54088086
          test_roc: 0.7245 test_ap: 0.7673 test_f1: 0.6782 test_recon_acc: 0.5774
difference_matrix tensor([[0.0000, 0.1224, 0.1229, 0.1227, 0.1227, 0.1228, 0.1225, 0.1226, 0.1225,
         0.1227],
        [0.1224, 0.0000, 0.1227, 0.1225, 0.1226, 0.1226, 0.1226, 0.1224, 0.1228,
         0.1225],
        [0.1229, 0.1227, 0.0000, 0.1227, 0.1235, 0.1230, 0.1227, 0.1229, 0.1232,
         0.1228],
        [0.1227, 0.1225, 0.1227, 0.0000, 0.1230, 0.1231, 0.1227, 0.1224, 0.1230,
         0.1227],
        [0.1227, 0.1226, 0.1235, 0.1230, 0.0000, 0.1228, 0.1231, 0.1229, 0.1231,
         0.1230],
        [0.1228, 0.1226, 0.1230, 0.1231, 0.1228, 0.0000, 0.1229, 0.1228, 0.1228,
         0.1228],
        [0.1225, 0.1226, 0.1227, 0.1227, 0.1231, 0.1229, 0.0000, 0.1224, 0.1233,
         0.1227],
        [0.1226, 0.1224, 0.1229, 0.1224, 0.1229, 0.1228, 0.1224, 0.0000, 0.1226,
         0.1227],
        [0.1225, 0.1228, 0.1232, 0.1230, 0.1231, 0.1228, 0.1233, 0.1226, 0.0000,
         0.1226],
        [0.1227, 0.1225, 0.1228, 0.1227, 0.1230, 0.1228, 0.1227, 0.1227, 0.1226,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0272, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3563246
Epoch358: train_loss: 4.1509 recon_acc: 0.2491 val_roc: 0.7451 val_ap: 0.7975 f1: 0.6857 time: 0.2553
thresh 0.54109526
          test_roc: 0.7247 test_ap: 0.7676 test_f1: 0.6782 test_recon_acc: 0.5779
difference_matrix tensor([[0.0000, 0.1223, 0.1228, 0.1226, 0.1226, 0.1227, 0.1224, 0.1225, 0.1224,
         0.1225],
        [0.1223, 0.0000, 0.1226, 0.1224, 0.1225, 0.1225, 0.1225, 0.1222, 0.1227,
         0.1224],
        [0.1228, 0.1226, 0.0000, 0.1226, 0.1233, 0.1229, 0.1226, 0.1228, 0.1231,
         0.1227],
        [0.1226, 0.1224, 0.1226, 0.0000, 0.1229, 0.1230, 0.1226, 0.1223, 0.1229,
         0.1226],
        [0.1226, 0.1225, 0.1233, 0.1229, 0.0000, 0.1227, 0.1230, 0.1228, 0.1229,
         0.1229],
        [0.1227, 0.1225, 0.1229, 0.1230, 0.1227, 0.0000, 0.1228, 0.1227, 0.1227,
         0.1227],
        [0.1224, 0.1225, 0.1226, 0.1226, 0.1230, 0.1228, 0.0000, 0.1223, 0.1231,
         0.1226],
        [0.1225, 0.1222, 0.1228, 0.1223, 0.1228, 0.1227, 0.1223, 0.0000, 0.1225,
         0.1226],
        [0.1224, 0.1227, 0.1231, 0.1229, 0.1229, 0.1227, 0.1231, 0.1225, 0.0000,
         0.1225],
        [0.1225, 0.1224, 0.1227, 0.1226, 0.1229, 0.1227, 0.1225, 0.1226, 0.1225,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0273, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35612962
Epoch359: train_loss: 4.1500 recon_acc: 0.2487 val_roc: 0.7455 val_ap: 0.7979 f1: 0.6857 time: 0.2663
thresh 0.5412716
          test_roc: 0.7250 test_ap: 0.7680 test_f1: 0.6782 test_recon_acc: 0.5783
difference_matrix tensor([[0.0000, 0.1222, 0.1227, 0.1225, 0.1225, 0.1226, 0.1223, 0.1224, 0.1223,
         0.1224],
        [0.1222, 0.0000, 0.1225, 0.1222, 0.1224, 0.1224, 0.1223, 0.1221, 0.1226,
         0.1223],
        [0.1227, 0.1225, 0.0000, 0.1225, 0.1232, 0.1228, 0.1225, 0.1226, 0.1230,
         0.1226],
        [0.1225, 0.1222, 0.1225, 0.0000, 0.1228, 0.1229, 0.1225, 0.1221, 0.1228,
         0.1225],
        [0.1225, 0.1224, 0.1232, 0.1228, 0.0000, 0.1226, 0.1229, 0.1227, 0.1228,
         0.1228],
        [0.1226, 0.1224, 0.1228, 0.1229, 0.1226, 0.0000, 0.1227, 0.1226, 0.1226,
         0.1226],
        [0.1223, 0.1223, 0.1225, 0.1225, 0.1229, 0.1227, 0.0000, 0.1221, 0.1230,
         0.1224],
        [0.1224, 0.1221, 0.1226, 0.1221, 0.1227, 0.1226, 0.1221, 0.0000, 0.1224,
         0.1225],
        [0.1223, 0.1226, 0.1230, 0.1228, 0.1228, 0.1226, 0.1230, 0.1224, 0.0000,
         0.1224],
        [0.1224, 0.1223, 0.1226, 0.1225, 0.1228, 0.1226, 0.1224, 0.1225, 0.1224,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0274, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35593638
Epoch360: train_loss: 4.1492 recon_acc: 0.2483 val_roc: 0.7459 val_ap: 0.7983 f1: 0.6857 time: 0.2787
thresh 0.5408801
          test_roc: 0.7252 test_ap: 0.7686 test_f1: 0.6782 test_recon_acc: 0.5776
difference_matrix tensor([[0.0000, 0.1221, 0.1226, 0.1224, 0.1224, 0.1225, 0.1222, 0.1223, 0.1222,
         0.1223],
        [0.1221, 0.0000, 0.1224, 0.1221, 0.1223, 0.1223, 0.1222, 0.1220, 0.1225,
         0.1222],
        [0.1226, 0.1224, 0.0000, 0.1224, 0.1231, 0.1227, 0.1224, 0.1225, 0.1229,
         0.1225],
        [0.1224, 0.1221, 0.1224, 0.0000, 0.1227, 0.1228, 0.1223, 0.1220, 0.1227,
         0.1224],
        [0.1224, 0.1223, 0.1231, 0.1227, 0.0000, 0.1225, 0.1228, 0.1225, 0.1227,
         0.1227],
        [0.1225, 0.1223, 0.1227, 0.1228, 0.1225, 0.0000, 0.1226, 0.1225, 0.1225,
         0.1225],
        [0.1222, 0.1222, 0.1224, 0.1223, 0.1228, 0.1226, 0.0000, 0.1220, 0.1229,
         0.1223],
        [0.1223, 0.1220, 0.1225, 0.1220, 0.1225, 0.1225, 0.1220, 0.0000, 0.1223,
         0.1224],
        [0.1222, 0.1225, 0.1229, 0.1227, 0.1227, 0.1225, 0.1229, 0.1223, 0.0000,
         0.1223],
        [0.1223, 0.1222, 0.1225, 0.1224, 0.1227, 0.1225, 0.1223, 0.1224, 0.1223,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0276, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34795102
Epoch361: train_loss: 4.1484 recon_acc: 0.2356 val_roc: 0.7461 val_ap: 0.7987 f1: 0.6854 time: 0.2637
thresh 0.5404931
          test_roc: 0.7256 test_ap: 0.7690 test_f1: 0.6782 test_recon_acc: 0.5769
difference_matrix tensor([[0.0000, 0.1220, 0.1225, 0.1223, 0.1223, 0.1224, 0.1221, 0.1221, 0.1221,
         0.1222],
        [0.1220, 0.0000, 0.1223, 0.1220, 0.1222, 0.1221, 0.1221, 0.1219, 0.1224,
         0.1221],
        [0.1225, 0.1223, 0.0000, 0.1223, 0.1230, 0.1225, 0.1223, 0.1224, 0.1228,
         0.1224],
        [0.1223, 0.1220, 0.1223, 0.0000, 0.1226, 0.1227, 0.1222, 0.1219, 0.1226,
         0.1222],
        [0.1223, 0.1222, 0.1230, 0.1226, 0.0000, 0.1224, 0.1227, 0.1224, 0.1226,
         0.1226],
        [0.1224, 0.1221, 0.1225, 0.1227, 0.1224, 0.0000, 0.1225, 0.1224, 0.1224,
         0.1224],
        [0.1221, 0.1221, 0.1223, 0.1222, 0.1227, 0.1225, 0.0000, 0.1219, 0.1228,
         0.1222],
        [0.1221, 0.1219, 0.1224, 0.1219, 0.1224, 0.1224, 0.1219, 0.0000, 0.1222,
         0.1223],
        [0.1221, 0.1224, 0.1228, 0.1226, 0.1226, 0.1224, 0.1228, 0.1222, 0.0000,
         0.1222],
        [0.1222, 0.1221, 0.1224, 0.1222, 0.1226, 0.1224, 0.1222, 0.1223, 0.1222,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0277, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34889197
Epoch362: train_loss: 4.1475 recon_acc: 0.2370 val_roc: 0.7464 val_ap: 0.7990 f1: 0.6854 time: 0.2671
thresh 0.5401104
          test_roc: 0.7259 test_ap: 0.7694 test_f1: 0.6789 test_recon_acc: 0.5763
difference_matrix tensor([[0.0000, 0.1219, 0.1224, 0.1221, 0.1222, 0.1223, 0.1220, 0.1220, 0.1220,
         0.1221],
        [0.1219, 0.0000, 0.1222, 0.1219, 0.1221, 0.1220, 0.1220, 0.1218, 0.1223,
         0.1220],
        [0.1224, 0.1222, 0.0000, 0.1222, 0.1229, 0.1224, 0.1222, 0.1223, 0.1227,
         0.1223],
        [0.1221, 0.1219, 0.1222, 0.0000, 0.1225, 0.1226, 0.1221, 0.1218, 0.1225,
         0.1221],
        [0.1222, 0.1221, 0.1229, 0.1225, 0.0000, 0.1223, 0.1226, 0.1223, 0.1225,
         0.1224],
        [0.1223, 0.1220, 0.1224, 0.1226, 0.1223, 0.0000, 0.1224, 0.1223, 0.1223,
         0.1223],
        [0.1220, 0.1220, 0.1222, 0.1221, 0.1226, 0.1224, 0.0000, 0.1218, 0.1227,
         0.1221],
        [0.1220, 0.1218, 0.1223, 0.1218, 0.1223, 0.1223, 0.1218, 0.0000, 0.1221,
         0.1222],
        [0.1220, 0.1223, 0.1227, 0.1225, 0.1225, 0.1223, 0.1227, 0.1221, 0.0000,
         0.1221],
        [0.1221, 0.1220, 0.1223, 0.1221, 0.1224, 0.1223, 0.1221, 0.1222, 0.1221,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0278, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3603573
Epoch363: train_loss: 4.1467 recon_acc: 0.2550 val_roc: 0.7468 val_ap: 0.7993 f1: 0.6858 time: 0.2691
thresh 0.54221946
          test_roc: 0.7261 test_ap: 0.7697 test_f1: 0.6789 test_recon_acc: 0.5802
difference_matrix tensor([[0.0000, 0.1218, 0.1223, 0.1220, 0.1221, 0.1222, 0.1219, 0.1219, 0.1218,
         0.1220],
        [0.1218, 0.0000, 0.1221, 0.1218, 0.1220, 0.1219, 0.1219, 0.1217, 0.1222,
         0.1219],
        [0.1223, 0.1221, 0.0000, 0.1221, 0.1228, 0.1223, 0.1221, 0.1222, 0.1226,
         0.1222],
        [0.1220, 0.1218, 0.1221, 0.0000, 0.1224, 0.1225, 0.1220, 0.1217, 0.1224,
         0.1220],
        [0.1221, 0.1220, 0.1228, 0.1224, 0.0000, 0.1221, 0.1225, 0.1222, 0.1224,
         0.1223],
        [0.1222, 0.1219, 0.1223, 0.1225, 0.1221, 0.0000, 0.1223, 0.1222, 0.1222,
         0.1222],
        [0.1219, 0.1219, 0.1221, 0.1220, 0.1225, 0.1223, 0.0000, 0.1217, 0.1226,
         0.1220],
        [0.1219, 0.1217, 0.1222, 0.1217, 0.1222, 0.1222, 0.1217, 0.0000, 0.1220,
         0.1221],
        [0.1218, 0.1222, 0.1226, 0.1224, 0.1224, 0.1222, 0.1226, 0.1220, 0.0000,
         0.1220],
        [0.1220, 0.1219, 0.1222, 0.1220, 0.1223, 0.1222, 0.1220, 0.1221, 0.1220,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0279, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.36044556
Epoch364: train_loss: 4.1459 recon_acc: 0.2550 val_roc: 0.7471 val_ap: 0.7997 f1: 0.6858 time: 0.2922
thresh 0.54770505
          test_roc: 0.7263 test_ap: 0.7701 test_f1: 0.6784 test_recon_acc: 0.5902
difference_matrix tensor([[0.0000, 0.1217, 0.1222, 0.1219, 0.1219, 0.1221, 0.1218, 0.1218, 0.1217,
         0.1219],
        [0.1217, 0.0000, 0.1220, 0.1217, 0.1219, 0.1218, 0.1218, 0.1216, 0.1221,
         0.1218],
        [0.1222, 0.1220, 0.0000, 0.1220, 0.1227, 0.1222, 0.1220, 0.1221, 0.1225,
         0.1221],
        [0.1219, 0.1217, 0.1220, 0.0000, 0.1223, 0.1224, 0.1219, 0.1216, 0.1223,
         0.1219],
        [0.1219, 0.1219, 0.1227, 0.1223, 0.0000, 0.1220, 0.1224, 0.1221, 0.1223,
         0.1222],
        [0.1221, 0.1218, 0.1222, 0.1224, 0.1220, 0.0000, 0.1222, 0.1221, 0.1220,
         0.1221],
        [0.1218, 0.1218, 0.1220, 0.1219, 0.1224, 0.1222, 0.0000, 0.1216, 0.1225,
         0.1219],
        [0.1218, 0.1216, 0.1221, 0.1216, 0.1221, 0.1221, 0.1216, 0.0000, 0.1219,
         0.1220],
        [0.1217, 0.1221, 0.1225, 0.1223, 0.1223, 0.1220, 0.1225, 0.1219, 0.0000,
         0.1219],
        [0.1219, 0.1218, 0.1221, 0.1219, 0.1222, 0.1221, 0.1219, 0.1220, 0.1219,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0280, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34338322
Epoch365: train_loss: 4.1451 recon_acc: 0.2281 val_roc: 0.7475 val_ap: 0.8003 f1: 0.6865 time: 0.2711
thresh 0.5471163
          test_roc: 0.7266 test_ap: 0.7704 test_f1: 0.6784 test_recon_acc: 0.5892
difference_matrix tensor([[0.0000, 0.1216, 0.1221, 0.1218, 0.1218, 0.1220, 0.1217, 0.1217, 0.1216,
         0.1218],
        [0.1216, 0.0000, 0.1219, 0.1216, 0.1218, 0.1217, 0.1217, 0.1215, 0.1220,
         0.1217],
        [0.1221, 0.1219, 0.0000, 0.1219, 0.1226, 0.1221, 0.1219, 0.1220, 0.1224,
         0.1220],
        [0.1218, 0.1216, 0.1219, 0.0000, 0.1222, 0.1223, 0.1218, 0.1215, 0.1222,
         0.1218],
        [0.1218, 0.1218, 0.1226, 0.1222, 0.0000, 0.1219, 0.1223, 0.1220, 0.1222,
         0.1221],
        [0.1220, 0.1217, 0.1221, 0.1223, 0.1219, 0.0000, 0.1221, 0.1220, 0.1219,
         0.1220],
        [0.1217, 0.1217, 0.1219, 0.1218, 0.1223, 0.1221, 0.0000, 0.1215, 0.1224,
         0.1218],
        [0.1217, 0.1215, 0.1220, 0.1215, 0.1220, 0.1220, 0.1215, 0.0000, 0.1218,
         0.1219],
        [0.1216, 0.1220, 0.1224, 0.1222, 0.1222, 0.1219, 0.1224, 0.1218, 0.0000,
         0.1218],
        [0.1218, 0.1217, 0.1220, 0.1218, 0.1221, 0.1220, 0.1218, 0.1219, 0.1218,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0281, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3445218
Epoch366: train_loss: 4.1443 recon_acc: 0.2298 val_roc: 0.7478 val_ap: 0.8006 f1: 0.6865 time: 0.2736
thresh 0.5480841
          test_roc: 0.7268 test_ap: 0.7706 test_f1: 0.6784 test_recon_acc: 0.5910
difference_matrix tensor([[0.0000, 0.1215, 0.1220, 0.1217, 0.1217, 0.1219, 0.1216, 0.1216, 0.1215,
         0.1217],
        [0.1215, 0.0000, 0.1218, 0.1215, 0.1217, 0.1216, 0.1216, 0.1214, 0.1219,
         0.1216],
        [0.1220, 0.1218, 0.0000, 0.1218, 0.1225, 0.1220, 0.1218, 0.1219, 0.1223,
         0.1219],
        [0.1217, 0.1215, 0.1218, 0.0000, 0.1221, 0.1222, 0.1217, 0.1214, 0.1221,
         0.1217],
        [0.1217, 0.1217, 0.1225, 0.1221, 0.0000, 0.1218, 0.1222, 0.1219, 0.1221,
         0.1220],
        [0.1219, 0.1216, 0.1220, 0.1222, 0.1218, 0.0000, 0.1220, 0.1219, 0.1218,
         0.1219],
        [0.1216, 0.1216, 0.1218, 0.1217, 0.1222, 0.1220, 0.0000, 0.1214, 0.1223,
         0.1217],
        [0.1216, 0.1214, 0.1219, 0.1214, 0.1219, 0.1219, 0.1214, 0.0000, 0.1217,
         0.1218],
        [0.1215, 0.1219, 0.1223, 0.1221, 0.1221, 0.1218, 0.1223, 0.1217, 0.0000,
         0.1217],
        [0.1217, 0.1216, 0.1219, 0.1217, 0.1220, 0.1219, 0.1217, 0.1218, 0.1217,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0282, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34566933
Epoch367: train_loss: 4.1435 recon_acc: 0.2315 val_roc: 0.7479 val_ap: 0.8008 f1: 0.6876 time: 0.2975
thresh 0.54799026
          test_roc: 0.7271 test_ap: 0.7711 test_f1: 0.6784 test_recon_acc: 0.5909
difference_matrix tensor([[0.0000, 0.1214, 0.1219, 0.1216, 0.1216, 0.1218, 0.1215, 0.1215, 0.1214,
         0.1216],
        [0.1214, 0.0000, 0.1217, 0.1214, 0.1216, 0.1215, 0.1215, 0.1213, 0.1218,
         0.1215],
        [0.1219, 0.1217, 0.0000, 0.1217, 0.1224, 0.1219, 0.1217, 0.1218, 0.1222,
         0.1218],
        [0.1216, 0.1214, 0.1217, 0.0000, 0.1219, 0.1221, 0.1216, 0.1213, 0.1220,
         0.1216],
        [0.1216, 0.1216, 0.1224, 0.1219, 0.0000, 0.1217, 0.1221, 0.1218, 0.1220,
         0.1219],
        [0.1218, 0.1215, 0.1219, 0.1221, 0.1217, 0.0000, 0.1219, 0.1218, 0.1217,
         0.1218],
        [0.1215, 0.1215, 0.1217, 0.1216, 0.1221, 0.1219, 0.0000, 0.1213, 0.1222,
         0.1216],
        [0.1215, 0.1213, 0.1218, 0.1213, 0.1218, 0.1218, 0.1213, 0.0000, 0.1216,
         0.1217],
        [0.1214, 0.1218, 0.1222, 0.1220, 0.1220, 0.1217, 0.1222, 0.1216, 0.0000,
         0.1216],
        [0.1216, 0.1215, 0.1218, 0.1216, 0.1219, 0.1218, 0.1216, 0.1217, 0.1216,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0283, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34682587
Epoch368: train_loss: 4.1428 recon_acc: 0.2331 val_roc: 0.7481 val_ap: 0.8010 f1: 0.6876 time: 0.2895
thresh 0.5476956
          test_roc: 0.7274 test_ap: 0.7715 test_f1: 0.6784 test_recon_acc: 0.5904
difference_matrix tensor([[0.0000, 0.1213, 0.1218, 0.1215, 0.1215, 0.1217, 0.1214, 0.1214, 0.1213,
         0.1215],
        [0.1213, 0.0000, 0.1216, 0.1213, 0.1215, 0.1214, 0.1214, 0.1212, 0.1217,
         0.1214],
        [0.1218, 0.1216, 0.0000, 0.1216, 0.1223, 0.1218, 0.1216, 0.1217, 0.1221,
         0.1217],
        [0.1215, 0.1213, 0.1216, 0.0000, 0.1218, 0.1220, 0.1215, 0.1212, 0.1219,
         0.1215],
        [0.1215, 0.1215, 0.1223, 0.1218, 0.0000, 0.1216, 0.1220, 0.1217, 0.1219,
         0.1218],
        [0.1217, 0.1214, 0.1218, 0.1220, 0.1216, 0.0000, 0.1218, 0.1217, 0.1216,
         0.1217],
        [0.1214, 0.1214, 0.1216, 0.1215, 0.1220, 0.1218, 0.0000, 0.1212, 0.1221,
         0.1215],
        [0.1214, 0.1212, 0.1217, 0.1212, 0.1217, 0.1217, 0.1212, 0.0000, 0.1215,
         0.1216],
        [0.1213, 0.1217, 0.1221, 0.1219, 0.1219, 0.1216, 0.1221, 0.1215, 0.0000,
         0.1215],
        [0.1215, 0.1214, 0.1217, 0.1215, 0.1218, 0.1217, 0.1215, 0.1216, 0.1215,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0284, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34799117
Epoch369: train_loss: 4.1420 recon_acc: 0.2349 val_roc: 0.7484 val_ap: 0.8012 f1: 0.6876 time: 0.2734
thresh 0.5474035
          test_roc: 0.7278 test_ap: 0.7720 test_f1: 0.6777 test_recon_acc: 0.5899
difference_matrix tensor([[0.0000, 0.1212, 0.1217, 0.1214, 0.1214, 0.1216, 0.1213, 0.1213, 0.1212,
         0.1214],
        [0.1212, 0.0000, 0.1215, 0.1212, 0.1214, 0.1213, 0.1213, 0.1211, 0.1216,
         0.1213],
        [0.1217, 0.1215, 0.0000, 0.1215, 0.1222, 0.1217, 0.1215, 0.1216, 0.1220,
         0.1216],
        [0.1214, 0.1212, 0.1215, 0.0000, 0.1217, 0.1219, 0.1214, 0.1211, 0.1218,
         0.1214],
        [0.1214, 0.1214, 0.1222, 0.1217, 0.0000, 0.1215, 0.1219, 0.1216, 0.1218,
         0.1217],
        [0.1216, 0.1213, 0.1217, 0.1219, 0.1215, 0.0000, 0.1217, 0.1216, 0.1215,
         0.1216],
        [0.1213, 0.1213, 0.1215, 0.1214, 0.1219, 0.1217, 0.0000, 0.1211, 0.1220,
         0.1214],
        [0.1213, 0.1211, 0.1216, 0.1211, 0.1216, 0.1216, 0.1211, 0.0000, 0.1214,
         0.1215],
        [0.1212, 0.1216, 0.1220, 0.1218, 0.1218, 0.1215, 0.1220, 0.1214, 0.0000,
         0.1214],
        [0.1214, 0.1213, 0.1216, 0.1214, 0.1217, 0.1216, 0.1214, 0.1215, 0.1214,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0285, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34916505
Epoch370: train_loss: 4.1412 recon_acc: 0.2366 val_roc: 0.7486 val_ap: 0.8015 f1: 0.6876 time: 0.2626
thresh 0.5439311
          test_roc: 0.7280 test_ap: 0.7724 test_f1: 0.6776 test_recon_acc: 0.5836
difference_matrix tensor([[0.0000, 0.1211, 0.1216, 0.1213, 0.1213, 0.1215, 0.1212, 0.1212, 0.1211,
         0.1213],
        [0.1211, 0.0000, 0.1214, 0.1211, 0.1213, 0.1212, 0.1212, 0.1210, 0.1215,
         0.1212],
        [0.1216, 0.1214, 0.0000, 0.1214, 0.1221, 0.1216, 0.1214, 0.1215, 0.1219,
         0.1215],
        [0.1213, 0.1211, 0.1214, 0.0000, 0.1216, 0.1218, 0.1213, 0.1210, 0.1217,
         0.1213],
        [0.1213, 0.1213, 0.1221, 0.1216, 0.0000, 0.1214, 0.1218, 0.1215, 0.1217,
         0.1216],
        [0.1215, 0.1212, 0.1216, 0.1218, 0.1214, 0.0000, 0.1216, 0.1215, 0.1214,
         0.1215],
        [0.1212, 0.1212, 0.1214, 0.1213, 0.1218, 0.1216, 0.0000, 0.1210, 0.1219,
         0.1213],
        [0.1212, 0.1210, 0.1215, 0.1210, 0.1215, 0.1215, 0.1210, 0.0000, 0.1213,
         0.1214],
        [0.1211, 0.1215, 0.1219, 0.1217, 0.1217, 0.1214, 0.1219, 0.1213, 0.0000,
         0.1213],
        [0.1213, 0.1212, 0.1215, 0.1213, 0.1216, 0.1215, 0.1213, 0.1214, 0.1213,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0286, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3503475
Epoch371: train_loss: 4.1405 recon_acc: 0.2383 val_roc: 0.7489 val_ap: 0.8017 f1: 0.6876 time: 0.3183
thresh 0.54363537
          test_roc: 0.7282 test_ap: 0.7729 test_f1: 0.6776 test_recon_acc: 0.5831
difference_matrix tensor([[0.0000, 0.1210, 0.1215, 0.1212, 0.1212, 0.1214, 0.1211, 0.1211, 0.1210,
         0.1212],
        [0.1210, 0.0000, 0.1213, 0.1210, 0.1212, 0.1211, 0.1211, 0.1209, 0.1214,
         0.1211],
        [0.1215, 0.1213, 0.0000, 0.1213, 0.1220, 0.1215, 0.1213, 0.1214, 0.1218,
         0.1214],
        [0.1212, 0.1210, 0.1213, 0.0000, 0.1215, 0.1217, 0.1212, 0.1209, 0.1216,
         0.1212],
        [0.1212, 0.1212, 0.1220, 0.1215, 0.0000, 0.1213, 0.1217, 0.1214, 0.1216,
         0.1215],
        [0.1214, 0.1211, 0.1215, 0.1217, 0.1213, 0.0000, 0.1215, 0.1214, 0.1213,
         0.1214],
        [0.1211, 0.1211, 0.1213, 0.1212, 0.1217, 0.1215, 0.0000, 0.1209, 0.1218,
         0.1212],
        [0.1211, 0.1209, 0.1214, 0.1209, 0.1214, 0.1214, 0.1209, 0.0000, 0.1212,
         0.1213],
        [0.1210, 0.1214, 0.1218, 0.1216, 0.1216, 0.1213, 0.1218, 0.1212, 0.0000,
         0.1212],
        [0.1212, 0.1211, 0.1214, 0.1212, 0.1215, 0.1214, 0.1212, 0.1213, 0.1212,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0287, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35122973
Epoch372: train_loss: 4.1397 recon_acc: 0.2396 val_roc: 0.7493 val_ap: 0.8020 f1: 0.6887 time: 0.2798
thresh 0.5430642
          test_roc: 0.7286 test_ap: 0.7733 test_f1: 0.6776 test_recon_acc: 0.5821
difference_matrix tensor([[0.0000, 0.1209, 0.1214, 0.1211, 0.1211, 0.1213, 0.1210, 0.1210, 0.1209,
         0.1211],
        [0.1209, 0.0000, 0.1212, 0.1209, 0.1211, 0.1210, 0.1210, 0.1208, 0.1213,
         0.1210],
        [0.1214, 0.1212, 0.0000, 0.1212, 0.1219, 0.1214, 0.1212, 0.1213, 0.1217,
         0.1213],
        [0.1211, 0.1209, 0.1212, 0.0000, 0.1214, 0.1216, 0.1211, 0.1208, 0.1215,
         0.1211],
        [0.1211, 0.1211, 0.1219, 0.1214, 0.0000, 0.1212, 0.1216, 0.1213, 0.1215,
         0.1214],
        [0.1213, 0.1210, 0.1214, 0.1216, 0.1212, 0.0000, 0.1214, 0.1213, 0.1212,
         0.1213],
        [0.1210, 0.1210, 0.1212, 0.1211, 0.1216, 0.1214, 0.0000, 0.1208, 0.1217,
         0.1211],
        [0.1210, 0.1208, 0.1213, 0.1208, 0.1213, 0.1213, 0.1208, 0.0000, 0.1211,
         0.1212],
        [0.1209, 0.1213, 0.1217, 0.1215, 0.1215, 0.1212, 0.1217, 0.1211, 0.0000,
         0.1211],
        [0.1211, 0.1210, 0.1213, 0.1211, 0.1214, 0.1213, 0.1211, 0.1212, 0.1211,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0288, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3513041
Epoch373: train_loss: 4.1390 recon_acc: 0.2396 val_roc: 0.7495 val_ap: 0.8021 f1: 0.6887 time: 0.2542
thresh 0.5447102
          test_roc: 0.7289 test_ap: 0.7737 test_f1: 0.6776 test_recon_acc: 0.5852
difference_matrix tensor([[0.0000, 0.1208, 0.1213, 0.1210, 0.1210, 0.1212, 0.1209, 0.1209, 0.1208,
         0.1210],
        [0.1208, 0.0000, 0.1211, 0.1208, 0.1210, 0.1209, 0.1209, 0.1207, 0.1212,
         0.1209],
        [0.1213, 0.1211, 0.0000, 0.1211, 0.1218, 0.1213, 0.1211, 0.1212, 0.1216,
         0.1212],
        [0.1210, 0.1208, 0.1211, 0.0000, 0.1214, 0.1215, 0.1210, 0.1207, 0.1214,
         0.1210],
        [0.1210, 0.1210, 0.1218, 0.1214, 0.0000, 0.1211, 0.1215, 0.1212, 0.1214,
         0.1213],
        [0.1212, 0.1209, 0.1213, 0.1215, 0.1211, 0.0000, 0.1213, 0.1212, 0.1211,
         0.1212],
        [0.1209, 0.1209, 0.1211, 0.1210, 0.1215, 0.1213, 0.0000, 0.1207, 0.1216,
         0.1210],
        [0.1209, 0.1207, 0.1212, 0.1207, 0.1212, 0.1212, 0.1207, 0.0000, 0.1210,
         0.1211],
        [0.1208, 0.1212, 0.1216, 0.1214, 0.1214, 0.1211, 0.1216, 0.1210, 0.0000,
         0.1210],
        [0.1210, 0.1209, 0.1212, 0.1210, 0.1213, 0.1212, 0.1210, 0.1211, 0.1210,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0289, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35137734
Epoch374: train_loss: 4.1382 recon_acc: 0.2396 val_roc: 0.7497 val_ap: 0.8025 f1: 0.6887 time: 0.2575
thresh 0.54497564
          test_roc: 0.7291 test_ap: 0.7740 test_f1: 0.6783 test_recon_acc: 0.5857
difference_matrix tensor([[0.0000, 0.1207, 0.1212, 0.1209, 0.1209, 0.1211, 0.1208, 0.1208, 0.1207,
         0.1209],
        [0.1207, 0.0000, 0.1210, 0.1207, 0.1209, 0.1209, 0.1208, 0.1206, 0.1211,
         0.1208],
        [0.1212, 0.1210, 0.0000, 0.1210, 0.1217, 0.1212, 0.1210, 0.1211, 0.1215,
         0.1211],
        [0.1209, 0.1207, 0.1210, 0.0000, 0.1213, 0.1214, 0.1209, 0.1206, 0.1213,
         0.1209],
        [0.1209, 0.1209, 0.1217, 0.1213, 0.0000, 0.1210, 0.1214, 0.1211, 0.1213,
         0.1212],
        [0.1211, 0.1209, 0.1212, 0.1214, 0.1210, 0.0000, 0.1212, 0.1211, 0.1211,
         0.1211],
        [0.1208, 0.1208, 0.1210, 0.1209, 0.1214, 0.1212, 0.0000, 0.1206, 0.1215,
         0.1209],
        [0.1208, 0.1206, 0.1211, 0.1206, 0.1211, 0.1211, 0.1206, 0.0000, 0.1209,
         0.1210],
        [0.1207, 0.1211, 0.1215, 0.1213, 0.1213, 0.1211, 0.1215, 0.1209, 0.0000,
         0.1209],
        [0.1209, 0.1208, 0.1211, 0.1209, 0.1212, 0.1211, 0.1209, 0.1210, 0.1209,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0290, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3532225
Epoch375: train_loss: 4.1375 recon_acc: 0.2424 val_roc: 0.7501 val_ap: 0.8029 f1: 0.6889 time: 0.2498
thresh 0.54524374
          test_roc: 0.7294 test_ap: 0.7744 test_f1: 0.6783 test_recon_acc: 0.5862
difference_matrix tensor([[0.0000, 0.1206, 0.1211, 0.1208, 0.1208, 0.1210, 0.1207, 0.1207, 0.1206,
         0.1208],
        [0.1206, 0.0000, 0.1209, 0.1206, 0.1208, 0.1208, 0.1207, 0.1205, 0.1210,
         0.1207],
        [0.1211, 0.1209, 0.0000, 0.1209, 0.1216, 0.1211, 0.1209, 0.1210, 0.1214,
         0.1210],
        [0.1208, 0.1206, 0.1209, 0.0000, 0.1212, 0.1213, 0.1208, 0.1205, 0.1212,
         0.1208],
        [0.1208, 0.1208, 0.1216, 0.1212, 0.0000, 0.1209, 0.1213, 0.1210, 0.1212,
         0.1211],
        [0.1210, 0.1208, 0.1211, 0.1213, 0.1209, 0.0000, 0.1211, 0.1210, 0.1210,
         0.1210],
        [0.1207, 0.1207, 0.1209, 0.1208, 0.1213, 0.1211, 0.0000, 0.1205, 0.1214,
         0.1208],
        [0.1207, 0.1205, 0.1210, 0.1205, 0.1210, 0.1210, 0.1205, 0.0000, 0.1208,
         0.1209],
        [0.1206, 0.1210, 0.1214, 0.1212, 0.1212, 0.1210, 0.1214, 0.1208, 0.0000,
         0.1208],
        [0.1208, 0.1207, 0.1210, 0.1208, 0.1211, 0.1210, 0.1208, 0.1209, 0.1208,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0291, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35305288
Epoch376: train_loss: 4.1368 recon_acc: 0.2420 val_roc: 0.7503 val_ap: 0.8032 f1: 0.6889 time: 0.2445
thresh 0.5428615
          test_roc: 0.7297 test_ap: 0.7748 test_f1: 0.6790 test_recon_acc: 0.5819
difference_matrix tensor([[0.0000, 0.1205, 0.1210, 0.1207, 0.1207, 0.1209, 0.1206, 0.1206, 0.1206,
         0.1207],
        [0.1205, 0.0000, 0.1208, 0.1205, 0.1207, 0.1207, 0.1206, 0.1204, 0.1209,
         0.1206],
        [0.1210, 0.1208, 0.0000, 0.1208, 0.1215, 0.1210, 0.1208, 0.1209, 0.1213,
         0.1209],
        [0.1207, 0.1205, 0.1208, 0.0000, 0.1211, 0.1212, 0.1207, 0.1204, 0.1211,
         0.1207],
        [0.1207, 0.1207, 0.1215, 0.1211, 0.0000, 0.1208, 0.1212, 0.1209, 0.1211,
         0.1211],
        [0.1209, 0.1207, 0.1210, 0.1212, 0.1208, 0.0000, 0.1210, 0.1209, 0.1209,
         0.1209],
        [0.1206, 0.1206, 0.1208, 0.1207, 0.1212, 0.1210, 0.0000, 0.1204, 0.1213,
         0.1207],
        [0.1206, 0.1204, 0.1209, 0.1204, 0.1209, 0.1209, 0.1204, 0.0000, 0.1207,
         0.1208],
        [0.1206, 0.1209, 0.1213, 0.1211, 0.1211, 0.1209, 0.1213, 0.1207, 0.0000,
         0.1207],
        [0.1207, 0.1206, 0.1209, 0.1207, 0.1211, 0.1209, 0.1207, 0.1208, 0.1207,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0292, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35288456
Epoch377: train_loss: 4.1361 recon_acc: 0.2417 val_roc: 0.7505 val_ap: 0.8034 f1: 0.6889 time: 0.2624
thresh 0.5445948
          test_roc: 0.7300 test_ap: 0.7751 test_f1: 0.6797 test_recon_acc: 0.5851
difference_matrix tensor([[0.0000, 0.1204, 0.1209, 0.1206, 0.1207, 0.1208, 0.1205, 0.1205, 0.1205,
         0.1206],
        [0.1204, 0.0000, 0.1207, 0.1204, 0.1206, 0.1206, 0.1205, 0.1203, 0.1208,
         0.1205],
        [0.1209, 0.1207, 0.0000, 0.1207, 0.1214, 0.1209, 0.1207, 0.1209, 0.1212,
         0.1208],
        [0.1206, 0.1204, 0.1207, 0.0000, 0.1210, 0.1211, 0.1206, 0.1203, 0.1210,
         0.1206],
        [0.1207, 0.1206, 0.1214, 0.1210, 0.0000, 0.1207, 0.1211, 0.1208, 0.1210,
         0.1210],
        [0.1208, 0.1206, 0.1209, 0.1211, 0.1207, 0.0000, 0.1209, 0.1208, 0.1208,
         0.1208],
        [0.1205, 0.1205, 0.1207, 0.1206, 0.1211, 0.1209, 0.0000, 0.1203, 0.1212,
         0.1206],
        [0.1205, 0.1203, 0.1209, 0.1203, 0.1208, 0.1208, 0.1203, 0.0000, 0.1206,
         0.1207],
        [0.1205, 0.1208, 0.1212, 0.1210, 0.1210, 0.1208, 0.1212, 0.1206, 0.0000,
         0.1206],
        [0.1206, 0.1205, 0.1208, 0.1206, 0.1210, 0.1208, 0.1206, 0.1207, 0.1206,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0293, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35165802
Epoch378: train_loss: 4.1354 recon_acc: 0.2396 val_roc: 0.7510 val_ap: 0.8039 f1: 0.6899 time: 0.2723
thresh 0.5448885
          test_roc: 0.7303 test_ap: 0.7755 test_f1: 0.6797 test_recon_acc: 0.5857
difference_matrix tensor([[0.0000, 0.1203, 0.1208, 0.1205, 0.1206, 0.1207, 0.1204, 0.1204, 0.1204,
         0.1205],
        [0.1203, 0.0000, 0.1206, 0.1203, 0.1205, 0.1205, 0.1204, 0.1202, 0.1207,
         0.1204],
        [0.1208, 0.1206, 0.0000, 0.1206, 0.1213, 0.1209, 0.1206, 0.1208, 0.1211,
         0.1207],
        [0.1205, 0.1203, 0.1206, 0.0000, 0.1209, 0.1210, 0.1205, 0.1202, 0.1209,
         0.1206],
        [0.1206, 0.1205, 0.1213, 0.1209, 0.0000, 0.1206, 0.1210, 0.1207, 0.1209,
         0.1209],
        [0.1207, 0.1205, 0.1209, 0.1210, 0.1206, 0.0000, 0.1208, 0.1207, 0.1207,
         0.1207],
        [0.1204, 0.1204, 0.1206, 0.1205, 0.1210, 0.1208, 0.0000, 0.1202, 0.1211,
         0.1205],
        [0.1204, 0.1202, 0.1208, 0.1202, 0.1207, 0.1207, 0.1202, 0.0000, 0.1205,
         0.1206],
        [0.1204, 0.1207, 0.1211, 0.1209, 0.1209, 0.1207, 0.1211, 0.1205, 0.0000,
         0.1205],
        [0.1205, 0.1204, 0.1207, 0.1206, 0.1209, 0.1207, 0.1205, 0.1206, 0.1205,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0294, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35172507
Epoch379: train_loss: 4.1347 recon_acc: 0.2397 val_roc: 0.7511 val_ap: 0.8042 f1: 0.6899 time: 0.2597
thresh 0.54462117
          test_roc: 0.7305 test_ap: 0.7758 test_f1: 0.6797 test_recon_acc: 0.5852
difference_matrix tensor([[0.0000, 0.1202, 0.1207, 0.1205, 0.1205, 0.1206, 0.1203, 0.1204, 0.1203,
         0.1205],
        [0.1202, 0.0000, 0.1205, 0.1202, 0.1204, 0.1204, 0.1203, 0.1201, 0.1206,
         0.1203],
        [0.1207, 0.1205, 0.0000, 0.1205, 0.1212, 0.1208, 0.1205, 0.1207, 0.1210,
         0.1206],
        [0.1205, 0.1202, 0.1205, 0.0000, 0.1208, 0.1209, 0.1204, 0.1201, 0.1208,
         0.1205],
        [0.1205, 0.1204, 0.1212, 0.1208, 0.0000, 0.1206, 0.1209, 0.1206, 0.1208,
         0.1208],
        [0.1206, 0.1204, 0.1208, 0.1209, 0.1206, 0.0000, 0.1207, 0.1206, 0.1206,
         0.1206],
        [0.1203, 0.1203, 0.1205, 0.1204, 0.1209, 0.1207, 0.0000, 0.1201, 0.1210,
         0.1204],
        [0.1204, 0.1201, 0.1207, 0.1201, 0.1206, 0.1206, 0.1201, 0.0000, 0.1204,
         0.1205],
        [0.1203, 0.1206, 0.1210, 0.1208, 0.1208, 0.1206, 0.1210, 0.1204, 0.0000,
         0.1204],
        [0.1205, 0.1203, 0.1206, 0.1205, 0.1208, 0.1206, 0.1204, 0.1205, 0.1204,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0295, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35179082
Epoch380: train_loss: 4.1340 recon_acc: 0.2396 val_roc: 0.7513 val_ap: 0.8045 f1: 0.6899 time: 0.2555
thresh 0.54435617
          test_roc: 0.7308 test_ap: 0.7762 test_f1: 0.6790 test_recon_acc: 0.5848
difference_matrix tensor([[0.0000, 0.1201, 0.1206, 0.1204, 0.1204, 0.1206, 0.1202, 0.1203, 0.1202,
         0.1204],
        [0.1201, 0.0000, 0.1204, 0.1201, 0.1203, 0.1203, 0.1202, 0.1200, 0.1205,
         0.1202],
        [0.1206, 0.1204, 0.0000, 0.1204, 0.1211, 0.1207, 0.1204, 0.1206, 0.1209,
         0.1205],
        [0.1204, 0.1201, 0.1204, 0.0000, 0.1207, 0.1208, 0.1203, 0.1200, 0.1207,
         0.1204],
        [0.1204, 0.1203, 0.1211, 0.1207, 0.0000, 0.1205, 0.1208, 0.1206, 0.1207,
         0.1207],
        [0.1206, 0.1203, 0.1207, 0.1208, 0.1205, 0.0000, 0.1206, 0.1205, 0.1205,
         0.1205],
        [0.1202, 0.1202, 0.1204, 0.1203, 0.1208, 0.1206, 0.0000, 0.1200, 0.1209,
         0.1204],
        [0.1203, 0.1200, 0.1206, 0.1200, 0.1206, 0.1205, 0.1200, 0.0000, 0.1203,
         0.1204],
        [0.1202, 0.1205, 0.1209, 0.1207, 0.1207, 0.1205, 0.1209, 0.1203, 0.0000,
         0.1203],
        [0.1204, 0.1202, 0.1205, 0.1204, 0.1207, 0.1205, 0.1204, 0.1204, 0.1203,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0295, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3518553
Epoch381: train_loss: 4.1333 recon_acc: 0.2397 val_roc: 0.7517 val_ap: 0.8048 f1: 0.6899 time: 0.2767
thresh 0.5440935
          test_roc: 0.7311 test_ap: 0.7766 test_f1: 0.6803 test_recon_acc: 0.5844
difference_matrix tensor([[0.0000, 0.1200, 0.1205, 0.1203, 0.1203, 0.1205, 0.1201, 0.1202, 0.1201,
         0.1203],
        [0.1200, 0.0000, 0.1203, 0.1200, 0.1202, 0.1202, 0.1201, 0.1199, 0.1204,
         0.1201],
        [0.1205, 0.1203, 0.0000, 0.1203, 0.1210, 0.1206, 0.1203, 0.1205, 0.1208,
         0.1204],
        [0.1203, 0.1200, 0.1203, 0.0000, 0.1206, 0.1207, 0.1203, 0.1199, 0.1206,
         0.1203],
        [0.1203, 0.1202, 0.1210, 0.1206, 0.0000, 0.1204, 0.1207, 0.1205, 0.1207,
         0.1206],
        [0.1205, 0.1202, 0.1206, 0.1207, 0.1204, 0.0000, 0.1205, 0.1204, 0.1204,
         0.1204],
        [0.1201, 0.1201, 0.1203, 0.1203, 0.1207, 0.1205, 0.0000, 0.1199, 0.1208,
         0.1203],
        [0.1202, 0.1199, 0.1205, 0.1199, 0.1205, 0.1204, 0.1199, 0.0000, 0.1202,
         0.1203],
        [0.1201, 0.1204, 0.1208, 0.1206, 0.1207, 0.1204, 0.1208, 0.1202, 0.0000,
         0.1202],
        [0.1203, 0.1201, 0.1204, 0.1203, 0.1206, 0.1204, 0.1203, 0.1203, 0.1202,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0296, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35191852
Epoch382: train_loss: 4.1326 recon_acc: 0.2397 val_roc: 0.7520 val_ap: 0.8052 f1: 0.6899 time: 0.2744
thresh 0.5438331
          test_roc: 0.7313 test_ap: 0.7769 test_f1: 0.6803 test_recon_acc: 0.5839
difference_matrix tensor([[0.0000, 0.1200, 0.1204, 0.1202, 0.1202, 0.1204, 0.1200, 0.1201, 0.1200,
         0.1202],
        [0.1200, 0.0000, 0.1202, 0.1199, 0.1201, 0.1201, 0.1200, 0.1198, 0.1203,
         0.1200],
        [0.1204, 0.1202, 0.0000, 0.1202, 0.1209, 0.1205, 0.1202, 0.1204, 0.1207,
         0.1203],
        [0.1202, 0.1199, 0.1202, 0.0000, 0.1205, 0.1206, 0.1202, 0.1199, 0.1205,
         0.1202],
        [0.1202, 0.1201, 0.1209, 0.1205, 0.0000, 0.1203, 0.1206, 0.1204, 0.1206,
         0.1205],
        [0.1204, 0.1201, 0.1205, 0.1206, 0.1203, 0.0000, 0.1205, 0.1203, 0.1203,
         0.1204],
        [0.1200, 0.1200, 0.1202, 0.1202, 0.1206, 0.1205, 0.0000, 0.1198, 0.1207,
         0.1202],
        [0.1201, 0.1198, 0.1204, 0.1199, 0.1204, 0.1203, 0.1198, 0.0000, 0.1202,
         0.1202],
        [0.1200, 0.1203, 0.1207, 0.1205, 0.1206, 0.1203, 0.1207, 0.1202, 0.0000,
         0.1201],
        [0.1202, 0.1200, 0.1203, 0.1202, 0.1205, 0.1204, 0.1202, 0.1202, 0.1201,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0297, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35190043
Epoch383: train_loss: 4.1319 recon_acc: 0.2395 val_roc: 0.7523 val_ap: 0.8055 f1: 0.6899 time: 0.2575
thresh 0.5434544
          test_roc: 0.7316 test_ap: 0.7772 test_f1: 0.6796 test_recon_acc: 0.5833
difference_matrix tensor([[0.0000, 0.1199, 0.1203, 0.1201, 0.1201, 0.1203, 0.1199, 0.1200, 0.1199,
         0.1201],
        [0.1199, 0.0000, 0.1201, 0.1199, 0.1200, 0.1200, 0.1199, 0.1197, 0.1202,
         0.1199],
        [0.1203, 0.1201, 0.0000, 0.1202, 0.1208, 0.1204, 0.1201, 0.1203, 0.1206,
         0.1203],
        [0.1201, 0.1199, 0.1202, 0.0000, 0.1204, 0.1205, 0.1201, 0.1198, 0.1205,
         0.1201],
        [0.1201, 0.1200, 0.1208, 0.1204, 0.0000, 0.1202, 0.1206, 0.1203, 0.1205,
         0.1204],
        [0.1203, 0.1200, 0.1204, 0.1205, 0.1202, 0.0000, 0.1204, 0.1202, 0.1202,
         0.1203],
        [0.1199, 0.1199, 0.1201, 0.1201, 0.1206, 0.1204, 0.0000, 0.1197, 0.1206,
         0.1201],
        [0.1200, 0.1197, 0.1203, 0.1198, 0.1203, 0.1202, 0.1197, 0.0000, 0.1201,
         0.1201],
        [0.1199, 0.1202, 0.1206, 0.1205, 0.1205, 0.1202, 0.1206, 0.1201, 0.0000,
         0.1200],
        [0.1201, 0.1199, 0.1203, 0.1201, 0.1204, 0.1203, 0.1201, 0.1201, 0.1200,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0298, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35174054
Epoch384: train_loss: 4.1312 recon_acc: 0.2392 val_roc: 0.7525 val_ap: 0.8059 f1: 0.6899 time: 0.2765
thresh 0.5513215
          test_roc: 0.7319 test_ap: 0.7778 test_f1: 0.6784 test_recon_acc: 0.5977
difference_matrix tensor([[0.0000, 0.1198, 0.1202, 0.1200, 0.1200, 0.1202, 0.1198, 0.1199, 0.1198,
         0.1200],
        [0.1198, 0.0000, 0.1201, 0.1198, 0.1199, 0.1199, 0.1198, 0.1197, 0.1202,
         0.1199],
        [0.1202, 0.1201, 0.0000, 0.1201, 0.1207, 0.1203, 0.1200, 0.1202, 0.1206,
         0.1202],
        [0.1200, 0.1198, 0.1201, 0.0000, 0.1203, 0.1204, 0.1200, 0.1197, 0.1204,
         0.1200],
        [0.1200, 0.1199, 0.1207, 0.1203, 0.0000, 0.1201, 0.1205, 0.1202, 0.1204,
         0.1203],
        [0.1202, 0.1199, 0.1203, 0.1204, 0.1201, 0.0000, 0.1203, 0.1201, 0.1201,
         0.1202],
        [0.1198, 0.1198, 0.1200, 0.1200, 0.1205, 0.1203, 0.0000, 0.1196, 0.1206,
         0.1200],
        [0.1199, 0.1197, 0.1202, 0.1197, 0.1202, 0.1201, 0.1196, 0.0000, 0.1200,
         0.1200],
        [0.1198, 0.1202, 0.1206, 0.1204, 0.1204, 0.1201, 0.1206, 0.1200, 0.0000,
         0.1199],
        [0.1200, 0.1199, 0.1202, 0.1200, 0.1203, 0.1202, 0.1200, 0.1200, 0.1199,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0299, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3515816
Epoch385: train_loss: 4.1306 recon_acc: 0.2388 val_roc: 0.7528 val_ap: 0.8062 f1: 0.6899 time: 0.2843
thresh 0.54659694
          test_roc: 0.7321 test_ap: 0.7782 test_f1: 0.6790 test_recon_acc: 0.5892
difference_matrix tensor([[0.0000, 0.1197, 0.1202, 0.1199, 0.1199, 0.1201, 0.1198, 0.1198, 0.1197,
         0.1199],
        [0.1197, 0.0000, 0.1200, 0.1197, 0.1198, 0.1198, 0.1197, 0.1196, 0.1201,
         0.1198],
        [0.1202, 0.1200, 0.0000, 0.1200, 0.1207, 0.1202, 0.1199, 0.1201, 0.1205,
         0.1201],
        [0.1199, 0.1197, 0.1200, 0.0000, 0.1202, 0.1204, 0.1199, 0.1196, 0.1203,
         0.1199],
        [0.1199, 0.1198, 0.1207, 0.1202, 0.0000, 0.1200, 0.1204, 0.1201, 0.1203,
         0.1202],
        [0.1201, 0.1198, 0.1202, 0.1204, 0.1200, 0.0000, 0.1202, 0.1201, 0.1200,
         0.1201],
        [0.1198, 0.1197, 0.1199, 0.1199, 0.1204, 0.1202, 0.0000, 0.1196, 0.1205,
         0.1199],
        [0.1198, 0.1196, 0.1201, 0.1196, 0.1201, 0.1201, 0.1196, 0.0000, 0.1199,
         0.1199],
        [0.1197, 0.1201, 0.1205, 0.1203, 0.1203, 0.1200, 0.1205, 0.1199, 0.0000,
         0.1199],
        [0.1199, 0.1198, 0.1201, 0.1199, 0.1202, 0.1201, 0.1199, 0.1199, 0.1199,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0300, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3514238
Epoch386: train_loss: 4.1299 recon_acc: 0.2385 val_roc: 0.7531 val_ap: 0.8065 f1: 0.6899 time: 0.2560
thresh 0.5465024
          test_roc: 0.7323 test_ap: 0.7785 test_f1: 0.6797 test_recon_acc: 0.5890
difference_matrix tensor([[0.0000, 0.1196, 0.1201, 0.1198, 0.1198, 0.1200, 0.1197, 0.1197, 0.1196,
         0.1198],
        [0.1196, 0.0000, 0.1199, 0.1196, 0.1197, 0.1198, 0.1197, 0.1195, 0.1200,
         0.1197],
        [0.1201, 0.1199, 0.0000, 0.1199, 0.1206, 0.1201, 0.1198, 0.1200, 0.1204,
         0.1200],
        [0.1198, 0.1196, 0.1199, 0.0000, 0.1201, 0.1203, 0.1198, 0.1195, 0.1202,
         0.1198],
        [0.1198, 0.1197, 0.1206, 0.1201, 0.0000, 0.1199, 0.1203, 0.1200, 0.1202,
         0.1201],
        [0.1200, 0.1198, 0.1201, 0.1203, 0.1199, 0.0000, 0.1201, 0.1200, 0.1200,
         0.1200],
        [0.1197, 0.1197, 0.1198, 0.1198, 0.1203, 0.1201, 0.0000, 0.1195, 0.1204,
         0.1198],
        [0.1197, 0.1195, 0.1200, 0.1195, 0.1200, 0.1200, 0.1195, 0.0000, 0.1198,
         0.1199],
        [0.1196, 0.1200, 0.1204, 0.1202, 0.1202, 0.1200, 0.1204, 0.1198, 0.0000,
         0.1198],
        [0.1198, 0.1197, 0.1200, 0.1198, 0.1201, 0.1200, 0.1198, 0.1199, 0.1198,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0301, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35126716
Epoch387: train_loss: 4.1293 recon_acc: 0.2381 val_roc: 0.7533 val_ap: 0.8066 f1: 0.6899 time: 0.5779
thresh 0.5464093
          test_roc: 0.7325 test_ap: 0.7788 test_f1: 0.6797 test_recon_acc: 0.5889
difference_matrix tensor([[0.0000, 0.1195, 0.1200, 0.1197, 0.1197, 0.1199, 0.1196, 0.1196, 0.1195,
         0.1197],
        [0.1195, 0.0000, 0.1198, 0.1195, 0.1196, 0.1197, 0.1196, 0.1194, 0.1199,
         0.1196],
        [0.1200, 0.1198, 0.0000, 0.1198, 0.1205, 0.1200, 0.1198, 0.1200, 0.1203,
         0.1199],
        [0.1197, 0.1195, 0.1198, 0.0000, 0.1201, 0.1202, 0.1197, 0.1194, 0.1201,
         0.1197],
        [0.1197, 0.1196, 0.1205, 0.1201, 0.0000, 0.1198, 0.1202, 0.1199, 0.1201,
         0.1201],
        [0.1199, 0.1197, 0.1200, 0.1202, 0.1198, 0.0000, 0.1200, 0.1199, 0.1199,
         0.1199],
        [0.1196, 0.1196, 0.1198, 0.1197, 0.1202, 0.1200, 0.0000, 0.1194, 0.1203,
         0.1197],
        [0.1196, 0.1194, 0.1200, 0.1194, 0.1199, 0.1199, 0.1194, 0.0000, 0.1197,
         0.1198],
        [0.1195, 0.1199, 0.1203, 0.1201, 0.1201, 0.1199, 0.1203, 0.1197, 0.0000,
         0.1197],
        [0.1197, 0.1196, 0.1199, 0.1197, 0.1201, 0.1199, 0.1197, 0.1198, 0.1197,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0302, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35111144
Epoch388: train_loss: 4.1286 recon_acc: 0.2378 val_roc: 0.7536 val_ap: 0.8070 f1: 0.6899 time: 0.6520
thresh 0.55122656
          test_roc: 0.7328 test_ap: 0.7792 test_f1: 0.6798 test_recon_acc: 0.5978
difference_matrix tensor([[0.0000, 0.1194, 0.1199, 0.1196, 0.1197, 0.1199, 0.1195, 0.1195, 0.1195,
         0.1196],
        [0.1194, 0.0000, 0.1197, 0.1194, 0.1196, 0.1196, 0.1195, 0.1193, 0.1198,
         0.1195],
        [0.1199, 0.1197, 0.0000, 0.1197, 0.1204, 0.1199, 0.1197, 0.1199, 0.1202,
         0.1198],
        [0.1196, 0.1194, 0.1197, 0.0000, 0.1200, 0.1201, 0.1196, 0.1193, 0.1200,
         0.1197],
        [0.1197, 0.1196, 0.1204, 0.1200, 0.0000, 0.1197, 0.1201, 0.1198, 0.1200,
         0.1200],
        [0.1199, 0.1196, 0.1199, 0.1201, 0.1197, 0.0000, 0.1199, 0.1198, 0.1198,
         0.1198],
        [0.1195, 0.1195, 0.1197, 0.1196, 0.1201, 0.1199, 0.0000, 0.1193, 0.1202,
         0.1196],
        [0.1195, 0.1193, 0.1199, 0.1193, 0.1198, 0.1198, 0.1193, 0.0000, 0.1196,
         0.1197],
        [0.1195, 0.1198, 0.1202, 0.1200, 0.1200, 0.1198, 0.1202, 0.1196, 0.0000,
         0.1196],
        [0.1196, 0.1195, 0.1198, 0.1197, 0.1200, 0.1198, 0.1196, 0.1197, 0.1196,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0303, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35095677
Epoch389: train_loss: 4.1280 recon_acc: 0.2374 val_roc: 0.7539 val_ap: 0.8075 f1: 0.6899 time: 0.7167
thresh 0.55119944
          test_roc: 0.7331 test_ap: 0.7795 test_f1: 0.6798 test_recon_acc: 0.5978
difference_matrix tensor([[0.0000, 0.1193, 0.1198, 0.1196, 0.1196, 0.1198, 0.1194, 0.1195, 0.1194,
         0.1196],
        [0.1193, 0.0000, 0.1196, 0.1193, 0.1195, 0.1195, 0.1194, 0.1192, 0.1197,
         0.1194],
        [0.1198, 0.1196, 0.0000, 0.1196, 0.1203, 0.1199, 0.1196, 0.1198, 0.1201,
         0.1197],
        [0.1196, 0.1193, 0.1196, 0.0000, 0.1199, 0.1200, 0.1195, 0.1192, 0.1199,
         0.1196],
        [0.1196, 0.1195, 0.1203, 0.1199, 0.0000, 0.1196, 0.1200, 0.1197, 0.1199,
         0.1199],
        [0.1198, 0.1195, 0.1199, 0.1200, 0.1196, 0.0000, 0.1198, 0.1197, 0.1197,
         0.1197],
        [0.1194, 0.1194, 0.1196, 0.1195, 0.1200, 0.1198, 0.0000, 0.1192, 0.1201,
         0.1196],
        [0.1195, 0.1192, 0.1198, 0.1192, 0.1197, 0.1197, 0.1192, 0.0000, 0.1195,
         0.1196],
        [0.1194, 0.1197, 0.1201, 0.1199, 0.1199, 0.1197, 0.1201, 0.1195, 0.0000,
         0.1195],
        [0.1196, 0.1194, 0.1197, 0.1196, 0.1199, 0.1197, 0.1196, 0.1196, 0.1195,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0303, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.350803
Epoch390: train_loss: 4.1273 recon_acc: 0.2371 val_roc: 0.7543 val_ap: 0.8079 f1: 0.6899 time: 0.6565
thresh 0.551171
          test_roc: 0.7333 test_ap: 0.7798 test_f1: 0.6798 test_recon_acc: 0.5978
difference_matrix tensor([[0.0000, 0.1192, 0.1197, 0.1195, 0.1195, 0.1197, 0.1193, 0.1194, 0.1193,
         0.1195],
        [0.1192, 0.0000, 0.1195, 0.1192, 0.1194, 0.1194, 0.1193, 0.1191, 0.1196,
         0.1193],
        [0.1197, 0.1195, 0.0000, 0.1195, 0.1202, 0.1198, 0.1195, 0.1197, 0.1200,
         0.1196],
        [0.1195, 0.1192, 0.1195, 0.0000, 0.1198, 0.1199, 0.1194, 0.1191, 0.1198,
         0.1195],
        [0.1195, 0.1194, 0.1202, 0.1198, 0.0000, 0.1196, 0.1199, 0.1197, 0.1199,
         0.1198],
        [0.1197, 0.1194, 0.1198, 0.1199, 0.1196, 0.0000, 0.1198, 0.1196, 0.1196,
         0.1197],
        [0.1193, 0.1193, 0.1195, 0.1194, 0.1199, 0.1198, 0.0000, 0.1191, 0.1200,
         0.1195],
        [0.1194, 0.1191, 0.1197, 0.1191, 0.1197, 0.1196, 0.1191, 0.0000, 0.1194,
         0.1195],
        [0.1193, 0.1196, 0.1200, 0.1198, 0.1199, 0.1196, 0.1200, 0.1194, 0.0000,
         0.1194],
        [0.1195, 0.1193, 0.1196, 0.1195, 0.1198, 0.1197, 0.1195, 0.1195, 0.1194,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0304, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3506503
Epoch391: train_loss: 4.1267 recon_acc: 0.2367 val_roc: 0.7547 val_ap: 0.8083 f1: 0.6899 time: 0.7832
thresh 0.54986686
          test_roc: 0.7336 test_ap: 0.7802 test_f1: 0.6798 test_recon_acc: 0.5954
difference_matrix tensor([[0.0000, 0.1192, 0.1196, 0.1194, 0.1194, 0.1196, 0.1192, 0.1193, 0.1192,
         0.1194],
        [0.1192, 0.0000, 0.1194, 0.1192, 0.1193, 0.1193, 0.1192, 0.1190, 0.1195,
         0.1192],
        [0.1196, 0.1194, 0.0000, 0.1195, 0.1201, 0.1197, 0.1194, 0.1196, 0.1200,
         0.1196],
        [0.1194, 0.1192, 0.1195, 0.0000, 0.1197, 0.1198, 0.1194, 0.1191, 0.1198,
         0.1194],
        [0.1194, 0.1193, 0.1201, 0.1197, 0.0000, 0.1195, 0.1199, 0.1196, 0.1198,
         0.1197],
        [0.1196, 0.1193, 0.1197, 0.1198, 0.1195, 0.0000, 0.1197, 0.1195, 0.1195,
         0.1196],
        [0.1192, 0.1192, 0.1194, 0.1194, 0.1199, 0.1197, 0.0000, 0.1190, 0.1199,
         0.1194],
        [0.1193, 0.1190, 0.1196, 0.1191, 0.1196, 0.1195, 0.1190, 0.0000, 0.1194,
         0.1194],
        [0.1192, 0.1195, 0.1200, 0.1198, 0.1198, 0.1195, 0.1199, 0.1194, 0.0000,
         0.1193],
        [0.1194, 0.1192, 0.1196, 0.1194, 0.1197, 0.1196, 0.1194, 0.1194, 0.1193,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0305, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3447188
Epoch392: train_loss: 4.1261 recon_acc: 0.2274 val_roc: 0.7549 val_ap: 0.8085 f1: 0.6908 time: 0.5379
thresh 0.550174
          test_roc: 0.7338 test_ap: 0.7805 test_f1: 0.6805 test_recon_acc: 0.5960
difference_matrix tensor([[0.0000, 0.1191, 0.1195, 0.1193, 0.1193, 0.1195, 0.1191, 0.1192, 0.1191,
         0.1193],
        [0.1191, 0.0000, 0.1194, 0.1191, 0.1192, 0.1193, 0.1191, 0.1190, 0.1195,
         0.1192],
        [0.1195, 0.1194, 0.0000, 0.1194, 0.1200, 0.1196, 0.1193, 0.1195, 0.1199,
         0.1195],
        [0.1193, 0.1191, 0.1194, 0.0000, 0.1196, 0.1198, 0.1193, 0.1190, 0.1197,
         0.1193],
        [0.1193, 0.1192, 0.1200, 0.1196, 0.0000, 0.1194, 0.1198, 0.1195, 0.1197,
         0.1196],
        [0.1195, 0.1193, 0.1196, 0.1198, 0.1194, 0.0000, 0.1196, 0.1195, 0.1194,
         0.1195],
        [0.1191, 0.1191, 0.1193, 0.1193, 0.1198, 0.1196, 0.0000, 0.1189, 0.1198,
         0.1193],
        [0.1192, 0.1190, 0.1195, 0.1190, 0.1195, 0.1195, 0.1189, 0.0000, 0.1193,
         0.1193],
        [0.1191, 0.1195, 0.1199, 0.1197, 0.1197, 0.1194, 0.1198, 0.1193, 0.0000,
         0.1193],
        [0.1193, 0.1192, 0.1195, 0.1193, 0.1196, 0.1195, 0.1193, 0.1193, 0.1193,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0306, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34497002
Epoch393: train_loss: 4.1255 recon_acc: 0.2277 val_roc: 0.7550 val_ap: 0.8088 f1: 0.6908 time: 0.7020
thresh 0.5504746
          test_roc: 0.7341 test_ap: 0.7809 test_f1: 0.6798 test_recon_acc: 0.5966
difference_matrix tensor([[0.0000, 0.1190, 0.1195, 0.1192, 0.1192, 0.1194, 0.1191, 0.1191, 0.1190,
         0.1192],
        [0.1190, 0.0000, 0.1193, 0.1190, 0.1191, 0.1192, 0.1190, 0.1189, 0.1194,
         0.1191],
        [0.1195, 0.1193, 0.0000, 0.1193, 0.1200, 0.1195, 0.1192, 0.1194, 0.1198,
         0.1194],
        [0.1192, 0.1190, 0.1193, 0.0000, 0.1195, 0.1197, 0.1192, 0.1189, 0.1196,
         0.1192],
        [0.1192, 0.1191, 0.1200, 0.1195, 0.0000, 0.1193, 0.1197, 0.1194, 0.1196,
         0.1195],
        [0.1194, 0.1192, 0.1195, 0.1197, 0.1193, 0.0000, 0.1195, 0.1194, 0.1194,
         0.1194],
        [0.1191, 0.1190, 0.1192, 0.1192, 0.1197, 0.1195, 0.0000, 0.1189, 0.1198,
         0.1192],
        [0.1191, 0.1189, 0.1194, 0.1189, 0.1194, 0.1194, 0.1189, 0.0000, 0.1192,
         0.1193],
        [0.1190, 0.1194, 0.1198, 0.1196, 0.1196, 0.1194, 0.1198, 0.1192, 0.0000,
         0.1192],
        [0.1192, 0.1191, 0.1194, 0.1192, 0.1195, 0.1194, 0.1192, 0.1193, 0.1192,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0307, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34522253
Epoch394: train_loss: 4.1249 recon_acc: 0.2280 val_roc: 0.7552 val_ap: 0.8090 f1: 0.6908 time: 0.7773
thresh 0.55079377
          test_roc: 0.7343 test_ap: 0.7811 test_f1: 0.6791 test_recon_acc: 0.5972
difference_matrix tensor([[0.0000, 0.1189, 0.1194, 0.1191, 0.1191, 0.1193, 0.1190, 0.1190, 0.1190,
         0.1191],
        [0.1189, 0.0000, 0.1192, 0.1189, 0.1190, 0.1191, 0.1190, 0.1188, 0.1193,
         0.1190],
        [0.1194, 0.1192, 0.0000, 0.1192, 0.1199, 0.1194, 0.1192, 0.1194, 0.1197,
         0.1193],
        [0.1191, 0.1189, 0.1192, 0.0000, 0.1195, 0.1196, 0.1191, 0.1188, 0.1195,
         0.1191],
        [0.1191, 0.1190, 0.1199, 0.1195, 0.0000, 0.1192, 0.1196, 0.1193, 0.1195,
         0.1195],
        [0.1193, 0.1191, 0.1194, 0.1196, 0.1192, 0.0000, 0.1194, 0.1193, 0.1193,
         0.1193],
        [0.1190, 0.1190, 0.1192, 0.1191, 0.1196, 0.1194, 0.0000, 0.1188, 0.1197,
         0.1191],
        [0.1190, 0.1188, 0.1194, 0.1188, 0.1193, 0.1193, 0.1188, 0.0000, 0.1191,
         0.1192],
        [0.1190, 0.1193, 0.1197, 0.1195, 0.1195, 0.1193, 0.1197, 0.1191, 0.0000,
         0.1191],
        [0.1191, 0.1190, 0.1193, 0.1191, 0.1195, 0.1193, 0.1191, 0.1192, 0.1191,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0308, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34547627
Epoch395: train_loss: 4.1243 recon_acc: 0.2283 val_roc: 0.7555 val_ap: 0.8093 f1: 0.6919 time: 0.6914
thresh 0.55100983
          test_roc: 0.7346 test_ap: 0.7816 test_f1: 0.6798 test_recon_acc: 0.5977
difference_matrix tensor([[0.0000, 0.1188, 0.1193, 0.1190, 0.1191, 0.1193, 0.1189, 0.1190, 0.1189,
         0.1191],
        [0.1188, 0.0000, 0.1191, 0.1188, 0.1190, 0.1190, 0.1189, 0.1187, 0.1192,
         0.1189],
        [0.1193, 0.1191, 0.0000, 0.1191, 0.1198, 0.1194, 0.1191, 0.1193, 0.1196,
         0.1192],
        [0.1190, 0.1188, 0.1191, 0.0000, 0.1194, 0.1195, 0.1190, 0.1187, 0.1194,
         0.1191],
        [0.1191, 0.1190, 0.1198, 0.1194, 0.0000, 0.1191, 0.1195, 0.1192, 0.1194,
         0.1194],
        [0.1193, 0.1190, 0.1194, 0.1195, 0.1191, 0.0000, 0.1193, 0.1192, 0.1192,
         0.1192],
        [0.1189, 0.1189, 0.1191, 0.1190, 0.1195, 0.1193, 0.0000, 0.1187, 0.1196,
         0.1190],
        [0.1190, 0.1187, 0.1193, 0.1187, 0.1192, 0.1192, 0.1187, 0.0000, 0.1190,
         0.1191],
        [0.1189, 0.1192, 0.1196, 0.1194, 0.1194, 0.1192, 0.1196, 0.1190, 0.0000,
         0.1190],
        [0.1191, 0.1189, 0.1192, 0.1191, 0.1194, 0.1192, 0.1190, 0.1191, 0.1190,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0309, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3457313
Epoch396: train_loss: 4.1237 recon_acc: 0.2286 val_roc: 0.7557 val_ap: 0.8097 f1: 0.6919 time: 0.4881
thresh 0.550974
          test_roc: 0.7349 test_ap: 0.7820 test_f1: 0.6798 test_recon_acc: 0.5977
difference_matrix tensor([[0.0000, 0.1187, 0.1192, 0.1190, 0.1190, 0.1192, 0.1188, 0.1189, 0.1188,
         0.1190],
        [0.1187, 0.0000, 0.1190, 0.1187, 0.1189, 0.1189, 0.1188, 0.1186, 0.1191,
         0.1188],
        [0.1192, 0.1190, 0.0000, 0.1191, 0.1197, 0.1193, 0.1190, 0.1192, 0.1195,
         0.1191],
        [0.1190, 0.1187, 0.1191, 0.0000, 0.1193, 0.1194, 0.1189, 0.1186, 0.1193,
         0.1190],
        [0.1190, 0.1189, 0.1197, 0.1193, 0.0000, 0.1191, 0.1194, 0.1192, 0.1194,
         0.1193],
        [0.1192, 0.1189, 0.1193, 0.1194, 0.1191, 0.0000, 0.1193, 0.1191, 0.1191,
         0.1191],
        [0.1188, 0.1188, 0.1190, 0.1189, 0.1194, 0.1193, 0.0000, 0.1186, 0.1195,
         0.1190],
        [0.1189, 0.1186, 0.1192, 0.1186, 0.1192, 0.1191, 0.1186, 0.0000, 0.1189,
         0.1190],
        [0.1188, 0.1191, 0.1195, 0.1193, 0.1194, 0.1191, 0.1195, 0.1189, 0.0000,
         0.1189],
        [0.1190, 0.1188, 0.1191, 0.1190, 0.1193, 0.1191, 0.1190, 0.1190, 0.1189,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0309, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34598744
Epoch397: train_loss: 4.1231 recon_acc: 0.2289 val_roc: 0.7561 val_ap: 0.8102 f1: 0.6919 time: 0.6601
thresh 0.55093706
          test_roc: 0.7352 test_ap: 0.7824 test_f1: 0.6798 test_recon_acc: 0.5976
difference_matrix tensor([[0.0000, 0.1187, 0.1191, 0.1189, 0.1189, 0.1191, 0.1187, 0.1188, 0.1187,
         0.1189],
        [0.1187, 0.0000, 0.1190, 0.1186, 0.1188, 0.1188, 0.1187, 0.1185, 0.1190,
         0.1187],
        [0.1191, 0.1190, 0.0000, 0.1190, 0.1196, 0.1192, 0.1189, 0.1191, 0.1195,
         0.1191],
        [0.1189, 0.1186, 0.1190, 0.0000, 0.1192, 0.1193, 0.1189, 0.1186, 0.1193,
         0.1189],
        [0.1189, 0.1188, 0.1196, 0.1192, 0.0000, 0.1190, 0.1194, 0.1191, 0.1193,
         0.1192],
        [0.1191, 0.1188, 0.1192, 0.1193, 0.1190, 0.0000, 0.1192, 0.1190, 0.1190,
         0.1191],
        [0.1187, 0.1187, 0.1189, 0.1189, 0.1194, 0.1192, 0.0000, 0.1185, 0.1194,
         0.1189],
        [0.1188, 0.1185, 0.1191, 0.1186, 0.1191, 0.1190, 0.1185, 0.0000, 0.1189,
         0.1189],
        [0.1187, 0.1190, 0.1195, 0.1193, 0.1193, 0.1190, 0.1194, 0.1189, 0.0000,
         0.1188],
        [0.1189, 0.1187, 0.1191, 0.1189, 0.1192, 0.1191, 0.1189, 0.1189, 0.1188,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0310, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34624478
Epoch398: train_loss: 4.1225 recon_acc: 0.2292 val_roc: 0.7564 val_ap: 0.8105 f1: 0.6919 time: 0.3081
thresh 0.55089897
          test_roc: 0.7355 test_ap: 0.7829 test_f1: 0.6805 test_recon_acc: 0.5976
difference_matrix tensor([[0.0000, 0.1186, 0.1191, 0.1188, 0.1188, 0.1190, 0.1186, 0.1187, 0.1186,
         0.1188],
        [0.1186, 0.0000, 0.1189, 0.1186, 0.1187, 0.1188, 0.1186, 0.1185, 0.1190,
         0.1187],
        [0.1191, 0.1189, 0.0000, 0.1189, 0.1195, 0.1191, 0.1188, 0.1190, 0.1194,
         0.1190],
        [0.1188, 0.1186, 0.1189, 0.0000, 0.1191, 0.1193, 0.1188, 0.1185, 0.1192,
         0.1188],
        [0.1188, 0.1187, 0.1195, 0.1191, 0.0000, 0.1189, 0.1193, 0.1190, 0.1192,
         0.1191],
        [0.1190, 0.1188, 0.1191, 0.1193, 0.1189, 0.0000, 0.1191, 0.1190, 0.1189,
         0.1190],
        [0.1186, 0.1186, 0.1188, 0.1188, 0.1193, 0.1191, 0.0000, 0.1184, 0.1193,
         0.1188],
        [0.1187, 0.1185, 0.1190, 0.1185, 0.1190, 0.1190, 0.1184, 0.0000, 0.1188,
         0.1188],
        [0.1186, 0.1190, 0.1194, 0.1192, 0.1192, 0.1189, 0.1193, 0.1188, 0.0000,
         0.1188],
        [0.1188, 0.1187, 0.1190, 0.1188, 0.1191, 0.1190, 0.1188, 0.1188, 0.1188,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0311, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3465034
Epoch399: train_loss: 4.1219 recon_acc: 0.2295 val_roc: 0.7564 val_ap: 0.8106 f1: 0.6919 time: 0.2865
difference_matrix tensor([[0.0000, 0.1185, 0.1190, 0.1187, 0.1187, 0.1189, 0.1186, 0.1186, 0.1185,
         0.1187],
        [0.1185, 0.0000, 0.1188, 0.1185, 0.1186, 0.1187, 0.1185, 0.1184, 0.1189,
         0.1186],
        [0.1190, 0.1188, 0.0000, 0.1188, 0.1195, 0.1190, 0.1187, 0.1190, 0.1193,
         0.1189],
        [0.1187, 0.1185, 0.1188, 0.0000, 0.1190, 0.1192, 0.1187, 0.1184, 0.1191,
         0.1187],
        [0.1187, 0.1186, 0.1195, 0.1190, 0.0000, 0.1188, 0.1192, 0.1189, 0.1191,
         0.1191],
        [0.1189, 0.1187, 0.1190, 0.1192, 0.1188, 0.0000, 0.1190, 0.1189, 0.1189,
         0.1189],
        [0.1186, 0.1185, 0.1187, 0.1187, 0.1192, 0.1190, 0.0000, 0.1184, 0.1193,
         0.1187],
        [0.1186, 0.1184, 0.1190, 0.1184, 0.1189, 0.1189, 0.1184, 0.0000, 0.1187,
         0.1188],
        [0.1185, 0.1189, 0.1193, 0.1191, 0.1191, 0.1189, 0.1193, 0.1187, 0.0000,
         0.1187],
        [0.1187, 0.1186, 0.1189, 0.1187, 0.1191, 0.1189, 0.1187, 0.1188, 0.1187,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0312, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34676307
Epoch400: train_loss: 4.1213 recon_acc: 0.2298 val_roc: 0.7567 val_ap: 0.8109 f1: 0.6931 time: 0.2605
thresh 0.55081964
          test_roc: 0.7359 test_ap: 0.7835 test_f1: 0.6805 test_recon_acc: 0.5975
difference_matrix tensor([[0.0000, 0.1184, 0.1189, 0.1186, 0.1187, 0.1189, 0.1185, 0.1186, 0.1185,
         0.1187],
        [0.1184, 0.0000, 0.1187, 0.1184, 0.1185, 0.1186, 0.1185, 0.1183, 0.1188,
         0.1185],
        [0.1189, 0.1187, 0.0000, 0.1187, 0.1194, 0.1189, 0.1187, 0.1189, 0.1192,
         0.1188],
        [0.1186, 0.1184, 0.1187, 0.0000, 0.1190, 0.1191, 0.1186, 0.1183, 0.1190,
         0.1187],
        [0.1187, 0.1185, 0.1194, 0.1190, 0.0000, 0.1187, 0.1191, 0.1188, 0.1190,
         0.1190],
        [0.1189, 0.1186, 0.1189, 0.1191, 0.1187, 0.0000, 0.1189, 0.1188, 0.1188,
         0.1188],
        [0.1185, 0.1185, 0.1187, 0.1186, 0.1191, 0.1189, 0.0000, 0.1183, 0.1192,
         0.1186],
        [0.1186, 0.1183, 0.1189, 0.1183, 0.1188, 0.1188, 0.1183, 0.0000, 0.1186,
         0.1187],
        [0.1185, 0.1188, 0.1192, 0.1190, 0.1190, 0.1188, 0.1192, 0.1186, 0.0000,
         0.1186],
        [0.1187, 0.1185, 0.1188, 0.1187, 0.1190, 0.1188, 0.1186, 0.1187, 0.1186,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0313, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.347024
Epoch401: train_loss: 4.1208 recon_acc: 0.2301 val_roc: 0.7568 val_ap: 0.8111 f1: 0.6931 time: 0.2640
thresh 0.5507784
          test_roc: 0.7361 test_ap: 0.7838 test_f1: 0.6798 test_recon_acc: 0.5975
difference_matrix tensor([[0.0000, 0.1183, 0.1188, 0.1186, 0.1186, 0.1188, 0.1184, 0.1185, 0.1184,
         0.1186],
        [0.1183, 0.0000, 0.1186, 0.1183, 0.1185, 0.1185, 0.1184, 0.1182, 0.1187,
         0.1184],
        [0.1188, 0.1186, 0.0000, 0.1187, 0.1193, 0.1189, 0.1186, 0.1188, 0.1192,
         0.1188],
        [0.1186, 0.1183, 0.1187, 0.0000, 0.1189, 0.1190, 0.1185, 0.1182, 0.1189,
         0.1186],
        [0.1186, 0.1185, 0.1193, 0.1189, 0.0000, 0.1186, 0.1190, 0.1188, 0.1190,
         0.1189],
        [0.1188, 0.1185, 0.1189, 0.1190, 0.1186, 0.0000, 0.1189, 0.1187, 0.1187,
         0.1187],
        [0.1184, 0.1184, 0.1186, 0.1185, 0.1190, 0.1189, 0.0000, 0.1182, 0.1191,
         0.1186],
        [0.1185, 0.1182, 0.1188, 0.1182, 0.1188, 0.1187, 0.1182, 0.0000, 0.1185,
         0.1186],
        [0.1184, 0.1187, 0.1192, 0.1189, 0.1190, 0.1187, 0.1191, 0.1185, 0.0000,
         0.1185],
        [0.1186, 0.1184, 0.1188, 0.1186, 0.1189, 0.1187, 0.1186, 0.1186, 0.1185,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0313, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.347286
Epoch402: train_loss: 4.1202 recon_acc: 0.2305 val_roc: 0.7571 val_ap: 0.8113 f1: 0.6931 time: 0.2608
thresh 0.5507361
          test_roc: 0.7362 test_ap: 0.7840 test_f1: 0.6798 test_recon_acc: 0.5975
difference_matrix tensor([[0.0000, 0.1183, 0.1187, 0.1185, 0.1185, 0.1187, 0.1183, 0.1184, 0.1183,
         0.1185],
        [0.1183, 0.0000, 0.1186, 0.1182, 0.1184, 0.1185, 0.1183, 0.1181, 0.1187,
         0.1184],
        [0.1187, 0.1186, 0.0000, 0.1186, 0.1192, 0.1188, 0.1185, 0.1187, 0.1191,
         0.1187],
        [0.1185, 0.1182, 0.1186, 0.0000, 0.1188, 0.1190, 0.1185, 0.1182, 0.1189,
         0.1185],
        [0.1185, 0.1184, 0.1192, 0.1188, 0.0000, 0.1186, 0.1190, 0.1187, 0.1189,
         0.1188],
        [0.1187, 0.1185, 0.1188, 0.1190, 0.1186, 0.0000, 0.1188, 0.1186, 0.1186,
         0.1187],
        [0.1183, 0.1183, 0.1185, 0.1185, 0.1190, 0.1188, 0.0000, 0.1181, 0.1190,
         0.1185],
        [0.1184, 0.1181, 0.1187, 0.1181, 0.1187, 0.1186, 0.1181, 0.0000, 0.1185,
         0.1185],
        [0.1183, 0.1187, 0.1191, 0.1189, 0.1189, 0.1186, 0.1190, 0.1185, 0.0000,
         0.1184],
        [0.1185, 0.1184, 0.1187, 0.1185, 0.1188, 0.1187, 0.1185, 0.1185, 0.1184,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0314, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34754905
Epoch403: train_loss: 4.1196 recon_acc: 0.2308 val_roc: 0.7575 val_ap: 0.8116 f1: 0.6931 time: 0.2656
thresh 0.5506929
          test_roc: 0.7366 test_ap: 0.7844 test_f1: 0.6798 test_recon_acc: 0.5975
difference_matrix tensor([[0.0000, 0.1182, 0.1187, 0.1184, 0.1184, 0.1186, 0.1183, 0.1183, 0.1182,
         0.1184],
        [0.1182, 0.0000, 0.1185, 0.1182, 0.1183, 0.1184, 0.1182, 0.1181, 0.1186,
         0.1183],
        [0.1187, 0.1185, 0.0000, 0.1185, 0.1191, 0.1187, 0.1184, 0.1186, 0.1190,
         0.1186],
        [0.1184, 0.1182, 0.1185, 0.0000, 0.1187, 0.1189, 0.1184, 0.1181, 0.1188,
         0.1184],
        [0.1184, 0.1183, 0.1191, 0.1187, 0.0000, 0.1185, 0.1189, 0.1186, 0.1188,
         0.1187],
        [0.1186, 0.1184, 0.1187, 0.1189, 0.1185, 0.0000, 0.1187, 0.1186, 0.1186,
         0.1186],
        [0.1183, 0.1182, 0.1184, 0.1184, 0.1189, 0.1187, 0.0000, 0.1180, 0.1190,
         0.1184],
        [0.1183, 0.1181, 0.1186, 0.1181, 0.1186, 0.1186, 0.1180, 0.0000, 0.1184,
         0.1184],
        [0.1182, 0.1186, 0.1190, 0.1188, 0.1188, 0.1186, 0.1189, 0.1184, 0.0000,
         0.1184],
        [0.1184, 0.1183, 0.1186, 0.1184, 0.1187, 0.1186, 0.1184, 0.1184, 0.1184,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0315, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3476448
Epoch404: train_loss: 4.1191 recon_acc: 0.2309 val_roc: 0.7578 val_ap: 0.8119 f1: 0.6931 time: 0.2854
thresh 0.55064875
          test_roc: 0.7369 test_ap: 0.7847 test_f1: 0.6798 test_recon_acc: 0.5974
difference_matrix tensor([[0.0000, 0.1181, 0.1186, 0.1183, 0.1183, 0.1186, 0.1182, 0.1182, 0.1182,
         0.1184],
        [0.1181, 0.0000, 0.1184, 0.1181, 0.1182, 0.1183, 0.1181, 0.1180, 0.1185,
         0.1182],
        [0.1186, 0.1184, 0.0000, 0.1184, 0.1191, 0.1186, 0.1183, 0.1186, 0.1189,
         0.1185],
        [0.1183, 0.1181, 0.1184, 0.0000, 0.1187, 0.1188, 0.1183, 0.1180, 0.1187,
         0.1183],
        [0.1183, 0.1182, 0.1191, 0.1187, 0.0000, 0.1184, 0.1188, 0.1185, 0.1187,
         0.1187],
        [0.1186, 0.1183, 0.1186, 0.1188, 0.1184, 0.0000, 0.1186, 0.1185, 0.1185,
         0.1185],
        [0.1182, 0.1181, 0.1183, 0.1183, 0.1188, 0.1186, 0.0000, 0.1180, 0.1189,
         0.1183],
        [0.1182, 0.1180, 0.1186, 0.1180, 0.1185, 0.1185, 0.1180, 0.0000, 0.1183,
         0.1184],
        [0.1182, 0.1185, 0.1189, 0.1187, 0.1187, 0.1185, 0.1189, 0.1183, 0.0000,
         0.1183],
        [0.1184, 0.1182, 0.1185, 0.1183, 0.1187, 0.1185, 0.1183, 0.1184, 0.1183,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0316, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34722784
Epoch405: train_loss: 4.1185 recon_acc: 0.2301 val_roc: 0.7580 val_ap: 0.8121 f1: 0.6931 time: 0.2450
thresh 0.55060357
          test_roc: 0.7372 test_ap: 0.7852 test_f1: 0.6798 test_recon_acc: 0.5974
difference_matrix tensor([[0.0000, 0.1180, 0.1185, 0.1182, 0.1183, 0.1185, 0.1181, 0.1182, 0.1181,
         0.1183],
        [0.1180, 0.0000, 0.1183, 0.1180, 0.1182, 0.1182, 0.1181, 0.1179, 0.1184,
         0.1181],
        [0.1185, 0.1183, 0.0000, 0.1183, 0.1190, 0.1186, 0.1183, 0.1185, 0.1188,
         0.1185],
        [0.1182, 0.1180, 0.1183, 0.0000, 0.1186, 0.1187, 0.1182, 0.1179, 0.1186,
         0.1183],
        [0.1183, 0.1182, 0.1190, 0.1186, 0.0000, 0.1183, 0.1187, 0.1184, 0.1186,
         0.1186],
        [0.1185, 0.1182, 0.1186, 0.1187, 0.1183, 0.0000, 0.1186, 0.1184, 0.1184,
         0.1184],
        [0.1181, 0.1181, 0.1183, 0.1182, 0.1187, 0.1186, 0.0000, 0.1179, 0.1188,
         0.1183],
        [0.1182, 0.1179, 0.1185, 0.1179, 0.1184, 0.1184, 0.1179, 0.0000, 0.1182,
         0.1183],
        [0.1181, 0.1184, 0.1188, 0.1186, 0.1186, 0.1184, 0.1188, 0.1182, 0.0000,
         0.1182],
        [0.1183, 0.1181, 0.1184, 0.1183, 0.1186, 0.1184, 0.1183, 0.1183, 0.1182,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0316, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34681427
Epoch406: train_loss: 4.1180 recon_acc: 0.2294 val_roc: 0.7583 val_ap: 0.8124 f1: 0.6931 time: 0.2738
thresh 0.5505174
          test_roc: 0.7375 test_ap: 0.7855 test_f1: 0.6791 test_recon_acc: 0.5973
difference_matrix tensor([[0.0000, 0.1180, 0.1184, 0.1182, 0.1182, 0.1184, 0.1180, 0.1181, 0.1180,
         0.1182],
        [0.1180, 0.0000, 0.1183, 0.1179, 0.1181, 0.1182, 0.1180, 0.1178, 0.1183,
         0.1180],
        [0.1184, 0.1183, 0.0000, 0.1183, 0.1189, 0.1185, 0.1182, 0.1184, 0.1188,
         0.1184],
        [0.1182, 0.1179, 0.1183, 0.0000, 0.1185, 0.1186, 0.1181, 0.1178, 0.1186,
         0.1182],
        [0.1182, 0.1181, 0.1189, 0.1185, 0.0000, 0.1183, 0.1187, 0.1184, 0.1186,
         0.1185],
        [0.1184, 0.1182, 0.1185, 0.1186, 0.1183, 0.0000, 0.1185, 0.1183, 0.1183,
         0.1184],
        [0.1180, 0.1180, 0.1182, 0.1181, 0.1187, 0.1185, 0.0000, 0.1178, 0.1187,
         0.1182],
        [0.1181, 0.1178, 0.1184, 0.1178, 0.1184, 0.1183, 0.1178, 0.0000, 0.1182,
         0.1182],
        [0.1180, 0.1183, 0.1188, 0.1186, 0.1186, 0.1183, 0.1187, 0.1182, 0.0000,
         0.1181],
        [0.1182, 0.1180, 0.1184, 0.1182, 0.1185, 0.1184, 0.1182, 0.1182, 0.1181,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0317, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3464041
Epoch407: train_loss: 4.1174 recon_acc: 0.2286 val_roc: 0.7585 val_ap: 0.8127 f1: 0.6931 time: 0.3053
thresh 0.55030113
          test_roc: 0.7378 test_ap: 0.7858 test_f1: 0.6791 test_recon_acc: 0.5969
difference_matrix tensor([[0.0000, 0.1179, 0.1184, 0.1181, 0.1181, 0.1183, 0.1179, 0.1180, 0.1179,
         0.1181],
        [0.1179, 0.0000, 0.1182, 0.1179, 0.1180, 0.1181, 0.1179, 0.1177, 0.1183,
         0.1180],
        [0.1184, 0.1182, 0.0000, 0.1182, 0.1188, 0.1184, 0.1181, 0.1183, 0.1187,
         0.1183],
        [0.1181, 0.1179, 0.1182, 0.0000, 0.1184, 0.1186, 0.1181, 0.1178, 0.1185,
         0.1181],
        [0.1181, 0.1180, 0.1188, 0.1184, 0.0000, 0.1182, 0.1186, 0.1183, 0.1185,
         0.1184],
        [0.1183, 0.1181, 0.1184, 0.1186, 0.1182, 0.0000, 0.1184, 0.1183, 0.1183,
         0.1183],
        [0.1179, 0.1179, 0.1181, 0.1181, 0.1186, 0.1184, 0.0000, 0.1177, 0.1186,
         0.1181],
        [0.1180, 0.1177, 0.1183, 0.1178, 0.1183, 0.1183, 0.1177, 0.0000, 0.1181,
         0.1181],
        [0.1179, 0.1183, 0.1187, 0.1185, 0.1185, 0.1183, 0.1186, 0.1181, 0.0000,
         0.1181],
        [0.1181, 0.1180, 0.1183, 0.1181, 0.1184, 0.1183, 0.1181, 0.1181, 0.1181,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0318, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34599742
Epoch408: train_loss: 4.1169 recon_acc: 0.2279 val_roc: 0.7589 val_ap: 0.8131 f1: 0.6931 time: 0.3052
thresh 0.55008227
          test_roc: 0.7380 test_ap: 0.7861 test_f1: 0.6791 test_recon_acc: 0.5966
difference_matrix tensor([[0.0000, 0.1178, 0.1183, 0.1180, 0.1180, 0.1183, 0.1179, 0.1179, 0.1179,
         0.1181],
        [0.1178, 0.0000, 0.1181, 0.1178, 0.1179, 0.1180, 0.1178, 0.1177, 0.1182,
         0.1179],
        [0.1183, 0.1181, 0.0000, 0.1181, 0.1187, 0.1183, 0.1180, 0.1183, 0.1186,
         0.1182],
        [0.1180, 0.1178, 0.1181, 0.0000, 0.1183, 0.1185, 0.1180, 0.1177, 0.1184,
         0.1180],
        [0.1180, 0.1179, 0.1187, 0.1183, 0.0000, 0.1181, 0.1185, 0.1182, 0.1184,
         0.1184],
        [0.1183, 0.1180, 0.1183, 0.1185, 0.1181, 0.0000, 0.1183, 0.1182, 0.1182,
         0.1182],
        [0.1179, 0.1178, 0.1180, 0.1180, 0.1185, 0.1183, 0.0000, 0.1177, 0.1186,
         0.1180],
        [0.1179, 0.1177, 0.1183, 0.1177, 0.1182, 0.1182, 0.1177, 0.0000, 0.1180,
         0.1181],
        [0.1179, 0.1182, 0.1186, 0.1184, 0.1184, 0.1182, 0.1186, 0.1180, 0.0000,
         0.1180],
        [0.1181, 0.1179, 0.1182, 0.1180, 0.1184, 0.1182, 0.1180, 0.1181, 0.1180,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0319, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34559408
Epoch409: train_loss: 4.1164 recon_acc: 0.2272 val_roc: 0.7591 val_ap: 0.8134 f1: 0.6931 time: 0.2667
thresh 0.54986066
          test_roc: 0.7382 test_ap: 0.7864 test_f1: 0.6784 test_recon_acc: 0.5962
difference_matrix tensor([[0.0000, 0.1177, 0.1182, 0.1179, 0.1180, 0.1182, 0.1178, 0.1179, 0.1178,
         0.1180],
        [0.1177, 0.0000, 0.1180, 0.1177, 0.1178, 0.1179, 0.1178, 0.1176, 0.1181,
         0.1178],
        [0.1182, 0.1180, 0.0000, 0.1181, 0.1187, 0.1183, 0.1180, 0.1182, 0.1186,
         0.1182],
        [0.1179, 0.1177, 0.1181, 0.0000, 0.1183, 0.1184, 0.1179, 0.1176, 0.1183,
         0.1180],
        [0.1180, 0.1178, 0.1187, 0.1183, 0.0000, 0.1180, 0.1184, 0.1181, 0.1183,
         0.1183],
        [0.1182, 0.1179, 0.1183, 0.1184, 0.1180, 0.0000, 0.1183, 0.1181, 0.1181,
         0.1181],
        [0.1178, 0.1178, 0.1180, 0.1179, 0.1184, 0.1183, 0.0000, 0.1176, 0.1185,
         0.1180],
        [0.1179, 0.1176, 0.1182, 0.1176, 0.1181, 0.1181, 0.1176, 0.0000, 0.1179,
         0.1180],
        [0.1178, 0.1181, 0.1186, 0.1183, 0.1183, 0.1181, 0.1185, 0.1179, 0.0000,
         0.1179],
        [0.1180, 0.1178, 0.1182, 0.1180, 0.1183, 0.1181, 0.1180, 0.1180, 0.1179,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0319, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3451942
Epoch410: train_loss: 4.1158 recon_acc: 0.2265 val_roc: 0.7593 val_ap: 0.8137 f1: 0.6931 time: 0.3000
thresh 0.5496364
          test_roc: 0.7385 test_ap: 0.7869 test_f1: 0.6784 test_recon_acc: 0.5958
difference_matrix tensor([[0.0000, 0.1177, 0.1181, 0.1179, 0.1179, 0.1181, 0.1177, 0.1178, 0.1177,
         0.1179],
        [0.1177, 0.0000, 0.1180, 0.1176, 0.1178, 0.1179, 0.1177, 0.1175, 0.1180,
         0.1177],
        [0.1181, 0.1180, 0.0000, 0.1180, 0.1186, 0.1182, 0.1179, 0.1181, 0.1185,
         0.1181],
        [0.1179, 0.1176, 0.1180, 0.0000, 0.1182, 0.1184, 0.1178, 0.1175, 0.1183,
         0.1179],
        [0.1179, 0.1178, 0.1186, 0.1182, 0.0000, 0.1180, 0.1184, 0.1181, 0.1183,
         0.1182],
        [0.1181, 0.1179, 0.1182, 0.1184, 0.1180, 0.0000, 0.1182, 0.1180, 0.1180,
         0.1181],
        [0.1177, 0.1177, 0.1179, 0.1178, 0.1184, 0.1182, 0.0000, 0.1175, 0.1184,
         0.1179],
        [0.1178, 0.1175, 0.1181, 0.1175, 0.1181, 0.1180, 0.1175, 0.0000, 0.1179,
         0.1179],
        [0.1177, 0.1180, 0.1185, 0.1183, 0.1183, 0.1180, 0.1184, 0.1179, 0.0000,
         0.1178],
        [0.1179, 0.1177, 0.1181, 0.1179, 0.1182, 0.1181, 0.1179, 0.1179, 0.1178,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0320, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34479758
Epoch411: train_loss: 4.1153 recon_acc: 0.2258 val_roc: 0.7595 val_ap: 0.8140 f1: 0.6919 time: 0.2901
thresh 0.5494096
          test_roc: 0.7387 test_ap: 0.7871 test_f1: 0.6777 test_recon_acc: 0.5954
difference_matrix tensor([[0.0000, 0.1176, 0.1181, 0.1178, 0.1178, 0.1180, 0.1176, 0.1177, 0.1176,
         0.1178],
        [0.1176, 0.0000, 0.1179, 0.1176, 0.1177, 0.1178, 0.1176, 0.1174, 0.1180,
         0.1177],
        [0.1181, 0.1179, 0.0000, 0.1179, 0.1185, 0.1181, 0.1178, 0.1181, 0.1184,
         0.1180],
        [0.1178, 0.1176, 0.1179, 0.0000, 0.1181, 0.1183, 0.1178, 0.1175, 0.1182,
         0.1178],
        [0.1178, 0.1177, 0.1185, 0.1181, 0.0000, 0.1179, 0.1183, 0.1180, 0.1182,
         0.1181],
        [0.1180, 0.1178, 0.1181, 0.1183, 0.1179, 0.0000, 0.1181, 0.1180, 0.1180,
         0.1180],
        [0.1176, 0.1176, 0.1178, 0.1178, 0.1183, 0.1181, 0.0000, 0.1174, 0.1183,
         0.1178],
        [0.1177, 0.1174, 0.1181, 0.1175, 0.1180, 0.1180, 0.1174, 0.0000, 0.1178,
         0.1178],
        [0.1176, 0.1180, 0.1184, 0.1182, 0.1182, 0.1180, 0.1183, 0.1178, 0.0000,
         0.1178],
        [0.1178, 0.1177, 0.1180, 0.1178, 0.1181, 0.1180, 0.1178, 0.1178, 0.1178,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0321, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34762508
Epoch412: train_loss: 4.1148 recon_acc: 0.2302 val_roc: 0.7598 val_ap: 0.8143 f1: 0.6921 time: 0.2625
thresh 0.45063847
          test_roc: 0.7389 test_ap: 0.7875 test_f1: 0.6780 test_recon_acc: 0.4103
difference_matrix tensor([[0.0000, 0.1175, 0.1180, 0.1177, 0.1177, 0.1180, 0.1176, 0.1176, 0.1176,
         0.1178],
        [0.1175, 0.0000, 0.1178, 0.1175, 0.1176, 0.1177, 0.1175, 0.1174, 0.1179,
         0.1176],
        [0.1180, 0.1178, 0.0000, 0.1178, 0.1185, 0.1180, 0.1177, 0.1180, 0.1183,
         0.1179],
        [0.1177, 0.1175, 0.1178, 0.0000, 0.1181, 0.1182, 0.1177, 0.1174, 0.1181,
         0.1178],
        [0.1177, 0.1176, 0.1185, 0.1181, 0.0000, 0.1178, 0.1182, 0.1179, 0.1181,
         0.1181],
        [0.1180, 0.1177, 0.1180, 0.1182, 0.1178, 0.0000, 0.1180, 0.1179, 0.1179,
         0.1179],
        [0.1176, 0.1175, 0.1177, 0.1177, 0.1182, 0.1180, 0.0000, 0.1174, 0.1183,
         0.1177],
        [0.1176, 0.1174, 0.1180, 0.1174, 0.1179, 0.1179, 0.1174, 0.0000, 0.1177,
         0.1178],
        [0.1176, 0.1179, 0.1183, 0.1181, 0.1181, 0.1179, 0.1183, 0.1177, 0.0000,
         0.1177],
        [0.1178, 0.1176, 0.1179, 0.1178, 0.1181, 0.1179, 0.1177, 0.1178, 0.1177,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0322, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34748766
Epoch413: train_loss: 4.1143 recon_acc: 0.2299 val_roc: 0.7598 val_ap: 0.8145 f1: 0.6921 time: 0.2620
thresh 0.45035058
          test_roc: 0.7392 test_ap: 0.7878 test_f1: 0.6786 test_recon_acc: 0.4098
difference_matrix tensor([[0.0000, 0.1174, 0.1179, 0.1176, 0.1177, 0.1179, 0.1175, 0.1176, 0.1175,
         0.1177],
        [0.1174, 0.0000, 0.1177, 0.1174, 0.1176, 0.1177, 0.1175, 0.1173, 0.1178,
         0.1175],
        [0.1179, 0.1177, 0.0000, 0.1178, 0.1184, 0.1180, 0.1177, 0.1179, 0.1183,
         0.1179],
        [0.1176, 0.1174, 0.1178, 0.0000, 0.1180, 0.1181, 0.1176, 0.1173, 0.1180,
         0.1177],
        [0.1177, 0.1176, 0.1184, 0.1180, 0.0000, 0.1177, 0.1181, 0.1178, 0.1181,
         0.1180],
        [0.1179, 0.1177, 0.1180, 0.1181, 0.1177, 0.0000, 0.1180, 0.1178, 0.1178,
         0.1178],
        [0.1175, 0.1175, 0.1177, 0.1176, 0.1181, 0.1180, 0.0000, 0.1173, 0.1182,
         0.1177],
        [0.1176, 0.1173, 0.1179, 0.1173, 0.1178, 0.1178, 0.1173, 0.0000, 0.1177,
         0.1177],
        [0.1175, 0.1178, 0.1183, 0.1180, 0.1181, 0.1178, 0.1182, 0.1177, 0.0000,
         0.1176],
        [0.1177, 0.1175, 0.1179, 0.1177, 0.1180, 0.1178, 0.1177, 0.1177, 0.1176,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0322, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3473507
Epoch414: train_loss: 4.1138 recon_acc: 0.2296 val_roc: 0.7601 val_ap: 0.8147 f1: 0.6921 time: 0.2525
thresh 0.4504683
          test_roc: 0.7394 test_ap: 0.7881 test_f1: 0.6786 test_recon_acc: 0.4100
difference_matrix tensor([[0.0000, 0.1174, 0.1178, 0.1176, 0.1176, 0.1178, 0.1174, 0.1175, 0.1174,
         0.1176],
        [0.1174, 0.0000, 0.1177, 0.1173, 0.1175, 0.1176, 0.1174, 0.1172, 0.1178,
         0.1175],
        [0.1178, 0.1177, 0.0000, 0.1177, 0.1183, 0.1179, 0.1176, 0.1178, 0.1182,
         0.1178],
        [0.1176, 0.1173, 0.1177, 0.0000, 0.1179, 0.1181, 0.1176, 0.1172, 0.1180,
         0.1176],
        [0.1176, 0.1175, 0.1183, 0.1179, 0.0000, 0.1177, 0.1181, 0.1178, 0.1180,
         0.1179],
        [0.1178, 0.1176, 0.1179, 0.1181, 0.1177, 0.0000, 0.1179, 0.1178, 0.1177,
         0.1178],
        [0.1174, 0.1174, 0.1176, 0.1176, 0.1181, 0.1179, 0.0000, 0.1172, 0.1181,
         0.1176],
        [0.1175, 0.1172, 0.1178, 0.1172, 0.1178, 0.1178, 0.1172, 0.0000, 0.1176,
         0.1176],
        [0.1174, 0.1178, 0.1182, 0.1180, 0.1180, 0.1177, 0.1181, 0.1176, 0.0000,
         0.1176],
        [0.1176, 0.1175, 0.1178, 0.1176, 0.1179, 0.1178, 0.1176, 0.1176, 0.1176,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0323, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34721407
Epoch415: train_loss: 4.1133 recon_acc: 0.2293 val_roc: 0.7604 val_ap: 0.8150 f1: 0.6921 time: 0.2682
thresh 0.5363459
          test_roc: 0.7397 test_ap: 0.7884 test_f1: 0.6788 test_recon_acc: 0.5713
difference_matrix tensor([[0.0000, 0.1173, 0.1178, 0.1175, 0.1175, 0.1178, 0.1174, 0.1174, 0.1173,
         0.1176],
        [0.1173, 0.0000, 0.1176, 0.1173, 0.1174, 0.1175, 0.1173, 0.1172, 0.1177,
         0.1174],
        [0.1178, 0.1176, 0.0000, 0.1176, 0.1182, 0.1178, 0.1175, 0.1178, 0.1181,
         0.1177],
        [0.1175, 0.1173, 0.1176, 0.0000, 0.1178, 0.1180, 0.1175, 0.1172, 0.1179,
         0.1175],
        [0.1175, 0.1174, 0.1182, 0.1178, 0.0000, 0.1176, 0.1180, 0.1177, 0.1179,
         0.1179],
        [0.1178, 0.1175, 0.1178, 0.1180, 0.1176, 0.0000, 0.1178, 0.1177, 0.1177,
         0.1177],
        [0.1174, 0.1173, 0.1175, 0.1175, 0.1180, 0.1178, 0.0000, 0.1171, 0.1181,
         0.1175],
        [0.1174, 0.1172, 0.1178, 0.1172, 0.1177, 0.1177, 0.1171, 0.0000, 0.1175,
         0.1176],
        [0.1173, 0.1177, 0.1181, 0.1179, 0.1179, 0.1177, 0.1181, 0.1175, 0.0000,
         0.1175],
        [0.1176, 0.1174, 0.1177, 0.1175, 0.1179, 0.1177, 0.1175, 0.1176, 0.1175,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0324, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.34707782
Epoch416: train_loss: 4.1128 recon_acc: 0.2290 val_roc: 0.7607 val_ap: 0.8153 f1: 0.6921 time: 0.2721
thresh 0.5413078
          test_roc: 0.7400 test_ap: 0.7888 test_f1: 0.6790 test_recon_acc: 0.5806
difference_matrix tensor([[0.0000, 0.1172, 0.1177, 0.1174, 0.1175, 0.1177, 0.1173, 0.1174, 0.1173,
         0.1175],
        [0.1172, 0.0000, 0.1175, 0.1172, 0.1173, 0.1174, 0.1172, 0.1171, 0.1176,
         0.1173],
        [0.1177, 0.1175, 0.0000, 0.1176, 0.1182, 0.1177, 0.1175, 0.1177, 0.1181,
         0.1177],
        [0.1174, 0.1172, 0.1176, 0.0000, 0.1178, 0.1179, 0.1174, 0.1171, 0.1178,
         0.1175],
        [0.1175, 0.1173, 0.1182, 0.1178, 0.0000, 0.1175, 0.1179, 0.1176, 0.1178,
         0.1178],
        [0.1177, 0.1174, 0.1177, 0.1179, 0.1175, 0.0000, 0.1178, 0.1176, 0.1176,
         0.1176],
        [0.1173, 0.1172, 0.1175, 0.1174, 0.1179, 0.1178, 0.0000, 0.1171, 0.1180,
         0.1175],
        [0.1174, 0.1171, 0.1177, 0.1171, 0.1176, 0.1176, 0.1171, 0.0000, 0.1174,
         0.1175],
        [0.1173, 0.1176, 0.1181, 0.1178, 0.1178, 0.1176, 0.1180, 0.1174, 0.0000,
         0.1174],
        [0.1175, 0.1173, 0.1177, 0.1175, 0.1178, 0.1176, 0.1175, 0.1175, 0.1174,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0325, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35133803
Epoch417: train_loss: 4.1123 recon_acc: 0.2357 val_roc: 0.7610 val_ap: 0.8157 f1: 0.6910 time: 0.2720
thresh 0.543077
          test_roc: 0.7402 test_ap: 0.7891 test_f1: 0.6797 test_recon_acc: 0.5840
difference_matrix tensor([[0.0000, 0.1172, 0.1176, 0.1174, 0.1174, 0.1176, 0.1172, 0.1173, 0.1172,
         0.1174],
        [0.1172, 0.0000, 0.1175, 0.1171, 0.1173, 0.1174, 0.1172, 0.1170, 0.1175,
         0.1172],
        [0.1176, 0.1175, 0.0000, 0.1175, 0.1181, 0.1177, 0.1174, 0.1176, 0.1180,
         0.1176],
        [0.1174, 0.1171, 0.1175, 0.0000, 0.1177, 0.1179, 0.1173, 0.1170, 0.1178,
         0.1174],
        [0.1174, 0.1173, 0.1181, 0.1177, 0.0000, 0.1174, 0.1179, 0.1176, 0.1178,
         0.1177],
        [0.1176, 0.1174, 0.1177, 0.1179, 0.1174, 0.0000, 0.1177, 0.1175, 0.1175,
         0.1176],
        [0.1172, 0.1172, 0.1174, 0.1173, 0.1179, 0.1177, 0.0000, 0.1170, 0.1179,
         0.1174],
        [0.1173, 0.1170, 0.1176, 0.1170, 0.1176, 0.1175, 0.1170, 0.0000, 0.1174,
         0.1174],
        [0.1172, 0.1175, 0.1180, 0.1178, 0.1178, 0.1175, 0.1179, 0.1174, 0.0000,
         0.1174],
        [0.1174, 0.1172, 0.1176, 0.1174, 0.1177, 0.1176, 0.1174, 0.1174, 0.1174,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0325, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3516156
Epoch418: train_loss: 4.1118 recon_acc: 0.2361 val_roc: 0.7612 val_ap: 0.8158 f1: 0.6910 time: 0.2591
thresh 0.5357555
          test_roc: 0.7404 test_ap: 0.7893 test_f1: 0.6802 test_recon_acc: 0.5703
difference_matrix tensor([[0.0000, 0.1171, 0.1176, 0.1173, 0.1173, 0.1176, 0.1171, 0.1172, 0.1171,
         0.1174],
        [0.1171, 0.0000, 0.1174, 0.1171, 0.1172, 0.1173, 0.1171, 0.1169, 0.1175,
         0.1172],
        [0.1176, 0.1174, 0.0000, 0.1174, 0.1180, 0.1176, 0.1173, 0.1176, 0.1179,
         0.1175],
        [0.1173, 0.1171, 0.1174, 0.0000, 0.1176, 0.1178, 0.1173, 0.1170, 0.1177,
         0.1173],
        [0.1173, 0.1172, 0.1180, 0.1176, 0.0000, 0.1174, 0.1178, 0.1175, 0.1177,
         0.1177],
        [0.1176, 0.1173, 0.1176, 0.1178, 0.1174, 0.0000, 0.1176, 0.1175, 0.1175,
         0.1175],
        [0.1171, 0.1171, 0.1173, 0.1173, 0.1178, 0.1176, 0.0000, 0.1169, 0.1178,
         0.1173],
        [0.1172, 0.1169, 0.1176, 0.1170, 0.1175, 0.1175, 0.1169, 0.0000, 0.1173,
         0.1173],
        [0.1171, 0.1175, 0.1179, 0.1177, 0.1177, 0.1175, 0.1178, 0.1173, 0.0000,
         0.1173],
        [0.1174, 0.1172, 0.1175, 0.1173, 0.1177, 0.1175, 0.1173, 0.1173, 0.1173,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0326, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35189393
Epoch419: train_loss: 4.1113 recon_acc: 0.2364 val_roc: 0.7614 val_ap: 0.8160 f1: 0.6910 time: 0.2745
thresh 0.53556156
          test_roc: 0.7407 test_ap: 0.7896 test_f1: 0.6809 test_recon_acc: 0.5700
difference_matrix tensor([[0.0000, 0.1170, 0.1175, 0.1172, 0.1173, 0.1175, 0.1171, 0.1172, 0.1171,
         0.1173],
        [0.1170, 0.0000, 0.1173, 0.1170, 0.1171, 0.1172, 0.1170, 0.1169, 0.1174,
         0.1171],
        [0.1175, 0.1173, 0.0000, 0.1174, 0.1180, 0.1175, 0.1172, 0.1175, 0.1179,
         0.1175],
        [0.1172, 0.1170, 0.1174, 0.0000, 0.1176, 0.1177, 0.1172, 0.1169, 0.1176,
         0.1173],
        [0.1173, 0.1171, 0.1180, 0.1176, 0.0000, 0.1173, 0.1177, 0.1174, 0.1176,
         0.1176],
        [0.1175, 0.1172, 0.1175, 0.1177, 0.1173, 0.0000, 0.1176, 0.1174, 0.1174,
         0.1174],
        [0.1171, 0.1170, 0.1172, 0.1172, 0.1177, 0.1176, 0.0000, 0.1169, 0.1178,
         0.1172],
        [0.1172, 0.1169, 0.1175, 0.1169, 0.1174, 0.1174, 0.1169, 0.0000, 0.1172,
         0.1173],
        [0.1171, 0.1174, 0.1179, 0.1176, 0.1176, 0.1174, 0.1178, 0.1172, 0.0000,
         0.1172],
        [0.1173, 0.1171, 0.1175, 0.1173, 0.1176, 0.1174, 0.1172, 0.1173, 0.1172,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0327, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35217315
Epoch420: train_loss: 4.1108 recon_acc: 0.2368 val_roc: 0.7618 val_ap: 0.8165 f1: 0.6910 time: 0.2882
thresh 0.53787273
          test_roc: 0.7409 test_ap: 0.7899 test_f1: 0.6802 test_recon_acc: 0.5744
difference_matrix tensor([[0.0000, 0.1170, 0.1174, 0.1172, 0.1172, 0.1174, 0.1170, 0.1171, 0.1170,
         0.1172],
        [0.1170, 0.0000, 0.1173, 0.1169, 0.1171, 0.1172, 0.1170, 0.1168, 0.1173,
         0.1170],
        [0.1174, 0.1173, 0.0000, 0.1173, 0.1179, 0.1175, 0.1172, 0.1174, 0.1178,
         0.1174],
        [0.1172, 0.1169, 0.1173, 0.0000, 0.1175, 0.1177, 0.1171, 0.1168, 0.1176,
         0.1172],
        [0.1172, 0.1171, 0.1179, 0.1175, 0.0000, 0.1172, 0.1176, 0.1174, 0.1176,
         0.1175],
        [0.1174, 0.1172, 0.1175, 0.1177, 0.1172, 0.0000, 0.1175, 0.1173, 0.1173,
         0.1174],
        [0.1170, 0.1170, 0.1172, 0.1171, 0.1176, 0.1175, 0.0000, 0.1168, 0.1177,
         0.1172],
        [0.1171, 0.1168, 0.1174, 0.1168, 0.1174, 0.1173, 0.1168, 0.0000, 0.1172,
         0.1172],
        [0.1170, 0.1173, 0.1178, 0.1176, 0.1176, 0.1173, 0.1177, 0.1172, 0.0000,
         0.1171],
        [0.1172, 0.1170, 0.1174, 0.1172, 0.1175, 0.1174, 0.1172, 0.1172, 0.1171,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0327, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.3524531
Epoch421: train_loss: 4.1103 recon_acc: 0.2372 val_roc: 0.7620 val_ap: 0.8167 f1: 0.6910 time: 0.2599
thresh 0.535105
          test_roc: 0.7411 test_ap: 0.7903 test_f1: 0.6802 test_recon_acc: 0.5692
difference_matrix tensor([[0.0000, 0.1169, 0.1174, 0.1171, 0.1171, 0.1174, 0.1169, 0.1170, 0.1169,
         0.1171],
        [0.1169, 0.0000, 0.1172, 0.1169, 0.1170, 0.1171, 0.1169, 0.1167, 0.1173,
         0.1170],
        [0.1174, 0.1172, 0.0000, 0.1172, 0.1178, 0.1174, 0.1171, 0.1174, 0.1177,
         0.1173],
        [0.1171, 0.1169, 0.1172, 0.0000, 0.1174, 0.1176, 0.1171, 0.1168, 0.1175,
         0.1171],
        [0.1171, 0.1170, 0.1178, 0.1174, 0.0000, 0.1172, 0.1176, 0.1173, 0.1175,
         0.1174],
        [0.1174, 0.1171, 0.1174, 0.1176, 0.1172, 0.0000, 0.1174, 0.1173, 0.1173,
         0.1173],
        [0.1169, 0.1169, 0.1171, 0.1171, 0.1176, 0.1174, 0.0000, 0.1167, 0.1176,
         0.1171],
        [0.1170, 0.1167, 0.1174, 0.1168, 0.1173, 0.1173, 0.1167, 0.0000, 0.1171,
         0.1171],
        [0.1169, 0.1173, 0.1177, 0.1175, 0.1175, 0.1173, 0.1176, 0.1171, 0.0000,
         0.1171],
        [0.1171, 0.1170, 0.1173, 0.1171, 0.1174, 0.1173, 0.1171, 0.1171, 0.1171,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0328, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.35273385
Epoch422: train_loss: 4.1099 recon_acc: 0.2376 val_roc: 0.7623 val_ap: 0.8170 f1: 0.6910 time: 0.2615
thresh 0.5422682
          test_roc: 0.7414 test_ap: 0.7907 test_f1: 0.6804 test_recon_acc: 0.5827
difference_matrix tensor([[0.0000, 0.1168, 0.1173, 0.1170, 0.1170, 0.1173, 0.1169, 0.1170, 0.1169,
         0.1171],
        [0.1168, 0.0000, 0.1171, 0.1168, 0.1169, 0.1170, 0.1168, 0.1167, 0.1172,
         0.1169],
        [0.1173, 0.1171, 0.0000, 0.1172, 0.1177, 0.1173, 0.1170, 0.1173, 0.1177,
         0.1173],
        [0.1170, 0.1168, 0.1172, 0.0000, 0.1174, 0.1175, 0.1170, 0.1167, 0.1174,
         0.1171],
        [0.1170, 0.1169, 0.1177, 0.1174, 0.0000, 0.1171, 0.1175, 0.1172, 0.1174,
         0.1174],
        [0.1173, 0.1170, 0.1173, 0.1175, 0.1171, 0.0000, 0.1174, 0.1172, 0.1172,
         0.1172],
        [0.1169, 0.1168, 0.1170, 0.1170, 0.1175, 0.1174, 0.0000, 0.1166, 0.1176,
         0.1170],
        [0.1170, 0.1167, 0.1173, 0.1167, 0.1172, 0.1172, 0.1166, 0.0000, 0.1170,
         0.1171],
        [0.1169, 0.1172, 0.1177, 0.1174, 0.1174, 0.1172, 0.1176, 0.1170, 0.0000,
         0.1170],
        [0.1171, 0.1169, 0.1173, 0.1171, 0.1174, 0.1172, 0.1170, 0.1171, 0.1170,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0329, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.49082777
Epoch423: train_loss: 4.1094 recon_acc: 0.4858 val_roc: 0.7625 val_ap: 0.8172 f1: 0.6926 time: 0.2956
thresh 0.54388183
          test_roc: 0.7415 test_ap: 0.7910 test_f1: 0.6804 test_recon_acc: 0.5856
difference_matrix tensor([[0.0000, 0.1168, 0.1172, 0.1170, 0.1170, 0.1172, 0.1168, 0.1169, 0.1168,
         0.1170],
        [0.1168, 0.0000, 0.1171, 0.1167, 0.1169, 0.1170, 0.1168, 0.1166, 0.1171,
         0.1168],
        [0.1172, 0.1171, 0.0000, 0.1171, 0.1177, 0.1173, 0.1170, 0.1172, 0.1176,
         0.1172],
        [0.1170, 0.1167, 0.1171, 0.0000, 0.1173, 0.1175, 0.1169, 0.1166, 0.1174,
         0.1170],
        [0.1170, 0.1169, 0.1177, 0.1173, 0.0000, 0.1170, 0.1174, 0.1172, 0.1174,
         0.1173],
        [0.1172, 0.1170, 0.1173, 0.1175, 0.1170, 0.0000, 0.1173, 0.1171, 0.1171,
         0.1172],
        [0.1168, 0.1168, 0.1170, 0.1169, 0.1174, 0.1173, 0.0000, 0.1166, 0.1175,
         0.1170],
        [0.1169, 0.1166, 0.1172, 0.1166, 0.1172, 0.1171, 0.1166, 0.0000, 0.1170,
         0.1170],
        [0.1168, 0.1171, 0.1176, 0.1174, 0.1174, 0.1171, 0.1175, 0.1170, 0.0000,
         0.1169],
        [0.1170, 0.1168, 0.1172, 0.1170, 0.1173, 0.1172, 0.1170, 0.1170, 0.1169,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0329, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.4926249
Epoch424: train_loss: 4.1089 recon_acc: 0.4892 val_roc: 0.7627 val_ap: 0.8174 f1: 0.6940 time: 0.2845
thresh 0.5438573
          test_roc: 0.7418 test_ap: 0.7914 test_f1: 0.6804 test_recon_acc: 0.5857
difference_matrix tensor([[0.0000, 0.1167, 0.1172, 0.1169, 0.1169, 0.1172, 0.1167, 0.1168, 0.1167,
         0.1170],
        [0.1167, 0.0000, 0.1170, 0.1167, 0.1168, 0.1169, 0.1167, 0.1165, 0.1171,
         0.1168],
        [0.1172, 0.1170, 0.0000, 0.1170, 0.1176, 0.1172, 0.1169, 0.1172, 0.1175,
         0.1171],
        [0.1169, 0.1167, 0.1170, 0.0000, 0.1172, 0.1174, 0.1169, 0.1166, 0.1173,
         0.1169],
        [0.1169, 0.1168, 0.1176, 0.1172, 0.0000, 0.1170, 0.1174, 0.1171, 0.1173,
         0.1173],
        [0.1172, 0.1169, 0.1172, 0.1174, 0.1170, 0.0000, 0.1172, 0.1171, 0.1171,
         0.1171],
        [0.1167, 0.1167, 0.1169, 0.1169, 0.1174, 0.1172, 0.0000, 0.1165, 0.1174,
         0.1169],
        [0.1168, 0.1165, 0.1172, 0.1166, 0.1171, 0.1171, 0.1165, 0.0000, 0.1169,
         0.1169],
        [0.1167, 0.1171, 0.1175, 0.1173, 0.1173, 0.1171, 0.1174, 0.1169, 0.0000,
         0.1169],
        [0.1170, 0.1168, 0.1171, 0.1169, 0.1173, 0.1171, 0.1169, 0.1169, 0.1169,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0330, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.4933469
Epoch425: train_loss: 4.1085 recon_acc: 0.4906 val_roc: 0.7628 val_ap: 0.8175 f1: 0.6940 time: 0.2606
thresh 0.54319274
          test_roc: 0.7420 test_ap: 0.7918 test_f1: 0.6804 test_recon_acc: 0.5845
difference_matrix tensor([[0.0000, 0.1166, 0.1171, 0.1168, 0.1169, 0.1171, 0.1167, 0.1168, 0.1167,
         0.1169],
        [0.1166, 0.0000, 0.1169, 0.1166, 0.1167, 0.1169, 0.1166, 0.1165, 0.1170,
         0.1167],
        [0.1171, 0.1169, 0.0000, 0.1170, 0.1175, 0.1171, 0.1168, 0.1171, 0.1175,
         0.1171],
        [0.1168, 0.1166, 0.1170, 0.0000, 0.1172, 0.1173, 0.1168, 0.1165, 0.1172,
         0.1169],
        [0.1169, 0.1167, 0.1175, 0.1172, 0.0000, 0.1169, 0.1173, 0.1170, 0.1172,
         0.1172],
        [0.1171, 0.1169, 0.1171, 0.1173, 0.1169, 0.0000, 0.1172, 0.1170, 0.1170,
         0.1170],
        [0.1167, 0.1166, 0.1168, 0.1168, 0.1173, 0.1172, 0.0000, 0.1164, 0.1174,
         0.1169],
        [0.1168, 0.1165, 0.1171, 0.1165, 0.1170, 0.1170, 0.1164, 0.0000, 0.1168,
         0.1169],
        [0.1167, 0.1170, 0.1175, 0.1172, 0.1172, 0.1170, 0.1174, 0.1168, 0.0000,
         0.1168],
        [0.1169, 0.1167, 0.1171, 0.1169, 0.1172, 0.1170, 0.1169, 0.1169, 0.1168,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0331, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.4936604
Epoch426: train_loss: 4.1080 recon_acc: 0.4912 val_roc: 0.7631 val_ap: 0.8178 f1: 0.6940 time: 0.2776
thresh 0.53216916
          test_roc: 0.7422 test_ap: 0.7920 test_f1: 0.6801 test_recon_acc: 0.5639
difference_matrix tensor([[0.0000, 0.1166, 0.1170, 0.1168, 0.1168, 0.1170, 0.1166, 0.1167, 0.1166,
         0.1168],
        [0.1166, 0.0000, 0.1169, 0.1165, 0.1167, 0.1168, 0.1166, 0.1164, 0.1169,
         0.1166],
        [0.1170, 0.1169, 0.0000, 0.1169, 0.1175, 0.1171, 0.1168, 0.1170, 0.1174,
         0.1170],
        [0.1168, 0.1165, 0.1169, 0.0000, 0.1171, 0.1173, 0.1167, 0.1164, 0.1172,
         0.1168],
        [0.1168, 0.1167, 0.1175, 0.1171, 0.0000, 0.1168, 0.1173, 0.1170, 0.1172,
         0.1171],
        [0.1170, 0.1168, 0.1171, 0.1173, 0.1168, 0.0000, 0.1171, 0.1170, 0.1169,
         0.1170],
        [0.1166, 0.1166, 0.1168, 0.1167, 0.1173, 0.1171, 0.0000, 0.1164, 0.1173,
         0.1168],
        [0.1167, 0.1164, 0.1170, 0.1164, 0.1170, 0.1170, 0.1164, 0.0000, 0.1168,
         0.1168],
        [0.1166, 0.1169, 0.1174, 0.1172, 0.1172, 0.1169, 0.1173, 0.1168, 0.0000,
         0.1168],
        [0.1168, 0.1166, 0.1170, 0.1168, 0.1171, 0.1170, 0.1168, 0.1168, 0.1168,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0331, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.49397433
Epoch427: train_loss: 4.1076 recon_acc: 0.4918 val_roc: 0.7631 val_ap: 0.8178 f1: 0.6940 time: 0.2822
difference_matrix tensor([[0.0000, 0.1165, 0.1170, 0.1167, 0.1167, 0.1170, 0.1165, 0.1166, 0.1165,
         0.1168],
        [0.1165, 0.0000, 0.1168, 0.1165, 0.1166, 0.1167, 0.1165, 0.1163, 0.1169,
         0.1166],
        [0.1170, 0.1168, 0.0000, 0.1168, 0.1174, 0.1170, 0.1167, 0.1170, 0.1173,
         0.1169],
        [0.1167, 0.1165, 0.1168, 0.0000, 0.1170, 0.1172, 0.1167, 0.1164, 0.1171,
         0.1167],
        [0.1167, 0.1166, 0.1174, 0.1170, 0.0000, 0.1168, 0.1172, 0.1169, 0.1171,
         0.1171],
        [0.1170, 0.1167, 0.1170, 0.1172, 0.1168, 0.0000, 0.1170, 0.1169, 0.1169,
         0.1169],
        [0.1165, 0.1165, 0.1167, 0.1167, 0.1172, 0.1170, 0.0000, 0.1163, 0.1172,
         0.1167],
        [0.1166, 0.1163, 0.1170, 0.1164, 0.1169, 0.1169, 0.1163, 0.0000, 0.1167,
         0.1167],
        [0.1165, 0.1169, 0.1173, 0.1171, 0.1171, 0.1169, 0.1172, 0.1167, 0.0000,
         0.1167],
        [0.1168, 0.1166, 0.1169, 0.1167, 0.1171, 0.1169, 0.1167, 0.1167, 0.1167,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0332, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.4934942
Epoch428: train_loss: 4.1071 recon_acc: 0.4909 val_roc: 0.7633 val_ap: 0.8180 f1: 0.6940 time: 0.2979
thresh 0.5321268
          test_roc: 0.7426 test_ap: 0.7925 test_f1: 0.6821 test_recon_acc: 0.5639
difference_matrix tensor([[0.0000, 0.1164, 0.1169, 0.1166, 0.1167, 0.1169, 0.1165, 0.1166, 0.1165,
         0.1167],
        [0.1164, 0.0000, 0.1167, 0.1164, 0.1165, 0.1167, 0.1164, 0.1163, 0.1168,
         0.1165],
        [0.1169, 0.1167, 0.0000, 0.1168, 0.1173, 0.1169, 0.1166, 0.1169, 0.1173,
         0.1169],
        [0.1166, 0.1164, 0.1168, 0.0000, 0.1170, 0.1171, 0.1166, 0.1163, 0.1170,
         0.1167],
        [0.1167, 0.1165, 0.1173, 0.1170, 0.0000, 0.1167, 0.1171, 0.1168, 0.1170,
         0.1170],
        [0.1169, 0.1167, 0.1169, 0.1171, 0.1167, 0.0000, 0.1170, 0.1168, 0.1168,
         0.1168],
        [0.1165, 0.1164, 0.1166, 0.1166, 0.1171, 0.1170, 0.0000, 0.1163, 0.1172,
         0.1167],
        [0.1166, 0.1163, 0.1169, 0.1163, 0.1168, 0.1168, 0.1163, 0.0000, 0.1166,
         0.1167],
        [0.1165, 0.1168, 0.1173, 0.1170, 0.1170, 0.1168, 0.1172, 0.1166, 0.0000,
         0.1166],
        [0.1167, 0.1165, 0.1169, 0.1167, 0.1170, 0.1168, 0.1167, 0.1167, 0.1166,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0332, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.49299693
Epoch429: train_loss: 4.1067 recon_acc: 0.4899 val_roc: 0.7635 val_ap: 0.8185 f1: 0.6940 time: 0.2799
thresh 0.53260636
          test_roc: 0.7428 test_ap: 0.7927 test_f1: 0.6821 test_recon_acc: 0.5648
difference_matrix tensor([[0.0000, 0.1164, 0.1168, 0.1166, 0.1166, 0.1168, 0.1164, 0.1165, 0.1164,
         0.1166],
        [0.1164, 0.0000, 0.1167, 0.1163, 0.1165, 0.1166, 0.1164, 0.1162, 0.1168,
         0.1165],
        [0.1168, 0.1167, 0.0000, 0.1167, 0.1173, 0.1169, 0.1166, 0.1168, 0.1172,
         0.1168],
        [0.1166, 0.1163, 0.1167, 0.0000, 0.1169, 0.1171, 0.1165, 0.1162, 0.1170,
         0.1166],
        [0.1166, 0.1165, 0.1173, 0.1169, 0.0000, 0.1166, 0.1171, 0.1168, 0.1170,
         0.1169],
        [0.1168, 0.1166, 0.1169, 0.1171, 0.1166, 0.0000, 0.1169, 0.1168, 0.1167,
         0.1168],
        [0.1164, 0.1164, 0.1166, 0.1165, 0.1171, 0.1169, 0.0000, 0.1162, 0.1171,
         0.1166],
        [0.1165, 0.1162, 0.1168, 0.1162, 0.1168, 0.1168, 0.1162, 0.0000, 0.1166,
         0.1166],
        [0.1164, 0.1168, 0.1172, 0.1170, 0.1170, 0.1167, 0.1171, 0.1166, 0.0000,
         0.1166],
        [0.1166, 0.1165, 0.1168, 0.1166, 0.1169, 0.1168, 0.1166, 0.1166, 0.1166,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0333, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.49250707
Epoch430: train_loss: 4.1062 recon_acc: 0.4890 val_roc: 0.7636 val_ap: 0.8186 f1: 0.6940 time: 0.2689
thresh 0.5323002
          test_roc: 0.7430 test_ap: 0.7930 test_f1: 0.6815 test_recon_acc: 0.5643
difference_matrix tensor([[0.0000, 0.1163, 0.1168, 0.1165, 0.1165, 0.1168, 0.1164, 0.1164, 0.1164,
         0.1166],
        [0.1163, 0.0000, 0.1166, 0.1163, 0.1164, 0.1165, 0.1163, 0.1161, 0.1167,
         0.1164],
        [0.1168, 0.1166, 0.0000, 0.1166, 0.1172, 0.1168, 0.1165, 0.1168, 0.1171,
         0.1168],
        [0.1165, 0.1163, 0.1166, 0.0000, 0.1168, 0.1170, 0.1165, 0.1162, 0.1169,
         0.1165],
        [0.1165, 0.1164, 0.1172, 0.1168, 0.0000, 0.1166, 0.1170, 0.1167, 0.1169,
         0.1169],
        [0.1168, 0.1165, 0.1168, 0.1170, 0.1166, 0.0000, 0.1168, 0.1167, 0.1167,
         0.1167],
        [0.1164, 0.1163, 0.1165, 0.1165, 0.1170, 0.1168, 0.0000, 0.1161, 0.1170,
         0.1165],
        [0.1164, 0.1161, 0.1168, 0.1162, 0.1167, 0.1167, 0.1161, 0.0000, 0.1165,
         0.1165],
        [0.1164, 0.1167, 0.1171, 0.1169, 0.1169, 0.1167, 0.1170, 0.1165, 0.0000,
         0.1165],
        [0.1166, 0.1164, 0.1168, 0.1165, 0.1169, 0.1167, 0.1165, 0.1165, 0.1165,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0334, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.4920246
Epoch431: train_loss: 4.1058 recon_acc: 0.4881 val_roc: 0.7639 val_ap: 0.8188 f1: 0.6940 time: 0.2824
thresh 0.5319953
          test_roc: 0.7433 test_ap: 0.7933 test_f1: 0.6815 test_recon_acc: 0.5638
difference_matrix tensor([[0.0000, 0.1162, 0.1167, 0.1164, 0.1165, 0.1167, 0.1163, 0.1164, 0.1163,
         0.1165],
        [0.1162, 0.0000, 0.1166, 0.1162, 0.1163, 0.1165, 0.1162, 0.1161, 0.1166,
         0.1163],
        [0.1167, 0.1166, 0.0000, 0.1166, 0.1172, 0.1168, 0.1165, 0.1167, 0.1171,
         0.1167],
        [0.1164, 0.1162, 0.1166, 0.0000, 0.1168, 0.1170, 0.1164, 0.1161, 0.1168,
         0.1165],
        [0.1165, 0.1163, 0.1172, 0.1168, 0.0000, 0.1165, 0.1169, 0.1166, 0.1169,
         0.1168],
        [0.1167, 0.1165, 0.1168, 0.1170, 0.1165, 0.0000, 0.1168, 0.1166, 0.1166,
         0.1166],
        [0.1163, 0.1162, 0.1165, 0.1164, 0.1169, 0.1168, 0.0000, 0.1161, 0.1170,
         0.1165],
        [0.1164, 0.1161, 0.1167, 0.1161, 0.1166, 0.1166, 0.1161, 0.0000, 0.1165,
         0.1165],
        [0.1163, 0.1166, 0.1171, 0.1168, 0.1169, 0.1166, 0.1170, 0.1165, 0.0000,
         0.1164],
        [0.1165, 0.1163, 0.1167, 0.1165, 0.1168, 0.1166, 0.1165, 0.1165, 0.1164,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0334, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.49154946
Epoch432: train_loss: 4.1054 recon_acc: 0.4872 val_roc: 0.7640 val_ap: 0.8190 f1: 0.6940 time: 0.2747
thresh 0.5308833
          test_roc: 0.7435 test_ap: 0.7936 test_f1: 0.6821 test_recon_acc: 0.5617
difference_matrix tensor([[0.0000, 0.1162, 0.1167, 0.1164, 0.1164, 0.1167, 0.1162, 0.1163, 0.1162,
         0.1165],
        [0.1162, 0.0000, 0.1165, 0.1162, 0.1163, 0.1164, 0.1162, 0.1160, 0.1166,
         0.1163],
        [0.1167, 0.1165, 0.0000, 0.1165, 0.1171, 0.1167, 0.1164, 0.1167, 0.1170,
         0.1166],
        [0.1164, 0.1162, 0.1165, 0.0000, 0.1167, 0.1169, 0.1164, 0.1160, 0.1168,
         0.1164],
        [0.1164, 0.1163, 0.1171, 0.1167, 0.0000, 0.1164, 0.1169, 0.1166, 0.1168,
         0.1167],
        [0.1167, 0.1164, 0.1167, 0.1169, 0.1164, 0.0000, 0.1167, 0.1166, 0.1166,
         0.1166],
        [0.1162, 0.1162, 0.1164, 0.1164, 0.1169, 0.1167, 0.0000, 0.1160, 0.1169,
         0.1164],
        [0.1163, 0.1160, 0.1167, 0.1160, 0.1166, 0.1166, 0.1160, 0.0000, 0.1164,
         0.1164],
        [0.1162, 0.1166, 0.1170, 0.1168, 0.1168, 0.1166, 0.1169, 0.1164, 0.0000,
         0.1164],
        [0.1165, 0.1163, 0.1166, 0.1164, 0.1167, 0.1166, 0.1164, 0.1164, 0.1164,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0335, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.4863913
Epoch433: train_loss: 4.1049 recon_acc: 0.4774 val_roc: 0.7641 val_ap: 0.8191 f1: 0.6951 time: 0.2826
thresh 0.5313898
          test_roc: 0.7438 test_ap: 0.7940 test_f1: 0.6828 test_recon_acc: 0.5627
difference_matrix tensor([[0.0000, 0.1161, 0.1166, 0.1163, 0.1163, 0.1166, 0.1162, 0.1163, 0.1162,
         0.1164],
        [0.1161, 0.0000, 0.1164, 0.1161, 0.1162, 0.1164, 0.1161, 0.1160, 0.1165,
         0.1162],
        [0.1166, 0.1164, 0.0000, 0.1165, 0.1170, 0.1166, 0.1163, 0.1166, 0.1170,
         0.1166],
        [0.1163, 0.1161, 0.1165, 0.0000, 0.1167, 0.1168, 0.1163, 0.1160, 0.1167,
         0.1164],
        [0.1163, 0.1162, 0.1170, 0.1167, 0.0000, 0.1164, 0.1168, 0.1165, 0.1167,
         0.1167],
        [0.1166, 0.1164, 0.1166, 0.1168, 0.1164, 0.0000, 0.1167, 0.1165, 0.1165,
         0.1165],
        [0.1162, 0.1161, 0.1163, 0.1163, 0.1168, 0.1167, 0.0000, 0.1159, 0.1169,
         0.1163],
        [0.1163, 0.1160, 0.1166, 0.1160, 0.1165, 0.1165, 0.1159, 0.0000, 0.1163,
         0.1164],
        [0.1162, 0.1165, 0.1170, 0.1167, 0.1167, 0.1165, 0.1169, 0.1163, 0.0000,
         0.1163],
        [0.1164, 0.1162, 0.1166, 0.1164, 0.1167, 0.1165, 0.1163, 0.1164, 0.1163,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0336, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.48727235
Epoch434: train_loss: 4.1045 recon_acc: 0.4791 val_roc: 0.7643 val_ap: 0.8194 f1: 0.6951 time: 0.2576
thresh 0.5310891
          test_roc: 0.7440 test_ap: 0.7942 test_f1: 0.6821 test_recon_acc: 0.5621
difference_matrix tensor([[0.0000, 0.1161, 0.1165, 0.1163, 0.1163, 0.1165, 0.1161, 0.1162, 0.1161,
         0.1163],
        [0.1161, 0.0000, 0.1164, 0.1160, 0.1162, 0.1163, 0.1160, 0.1159, 0.1165,
         0.1161],
        [0.1165, 0.1164, 0.0000, 0.1164, 0.1170, 0.1166, 0.1163, 0.1165, 0.1169,
         0.1165],
        [0.1163, 0.1160, 0.1164, 0.0000, 0.1166, 0.1168, 0.1162, 0.1159, 0.1167,
         0.1163],
        [0.1163, 0.1162, 0.1170, 0.1166, 0.0000, 0.1163, 0.1168, 0.1165, 0.1167,
         0.1166],
        [0.1165, 0.1163, 0.1166, 0.1168, 0.1163, 0.0000, 0.1166, 0.1165, 0.1164,
         0.1165],
        [0.1161, 0.1160, 0.1163, 0.1162, 0.1168, 0.1166, 0.0000, 0.1159, 0.1168,
         0.1163],
        [0.1162, 0.1159, 0.1165, 0.1159, 0.1165, 0.1165, 0.1159, 0.0000, 0.1163,
         0.1163],
        [0.1161, 0.1165, 0.1169, 0.1167, 0.1167, 0.1164, 0.1168, 0.1163, 0.0000,
         0.1163],
        [0.1163, 0.1161, 0.1165, 0.1163, 0.1166, 0.1165, 0.1163, 0.1163, 0.1163,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0336, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.48815477
Epoch435: train_loss: 4.1041 recon_acc: 0.4808 val_roc: 0.7645 val_ap: 0.8196 f1: 0.6965 time: 0.2546
thresh 0.5326345
          test_roc: 0.7443 test_ap: 0.7946 test_f1: 0.6815 test_recon_acc: 0.5650
difference_matrix tensor([[0.0000, 0.1160, 0.1165, 0.1162, 0.1162, 0.1165, 0.1160, 0.1161, 0.1161,
         0.1163],
        [0.1160, 0.0000, 0.1163, 0.1160, 0.1161, 0.1162, 0.1160, 0.1158, 0.1164,
         0.1161],
        [0.1165, 0.1163, 0.0000, 0.1163, 0.1169, 0.1165, 0.1162, 0.1165, 0.1168,
         0.1165],
        [0.1162, 0.1160, 0.1163, 0.0000, 0.1165, 0.1167, 0.1162, 0.1159, 0.1166,
         0.1162],
        [0.1162, 0.1161, 0.1169, 0.1165, 0.0000, 0.1163, 0.1167, 0.1164, 0.1166,
         0.1166],
        [0.1165, 0.1162, 0.1165, 0.1167, 0.1163, 0.0000, 0.1165, 0.1164, 0.1164,
         0.1164],
        [0.1160, 0.1160, 0.1162, 0.1162, 0.1167, 0.1165, 0.0000, 0.1158, 0.1167,
         0.1162],
        [0.1161, 0.1158, 0.1165, 0.1159, 0.1164, 0.1164, 0.1158, 0.0000, 0.1162,
         0.1162],
        [0.1161, 0.1164, 0.1168, 0.1166, 0.1166, 0.1164, 0.1167, 0.1162, 0.0000,
         0.1162],
        [0.1163, 0.1161, 0.1165, 0.1162, 0.1166, 0.1164, 0.1162, 0.1162, 0.1162,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0337, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.48903847
Epoch436: train_loss: 4.1037 recon_acc: 0.4825 val_roc: 0.7648 val_ap: 0.8198 f1: 0.6965 time: 0.2634
thresh 0.53049195
          test_roc: 0.7444 test_ap: 0.7949 test_f1: 0.6814 test_recon_acc: 0.5611
difference_matrix tensor([[0.0000, 0.1159, 0.1164, 0.1161, 0.1162, 0.1164, 0.1160, 0.1161, 0.1160,
         0.1162],
        [0.1159, 0.0000, 0.1163, 0.1159, 0.1160, 0.1162, 0.1159, 0.1158, 0.1163,
         0.1160],
        [0.1164, 0.1163, 0.0000, 0.1163, 0.1168, 0.1164, 0.1161, 0.1164, 0.1168,
         0.1164],
        [0.1161, 0.1159, 0.1163, 0.0000, 0.1165, 0.1167, 0.1161, 0.1158, 0.1165,
         0.1162],
        [0.1162, 0.1160, 0.1168, 0.1165, 0.0000, 0.1162, 0.1166, 0.1163, 0.1166,
         0.1165],
        [0.1164, 0.1162, 0.1164, 0.1167, 0.1162, 0.0000, 0.1165, 0.1163, 0.1163,
         0.1163],
        [0.1160, 0.1159, 0.1161, 0.1161, 0.1166, 0.1165, 0.0000, 0.1158, 0.1167,
         0.1162],
        [0.1161, 0.1158, 0.1164, 0.1158, 0.1163, 0.1163, 0.1158, 0.0000, 0.1162,
         0.1162],
        [0.1160, 0.1163, 0.1168, 0.1165, 0.1166, 0.1163, 0.1167, 0.1162, 0.0000,
         0.1161],
        [0.1162, 0.1160, 0.1164, 0.1162, 0.1165, 0.1163, 0.1162, 0.1162, 0.1161,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0337, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.48928475
Epoch437: train_loss: 4.1033 recon_acc: 0.4829 val_roc: 0.7651 val_ap: 0.8201 f1: 0.6965 time: 0.2783
thresh 0.5322092
          test_roc: 0.7447 test_ap: 0.7951 test_f1: 0.6808 test_recon_acc: 0.5643
difference_matrix tensor([[0.0000, 0.1159, 0.1164, 0.1161, 0.1161, 0.1164, 0.1159, 0.1160, 0.1159,
         0.1162],
        [0.1159, 0.0000, 0.1162, 0.1158, 0.1160, 0.1161, 0.1159, 0.1157, 0.1163,
         0.1160],
        [0.1164, 0.1162, 0.0000, 0.1162, 0.1168, 0.1164, 0.1161, 0.1164, 0.1167,
         0.1163],
        [0.1161, 0.1158, 0.1162, 0.0000, 0.1164, 0.1166, 0.1161, 0.1157, 0.1165,
         0.1161],
        [0.1161, 0.1160, 0.1168, 0.1164, 0.0000, 0.1161, 0.1166, 0.1163, 0.1165,
         0.1164],
        [0.1164, 0.1161, 0.1164, 0.1166, 0.1161, 0.0000, 0.1164, 0.1163, 0.1163,
         0.1163],
        [0.1159, 0.1159, 0.1161, 0.1161, 0.1166, 0.1164, 0.0000, 0.1157, 0.1166,
         0.1161],
        [0.1160, 0.1157, 0.1164, 0.1157, 0.1163, 0.1163, 0.1157, 0.0000, 0.1161,
         0.1161],
        [0.1159, 0.1163, 0.1167, 0.1165, 0.1165, 0.1163, 0.1166, 0.1161, 0.0000,
         0.1161],
        [0.1162, 0.1160, 0.1163, 0.1161, 0.1164, 0.1163, 0.1161, 0.1161, 0.1161,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0338, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.48885384
Epoch438: train_loss: 4.1029 recon_acc: 0.4821 val_roc: 0.7654 val_ap: 0.8202 f1: 0.6965 time: 0.2624
thresh 0.531924
          test_roc: 0.7449 test_ap: 0.7955 test_f1: 0.6808 test_recon_acc: 0.5638
difference_matrix tensor([[0.0000, 0.1158, 0.1163, 0.1160, 0.1160, 0.1163, 0.1159, 0.1160, 0.1159,
         0.1161],
        [0.1158, 0.0000, 0.1161, 0.1158, 0.1159, 0.1161, 0.1158, 0.1157, 0.1162,
         0.1159],
        [0.1163, 0.1161, 0.0000, 0.1162, 0.1167, 0.1163, 0.1160, 0.1163, 0.1167,
         0.1163],
        [0.1160, 0.1158, 0.1162, 0.0000, 0.1164, 0.1165, 0.1160, 0.1157, 0.1164,
         0.1161],
        [0.1160, 0.1159, 0.1167, 0.1164, 0.0000, 0.1161, 0.1165, 0.1162, 0.1164,
         0.1164],
        [0.1163, 0.1161, 0.1163, 0.1165, 0.1161, 0.0000, 0.1164, 0.1162, 0.1162,
         0.1162],
        [0.1159, 0.1158, 0.1160, 0.1160, 0.1165, 0.1164, 0.0000, 0.1156, 0.1166,
         0.1161],
        [0.1160, 0.1157, 0.1163, 0.1157, 0.1162, 0.1162, 0.1156, 0.0000, 0.1160,
         0.1161],
        [0.1159, 0.1162, 0.1167, 0.1164, 0.1164, 0.1162, 0.1166, 0.1160, 0.0000,
         0.1160],
        [0.1161, 0.1159, 0.1163, 0.1161, 0.1164, 0.1162, 0.1161, 0.1161, 0.1160,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0339, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.48843038
Epoch439: train_loss: 4.1024 recon_acc: 0.4813 val_roc: 0.7655 val_ap: 0.8203 f1: 0.6965 time: 0.2503
thresh 0.5414611
          test_roc: 0.7451 test_ap: 0.7958 test_f1: 0.6809 test_recon_acc: 0.5817
difference_matrix tensor([[0.0000, 0.1158, 0.1162, 0.1160, 0.1160, 0.1162, 0.1158, 0.1159, 0.1158,
         0.1160],
        [0.1158, 0.0000, 0.1161, 0.1157, 0.1159, 0.1160, 0.1157, 0.1156, 0.1162,
         0.1158],
        [0.1162, 0.1161, 0.0000, 0.1161, 0.1167, 0.1163, 0.1160, 0.1163, 0.1166,
         0.1162],
        [0.1160, 0.1157, 0.1161, 0.0000, 0.1163, 0.1165, 0.1159, 0.1156, 0.1164,
         0.1160],
        [0.1160, 0.1159, 0.1167, 0.1163, 0.0000, 0.1160, 0.1165, 0.1162, 0.1164,
         0.1163],
        [0.1162, 0.1160, 0.1163, 0.1165, 0.1160, 0.0000, 0.1163, 0.1162, 0.1161,
         0.1162],
        [0.1158, 0.1157, 0.1160, 0.1159, 0.1165, 0.1163, 0.0000, 0.1156, 0.1165,
         0.1160],
        [0.1159, 0.1156, 0.1163, 0.1156, 0.1162, 0.1162, 0.1156, 0.0000, 0.1160,
         0.1160],
        [0.1158, 0.1162, 0.1166, 0.1164, 0.1164, 0.1161, 0.1165, 0.1160, 0.0000,
         0.1160],
        [0.1160, 0.1158, 0.1162, 0.1160, 0.1163, 0.1162, 0.1160, 0.1160, 0.1160,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0339, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.48468426
Epoch440: train_loss: 4.1020 recon_acc: 0.4742 val_roc: 0.7655 val_ap: 0.8204 f1: 0.6977 time: 0.2618
thresh 0.54184914
          test_roc: 0.7453 test_ap: 0.7962 test_f1: 0.6809 test_recon_acc: 0.5825
difference_matrix tensor([[0.0000, 0.1157, 0.1162, 0.1159, 0.1159, 0.1162, 0.1158, 0.1158, 0.1158,
         0.1160],
        [0.1157, 0.0000, 0.1160, 0.1157, 0.1158, 0.1160, 0.1157, 0.1155, 0.1161,
         0.1158],
        [0.1162, 0.1160, 0.0000, 0.1161, 0.1166, 0.1162, 0.1159, 0.1162, 0.1166,
         0.1162],
        [0.1159, 0.1157, 0.1161, 0.0000, 0.1162, 0.1164, 0.1159, 0.1156, 0.1163,
         0.1160],
        [0.1159, 0.1158, 0.1166, 0.1162, 0.0000, 0.1160, 0.1164, 0.1161, 0.1163,
         0.1163],
        [0.1162, 0.1160, 0.1162, 0.1164, 0.1160, 0.0000, 0.1163, 0.1161, 0.1161,
         0.1161],
        [0.1158, 0.1157, 0.1159, 0.1159, 0.1164, 0.1163, 0.0000, 0.1155, 0.1164,
         0.1159],
        [0.1158, 0.1155, 0.1162, 0.1156, 0.1161, 0.1161, 0.1155, 0.0000, 0.1159,
         0.1159],
        [0.1158, 0.1161, 0.1166, 0.1163, 0.1163, 0.1161, 0.1164, 0.1159, 0.0000,
         0.1159],
        [0.1160, 0.1158, 0.1162, 0.1160, 0.1163, 0.1161, 0.1159, 0.1159, 0.1159,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0340, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.48515633
Epoch441: train_loss: 4.1016 recon_acc: 0.4751 val_roc: 0.7657 val_ap: 0.8205 f1: 0.6977 time: 0.2990
thresh 0.5432037
          test_roc: 0.7455 test_ap: 0.7966 test_f1: 0.6810 test_recon_acc: 0.5850
difference_matrix tensor([[0.0000, 0.1157, 0.1161, 0.1158, 0.1159, 0.1161, 0.1157, 0.1158, 0.1157,
         0.1159],
        [0.1157, 0.0000, 0.1160, 0.1156, 0.1157, 0.1159, 0.1156, 0.1155, 0.1160,
         0.1157],
        [0.1161, 0.1160, 0.0000, 0.1160, 0.1166, 0.1162, 0.1159, 0.1161, 0.1165,
         0.1161],
        [0.1158, 0.1156, 0.1160, 0.0000, 0.1162, 0.1164, 0.1158, 0.1155, 0.1163,
         0.1159],
        [0.1159, 0.1157, 0.1166, 0.1162, 0.0000, 0.1159, 0.1163, 0.1160, 0.1163,
         0.1162],
        [0.1161, 0.1159, 0.1162, 0.1164, 0.1159, 0.0000, 0.1162, 0.1160, 0.1160,
         0.1160],
        [0.1157, 0.1156, 0.1159, 0.1158, 0.1163, 0.1162, 0.0000, 0.1155, 0.1164,
         0.1159],
        [0.1158, 0.1155, 0.1161, 0.1155, 0.1160, 0.1160, 0.1155, 0.0000, 0.1159,
         0.1159],
        [0.1157, 0.1160, 0.1165, 0.1163, 0.1163, 0.1160, 0.1164, 0.1159, 0.0000,
         0.1159],
        [0.1159, 0.1157, 0.1161, 0.1159, 0.1162, 0.1160, 0.1159, 0.1159, 0.1159,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0340, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.48562586
Epoch442: train_loss: 4.1012 recon_acc: 0.4760 val_roc: 0.7659 val_ap: 0.8207 f1: 0.6977 time: 0.2807
thresh 0.5431786
          test_roc: 0.7457 test_ap: 0.7968 test_f1: 0.6810 test_recon_acc: 0.5850
difference_matrix tensor([[0.0000, 0.1156, 0.1161, 0.1158, 0.1158, 0.1161, 0.1156, 0.1157, 0.1157,
         0.1159],
        [0.1156, 0.0000, 0.1159, 0.1156, 0.1157, 0.1158, 0.1156, 0.1154, 0.1160,
         0.1157],
        [0.1161, 0.1159, 0.0000, 0.1159, 0.1165, 0.1161, 0.1158, 0.1161, 0.1164,
         0.1161],
        [0.1158, 0.1156, 0.1159, 0.0000, 0.1161, 0.1163, 0.1158, 0.1154, 0.1162,
         0.1158],
        [0.1158, 0.1157, 0.1165, 0.1161, 0.0000, 0.1158, 0.1163, 0.1160, 0.1162,
         0.1162],
        [0.1161, 0.1158, 0.1161, 0.1163, 0.1158, 0.0000, 0.1161, 0.1160, 0.1160,
         0.1160],
        [0.1156, 0.1156, 0.1158, 0.1158, 0.1163, 0.1161, 0.0000, 0.1154, 0.1163,
         0.1158],
        [0.1157, 0.1154, 0.1161, 0.1154, 0.1160, 0.1160, 0.1154, 0.0000, 0.1158,
         0.1158],
        [0.1157, 0.1160, 0.1164, 0.1162, 0.1162, 0.1160, 0.1163, 0.1158, 0.0000,
         0.1158],
        [0.1159, 0.1157, 0.1161, 0.1158, 0.1162, 0.1160, 0.1158, 0.1158, 0.1158,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0341, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.48609298
Epoch443: train_loss: 4.1009 recon_acc: 0.4769 val_roc: 0.7663 val_ap: 0.8211 f1: 0.6977 time: 0.2598
thresh 0.5431507
          test_roc: 0.7460 test_ap: 0.7972 test_f1: 0.6810 test_recon_acc: 0.5850
difference_matrix tensor([[0.0000, 0.1155, 0.1160, 0.1157, 0.1158, 0.1160, 0.1156, 0.1157, 0.1156,
         0.1158],
        [0.1155, 0.0000, 0.1159, 0.1155, 0.1156, 0.1158, 0.1155, 0.1154, 0.1159,
         0.1156],
        [0.1160, 0.1159, 0.0000, 0.1159, 0.1164, 0.1160, 0.1157, 0.1160, 0.1164,
         0.1160],
        [0.1157, 0.1155, 0.1159, 0.0000, 0.1161, 0.1163, 0.1157, 0.1154, 0.1161,
         0.1158],
        [0.1158, 0.1156, 0.1164, 0.1161, 0.0000, 0.1158, 0.1162, 0.1159, 0.1162,
         0.1161],
        [0.1160, 0.1158, 0.1160, 0.1163, 0.1158, 0.0000, 0.1161, 0.1159, 0.1159,
         0.1159],
        [0.1156, 0.1155, 0.1157, 0.1157, 0.1162, 0.1161, 0.0000, 0.1153, 0.1163,
         0.1158],
        [0.1157, 0.1154, 0.1160, 0.1154, 0.1159, 0.1159, 0.1153, 0.0000, 0.1158,
         0.1158],
        [0.1156, 0.1159, 0.1164, 0.1161, 0.1162, 0.1159, 0.1163, 0.1158, 0.0000,
         0.1157],
        [0.1158, 0.1156, 0.1160, 0.1158, 0.1161, 0.1159, 0.1158, 0.1158, 0.1157,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0341, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.4864221
Epoch444: train_loss: 4.1005 recon_acc: 0.4775 val_roc: 0.7666 val_ap: 0.8213 f1: 0.6990 time: 0.2676
thresh 0.49235427
          test_roc: 0.7463 test_ap: 0.7975 test_f1: 0.6811 test_recon_acc: 0.4888
difference_matrix tensor([[0.0000, 0.1155, 0.1159, 0.1157, 0.1157, 0.1160, 0.1155, 0.1156, 0.1155,
         0.1158],
        [0.1155, 0.0000, 0.1158, 0.1154, 0.1156, 0.1157, 0.1155, 0.1153, 0.1159,
         0.1156],
        [0.1159, 0.1158, 0.0000, 0.1158, 0.1164, 0.1160, 0.1157, 0.1160, 0.1163,
         0.1159],
        [0.1157, 0.1154, 0.1158, 0.0000, 0.1160, 0.1162, 0.1157, 0.1153, 0.1161,
         0.1157],
        [0.1157, 0.1156, 0.1164, 0.1160, 0.0000, 0.1157, 0.1162, 0.1159, 0.1161,
         0.1160],
        [0.1160, 0.1157, 0.1160, 0.1162, 0.1157, 0.0000, 0.1160, 0.1159, 0.1159,
         0.1159],
        [0.1155, 0.1155, 0.1157, 0.1156, 0.1162, 0.1160, 0.0000, 0.1153, 0.1162,
         0.1157],
        [0.1156, 0.1153, 0.1160, 0.1153, 0.1159, 0.1159, 0.1153, 0.0000, 0.1157,
         0.1157],
        [0.1155, 0.1159, 0.1163, 0.1161, 0.1161, 0.1159, 0.1162, 0.1157, 0.0000,
         0.1157],
        [0.1158, 0.1156, 0.1159, 0.1157, 0.1160, 0.1159, 0.1157, 0.1157, 0.1157,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0342, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.4860424
Epoch445: train_loss: 4.1001 recon_acc: 0.4768 val_roc: 0.7669 val_ap: 0.8216 f1: 0.6990 time: 0.2859
thresh 0.49264503
          test_roc: 0.7465 test_ap: 0.7978 test_f1: 0.6817 test_recon_acc: 0.4893
difference_matrix tensor([[0.0000, 0.1154, 0.1159, 0.1156, 0.1157, 0.1159, 0.1155, 0.1156, 0.1155,
         0.1157],
        [0.1154, 0.0000, 0.1158, 0.1154, 0.1155, 0.1157, 0.1154, 0.1153, 0.1158,
         0.1155],
        [0.1159, 0.1158, 0.0000, 0.1158, 0.1163, 0.1159, 0.1156, 0.1159, 0.1163,
         0.1159],
        [0.1156, 0.1154, 0.1158, 0.0000, 0.1160, 0.1161, 0.1156, 0.1153, 0.1160,
         0.1157],
        [0.1157, 0.1155, 0.1163, 0.1160, 0.0000, 0.1157, 0.1161, 0.1158, 0.1160,
         0.1160],
        [0.1159, 0.1157, 0.1159, 0.1161, 0.1157, 0.0000, 0.1160, 0.1158, 0.1158,
         0.1158],
        [0.1155, 0.1154, 0.1156, 0.1156, 0.1161, 0.1160, 0.0000, 0.1152, 0.1161,
         0.1157],
        [0.1156, 0.1153, 0.1159, 0.1153, 0.1158, 0.1158, 0.1152, 0.0000, 0.1157,
         0.1157],
        [0.1155, 0.1158, 0.1163, 0.1160, 0.1160, 0.1158, 0.1161, 0.1157, 0.0000,
         0.1156],
        [0.1157, 0.1155, 0.1159, 0.1157, 0.1160, 0.1158, 0.1157, 0.1157, 0.1156,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0343, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.48566973
Epoch446: train_loss: 4.0997 recon_acc: 0.4761 val_roc: 0.7672 val_ap: 0.8220 f1: 0.6977 time: 0.2955
thresh 0.49227324
          test_roc: 0.7467 test_ap: 0.7981 test_f1: 0.6823 test_recon_acc: 0.4886
difference_matrix tensor([[0.0000, 0.1154, 0.1158, 0.1156, 0.1156, 0.1159, 0.1154, 0.1155, 0.1154,
         0.1157],
        [0.1154, 0.0000, 0.1157, 0.1153, 0.1155, 0.1156, 0.1153, 0.1152, 0.1158,
         0.1155],
        [0.1158, 0.1157, 0.0000, 0.1157, 0.1163, 0.1159, 0.1156, 0.1159, 0.1162,
         0.1158],
        [0.1156, 0.1153, 0.1157, 0.0000, 0.1159, 0.1161, 0.1155, 0.1152, 0.1160,
         0.1156],
        [0.1156, 0.1155, 0.1163, 0.1159, 0.0000, 0.1156, 0.1161, 0.1158, 0.1160,
         0.1159],
        [0.1159, 0.1156, 0.1159, 0.1161, 0.1156, 0.0000, 0.1159, 0.1158, 0.1158,
         0.1158],
        [0.1154, 0.1153, 0.1156, 0.1155, 0.1161, 0.1159, 0.0000, 0.1152, 0.1161,
         0.1156],
        [0.1155, 0.1152, 0.1159, 0.1152, 0.1158, 0.1158, 0.1152, 0.0000, 0.1156,
         0.1156],
        [0.1154, 0.1158, 0.1162, 0.1160, 0.1160, 0.1158, 0.1161, 0.1156, 0.0000,
         0.1156],
        [0.1157, 0.1155, 0.1158, 0.1156, 0.1159, 0.1158, 0.1156, 0.1156, 0.1156,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0343, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.48530447
Epoch447: train_loss: 4.0993 recon_acc: 0.4754 val_roc: 0.7675 val_ap: 0.8223 f1: 0.6977 time: 0.2868
thresh 0.49306798
          test_roc: 0.7469 test_ap: 0.7984 test_f1: 0.6836 test_recon_acc: 0.4902
difference_matrix tensor([[0.0000, 0.1153, 0.1158, 0.1155, 0.1155, 0.1158, 0.1154, 0.1155, 0.1154,
         0.1156],
        [0.1153, 0.0000, 0.1156, 0.1153, 0.1154, 0.1156, 0.1153, 0.1151, 0.1157,
         0.1154],
        [0.1158, 0.1156, 0.0000, 0.1157, 0.1162, 0.1158, 0.1155, 0.1158, 0.1162,
         0.1158],
        [0.1155, 0.1153, 0.1157, 0.0000, 0.1158, 0.1160, 0.1155, 0.1152, 0.1159,
         0.1156],
        [0.1155, 0.1154, 0.1162, 0.1158, 0.0000, 0.1156, 0.1160, 0.1157, 0.1159,
         0.1159],
        [0.1158, 0.1156, 0.1158, 0.1160, 0.1156, 0.0000, 0.1159, 0.1157, 0.1157,
         0.1157],
        [0.1154, 0.1153, 0.1155, 0.1155, 0.1160, 0.1159, 0.0000, 0.1151, 0.1160,
         0.1155],
        [0.1155, 0.1151, 0.1158, 0.1152, 0.1157, 0.1157, 0.1151, 0.0000, 0.1155,
         0.1155],
        [0.1154, 0.1157, 0.1162, 0.1159, 0.1159, 0.1157, 0.1160, 0.1155, 0.0000,
         0.1155],
        [0.1156, 0.1154, 0.1158, 0.1156, 0.1159, 0.1157, 0.1155, 0.1155, 0.1155,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0344, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.62830704
Epoch448: train_loss: 4.0989 recon_acc: 0.7378 val_roc: 0.7464 val_ap: 0.8157 f1: 0.7040 time: 0.2780
difference_matrix tensor([[0.0000, 0.1153, 0.1157, 0.1154, 0.1155, 0.1158, 0.1153, 0.1154, 0.1153,
         0.1155],
        [0.1153, 0.0000, 0.1156, 0.1152, 0.1153, 0.1155, 0.1152, 0.1151, 0.1157,
         0.1153],
        [0.1157, 0.1156, 0.0000, 0.1156, 0.1162, 0.1158, 0.1155, 0.1158, 0.1161,
         0.1157],
        [0.1154, 0.1152, 0.1156, 0.0000, 0.1158, 0.1160, 0.1154, 0.1151, 0.1159,
         0.1155],
        [0.1155, 0.1153, 0.1162, 0.1158, 0.0000, 0.1155, 0.1160, 0.1156, 0.1159,
         0.1158],
        [0.1158, 0.1155, 0.1158, 0.1160, 0.1155, 0.0000, 0.1158, 0.1157, 0.1156,
         0.1157],
        [0.1153, 0.1152, 0.1155, 0.1154, 0.1160, 0.1158, 0.0000, 0.1151, 0.1160,
         0.1155],
        [0.1154, 0.1151, 0.1158, 0.1151, 0.1156, 0.1157, 0.1151, 0.0000, 0.1155,
         0.1155],
        [0.1153, 0.1157, 0.1161, 0.1159, 0.1159, 0.1156, 0.1160, 0.1155, 0.0000,
         0.1155],
        [0.1155, 0.1153, 0.1157, 0.1155, 0.1158, 0.1157, 0.1155, 0.1155, 0.1155,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0344, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6286495
Epoch449: train_loss: 4.0986 recon_acc: 0.7385 val_roc: 0.7465 val_ap: 0.8157 f1: 0.7040 time: 0.2946
difference_matrix tensor([[0.0000, 0.1152, 0.1157, 0.1154, 0.1154, 0.1157, 0.1153, 0.1153, 0.1153,
         0.1155],
        [0.1152, 0.0000, 0.1155, 0.1152, 0.1153, 0.1155, 0.1152, 0.1150, 0.1156,
         0.1153],
        [0.1157, 0.1155, 0.0000, 0.1156, 0.1161, 0.1157, 0.1154, 0.1157, 0.1161,
         0.1157],
        [0.1154, 0.1152, 0.1156, 0.0000, 0.1157, 0.1159, 0.1154, 0.1151, 0.1158,
         0.1155],
        [0.1154, 0.1153, 0.1161, 0.1157, 0.0000, 0.1154, 0.1159, 0.1156, 0.1158,
         0.1158],
        [0.1157, 0.1155, 0.1157, 0.1159, 0.1154, 0.0000, 0.1158, 0.1156, 0.1156,
         0.1156],
        [0.1152, 0.1152, 0.1154, 0.1154, 0.1159, 0.1158, 0.0000, 0.1150, 0.1159,
         0.1154],
        [0.1153, 0.1150, 0.1157, 0.1151, 0.1156, 0.1156, 0.1150, 0.0000, 0.1154,
         0.1154],
        [0.1153, 0.1156, 0.1161, 0.1158, 0.1158, 0.1156, 0.1159, 0.1154, 0.0000,
         0.1154],
        [0.1155, 0.1153, 0.1157, 0.1155, 0.1158, 0.1156, 0.1154, 0.1154, 0.1154,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0345, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6289892
Epoch450: train_loss: 4.0982 recon_acc: 0.7391 val_roc: 0.7466 val_ap: 0.8157 f1: 0.7040 time: 0.2734
difference_matrix tensor([[0.0000, 0.1152, 0.1156, 0.1153, 0.1154, 0.1156, 0.1152, 0.1153, 0.1152,
         0.1154],
        [0.1152, 0.0000, 0.1155, 0.1151, 0.1152, 0.1154, 0.1151, 0.1150, 0.1155,
         0.1152],
        [0.1156, 0.1155, 0.0000, 0.1155, 0.1160, 0.1156, 0.1154, 0.1157, 0.1160,
         0.1156],
        [0.1153, 0.1151, 0.1155, 0.0000, 0.1157, 0.1159, 0.1153, 0.1150, 0.1158,
         0.1154],
        [0.1154, 0.1152, 0.1160, 0.1157, 0.0000, 0.1154, 0.1158, 0.1155, 0.1158,
         0.1157],
        [0.1156, 0.1154, 0.1156, 0.1159, 0.1154, 0.0000, 0.1157, 0.1155, 0.1155,
         0.1156],
        [0.1152, 0.1151, 0.1154, 0.1153, 0.1158, 0.1157, 0.0000, 0.1149, 0.1159,
         0.1154],
        [0.1153, 0.1150, 0.1157, 0.1150, 0.1155, 0.1155, 0.1149, 0.0000, 0.1154,
         0.1154],
        [0.1152, 0.1155, 0.1160, 0.1158, 0.1158, 0.1155, 0.1159, 0.1154, 0.0000,
         0.1154],
        [0.1154, 0.1152, 0.1156, 0.1154, 0.1157, 0.1156, 0.1154, 0.1154, 0.1154,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0345, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6293262
Epoch451: train_loss: 4.0978 recon_acc: 0.7397 val_roc: 0.7467 val_ap: 0.8159 f1: 0.7040 time: 0.2516
difference_matrix tensor([[0.0000, 0.1151, 0.1156, 0.1153, 0.1153, 0.1156, 0.1151, 0.1152, 0.1152,
         0.1154],
        [0.1151, 0.0000, 0.1154, 0.1151, 0.1152, 0.1154, 0.1151, 0.1149, 0.1155,
         0.1152],
        [0.1156, 0.1154, 0.0000, 0.1155, 0.1160, 0.1156, 0.1153, 0.1156, 0.1160,
         0.1156],
        [0.1153, 0.1151, 0.1155, 0.0000, 0.1156, 0.1158, 0.1153, 0.1149, 0.1157,
         0.1154],
        [0.1153, 0.1152, 0.1160, 0.1156, 0.0000, 0.1153, 0.1158, 0.1155, 0.1157,
         0.1157],
        [0.1156, 0.1154, 0.1156, 0.1158, 0.1153, 0.0000, 0.1157, 0.1155, 0.1155,
         0.1155],
        [0.1151, 0.1151, 0.1153, 0.1153, 0.1158, 0.1157, 0.0000, 0.1149, 0.1158,
         0.1153],
        [0.1152, 0.1149, 0.1156, 0.1149, 0.1155, 0.1155, 0.1149, 0.0000, 0.1153,
         0.1153],
        [0.1152, 0.1155, 0.1160, 0.1157, 0.1157, 0.1155, 0.1158, 0.1153, 0.0000,
         0.1153],
        [0.1154, 0.1152, 0.1156, 0.1154, 0.1157, 0.1155, 0.1153, 0.1153, 0.1153,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0346, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6296605
Epoch452: train_loss: 4.0975 recon_acc: 0.7403 val_roc: 0.7469 val_ap: 0.8161 f1: 0.7040 time: 0.2520
difference_matrix tensor([[0.0000, 0.1151, 0.1155, 0.1152, 0.1153, 0.1155, 0.1151, 0.1152, 0.1151,
         0.1153],
        [0.1151, 0.0000, 0.1154, 0.1150, 0.1151, 0.1153, 0.1150, 0.1149, 0.1154,
         0.1151],
        [0.1155, 0.1154, 0.0000, 0.1154, 0.1159, 0.1155, 0.1152, 0.1155, 0.1159,
         0.1155],
        [0.1152, 0.1150, 0.1154, 0.0000, 0.1156, 0.1158, 0.1152, 0.1149, 0.1157,
         0.1153],
        [0.1153, 0.1151, 0.1159, 0.1156, 0.0000, 0.1153, 0.1157, 0.1154, 0.1157,
         0.1156],
        [0.1155, 0.1153, 0.1155, 0.1158, 0.1153, 0.0000, 0.1156, 0.1154, 0.1154,
         0.1154],
        [0.1151, 0.1150, 0.1152, 0.1152, 0.1157, 0.1156, 0.0000, 0.1148, 0.1158,
         0.1153],
        [0.1152, 0.1149, 0.1155, 0.1149, 0.1154, 0.1154, 0.1148, 0.0000, 0.1153,
         0.1153],
        [0.1151, 0.1154, 0.1159, 0.1157, 0.1157, 0.1154, 0.1158, 0.1153, 0.0000,
         0.1153],
        [0.1153, 0.1151, 0.1155, 0.1153, 0.1156, 0.1154, 0.1153, 0.1153, 0.1153,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0346, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6299922
Epoch453: train_loss: 4.0971 recon_acc: 0.7409 val_roc: 0.7470 val_ap: 0.8163 f1: 0.7040 time: 0.2632
difference_matrix tensor([[0.0000, 0.1150, 0.1155, 0.1152, 0.1152, 0.1155, 0.1150, 0.1151, 0.1151,
         0.1153],
        [0.1150, 0.0000, 0.1153, 0.1150, 0.1151, 0.1153, 0.1150, 0.1148, 0.1154,
         0.1151],
        [0.1155, 0.1153, 0.0000, 0.1154, 0.1159, 0.1155, 0.1152, 0.1155, 0.1159,
         0.1155],
        [0.1152, 0.1150, 0.1154, 0.0000, 0.1155, 0.1157, 0.1152, 0.1148, 0.1156,
         0.1152],
        [0.1152, 0.1151, 0.1159, 0.1155, 0.0000, 0.1152, 0.1157, 0.1154, 0.1156,
         0.1156],
        [0.1155, 0.1153, 0.1155, 0.1157, 0.1152, 0.0000, 0.1156, 0.1154, 0.1154,
         0.1154],
        [0.1150, 0.1150, 0.1152, 0.1152, 0.1157, 0.1156, 0.0000, 0.1148, 0.1157,
         0.1152],
        [0.1151, 0.1148, 0.1155, 0.1148, 0.1154, 0.1154, 0.1148, 0.0000, 0.1152,
         0.1152],
        [0.1151, 0.1154, 0.1159, 0.1156, 0.1156, 0.1154, 0.1157, 0.1152, 0.0000,
         0.1152],
        [0.1153, 0.1151, 0.1155, 0.1152, 0.1156, 0.1154, 0.1152, 0.1152, 0.1152,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0347, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6301213
Epoch454: train_loss: 4.0968 recon_acc: 0.7412 val_roc: 0.7473 val_ap: 0.8166 f1: 0.7040 time: 0.2616
difference_matrix tensor([[0.0000, 0.1150, 0.1154, 0.1151, 0.1152, 0.1154, 0.1150, 0.1151, 0.1150,
         0.1152],
        [0.1150, 0.0000, 0.1153, 0.1149, 0.1150, 0.1152, 0.1149, 0.1148, 0.1153,
         0.1150],
        [0.1154, 0.1153, 0.0000, 0.1153, 0.1158, 0.1154, 0.1151, 0.1154, 0.1158,
         0.1154],
        [0.1151, 0.1149, 0.1153, 0.0000, 0.1155, 0.1157, 0.1151, 0.1148, 0.1156,
         0.1152],
        [0.1152, 0.1150, 0.1158, 0.1155, 0.0000, 0.1152, 0.1156, 0.1153, 0.1156,
         0.1155],
        [0.1154, 0.1152, 0.1154, 0.1157, 0.1152, 0.0000, 0.1155, 0.1153, 0.1153,
         0.1153],
        [0.1150, 0.1149, 0.1151, 0.1151, 0.1156, 0.1155, 0.0000, 0.1147, 0.1157,
         0.1152],
        [0.1151, 0.1148, 0.1154, 0.1148, 0.1153, 0.1153, 0.1147, 0.0000, 0.1152,
         0.1152],
        [0.1150, 0.1153, 0.1158, 0.1156, 0.1156, 0.1153, 0.1157, 0.1152, 0.0000,
         0.1152],
        [0.1152, 0.1150, 0.1154, 0.1152, 0.1155, 0.1153, 0.1152, 0.1152, 0.1152,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0347, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6296103
Epoch455: train_loss: 4.0964 recon_acc: 0.7405 val_roc: 0.7476 val_ap: 0.8168 f1: 0.7040 time: 0.2907
difference_matrix tensor([[0.0000, 0.1149, 0.1154, 0.1151, 0.1151, 0.1154, 0.1149, 0.1150, 0.1150,
         0.1152],
        [0.1149, 0.0000, 0.1152, 0.1149, 0.1150, 0.1152, 0.1149, 0.1147, 0.1153,
         0.1150],
        [0.1154, 0.1152, 0.0000, 0.1153, 0.1158, 0.1154, 0.1151, 0.1154, 0.1158,
         0.1154],
        [0.1151, 0.1149, 0.1153, 0.0000, 0.1154, 0.1156, 0.1151, 0.1147, 0.1155,
         0.1151],
        [0.1151, 0.1150, 0.1158, 0.1154, 0.0000, 0.1151, 0.1156, 0.1153, 0.1155,
         0.1155],
        [0.1154, 0.1152, 0.1154, 0.1156, 0.1151, 0.0000, 0.1155, 0.1153, 0.1153,
         0.1153],
        [0.1149, 0.1149, 0.1151, 0.1151, 0.1156, 0.1155, 0.0000, 0.1147, 0.1156,
         0.1151],
        [0.1150, 0.1147, 0.1154, 0.1147, 0.1153, 0.1153, 0.1147, 0.0000, 0.1151,
         0.1151],
        [0.1150, 0.1153, 0.1158, 0.1155, 0.1155, 0.1153, 0.1156, 0.1151, 0.0000,
         0.1151],
        [0.1152, 0.1150, 0.1154, 0.1151, 0.1155, 0.1153, 0.1151, 0.1151, 0.1151,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0348, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.62875164
Epoch456: train_loss: 4.0961 recon_acc: 0.7391 val_roc: 0.7479 val_ap: 0.8171 f1: 0.7040 time: 0.2920
difference_matrix tensor([[0.0000, 0.1149, 0.1153, 0.1150, 0.1151, 0.1153, 0.1149, 0.1150, 0.1149,
         0.1151],
        [0.1149, 0.0000, 0.1152, 0.1148, 0.1149, 0.1151, 0.1148, 0.1147, 0.1152,
         0.1149],
        [0.1153, 0.1152, 0.0000, 0.1152, 0.1157, 0.1153, 0.1150, 0.1153, 0.1157,
         0.1153],
        [0.1150, 0.1148, 0.1152, 0.0000, 0.1154, 0.1156, 0.1150, 0.1147, 0.1155,
         0.1151],
        [0.1151, 0.1149, 0.1157, 0.1154, 0.0000, 0.1151, 0.1155, 0.1152, 0.1155,
         0.1154],
        [0.1153, 0.1151, 0.1153, 0.1156, 0.1151, 0.0000, 0.1154, 0.1152, 0.1152,
         0.1152],
        [0.1149, 0.1148, 0.1150, 0.1150, 0.1155, 0.1154, 0.0000, 0.1146, 0.1156,
         0.1151],
        [0.1150, 0.1147, 0.1153, 0.1147, 0.1152, 0.1152, 0.1146, 0.0000, 0.1151,
         0.1151],
        [0.1149, 0.1152, 0.1157, 0.1155, 0.1155, 0.1152, 0.1156, 0.1151, 0.0000,
         0.1151],
        [0.1151, 0.1149, 0.1153, 0.1151, 0.1154, 0.1152, 0.1151, 0.1151, 0.1151,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0348, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.62789106
Epoch457: train_loss: 4.0957 recon_acc: 0.7377 val_roc: 0.7481 val_ap: 0.8172 f1: 0.7040 time: 0.3184
difference_matrix tensor([[0.0000, 0.1148, 0.1153, 0.1150, 0.1150, 0.1153, 0.1148, 0.1149, 0.1149,
         0.1151],
        [0.1148, 0.0000, 0.1151, 0.1148, 0.1149, 0.1151, 0.1147, 0.1146, 0.1152,
         0.1149],
        [0.1153, 0.1151, 0.0000, 0.1152, 0.1157, 0.1153, 0.1150, 0.1153, 0.1157,
         0.1153],
        [0.1150, 0.1148, 0.1152, 0.0000, 0.1153, 0.1155, 0.1150, 0.1146, 0.1154,
         0.1150],
        [0.1150, 0.1149, 0.1157, 0.1153, 0.0000, 0.1150, 0.1155, 0.1152, 0.1154,
         0.1154],
        [0.1153, 0.1151, 0.1153, 0.1155, 0.1150, 0.0000, 0.1154, 0.1152, 0.1152,
         0.1152],
        [0.1148, 0.1147, 0.1150, 0.1150, 0.1155, 0.1154, 0.0000, 0.1146, 0.1155,
         0.1150],
        [0.1149, 0.1146, 0.1153, 0.1146, 0.1152, 0.1152, 0.1146, 0.0000, 0.1150,
         0.1150],
        [0.1149, 0.1152, 0.1157, 0.1154, 0.1154, 0.1152, 0.1155, 0.1150, 0.0000,
         0.1150],
        [0.1151, 0.1149, 0.1153, 0.1150, 0.1154, 0.1152, 0.1150, 0.1150, 0.1150,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0349, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6270285
Epoch458: train_loss: 4.0954 recon_acc: 0.7363 val_roc: 0.7482 val_ap: 0.8173 f1: 0.7040 time: 0.2779
difference_matrix tensor([[0.0000, 0.1148, 0.1152, 0.1149, 0.1150, 0.1152, 0.1148, 0.1149, 0.1148,
         0.1150],
        [0.1148, 0.0000, 0.1151, 0.1147, 0.1148, 0.1150, 0.1147, 0.1146, 0.1151,
         0.1148],
        [0.1152, 0.1151, 0.0000, 0.1151, 0.1156, 0.1152, 0.1149, 0.1152, 0.1156,
         0.1152],
        [0.1149, 0.1147, 0.1151, 0.0000, 0.1153, 0.1155, 0.1149, 0.1146, 0.1154,
         0.1150],
        [0.1150, 0.1148, 0.1156, 0.1153, 0.0000, 0.1150, 0.1154, 0.1151, 0.1154,
         0.1153],
        [0.1152, 0.1150, 0.1152, 0.1155, 0.1150, 0.0000, 0.1153, 0.1151, 0.1151,
         0.1151],
        [0.1148, 0.1147, 0.1149, 0.1149, 0.1154, 0.1153, 0.0000, 0.1145, 0.1155,
         0.1150],
        [0.1149, 0.1146, 0.1152, 0.1146, 0.1151, 0.1151, 0.1145, 0.0000, 0.1150,
         0.1150],
        [0.1148, 0.1151, 0.1156, 0.1154, 0.1154, 0.1151, 0.1155, 0.1150, 0.0000,
         0.1150],
        [0.1150, 0.1148, 0.1152, 0.1150, 0.1153, 0.1151, 0.1150, 0.1150, 0.1150,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0349, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.626164
Epoch459: train_loss: 4.0950 recon_acc: 0.7349 val_roc: 0.7485 val_ap: 0.8175 f1: 0.7040 time: 0.2599
difference_matrix tensor([[0.0000, 0.1147, 0.1152, 0.1149, 0.1149, 0.1152, 0.1147, 0.1148, 0.1148,
         0.1150],
        [0.1147, 0.0000, 0.1150, 0.1147, 0.1148, 0.1150, 0.1146, 0.1145, 0.1151,
         0.1148],
        [0.1152, 0.1150, 0.0000, 0.1151, 0.1156, 0.1152, 0.1149, 0.1152, 0.1156,
         0.1152],
        [0.1149, 0.1147, 0.1151, 0.0000, 0.1152, 0.1154, 0.1149, 0.1145, 0.1153,
         0.1149],
        [0.1149, 0.1148, 0.1156, 0.1152, 0.0000, 0.1149, 0.1154, 0.1151, 0.1153,
         0.1153],
        [0.1152, 0.1150, 0.1152, 0.1154, 0.1149, 0.0000, 0.1153, 0.1151, 0.1151,
         0.1151],
        [0.1147, 0.1146, 0.1149, 0.1149, 0.1154, 0.1153, 0.0000, 0.1145, 0.1154,
         0.1149],
        [0.1148, 0.1145, 0.1152, 0.1145, 0.1151, 0.1151, 0.1145, 0.0000, 0.1149,
         0.1149],
        [0.1148, 0.1151, 0.1156, 0.1153, 0.1153, 0.1151, 0.1154, 0.1149, 0.0000,
         0.1149],
        [0.1150, 0.1148, 0.1152, 0.1149, 0.1153, 0.1151, 0.1149, 0.1149, 0.1149,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0350, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.62529767
Epoch460: train_loss: 4.0947 recon_acc: 0.7335 val_roc: 0.7486 val_ap: 0.8176 f1: 0.7023 time: 0.2604
difference_matrix tensor([[0.0000, 0.1147, 0.1151, 0.1148, 0.1149, 0.1151, 0.1147, 0.1148, 0.1147,
         0.1149],
        [0.1147, 0.0000, 0.1150, 0.1146, 0.1147, 0.1149, 0.1146, 0.1145, 0.1150,
         0.1147],
        [0.1151, 0.1150, 0.0000, 0.1150, 0.1155, 0.1151, 0.1148, 0.1151, 0.1155,
         0.1151],
        [0.1148, 0.1146, 0.1150, 0.0000, 0.1152, 0.1154, 0.1148, 0.1145, 0.1153,
         0.1149],
        [0.1149, 0.1147, 0.1155, 0.1152, 0.0000, 0.1149, 0.1153, 0.1150, 0.1153,
         0.1152],
        [0.1151, 0.1149, 0.1151, 0.1154, 0.1149, 0.0000, 0.1152, 0.1150, 0.1150,
         0.1150],
        [0.1147, 0.1146, 0.1148, 0.1148, 0.1153, 0.1152, 0.0000, 0.1144, 0.1154,
         0.1149],
        [0.1148, 0.1145, 0.1151, 0.1145, 0.1150, 0.1150, 0.1144, 0.0000, 0.1149,
         0.1149],
        [0.1147, 0.1150, 0.1155, 0.1153, 0.1153, 0.1150, 0.1154, 0.1149, 0.0000,
         0.1149],
        [0.1149, 0.1147, 0.1151, 0.1149, 0.1152, 0.1150, 0.1149, 0.1149, 0.1149,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0350, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6294326
Epoch461: train_loss: 4.0943 recon_acc: 0.7405 val_roc: 0.7488 val_ap: 0.8178 f1: 0.7009 time: 0.2801
difference_matrix tensor([[0.0000, 0.1146, 0.1151, 0.1148, 0.1148, 0.1151, 0.1146, 0.1147, 0.1147,
         0.1149],
        [0.1146, 0.0000, 0.1149, 0.1146, 0.1147, 0.1149, 0.1145, 0.1144, 0.1150,
         0.1147],
        [0.1151, 0.1149, 0.0000, 0.1150, 0.1155, 0.1151, 0.1148, 0.1151, 0.1155,
         0.1151],
        [0.1148, 0.1146, 0.1150, 0.0000, 0.1151, 0.1153, 0.1148, 0.1144, 0.1152,
         0.1148],
        [0.1148, 0.1147, 0.1155, 0.1151, 0.0000, 0.1148, 0.1153, 0.1150, 0.1152,
         0.1152],
        [0.1151, 0.1149, 0.1151, 0.1153, 0.1148, 0.0000, 0.1152, 0.1150, 0.1150,
         0.1150],
        [0.1146, 0.1145, 0.1148, 0.1148, 0.1153, 0.1152, 0.0000, 0.1144, 0.1153,
         0.1148],
        [0.1147, 0.1144, 0.1151, 0.1144, 0.1150, 0.1150, 0.1144, 0.0000, 0.1148,
         0.1148],
        [0.1147, 0.1150, 0.1155, 0.1152, 0.1152, 0.1150, 0.1153, 0.1148, 0.0000,
         0.1148],
        [0.1149, 0.1147, 0.1151, 0.1148, 0.1152, 0.1150, 0.1148, 0.1148, 0.1148,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0351, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6293364
Epoch462: train_loss: 4.0940 recon_acc: 0.7404 val_roc: 0.7489 val_ap: 0.8179 f1: 0.7009 time: 0.2718
difference_matrix tensor([[0.0000, 0.1146, 0.1150, 0.1147, 0.1148, 0.1151, 0.1146, 0.1147, 0.1146,
         0.1149],
        [0.1146, 0.0000, 0.1149, 0.1145, 0.1146, 0.1148, 0.1145, 0.1144, 0.1149,
         0.1146],
        [0.1150, 0.1149, 0.0000, 0.1149, 0.1154, 0.1150, 0.1147, 0.1151, 0.1154,
         0.1150],
        [0.1147, 0.1145, 0.1149, 0.0000, 0.1151, 0.1153, 0.1147, 0.1144, 0.1152,
         0.1148],
        [0.1148, 0.1146, 0.1154, 0.1151, 0.0000, 0.1148, 0.1152, 0.1149, 0.1152,
         0.1151],
        [0.1151, 0.1148, 0.1150, 0.1153, 0.1148, 0.0000, 0.1151, 0.1149, 0.1149,
         0.1149],
        [0.1146, 0.1145, 0.1147, 0.1147, 0.1152, 0.1151, 0.0000, 0.1143, 0.1153,
         0.1148],
        [0.1147, 0.1144, 0.1151, 0.1144, 0.1149, 0.1149, 0.1143, 0.0000, 0.1148,
         0.1148],
        [0.1146, 0.1149, 0.1154, 0.1152, 0.1152, 0.1149, 0.1153, 0.1148, 0.0000,
         0.1148],
        [0.1149, 0.1146, 0.1150, 0.1148, 0.1151, 0.1149, 0.1148, 0.1148, 0.1148,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0351, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.62924075
Epoch463: train_loss: 4.0937 recon_acc: 0.7403 val_roc: 0.7489 val_ap: 0.8180 f1: 0.7009 time: 0.2572
difference_matrix tensor([[0.0000, 0.1145, 0.1150, 0.1147, 0.1147, 0.1150, 0.1145, 0.1146, 0.1146,
         0.1148],
        [0.1145, 0.0000, 0.1149, 0.1145, 0.1146, 0.1148, 0.1144, 0.1143, 0.1149,
         0.1146],
        [0.1150, 0.1149, 0.0000, 0.1149, 0.1154, 0.1150, 0.1147, 0.1150, 0.1154,
         0.1150],
        [0.1147, 0.1145, 0.1149, 0.0000, 0.1150, 0.1152, 0.1147, 0.1143, 0.1151,
         0.1148],
        [0.1147, 0.1146, 0.1154, 0.1150, 0.0000, 0.1147, 0.1152, 0.1149, 0.1151,
         0.1151],
        [0.1150, 0.1148, 0.1150, 0.1152, 0.1147, 0.0000, 0.1151, 0.1149, 0.1149,
         0.1149],
        [0.1145, 0.1144, 0.1147, 0.1147, 0.1152, 0.1151, 0.0000, 0.1143, 0.1152,
         0.1147],
        [0.1146, 0.1143, 0.1150, 0.1143, 0.1149, 0.1149, 0.1143, 0.0000, 0.1147,
         0.1147],
        [0.1146, 0.1149, 0.1154, 0.1151, 0.1151, 0.1149, 0.1152, 0.1147, 0.0000,
         0.1147],
        [0.1148, 0.1146, 0.1150, 0.1148, 0.1151, 0.1149, 0.1147, 0.1147, 0.1147,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0352, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.62914574
Epoch464: train_loss: 4.0934 recon_acc: 0.7402 val_roc: 0.7492 val_ap: 0.8182 f1: 0.7009 time: 0.2883
difference_matrix tensor([[0.0000, 0.1145, 0.1149, 0.1146, 0.1147, 0.1150, 0.1145, 0.1146, 0.1145,
         0.1148],
        [0.1145, 0.0000, 0.1148, 0.1144, 0.1145, 0.1147, 0.1144, 0.1143, 0.1149,
         0.1145],
        [0.1149, 0.1148, 0.0000, 0.1148, 0.1153, 0.1149, 0.1146, 0.1150, 0.1153,
         0.1149],
        [0.1146, 0.1144, 0.1148, 0.0000, 0.1150, 0.1152, 0.1146, 0.1143, 0.1151,
         0.1147],
        [0.1147, 0.1145, 0.1153, 0.1150, 0.0000, 0.1147, 0.1151, 0.1148, 0.1151,
         0.1150],
        [0.1150, 0.1147, 0.1149, 0.1152, 0.1147, 0.0000, 0.1150, 0.1148, 0.1148,
         0.1148],
        [0.1145, 0.1144, 0.1146, 0.1146, 0.1151, 0.1150, 0.0000, 0.1142, 0.1152,
         0.1147],
        [0.1146, 0.1143, 0.1150, 0.1143, 0.1148, 0.1148, 0.1142, 0.0000, 0.1147,
         0.1147],
        [0.1145, 0.1149, 0.1153, 0.1151, 0.1151, 0.1148, 0.1152, 0.1147, 0.0000,
         0.1147],
        [0.1148, 0.1145, 0.1149, 0.1147, 0.1150, 0.1148, 0.1147, 0.1147, 0.1147,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0352, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6290513
Epoch465: train_loss: 4.0930 recon_acc: 0.7401 val_roc: 0.7492 val_ap: 0.8183 f1: 0.7009 time: 0.2793
difference_matrix tensor([[0.0000, 0.1144, 0.1149, 0.1146, 0.1146, 0.1149, 0.1144, 0.1146, 0.1145,
         0.1147],
        [0.1144, 0.0000, 0.1148, 0.1144, 0.1145, 0.1147, 0.1144, 0.1142, 0.1148,
         0.1145],
        [0.1149, 0.1148, 0.0000, 0.1148, 0.1153, 0.1149, 0.1146, 0.1149, 0.1153,
         0.1149],
        [0.1146, 0.1144, 0.1148, 0.0000, 0.1149, 0.1151, 0.1146, 0.1142, 0.1150,
         0.1147],
        [0.1146, 0.1145, 0.1153, 0.1149, 0.0000, 0.1146, 0.1151, 0.1148, 0.1150,
         0.1150],
        [0.1149, 0.1147, 0.1149, 0.1151, 0.1146, 0.0000, 0.1150, 0.1148, 0.1148,
         0.1148],
        [0.1144, 0.1144, 0.1146, 0.1146, 0.1151, 0.1150, 0.0000, 0.1142, 0.1151,
         0.1146],
        [0.1146, 0.1142, 0.1149, 0.1142, 0.1148, 0.1148, 0.1142, 0.0000, 0.1146,
         0.1146],
        [0.1145, 0.1148, 0.1153, 0.1150, 0.1150, 0.1148, 0.1151, 0.1146, 0.0000,
         0.1146],
        [0.1147, 0.1145, 0.1149, 0.1147, 0.1150, 0.1148, 0.1146, 0.1146, 0.1146,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0353, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65815943
Epoch466: train_loss: 4.0927 recon_acc: 0.7871 val_roc: 0.7494 val_ap: 0.8184 f1: 0.7007 time: 0.2735
difference_matrix tensor([[0.0000, 0.1144, 0.1148, 0.1145, 0.1146, 0.1149, 0.1144, 0.1145, 0.1144,
         0.1147],
        [0.1144, 0.0000, 0.1147, 0.1143, 0.1144, 0.1147, 0.1143, 0.1142, 0.1148,
         0.1144],
        [0.1148, 0.1147, 0.0000, 0.1147, 0.1152, 0.1148, 0.1145, 0.1149, 0.1152,
         0.1148],
        [0.1145, 0.1143, 0.1147, 0.0000, 0.1149, 0.1151, 0.1145, 0.1142, 0.1150,
         0.1146],
        [0.1146, 0.1144, 0.1152, 0.1149, 0.0000, 0.1146, 0.1151, 0.1147, 0.1150,
         0.1149],
        [0.1149, 0.1147, 0.1148, 0.1151, 0.1146, 0.0000, 0.1149, 0.1148, 0.1148,
         0.1148],
        [0.1144, 0.1143, 0.1145, 0.1145, 0.1151, 0.1149, 0.0000, 0.1141, 0.1151,
         0.1146],
        [0.1145, 0.1142, 0.1149, 0.1142, 0.1147, 0.1148, 0.1141, 0.0000, 0.1146,
         0.1146],
        [0.1144, 0.1148, 0.1152, 0.1150, 0.1150, 0.1148, 0.1151, 0.1146, 0.0000,
         0.1146],
        [0.1147, 0.1144, 0.1148, 0.1146, 0.1149, 0.1148, 0.1146, 0.1146, 0.1146,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0353, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6579569
Epoch467: train_loss: 4.0924 recon_acc: 0.7869 val_roc: 0.7495 val_ap: 0.8186 f1: 0.7007 time: 0.2595
difference_matrix tensor([[0.0000, 0.1143, 0.1148, 0.1145, 0.1145, 0.1148, 0.1143, 0.1145, 0.1144,
         0.1146],
        [0.1143, 0.0000, 0.1147, 0.1143, 0.1144, 0.1146, 0.1143, 0.1141, 0.1147,
         0.1144],
        [0.1148, 0.1147, 0.0000, 0.1147, 0.1152, 0.1148, 0.1145, 0.1148, 0.1152,
         0.1148],
        [0.1145, 0.1143, 0.1147, 0.0000, 0.1148, 0.1150, 0.1145, 0.1142, 0.1149,
         0.1146],
        [0.1145, 0.1144, 0.1152, 0.1148, 0.0000, 0.1145, 0.1150, 0.1147, 0.1149,
         0.1149],
        [0.1148, 0.1146, 0.1148, 0.1150, 0.1145, 0.0000, 0.1149, 0.1147, 0.1147,
         0.1147],
        [0.1143, 0.1143, 0.1145, 0.1145, 0.1150, 0.1149, 0.0000, 0.1141, 0.1150,
         0.1145],
        [0.1145, 0.1141, 0.1148, 0.1142, 0.1147, 0.1147, 0.1141, 0.0000, 0.1146,
         0.1145],
        [0.1144, 0.1147, 0.1152, 0.1149, 0.1149, 0.1147, 0.1150, 0.1146, 0.0000,
         0.1145],
        [0.1146, 0.1144, 0.1148, 0.1146, 0.1149, 0.1147, 0.1145, 0.1145, 0.1145,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0354, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6577524
Epoch468: train_loss: 4.0921 recon_acc: 0.7866 val_roc: 0.7496 val_ap: 0.8187 f1: 0.7007 time: 0.2647
difference_matrix tensor([[0.0000, 0.1143, 0.1147, 0.1144, 0.1145, 0.1148, 0.1143, 0.1144, 0.1143,
         0.1146],
        [0.1143, 0.0000, 0.1146, 0.1142, 0.1143, 0.1146, 0.1142, 0.1141, 0.1147,
         0.1143],
        [0.1147, 0.1146, 0.0000, 0.1147, 0.1151, 0.1147, 0.1144, 0.1148, 0.1151,
         0.1148],
        [0.1144, 0.1142, 0.1147, 0.0000, 0.1148, 0.1150, 0.1144, 0.1141, 0.1149,
         0.1145],
        [0.1145, 0.1143, 0.1151, 0.1148, 0.0000, 0.1145, 0.1150, 0.1146, 0.1149,
         0.1148],
        [0.1148, 0.1146, 0.1147, 0.1150, 0.1145, 0.0000, 0.1148, 0.1147, 0.1147,
         0.1147],
        [0.1143, 0.1142, 0.1144, 0.1144, 0.1150, 0.1148, 0.0000, 0.1140, 0.1150,
         0.1145],
        [0.1144, 0.1141, 0.1148, 0.1141, 0.1146, 0.1147, 0.1140, 0.0000, 0.1145,
         0.1145],
        [0.1143, 0.1147, 0.1151, 0.1149, 0.1149, 0.1147, 0.1150, 0.1145, 0.0000,
         0.1145],
        [0.1146, 0.1143, 0.1148, 0.1145, 0.1148, 0.1147, 0.1145, 0.1145, 0.1145,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0354, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65754604
Epoch469: train_loss: 4.0918 recon_acc: 0.7864 val_roc: 0.7498 val_ap: 0.8188 f1: 0.7007 time: 0.2594
difference_matrix tensor([[0.0000, 0.1142, 0.1147, 0.1144, 0.1145, 0.1147, 0.1143, 0.1144, 0.1143,
         0.1145],
        [0.1142, 0.0000, 0.1146, 0.1142, 0.1143, 0.1145, 0.1142, 0.1140, 0.1146,
         0.1143],
        [0.1147, 0.1146, 0.0000, 0.1146, 0.1151, 0.1147, 0.1144, 0.1147, 0.1151,
         0.1147],
        [0.1144, 0.1142, 0.1146, 0.0000, 0.1148, 0.1150, 0.1144, 0.1141, 0.1148,
         0.1145],
        [0.1145, 0.1143, 0.1151, 0.1148, 0.0000, 0.1144, 0.1149, 0.1146, 0.1148,
         0.1148],
        [0.1147, 0.1145, 0.1147, 0.1150, 0.1144, 0.0000, 0.1148, 0.1146, 0.1146,
         0.1146],
        [0.1143, 0.1142, 0.1144, 0.1144, 0.1149, 0.1148, 0.0000, 0.1140, 0.1149,
         0.1145],
        [0.1144, 0.1140, 0.1147, 0.1141, 0.1146, 0.1146, 0.1140, 0.0000, 0.1145,
         0.1144],
        [0.1143, 0.1146, 0.1151, 0.1148, 0.1148, 0.1146, 0.1149, 0.1145, 0.0000,
         0.1145],
        [0.1145, 0.1143, 0.1147, 0.1145, 0.1148, 0.1146, 0.1145, 0.1144, 0.1145,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0355, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6573374
Epoch470: train_loss: 4.0914 recon_acc: 0.7861 val_roc: 0.7500 val_ap: 0.8190 f1: 0.7007 time: 0.2566
difference_matrix tensor([[0.0000, 0.1142, 0.1147, 0.1144, 0.1144, 0.1147, 0.1142, 0.1143, 0.1143,
         0.1145],
        [0.1142, 0.0000, 0.1145, 0.1141, 0.1142, 0.1145, 0.1141, 0.1140, 0.1146,
         0.1143],
        [0.1147, 0.1145, 0.0000, 0.1146, 0.1150, 0.1147, 0.1144, 0.1147, 0.1150,
         0.1147],
        [0.1144, 0.1141, 0.1146, 0.0000, 0.1147, 0.1149, 0.1143, 0.1140, 0.1148,
         0.1144],
        [0.1144, 0.1142, 0.1150, 0.1147, 0.0000, 0.1144, 0.1149, 0.1146, 0.1148,
         0.1147],
        [0.1147, 0.1145, 0.1147, 0.1149, 0.1144, 0.0000, 0.1148, 0.1146, 0.1146,
         0.1146],
        [0.1142, 0.1141, 0.1144, 0.1143, 0.1149, 0.1148, 0.0000, 0.1140, 0.1149,
         0.1144],
        [0.1143, 0.1140, 0.1147, 0.1140, 0.1146, 0.1146, 0.1140, 0.0000, 0.1144,
         0.1144],
        [0.1143, 0.1146, 0.1150, 0.1148, 0.1148, 0.1146, 0.1149, 0.1144, 0.0000,
         0.1144],
        [0.1145, 0.1143, 0.1147, 0.1144, 0.1147, 0.1146, 0.1144, 0.1144, 0.1144,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0355, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6571271
Epoch471: train_loss: 4.0911 recon_acc: 0.7858 val_roc: 0.7501 val_ap: 0.8191 f1: 0.7007 time: 0.2457
difference_matrix tensor([[0.0000, 0.1141, 0.1146, 0.1143, 0.1144, 0.1146, 0.1142, 0.1143, 0.1142,
         0.1144],
        [0.1141, 0.0000, 0.1145, 0.1141, 0.1142, 0.1144, 0.1141, 0.1139, 0.1145,
         0.1142],
        [0.1146, 0.1145, 0.0000, 0.1145, 0.1150, 0.1146, 0.1143, 0.1146, 0.1150,
         0.1146],
        [0.1143, 0.1141, 0.1145, 0.0000, 0.1147, 0.1149, 0.1143, 0.1140, 0.1147,
         0.1144],
        [0.1144, 0.1142, 0.1150, 0.1147, 0.0000, 0.1143, 0.1148, 0.1145, 0.1148,
         0.1147],
        [0.1146, 0.1144, 0.1146, 0.1149, 0.1143, 0.0000, 0.1147, 0.1145, 0.1145,
         0.1145],
        [0.1142, 0.1141, 0.1143, 0.1143, 0.1148, 0.1147, 0.0000, 0.1139, 0.1148,
         0.1144],
        [0.1143, 0.1139, 0.1146, 0.1140, 0.1145, 0.1145, 0.1139, 0.0000, 0.1144,
         0.1144],
        [0.1142, 0.1145, 0.1150, 0.1147, 0.1148, 0.1145, 0.1148, 0.1144, 0.0000,
         0.1144],
        [0.1144, 0.1142, 0.1146, 0.1144, 0.1147, 0.1145, 0.1144, 0.1144, 0.1144,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0355, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6569146
Epoch472: train_loss: 4.0908 recon_acc: 0.7856 val_roc: 0.7502 val_ap: 0.8193 f1: 0.7007 time: 0.2579
difference_matrix tensor([[0.0000, 0.1141, 0.1146, 0.1143, 0.1143, 0.1146, 0.1141, 0.1142, 0.1142,
         0.1144],
        [0.1141, 0.0000, 0.1144, 0.1141, 0.1142, 0.1144, 0.1140, 0.1139, 0.1145,
         0.1142],
        [0.1146, 0.1144, 0.0000, 0.1145, 0.1150, 0.1146, 0.1143, 0.1146, 0.1150,
         0.1146],
        [0.1143, 0.1141, 0.1145, 0.0000, 0.1146, 0.1148, 0.1142, 0.1139, 0.1147,
         0.1143],
        [0.1143, 0.1142, 0.1150, 0.1146, 0.0000, 0.1143, 0.1148, 0.1145, 0.1147,
         0.1147],
        [0.1146, 0.1144, 0.1146, 0.1148, 0.1143, 0.0000, 0.1147, 0.1145, 0.1145,
         0.1145],
        [0.1141, 0.1140, 0.1143, 0.1142, 0.1148, 0.1147, 0.0000, 0.1139, 0.1148,
         0.1143],
        [0.1142, 0.1139, 0.1146, 0.1139, 0.1145, 0.1145, 0.1139, 0.0000, 0.1143,
         0.1143],
        [0.1142, 0.1145, 0.1150, 0.1147, 0.1147, 0.1145, 0.1148, 0.1143, 0.0000,
         0.1143],
        [0.1144, 0.1142, 0.1146, 0.1143, 0.1147, 0.1145, 0.1143, 0.1143, 0.1143,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0356, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6567002
Epoch473: train_loss: 4.0905 recon_acc: 0.7853 val_roc: 0.7505 val_ap: 0.8195 f1: 0.7007 time: 0.2680
difference_matrix tensor([[0.0000, 0.1141, 0.1145, 0.1142, 0.1143, 0.1146, 0.1141, 0.1142, 0.1141,
         0.1144],
        [0.1141, 0.0000, 0.1144, 0.1140, 0.1141, 0.1143, 0.1140, 0.1139, 0.1144,
         0.1141],
        [0.1145, 0.1144, 0.0000, 0.1144, 0.1149, 0.1145, 0.1142, 0.1146, 0.1149,
         0.1145],
        [0.1142, 0.1140, 0.1144, 0.0000, 0.1146, 0.1148, 0.1142, 0.1139, 0.1147,
         0.1143],
        [0.1143, 0.1141, 0.1149, 0.1146, 0.0000, 0.1143, 0.1147, 0.1144, 0.1147,
         0.1146],
        [0.1146, 0.1143, 0.1145, 0.1148, 0.1143, 0.0000, 0.1146, 0.1144, 0.1144,
         0.1144],
        [0.1141, 0.1140, 0.1142, 0.1142, 0.1147, 0.1146, 0.0000, 0.1138, 0.1147,
         0.1143],
        [0.1142, 0.1139, 0.1146, 0.1139, 0.1144, 0.1144, 0.1138, 0.0000, 0.1143,
         0.1143],
        [0.1141, 0.1144, 0.1149, 0.1147, 0.1147, 0.1144, 0.1147, 0.1143, 0.0000,
         0.1143],
        [0.1144, 0.1141, 0.1145, 0.1143, 0.1146, 0.1144, 0.1143, 0.1143, 0.1143,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0356, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65489155
Epoch474: train_loss: 4.0902 recon_acc: 0.7825 val_roc: 0.7507 val_ap: 0.8198 f1: 0.7022 time: 0.2595
difference_matrix tensor([[0.0000, 0.1140, 0.1145, 0.1142, 0.1142, 0.1145, 0.1140, 0.1141, 0.1141,
         0.1143],
        [0.1140, 0.0000, 0.1144, 0.1140, 0.1141, 0.1143, 0.1139, 0.1138, 0.1144,
         0.1141],
        [0.1145, 0.1144, 0.0000, 0.1144, 0.1149, 0.1145, 0.1142, 0.1145, 0.1149,
         0.1145],
        [0.1142, 0.1140, 0.1144, 0.0000, 0.1145, 0.1147, 0.1142, 0.1138, 0.1146,
         0.1143],
        [0.1142, 0.1141, 0.1149, 0.1145, 0.0000, 0.1142, 0.1147, 0.1144, 0.1146,
         0.1146],
        [0.1145, 0.1143, 0.1145, 0.1147, 0.1142, 0.0000, 0.1146, 0.1144, 0.1144,
         0.1144],
        [0.1140, 0.1139, 0.1142, 0.1142, 0.1147, 0.1146, 0.0000, 0.1138, 0.1147,
         0.1142],
        [0.1141, 0.1138, 0.1145, 0.1138, 0.1144, 0.1144, 0.1138, 0.0000, 0.1142,
         0.1142],
        [0.1141, 0.1144, 0.1149, 0.1146, 0.1146, 0.1144, 0.1147, 0.1142, 0.0000,
         0.1142],
        [0.1143, 0.1141, 0.1145, 0.1143, 0.1146, 0.1144, 0.1142, 0.1142, 0.1142,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0357, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6551314
Epoch475: train_loss: 4.0899 recon_acc: 0.7830 val_roc: 0.7509 val_ap: 0.8200 f1: 0.7022 time: 0.2810
difference_matrix tensor([[0.0000, 0.1140, 0.1144, 0.1141, 0.1142, 0.1145, 0.1140, 0.1141, 0.1140,
         0.1143],
        [0.1140, 0.0000, 0.1143, 0.1139, 0.1140, 0.1143, 0.1139, 0.1138, 0.1144,
         0.1140],
        [0.1144, 0.1143, 0.0000, 0.1144, 0.1148, 0.1144, 0.1141, 0.1145, 0.1148,
         0.1145],
        [0.1141, 0.1139, 0.1144, 0.0000, 0.1145, 0.1147, 0.1141, 0.1138, 0.1146,
         0.1142],
        [0.1142, 0.1140, 0.1148, 0.1145, 0.0000, 0.1142, 0.1146, 0.1143, 0.1146,
         0.1145],
        [0.1145, 0.1143, 0.1144, 0.1147, 0.1142, 0.0000, 0.1145, 0.1144, 0.1144,
         0.1143],
        [0.1140, 0.1139, 0.1141, 0.1141, 0.1146, 0.1145, 0.0000, 0.1137, 0.1147,
         0.1142],
        [0.1141, 0.1138, 0.1145, 0.1138, 0.1143, 0.1144, 0.1137, 0.0000, 0.1142,
         0.1142],
        [0.1140, 0.1144, 0.1148, 0.1146, 0.1146, 0.1144, 0.1147, 0.1142, 0.0000,
         0.1142],
        [0.1143, 0.1140, 0.1145, 0.1142, 0.1145, 0.1143, 0.1142, 0.1142, 0.1142,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0357, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65536934
Epoch476: train_loss: 4.0896 recon_acc: 0.7834 val_roc: 0.7512 val_ap: 0.8201 f1: 0.7022 time: 0.2752
difference_matrix tensor([[0.0000, 0.1139, 0.1144, 0.1141, 0.1141, 0.1144, 0.1139, 0.1141, 0.1140,
         0.1142],
        [0.1139, 0.0000, 0.1143, 0.1139, 0.1140, 0.1142, 0.1138, 0.1137, 0.1143,
         0.1140],
        [0.1144, 0.1143, 0.0000, 0.1143, 0.1148, 0.1144, 0.1141, 0.1144, 0.1148,
         0.1144],
        [0.1141, 0.1139, 0.1143, 0.0000, 0.1144, 0.1147, 0.1141, 0.1137, 0.1145,
         0.1142],
        [0.1141, 0.1140, 0.1148, 0.1144, 0.0000, 0.1141, 0.1146, 0.1143, 0.1145,
         0.1145],
        [0.1144, 0.1142, 0.1144, 0.1147, 0.1141, 0.0000, 0.1145, 0.1143, 0.1143,
         0.1143],
        [0.1139, 0.1138, 0.1141, 0.1141, 0.1146, 0.1145, 0.0000, 0.1137, 0.1146,
         0.1141],
        [0.1141, 0.1137, 0.1144, 0.1137, 0.1143, 0.1143, 0.1137, 0.0000, 0.1142,
         0.1141],
        [0.1140, 0.1143, 0.1148, 0.1145, 0.1145, 0.1143, 0.1146, 0.1142, 0.0000,
         0.1142],
        [0.1142, 0.1140, 0.1144, 0.1142, 0.1145, 0.1143, 0.1141, 0.1141, 0.1142,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0358, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65560526
Epoch477: train_loss: 4.0893 recon_acc: 0.7838 val_roc: 0.7515 val_ap: 0.8204 f1: 0.7022 time: 0.2866
difference_matrix tensor([[0.0000, 0.1139, 0.1143, 0.1141, 0.1141, 0.1144, 0.1139, 0.1140, 0.1140,
         0.1142],
        [0.1139, 0.0000, 0.1142, 0.1138, 0.1139, 0.1142, 0.1138, 0.1137, 0.1143,
         0.1140],
        [0.1143, 0.1142, 0.0000, 0.1143, 0.1147, 0.1143, 0.1140, 0.1144, 0.1147,
         0.1144],
        [0.1141, 0.1138, 0.1143, 0.0000, 0.1144, 0.1146, 0.1140, 0.1137, 0.1145,
         0.1141],
        [0.1141, 0.1139, 0.1147, 0.1144, 0.0000, 0.1141, 0.1146, 0.1142, 0.1145,
         0.1144],
        [0.1144, 0.1142, 0.1143, 0.1146, 0.1141, 0.0000, 0.1145, 0.1143, 0.1143,
         0.1143],
        [0.1139, 0.1138, 0.1140, 0.1140, 0.1146, 0.1145, 0.0000, 0.1136, 0.1146,
         0.1141],
        [0.1140, 0.1137, 0.1144, 0.1137, 0.1142, 0.1143, 0.1136, 0.0000, 0.1141,
         0.1141],
        [0.1140, 0.1143, 0.1147, 0.1145, 0.1145, 0.1143, 0.1146, 0.1141, 0.0000,
         0.1141],
        [0.1142, 0.1140, 0.1144, 0.1141, 0.1144, 0.1143, 0.1141, 0.1141, 0.1141,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0358, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.655598
Epoch478: train_loss: 4.0890 recon_acc: 0.7839 val_roc: 0.7517 val_ap: 0.8205 f1: 0.7022 time: 0.2750
difference_matrix tensor([[0.0000, 0.1138, 0.1143, 0.1140, 0.1141, 0.1143, 0.1139, 0.1140, 0.1139,
         0.1141],
        [0.1138, 0.0000, 0.1142, 0.1138, 0.1139, 0.1141, 0.1138, 0.1136, 0.1142,
         0.1139],
        [0.1143, 0.1142, 0.0000, 0.1142, 0.1147, 0.1143, 0.1140, 0.1143, 0.1147,
         0.1143],
        [0.1140, 0.1138, 0.1142, 0.0000, 0.1144, 0.1146, 0.1140, 0.1137, 0.1144,
         0.1141],
        [0.1141, 0.1139, 0.1147, 0.1144, 0.0000, 0.1140, 0.1145, 0.1142, 0.1145,
         0.1144],
        [0.1143, 0.1141, 0.1143, 0.1146, 0.1140, 0.0000, 0.1144, 0.1142, 0.1142,
         0.1142],
        [0.1139, 0.1138, 0.1140, 0.1140, 0.1145, 0.1144, 0.0000, 0.1136, 0.1145,
         0.1141],
        [0.1140, 0.1136, 0.1143, 0.1137, 0.1142, 0.1142, 0.1136, 0.0000, 0.1141,
         0.1140],
        [0.1139, 0.1142, 0.1147, 0.1144, 0.1145, 0.1142, 0.1145, 0.1141, 0.0000,
         0.1141],
        [0.1141, 0.1139, 0.1143, 0.1141, 0.1144, 0.1142, 0.1141, 0.1140, 0.1141,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0358, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6553714
Epoch479: train_loss: 4.0888 recon_acc: 0.7835 val_roc: 0.7519 val_ap: 0.8208 f1: 0.7039 time: 0.2651
difference_matrix tensor([[0.0000, 0.1138, 0.1143, 0.1140, 0.1140, 0.1143, 0.1138, 0.1139, 0.1139,
         0.1141],
        [0.1138, 0.0000, 0.1142, 0.1138, 0.1139, 0.1141, 0.1137, 0.1136, 0.1142,
         0.1139],
        [0.1143, 0.1142, 0.0000, 0.1142, 0.1146, 0.1143, 0.1140, 0.1143, 0.1147,
         0.1143],
        [0.1140, 0.1138, 0.1142, 0.0000, 0.1143, 0.1145, 0.1139, 0.1136, 0.1144,
         0.1140],
        [0.1140, 0.1139, 0.1146, 0.1143, 0.0000, 0.1140, 0.1145, 0.1142, 0.1144,
         0.1144],
        [0.1143, 0.1141, 0.1143, 0.1145, 0.1140, 0.0000, 0.1144, 0.1142, 0.1142,
         0.1142],
        [0.1138, 0.1137, 0.1140, 0.1139, 0.1145, 0.1144, 0.0000, 0.1136, 0.1145,
         0.1140],
        [0.1139, 0.1136, 0.1143, 0.1136, 0.1142, 0.1142, 0.1136, 0.0000, 0.1140,
         0.1140],
        [0.1139, 0.1142, 0.1147, 0.1144, 0.1144, 0.1142, 0.1145, 0.1140, 0.0000,
         0.1140],
        [0.1141, 0.1139, 0.1143, 0.1140, 0.1144, 0.1142, 0.1140, 0.1140, 0.1140,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0359, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6595222
Epoch480: train_loss: 4.0885 recon_acc: 0.7901 val_roc: 0.7520 val_ap: 0.8208 f1: 0.7010 time: 0.2477
difference_matrix tensor([[0.0000, 0.1138, 0.1142, 0.1139, 0.1140, 0.1143, 0.1138, 0.1139, 0.1138,
         0.1141],
        [0.1138, 0.0000, 0.1141, 0.1137, 0.1138, 0.1141, 0.1137, 0.1135, 0.1142,
         0.1138],
        [0.1142, 0.1141, 0.0000, 0.1141, 0.1146, 0.1142, 0.1139, 0.1143, 0.1146,
         0.1142],
        [0.1139, 0.1137, 0.1141, 0.0000, 0.1143, 0.1145, 0.1139, 0.1136, 0.1144,
         0.1140],
        [0.1140, 0.1138, 0.1146, 0.1143, 0.0000, 0.1139, 0.1144, 0.1141, 0.1144,
         0.1143],
        [0.1143, 0.1141, 0.1142, 0.1145, 0.1139, 0.0000, 0.1143, 0.1141, 0.1141,
         0.1141],
        [0.1138, 0.1137, 0.1139, 0.1139, 0.1144, 0.1143, 0.0000, 0.1135, 0.1144,
         0.1140],
        [0.1139, 0.1135, 0.1143, 0.1136, 0.1141, 0.1141, 0.1135, 0.0000, 0.1140,
         0.1140],
        [0.1138, 0.1142, 0.1146, 0.1144, 0.1144, 0.1141, 0.1144, 0.1140, 0.0000,
         0.1140],
        [0.1141, 0.1138, 0.1142, 0.1140, 0.1143, 0.1141, 0.1140, 0.1140, 0.1140,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0359, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65942276
Epoch481: train_loss: 4.0882 recon_acc: 0.7900 val_roc: 0.7522 val_ap: 0.8210 f1: 0.7027 time: 0.2507
difference_matrix tensor([[0.0000, 0.1137, 0.1142, 0.1139, 0.1139, 0.1142, 0.1137, 0.1139, 0.1138,
         0.1140],
        [0.1137, 0.0000, 0.1141, 0.1137, 0.1138, 0.1140, 0.1136, 0.1135, 0.1141,
         0.1138],
        [0.1142, 0.1141, 0.0000, 0.1141, 0.1146, 0.1142, 0.1139, 0.1142, 0.1146,
         0.1142],
        [0.1139, 0.1137, 0.1141, 0.0000, 0.1142, 0.1145, 0.1139, 0.1135, 0.1143,
         0.1140],
        [0.1139, 0.1138, 0.1146, 0.1142, 0.0000, 0.1139, 0.1144, 0.1141, 0.1143,
         0.1143],
        [0.1142, 0.1140, 0.1142, 0.1145, 0.1139, 0.0000, 0.1143, 0.1141, 0.1141,
         0.1141],
        [0.1137, 0.1136, 0.1139, 0.1139, 0.1144, 0.1143, 0.0000, 0.1135, 0.1144,
         0.1139],
        [0.1139, 0.1135, 0.1142, 0.1135, 0.1141, 0.1141, 0.1135, 0.0000, 0.1140,
         0.1139],
        [0.1138, 0.1141, 0.1146, 0.1143, 0.1143, 0.1141, 0.1144, 0.1140, 0.0000,
         0.1139],
        [0.1140, 0.1138, 0.1142, 0.1140, 0.1143, 0.1141, 0.1139, 0.1139, 0.1139,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0360, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6593223
Epoch482: train_loss: 4.0879 recon_acc: 0.7899 val_roc: 0.7524 val_ap: 0.8212 f1: 0.7027 time: 0.2524
difference_matrix tensor([[0.0000, 0.1137, 0.1141, 0.1138, 0.1139, 0.1142, 0.1137, 0.1138, 0.1137,
         0.1140],
        [0.1137, 0.0000, 0.1140, 0.1136, 0.1137, 0.1140, 0.1136, 0.1135, 0.1141,
         0.1137],
        [0.1141, 0.1140, 0.0000, 0.1141, 0.1145, 0.1141, 0.1138, 0.1142, 0.1145,
         0.1142],
        [0.1138, 0.1136, 0.1141, 0.0000, 0.1142, 0.1144, 0.1138, 0.1135, 0.1143,
         0.1139],
        [0.1139, 0.1137, 0.1145, 0.1142, 0.0000, 0.1139, 0.1144, 0.1140, 0.1143,
         0.1142],
        [0.1142, 0.1140, 0.1141, 0.1144, 0.1139, 0.0000, 0.1143, 0.1141, 0.1141,
         0.1140],
        [0.1137, 0.1136, 0.1138, 0.1138, 0.1144, 0.1143, 0.0000, 0.1134, 0.1144,
         0.1139],
        [0.1138, 0.1135, 0.1142, 0.1135, 0.1140, 0.1141, 0.1134, 0.0000, 0.1139,
         0.1139],
        [0.1137, 0.1141, 0.1145, 0.1143, 0.1143, 0.1141, 0.1144, 0.1139, 0.0000,
         0.1139],
        [0.1140, 0.1137, 0.1142, 0.1139, 0.1142, 0.1140, 0.1139, 0.1139, 0.1139,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0360, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6592209
Epoch483: train_loss: 4.0876 recon_acc: 0.7898 val_roc: 0.7526 val_ap: 0.8215 f1: 0.7027 time: 0.2580
difference_matrix tensor([[0.0000, 0.1136, 0.1141, 0.1138, 0.1139, 0.1141, 0.1137, 0.1138, 0.1137,
         0.1139],
        [0.1136, 0.0000, 0.1140, 0.1136, 0.1137, 0.1139, 0.1135, 0.1134, 0.1140,
         0.1137],
        [0.1141, 0.1140, 0.0000, 0.1140, 0.1145, 0.1141, 0.1138, 0.1141, 0.1145,
         0.1141],
        [0.1138, 0.1136, 0.1140, 0.0000, 0.1142, 0.1144, 0.1138, 0.1135, 0.1142,
         0.1139],
        [0.1139, 0.1137, 0.1145, 0.1142, 0.0000, 0.1138, 0.1143, 0.1140, 0.1142,
         0.1142],
        [0.1141, 0.1139, 0.1141, 0.1144, 0.1138, 0.0000, 0.1142, 0.1140, 0.1140,
         0.1140],
        [0.1137, 0.1135, 0.1138, 0.1138, 0.1143, 0.1142, 0.0000, 0.1134, 0.1143,
         0.1139],
        [0.1138, 0.1134, 0.1141, 0.1135, 0.1140, 0.1140, 0.1134, 0.0000, 0.1139,
         0.1138],
        [0.1137, 0.1140, 0.1145, 0.1142, 0.1142, 0.1140, 0.1143, 0.1139, 0.0000,
         0.1139],
        [0.1139, 0.1137, 0.1141, 0.1139, 0.1142, 0.1140, 0.1139, 0.1138, 0.1139,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0361, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65911835
Epoch484: train_loss: 4.0873 recon_acc: 0.7897 val_roc: 0.7527 val_ap: 0.8216 f1: 0.7027 time: 0.2606
difference_matrix tensor([[0.0000, 0.1136, 0.1141, 0.1138, 0.1138, 0.1141, 0.1136, 0.1137, 0.1137,
         0.1139],
        [0.1136, 0.0000, 0.1140, 0.1135, 0.1136, 0.1139, 0.1135, 0.1134, 0.1140,
         0.1137],
        [0.1141, 0.1140, 0.0000, 0.1140, 0.1144, 0.1140, 0.1137, 0.1141, 0.1145,
         0.1141],
        [0.1138, 0.1135, 0.1140, 0.0000, 0.1141, 0.1143, 0.1137, 0.1134, 0.1142,
         0.1138],
        [0.1138, 0.1136, 0.1144, 0.1141, 0.0000, 0.1138, 0.1143, 0.1140, 0.1142,
         0.1142],
        [0.1141, 0.1139, 0.1140, 0.1143, 0.1138, 0.0000, 0.1142, 0.1140, 0.1140,
         0.1140],
        [0.1136, 0.1135, 0.1137, 0.1137, 0.1143, 0.1142, 0.0000, 0.1133, 0.1143,
         0.1138],
        [0.1137, 0.1134, 0.1141, 0.1134, 0.1140, 0.1140, 0.1133, 0.0000, 0.1138,
         0.1138],
        [0.1137, 0.1140, 0.1145, 0.1142, 0.1142, 0.1140, 0.1143, 0.1138, 0.0000,
         0.1138],
        [0.1139, 0.1137, 0.1141, 0.1138, 0.1142, 0.1140, 0.1138, 0.1138, 0.1138,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0361, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6590149
Epoch485: train_loss: 4.0871 recon_acc: 0.7896 val_roc: 0.7530 val_ap: 0.8220 f1: 0.7027 time: 0.2725
difference_matrix tensor([[0.0000, 0.1136, 0.1140, 0.1137, 0.1138, 0.1141, 0.1136, 0.1137, 0.1136,
         0.1139],
        [0.1136, 0.0000, 0.1139, 0.1135, 0.1136, 0.1139, 0.1135, 0.1133, 0.1140,
         0.1136],
        [0.1140, 0.1139, 0.0000, 0.1140, 0.1144, 0.1140, 0.1137, 0.1141, 0.1144,
         0.1141],
        [0.1137, 0.1135, 0.1140, 0.0000, 0.1141, 0.1143, 0.1137, 0.1134, 0.1142,
         0.1138],
        [0.1138, 0.1136, 0.1144, 0.1141, 0.0000, 0.1137, 0.1142, 0.1139, 0.1142,
         0.1141],
        [0.1141, 0.1139, 0.1140, 0.1143, 0.1137, 0.0000, 0.1141, 0.1139, 0.1139,
         0.1139],
        [0.1136, 0.1135, 0.1137, 0.1137, 0.1142, 0.1141, 0.0000, 0.1133, 0.1142,
         0.1138],
        [0.1137, 0.1133, 0.1141, 0.1134, 0.1139, 0.1139, 0.1133, 0.0000, 0.1138,
         0.1138],
        [0.1136, 0.1140, 0.1144, 0.1142, 0.1142, 0.1139, 0.1142, 0.1138, 0.0000,
         0.1138],
        [0.1139, 0.1136, 0.1141, 0.1138, 0.1141, 0.1139, 0.1138, 0.1138, 0.1138,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0361, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65891033
Epoch486: train_loss: 4.0868 recon_acc: 0.7895 val_roc: 0.7531 val_ap: 0.8221 f1: 0.7027 time: 0.2636
difference_matrix tensor([[0.0000, 0.1135, 0.1140, 0.1137, 0.1137, 0.1140, 0.1135, 0.1137, 0.1136,
         0.1138],
        [0.1135, 0.0000, 0.1139, 0.1135, 0.1136, 0.1138, 0.1134, 0.1133, 0.1139,
         0.1136],
        [0.1140, 0.1139, 0.0000, 0.1139, 0.1144, 0.1140, 0.1137, 0.1140, 0.1144,
         0.1140],
        [0.1137, 0.1135, 0.1139, 0.0000, 0.1140, 0.1143, 0.1137, 0.1133, 0.1141,
         0.1138],
        [0.1137, 0.1136, 0.1144, 0.1140, 0.0000, 0.1137, 0.1142, 0.1139, 0.1141,
         0.1141],
        [0.1140, 0.1138, 0.1140, 0.1143, 0.1137, 0.0000, 0.1141, 0.1139, 0.1139,
         0.1139],
        [0.1135, 0.1134, 0.1137, 0.1137, 0.1142, 0.1141, 0.0000, 0.1133, 0.1142,
         0.1137],
        [0.1137, 0.1133, 0.1140, 0.1133, 0.1139, 0.1139, 0.1133, 0.0000, 0.1138,
         0.1137],
        [0.1136, 0.1139, 0.1144, 0.1141, 0.1141, 0.1139, 0.1142, 0.1138, 0.0000,
         0.1137],
        [0.1138, 0.1136, 0.1140, 0.1138, 0.1141, 0.1139, 0.1137, 0.1137, 0.1137,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0362, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65785944
Epoch487: train_loss: 4.0865 recon_acc: 0.7879 val_roc: 0.7531 val_ap: 0.8221 f1: 0.7024 time: 0.3054
difference_matrix tensor([[0.0000, 0.1135, 0.1139, 0.1136, 0.1137, 0.1140, 0.1135, 0.1136, 0.1136,
         0.1138],
        [0.1135, 0.0000, 0.1138, 0.1134, 0.1135, 0.1138, 0.1134, 0.1133, 0.1139,
         0.1135],
        [0.1139, 0.1138, 0.0000, 0.1139, 0.1143, 0.1139, 0.1136, 0.1140, 0.1143,
         0.1140],
        [0.1136, 0.1134, 0.1139, 0.0000, 0.1140, 0.1142, 0.1136, 0.1133, 0.1141,
         0.1137],
        [0.1137, 0.1135, 0.1143, 0.1140, 0.0000, 0.1137, 0.1142, 0.1138, 0.1141,
         0.1140],
        [0.1140, 0.1138, 0.1139, 0.1142, 0.1137, 0.0000, 0.1141, 0.1139, 0.1139,
         0.1138],
        [0.1135, 0.1134, 0.1136, 0.1136, 0.1142, 0.1141, 0.0000, 0.1132, 0.1142,
         0.1137],
        [0.1136, 0.1133, 0.1140, 0.1133, 0.1138, 0.1139, 0.1132, 0.0000, 0.1137,
         0.1137],
        [0.1136, 0.1139, 0.1143, 0.1141, 0.1141, 0.1139, 0.1142, 0.1137, 0.0000,
         0.1137],
        [0.1138, 0.1135, 0.1140, 0.1137, 0.1140, 0.1138, 0.1137, 0.1137, 0.1137,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0362, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6580743
Epoch488: train_loss: 4.0863 recon_acc: 0.7883 val_roc: 0.7532 val_ap: 0.8222 f1: 0.7024 time: 0.2976
difference_matrix tensor([[0.0000, 0.1134, 0.1139, 0.1136, 0.1137, 0.1139, 0.1135, 0.1136, 0.1135,
         0.1138],
        [0.1134, 0.0000, 0.1138, 0.1134, 0.1135, 0.1138, 0.1133, 0.1132, 0.1138,
         0.1135],
        [0.1139, 0.1138, 0.0000, 0.1138, 0.1143, 0.1139, 0.1136, 0.1140, 0.1143,
         0.1139],
        [0.1136, 0.1134, 0.1138, 0.0000, 0.1140, 0.1142, 0.1136, 0.1133, 0.1140,
         0.1137],
        [0.1137, 0.1135, 0.1143, 0.1140, 0.0000, 0.1136, 0.1141, 0.1138, 0.1141,
         0.1140],
        [0.1139, 0.1138, 0.1139, 0.1142, 0.1136, 0.0000, 0.1140, 0.1138, 0.1138,
         0.1138],
        [0.1135, 0.1133, 0.1136, 0.1136, 0.1141, 0.1140, 0.0000, 0.1132, 0.1141,
         0.1137],
        [0.1136, 0.1132, 0.1140, 0.1132, 0.1138, 0.1138, 0.1132, 0.0000, 0.1137,
         0.1136],
        [0.1135, 0.1138, 0.1143, 0.1140, 0.1141, 0.1138, 0.1141, 0.1137, 0.0000,
         0.1137],
        [0.1138, 0.1135, 0.1139, 0.1137, 0.1140, 0.1138, 0.1137, 0.1136, 0.1137,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0363, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64544284
Epoch489: train_loss: 4.0860 recon_acc: 0.7683 val_roc: 0.7534 val_ap: 0.8224 f1: 0.7031 time: 0.2720
difference_matrix tensor([[0.0000, 0.1134, 0.1139, 0.1136, 0.1136, 0.1139, 0.1134, 0.1135, 0.1135,
         0.1137],
        [0.1134, 0.0000, 0.1138, 0.1134, 0.1134, 0.1137, 0.1133, 0.1132, 0.1138,
         0.1135],
        [0.1139, 0.1138, 0.0000, 0.1138, 0.1142, 0.1138, 0.1135, 0.1139, 0.1143,
         0.1139],
        [0.1136, 0.1134, 0.1138, 0.0000, 0.1139, 0.1141, 0.1135, 0.1132, 0.1140,
         0.1136],
        [0.1136, 0.1134, 0.1142, 0.1139, 0.0000, 0.1136, 0.1141, 0.1138, 0.1140,
         0.1140],
        [0.1139, 0.1137, 0.1138, 0.1141, 0.1136, 0.0000, 0.1140, 0.1138, 0.1138,
         0.1138],
        [0.1134, 0.1133, 0.1135, 0.1135, 0.1141, 0.1140, 0.0000, 0.1131, 0.1141,
         0.1136],
        [0.1135, 0.1132, 0.1139, 0.1132, 0.1138, 0.1138, 0.1131, 0.0000, 0.1136,
         0.1136],
        [0.1135, 0.1138, 0.1143, 0.1140, 0.1140, 0.1138, 0.1141, 0.1136, 0.0000,
         0.1136],
        [0.1137, 0.1135, 0.1139, 0.1136, 0.1140, 0.1138, 0.1136, 0.1136, 0.1136,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0363, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6456035
Epoch490: train_loss: 4.0857 recon_acc: 0.7686 val_roc: 0.7536 val_ap: 0.8225 f1: 0.7031 time: 0.2680
difference_matrix tensor([[0.0000, 0.1134, 0.1138, 0.1135, 0.1136, 0.1139, 0.1134, 0.1135, 0.1134,
         0.1137],
        [0.1134, 0.0000, 0.1137, 0.1133, 0.1134, 0.1137, 0.1133, 0.1131, 0.1138,
         0.1134],
        [0.1138, 0.1137, 0.0000, 0.1138, 0.1142, 0.1138, 0.1135, 0.1139, 0.1142,
         0.1139],
        [0.1135, 0.1133, 0.1138, 0.0000, 0.1139, 0.1141, 0.1135, 0.1132, 0.1140,
         0.1136],
        [0.1136, 0.1134, 0.1142, 0.1139, 0.0000, 0.1135, 0.1140, 0.1137, 0.1140,
         0.1139],
        [0.1139, 0.1137, 0.1138, 0.1141, 0.1135, 0.0000, 0.1139, 0.1137, 0.1138,
         0.1137],
        [0.1134, 0.1133, 0.1135, 0.1135, 0.1140, 0.1139, 0.0000, 0.1131, 0.1140,
         0.1136],
        [0.1135, 0.1131, 0.1139, 0.1132, 0.1137, 0.1137, 0.1131, 0.0000, 0.1136,
         0.1136],
        [0.1134, 0.1138, 0.1142, 0.1140, 0.1140, 0.1138, 0.1140, 0.1136, 0.0000,
         0.1136],
        [0.1137, 0.1134, 0.1139, 0.1136, 0.1139, 0.1137, 0.1136, 0.1136, 0.1136,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0363, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.645763
Epoch491: train_loss: 4.0855 recon_acc: 0.7690 val_roc: 0.7538 val_ap: 0.8227 f1: 0.7031 time: 0.2500
difference_matrix tensor([[0.0000, 0.1133, 0.1138, 0.1135, 0.1135, 0.1138, 0.1133, 0.1135, 0.1134,
         0.1136],
        [0.1133, 0.0000, 0.1137, 0.1133, 0.1134, 0.1136, 0.1132, 0.1131, 0.1137,
         0.1134],
        [0.1138, 0.1137, 0.0000, 0.1137, 0.1142, 0.1138, 0.1135, 0.1138, 0.1142,
         0.1138],
        [0.1135, 0.1133, 0.1137, 0.0000, 0.1138, 0.1141, 0.1135, 0.1131, 0.1139,
         0.1136],
        [0.1135, 0.1134, 0.1142, 0.1138, 0.0000, 0.1135, 0.1140, 0.1137, 0.1139,
         0.1139],
        [0.1138, 0.1136, 0.1138, 0.1141, 0.1135, 0.0000, 0.1139, 0.1137, 0.1137,
         0.1137],
        [0.1133, 0.1132, 0.1135, 0.1135, 0.1140, 0.1139, 0.0000, 0.1131, 0.1140,
         0.1135],
        [0.1135, 0.1131, 0.1138, 0.1131, 0.1137, 0.1137, 0.1131, 0.0000, 0.1136,
         0.1135],
        [0.1134, 0.1137, 0.1142, 0.1139, 0.1139, 0.1137, 0.1140, 0.1136, 0.0000,
         0.1136],
        [0.1136, 0.1134, 0.1138, 0.1136, 0.1139, 0.1137, 0.1135, 0.1135, 0.1136,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0364, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6459212
Epoch492: train_loss: 4.0852 recon_acc: 0.7693 val_roc: 0.7541 val_ap: 0.8230 f1: 0.7031 time: 0.2428
difference_matrix tensor([[0.0000, 0.1133, 0.1138, 0.1134, 0.1135, 0.1138, 0.1133, 0.1134, 0.1134,
         0.1136],
        [0.1133, 0.0000, 0.1137, 0.1132, 0.1133, 0.1136, 0.1132, 0.1131, 0.1137,
         0.1134],
        [0.1138, 0.1137, 0.0000, 0.1137, 0.1141, 0.1137, 0.1134, 0.1138, 0.1141,
         0.1138],
        [0.1134, 0.1132, 0.1137, 0.0000, 0.1138, 0.1140, 0.1134, 0.1131, 0.1139,
         0.1135],
        [0.1135, 0.1133, 0.1141, 0.1138, 0.0000, 0.1135, 0.1140, 0.1136, 0.1139,
         0.1138],
        [0.1138, 0.1136, 0.1137, 0.1140, 0.1135, 0.0000, 0.1139, 0.1137, 0.1137,
         0.1137],
        [0.1133, 0.1132, 0.1134, 0.1134, 0.1140, 0.1139, 0.0000, 0.1130, 0.1140,
         0.1135],
        [0.1134, 0.1131, 0.1138, 0.1131, 0.1136, 0.1137, 0.1130, 0.0000, 0.1135,
         0.1135],
        [0.1134, 0.1137, 0.1141, 0.1139, 0.1139, 0.1137, 0.1140, 0.1135, 0.0000,
         0.1135],
        [0.1136, 0.1134, 0.1138, 0.1135, 0.1138, 0.1137, 0.1135, 0.1135, 0.1135,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0364, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6506899
Epoch493: train_loss: 4.0849 recon_acc: 0.7769 val_roc: 0.7543 val_ap: 0.8232 f1: 0.7050 time: 0.2645
difference_matrix tensor([[0.0000, 0.1133, 0.1137, 0.1134, 0.1135, 0.1138, 0.1133, 0.1134, 0.1133,
         0.1136],
        [0.1133, 0.0000, 0.1136, 0.1132, 0.1133, 0.1136, 0.1131, 0.1130, 0.1137,
         0.1133],
        [0.1137, 0.1136, 0.0000, 0.1137, 0.1141, 0.1137, 0.1134, 0.1138, 0.1141,
         0.1138],
        [0.1134, 0.1132, 0.1137, 0.0000, 0.1138, 0.1140, 0.1134, 0.1131, 0.1139,
         0.1135],
        [0.1135, 0.1133, 0.1141, 0.1138, 0.0000, 0.1134, 0.1139, 0.1136, 0.1139,
         0.1138],
        [0.1138, 0.1136, 0.1137, 0.1140, 0.1134, 0.0000, 0.1138, 0.1136, 0.1136,
         0.1136],
        [0.1133, 0.1131, 0.1134, 0.1134, 0.1139, 0.1138, 0.0000, 0.1130, 0.1139,
         0.1135],
        [0.1134, 0.1130, 0.1138, 0.1131, 0.1136, 0.1136, 0.1130, 0.0000, 0.1135,
         0.1134],
        [0.1133, 0.1137, 0.1141, 0.1139, 0.1139, 0.1136, 0.1139, 0.1135, 0.0000,
         0.1135],
        [0.1136, 0.1133, 0.1138, 0.1135, 0.1138, 0.1136, 0.1135, 0.1134, 0.1135,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0364, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6517303
Epoch494: train_loss: 4.0847 recon_acc: 0.7786 val_roc: 0.7543 val_ap: 0.8233 f1: 0.7050 time: 0.2548
difference_matrix tensor([[0.0000, 0.1132, 0.1137, 0.1134, 0.1134, 0.1137, 0.1132, 0.1134, 0.1133,
         0.1135],
        [0.1132, 0.0000, 0.1136, 0.1132, 0.1133, 0.1135, 0.1131, 0.1130, 0.1136,
         0.1133],
        [0.1137, 0.1136, 0.0000, 0.1136, 0.1140, 0.1137, 0.1134, 0.1137, 0.1141,
         0.1137],
        [0.1134, 0.1132, 0.1136, 0.0000, 0.1137, 0.1140, 0.1134, 0.1130, 0.1138,
         0.1135],
        [0.1134, 0.1133, 0.1140, 0.1137, 0.0000, 0.1134, 0.1139, 0.1136, 0.1138,
         0.1138],
        [0.1137, 0.1135, 0.1137, 0.1140, 0.1134, 0.0000, 0.1138, 0.1136, 0.1136,
         0.1136],
        [0.1132, 0.1131, 0.1134, 0.1134, 0.1139, 0.1138, 0.0000, 0.1130, 0.1139,
         0.1134],
        [0.1134, 0.1130, 0.1137, 0.1130, 0.1136, 0.1136, 0.1130, 0.0000, 0.1135,
         0.1134],
        [0.1133, 0.1136, 0.1141, 0.1138, 0.1138, 0.1136, 0.1139, 0.1135, 0.0000,
         0.1135],
        [0.1135, 0.1133, 0.1137, 0.1135, 0.1138, 0.1136, 0.1134, 0.1134, 0.1135,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0365, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65147114
Epoch495: train_loss: 4.0844 recon_acc: 0.7783 val_roc: 0.7544 val_ap: 0.8234 f1: 0.7050 time: 0.2563
difference_matrix tensor([[0.0000, 0.1132, 0.1136, 0.1133, 0.1134, 0.1137, 0.1132, 0.1133, 0.1133,
         0.1135],
        [0.1132, 0.0000, 0.1135, 0.1131, 0.1132, 0.1135, 0.1131, 0.1130, 0.1136,
         0.1132],
        [0.1136, 0.1135, 0.0000, 0.1136, 0.1140, 0.1136, 0.1133, 0.1137, 0.1140,
         0.1137],
        [0.1133, 0.1131, 0.1136, 0.0000, 0.1137, 0.1139, 0.1133, 0.1130, 0.1138,
         0.1134],
        [0.1134, 0.1132, 0.1140, 0.1137, 0.0000, 0.1133, 0.1139, 0.1135, 0.1138,
         0.1137],
        [0.1137, 0.1135, 0.1136, 0.1139, 0.1133, 0.0000, 0.1138, 0.1136, 0.1136,
         0.1135],
        [0.1132, 0.1131, 0.1133, 0.1133, 0.1139, 0.1138, 0.0000, 0.1129, 0.1138,
         0.1134],
        [0.1133, 0.1130, 0.1137, 0.1130, 0.1135, 0.1136, 0.1129, 0.0000, 0.1134,
         0.1134],
        [0.1133, 0.1136, 0.1140, 0.1138, 0.1138, 0.1136, 0.1138, 0.1134, 0.0000,
         0.1134],
        [0.1135, 0.1132, 0.1137, 0.1134, 0.1137, 0.1135, 0.1134, 0.1134, 0.1134,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0365, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65120995
Epoch496: train_loss: 4.0842 recon_acc: 0.7779 val_roc: 0.7545 val_ap: 0.8236 f1: 0.7050 time: 0.2534
difference_matrix tensor([[0.0000, 0.1132, 0.1136, 0.1133, 0.1134, 0.1137, 0.1131, 0.1133, 0.1132,
         0.1135],
        [0.1132, 0.0000, 0.1135, 0.1131, 0.1132, 0.1135, 0.1130, 0.1129, 0.1135,
         0.1132],
        [0.1136, 0.1135, 0.0000, 0.1136, 0.1140, 0.1136, 0.1133, 0.1137, 0.1140,
         0.1136],
        [0.1133, 0.1131, 0.1136, 0.0000, 0.1137, 0.1139, 0.1133, 0.1129, 0.1137,
         0.1134],
        [0.1134, 0.1132, 0.1140, 0.1137, 0.0000, 0.1133, 0.1138, 0.1135, 0.1138,
         0.1137],
        [0.1137, 0.1135, 0.1136, 0.1139, 0.1133, 0.0000, 0.1137, 0.1135, 0.1135,
         0.1135],
        [0.1131, 0.1130, 0.1133, 0.1133, 0.1138, 0.1137, 0.0000, 0.1129, 0.1138,
         0.1134],
        [0.1133, 0.1129, 0.1137, 0.1129, 0.1135, 0.1135, 0.1129, 0.0000, 0.1134,
         0.1133],
        [0.1132, 0.1135, 0.1140, 0.1137, 0.1138, 0.1135, 0.1138, 0.1134, 0.0000,
         0.1134],
        [0.1135, 0.1132, 0.1136, 0.1134, 0.1137, 0.1135, 0.1134, 0.1133, 0.1134,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0366, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6556522
Epoch497: train_loss: 4.0839 recon_acc: 0.7850 val_roc: 0.7547 val_ap: 0.8238 f1: 0.7053 time: 0.2588
difference_matrix tensor([[0.0000, 0.1131, 0.1136, 0.1133, 0.1133, 0.1136, 0.1131, 0.1132, 0.1132,
         0.1134],
        [0.1131, 0.0000, 0.1135, 0.1131, 0.1131, 0.1134, 0.1130, 0.1129, 0.1135,
         0.1132],
        [0.1136, 0.1135, 0.0000, 0.1135, 0.1139, 0.1135, 0.1132, 0.1136, 0.1140,
         0.1136],
        [0.1133, 0.1131, 0.1135, 0.0000, 0.1136, 0.1138, 0.1132, 0.1129, 0.1137,
         0.1134],
        [0.1133, 0.1131, 0.1139, 0.1136, 0.0000, 0.1133, 0.1138, 0.1135, 0.1137,
         0.1137],
        [0.1136, 0.1134, 0.1135, 0.1138, 0.1133, 0.0000, 0.1137, 0.1135, 0.1135,
         0.1135],
        [0.1131, 0.1130, 0.1132, 0.1132, 0.1138, 0.1137, 0.0000, 0.1128, 0.1138,
         0.1133],
        [0.1132, 0.1129, 0.1136, 0.1129, 0.1135, 0.1135, 0.1128, 0.0000, 0.1134,
         0.1133],
        [0.1132, 0.1135, 0.1140, 0.1137, 0.1137, 0.1135, 0.1138, 0.1134, 0.0000,
         0.1133],
        [0.1134, 0.1132, 0.1136, 0.1134, 0.1137, 0.1135, 0.1133, 0.1133, 0.1133,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0366, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65604705
Epoch498: train_loss: 4.0837 recon_acc: 0.7857 val_roc: 0.7548 val_ap: 0.8239 f1: 0.7070 time: 0.2730
difference_matrix tensor([[0.0000, 0.1131, 0.1135, 0.1132, 0.1133, 0.1136, 0.1131, 0.1132, 0.1131,
         0.1134],
        [0.1131, 0.0000, 0.1134, 0.1130, 0.1131, 0.1134, 0.1130, 0.1128, 0.1135,
         0.1131],
        [0.1135, 0.1134, 0.0000, 0.1135, 0.1139, 0.1135, 0.1132, 0.1136, 0.1139,
         0.1136],
        [0.1132, 0.1130, 0.1135, 0.0000, 0.1136, 0.1138, 0.1132, 0.1129, 0.1137,
         0.1133],
        [0.1133, 0.1131, 0.1139, 0.1136, 0.0000, 0.1132, 0.1137, 0.1134, 0.1137,
         0.1136],
        [0.1136, 0.1134, 0.1135, 0.1138, 0.1132, 0.0000, 0.1137, 0.1134, 0.1135,
         0.1134],
        [0.1131, 0.1130, 0.1132, 0.1132, 0.1137, 0.1137, 0.0000, 0.1128, 0.1137,
         0.1133],
        [0.1132, 0.1128, 0.1136, 0.1129, 0.1134, 0.1134, 0.1128, 0.0000, 0.1133,
         0.1133],
        [0.1131, 0.1135, 0.1139, 0.1137, 0.1137, 0.1135, 0.1137, 0.1133, 0.0000,
         0.1133],
        [0.1134, 0.1131, 0.1136, 0.1133, 0.1136, 0.1134, 0.1133, 0.1133, 0.1133,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0366, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6561852
Epoch499: train_loss: 4.0834 recon_acc: 0.7859 val_roc: 0.7549 val_ap: 0.8240 f1: 0.7070 time: 0.2776
difference_matrix tensor([[0.0000, 0.1130, 0.1135, 0.1132, 0.1133, 0.1135, 0.1130, 0.1132, 0.1131,
         0.1134],
        [0.1130, 0.0000, 0.1134, 0.1130, 0.1131, 0.1134, 0.1129, 0.1128, 0.1134,
         0.1131],
        [0.1135, 0.1134, 0.0000, 0.1134, 0.1139, 0.1135, 0.1132, 0.1136, 0.1139,
         0.1135],
        [0.1132, 0.1130, 0.1134, 0.0000, 0.1135, 0.1138, 0.1132, 0.1128, 0.1136,
         0.1133],
        [0.1133, 0.1131, 0.1139, 0.1135, 0.0000, 0.1132, 0.1137, 0.1134, 0.1136,
         0.1136],
        [0.1135, 0.1134, 0.1135, 0.1138, 0.1132, 0.0000, 0.1136, 0.1134, 0.1134,
         0.1134],
        [0.1130, 0.1129, 0.1132, 0.1132, 0.1137, 0.1136, 0.0000, 0.1128, 0.1137,
         0.1132],
        [0.1132, 0.1128, 0.1136, 0.1128, 0.1134, 0.1134, 0.1128, 0.0000, 0.1133,
         0.1132],
        [0.1131, 0.1134, 0.1139, 0.1136, 0.1136, 0.1134, 0.1137, 0.1133, 0.0000,
         0.1133],
        [0.1134, 0.1131, 0.1135, 0.1133, 0.1136, 0.1134, 0.1132, 0.1132, 0.1133,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0367, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65632254
Epoch500: train_loss: 4.0832 recon_acc: 0.7862 val_roc: 0.7551 val_ap: 0.8242 f1: 0.7070 time: 0.2556
difference_matrix tensor([[0.0000, 0.1130, 0.1135, 0.1132, 0.1132, 0.1135, 0.1130, 0.1131, 0.1131,
         0.1133],
        [0.1130, 0.0000, 0.1134, 0.1129, 0.1130, 0.1133, 0.1129, 0.1128, 0.1134,
         0.1131],
        [0.1135, 0.1134, 0.0000, 0.1134, 0.1138, 0.1134, 0.1131, 0.1135, 0.1139,
         0.1135],
        [0.1132, 0.1129, 0.1134, 0.0000, 0.1135, 0.1137, 0.1131, 0.1128, 0.1136,
         0.1132],
        [0.1132, 0.1130, 0.1138, 0.1135, 0.0000, 0.1132, 0.1137, 0.1134, 0.1136,
         0.1136],
        [0.1135, 0.1133, 0.1134, 0.1137, 0.1132, 0.0000, 0.1136, 0.1134, 0.1134,
         0.1134],
        [0.1130, 0.1129, 0.1131, 0.1131, 0.1137, 0.1136, 0.0000, 0.1127, 0.1137,
         0.1132],
        [0.1131, 0.1128, 0.1135, 0.1128, 0.1134, 0.1134, 0.1127, 0.0000, 0.1132,
         0.1132],
        [0.1131, 0.1134, 0.1139, 0.1136, 0.1136, 0.1134, 0.1137, 0.1132, 0.0000,
         0.1132],
        [0.1133, 0.1131, 0.1135, 0.1132, 0.1136, 0.1134, 0.1132, 0.1132, 0.1132,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0367, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6564591
Epoch501: train_loss: 4.0829 recon_acc: 0.7864 val_roc: 0.7554 val_ap: 0.8243 f1: 0.7070 time: 0.2491
difference_matrix tensor([[0.0000, 0.1130, 0.1134, 0.1131, 0.1132, 0.1135, 0.1130, 0.1131, 0.1130,
         0.1133],
        [0.1130, 0.0000, 0.1133, 0.1129, 0.1130, 0.1133, 0.1128, 0.1127, 0.1134,
         0.1130],
        [0.1134, 0.1133, 0.0000, 0.1134, 0.1138, 0.1134, 0.1131, 0.1135, 0.1138,
         0.1135],
        [0.1131, 0.1129, 0.1134, 0.0000, 0.1135, 0.1137, 0.1131, 0.1128, 0.1136,
         0.1132],
        [0.1132, 0.1130, 0.1138, 0.1135, 0.0000, 0.1131, 0.1136, 0.1133, 0.1136,
         0.1135],
        [0.1135, 0.1133, 0.1134, 0.1137, 0.1131, 0.0000, 0.1136, 0.1133, 0.1134,
         0.1133],
        [0.1130, 0.1128, 0.1131, 0.1131, 0.1136, 0.1136, 0.0000, 0.1127, 0.1136,
         0.1132],
        [0.1131, 0.1127, 0.1135, 0.1128, 0.1133, 0.1133, 0.1127, 0.0000, 0.1132,
         0.1132],
        [0.1130, 0.1134, 0.1138, 0.1136, 0.1136, 0.1134, 0.1136, 0.1132, 0.0000,
         0.1132],
        [0.1133, 0.1130, 0.1135, 0.1132, 0.1135, 0.1133, 0.1132, 0.1132, 0.1132,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0367, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6565949
Epoch502: train_loss: 4.0827 recon_acc: 0.7867 val_roc: 0.7556 val_ap: 0.8245 f1: 0.7070 time: 0.2559
difference_matrix tensor([[0.0000, 0.1129, 0.1134, 0.1131, 0.1132, 0.1134, 0.1129, 0.1131, 0.1130,
         0.1133],
        [0.1129, 0.0000, 0.1133, 0.1129, 0.1130, 0.1133, 0.1128, 0.1127, 0.1133,
         0.1130],
        [0.1134, 0.1133, 0.0000, 0.1133, 0.1138, 0.1134, 0.1131, 0.1135, 0.1138,
         0.1134],
        [0.1131, 0.1129, 0.1133, 0.0000, 0.1134, 0.1137, 0.1131, 0.1127, 0.1135,
         0.1132],
        [0.1132, 0.1130, 0.1138, 0.1134, 0.0000, 0.1131, 0.1136, 0.1133, 0.1135,
         0.1135],
        [0.1134, 0.1133, 0.1134, 0.1137, 0.1131, 0.0000, 0.1135, 0.1133, 0.1133,
         0.1133],
        [0.1129, 0.1128, 0.1131, 0.1131, 0.1136, 0.1135, 0.0000, 0.1127, 0.1136,
         0.1131],
        [0.1131, 0.1127, 0.1135, 0.1127, 0.1133, 0.1133, 0.1127, 0.0000, 0.1132,
         0.1131],
        [0.1130, 0.1133, 0.1138, 0.1135, 0.1135, 0.1133, 0.1136, 0.1132, 0.0000,
         0.1132],
        [0.1133, 0.1130, 0.1134, 0.1132, 0.1135, 0.1133, 0.1131, 0.1131, 0.1132,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0368, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6567115
Epoch503: train_loss: 4.0825 recon_acc: 0.7869 val_roc: 0.7558 val_ap: 0.8248 f1: 0.7070 time: 0.2734
difference_matrix tensor([[0.0000, 0.1129, 0.1134, 0.1131, 0.1131, 0.1134, 0.1129, 0.1130, 0.1130,
         0.1132],
        [0.1129, 0.0000, 0.1133, 0.1128, 0.1129, 0.1132, 0.1128, 0.1127, 0.1133,
         0.1130],
        [0.1134, 0.1133, 0.0000, 0.1133, 0.1137, 0.1133, 0.1130, 0.1134, 0.1138,
         0.1134],
        [0.1131, 0.1128, 0.1133, 0.0000, 0.1134, 0.1136, 0.1130, 0.1127, 0.1135,
         0.1131],
        [0.1131, 0.1129, 0.1137, 0.1134, 0.0000, 0.1130, 0.1136, 0.1133, 0.1135,
         0.1134],
        [0.1134, 0.1132, 0.1133, 0.1136, 0.1130, 0.0000, 0.1135, 0.1133, 0.1133,
         0.1133],
        [0.1129, 0.1128, 0.1130, 0.1130, 0.1136, 0.1135, 0.0000, 0.1126, 0.1136,
         0.1131],
        [0.1130, 0.1127, 0.1134, 0.1127, 0.1133, 0.1133, 0.1126, 0.0000, 0.1131,
         0.1131],
        [0.1130, 0.1133, 0.1138, 0.1135, 0.1135, 0.1133, 0.1136, 0.1131, 0.0000,
         0.1131],
        [0.1132, 0.1130, 0.1134, 0.1131, 0.1134, 0.1133, 0.1131, 0.1131, 0.1131,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0368, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6561502
Epoch504: train_loss: 4.0822 recon_acc: 0.7861 val_roc: 0.7559 val_ap: 0.8249 f1: 0.7070 time: 0.2741
difference_matrix tensor([[0.0000, 0.1129, 0.1133, 0.1130, 0.1131, 0.1134, 0.1129, 0.1130, 0.1129,
         0.1132],
        [0.1129, 0.0000, 0.1132, 0.1128, 0.1129, 0.1132, 0.1127, 0.1126, 0.1133,
         0.1129],
        [0.1133, 0.1132, 0.0000, 0.1133, 0.1137, 0.1133, 0.1130, 0.1134, 0.1137,
         0.1134],
        [0.1130, 0.1128, 0.1133, 0.0000, 0.1134, 0.1136, 0.1130, 0.1127, 0.1135,
         0.1131],
        [0.1131, 0.1129, 0.1137, 0.1134, 0.0000, 0.1130, 0.1135, 0.1132, 0.1135,
         0.1134],
        [0.1134, 0.1132, 0.1133, 0.1136, 0.1130, 0.0000, 0.1135, 0.1132, 0.1133,
         0.1132],
        [0.1129, 0.1127, 0.1130, 0.1130, 0.1135, 0.1135, 0.0000, 0.1126, 0.1135,
         0.1131],
        [0.1130, 0.1126, 0.1134, 0.1127, 0.1132, 0.1132, 0.1126, 0.0000, 0.1131,
         0.1130],
        [0.1129, 0.1133, 0.1137, 0.1135, 0.1135, 0.1133, 0.1135, 0.1131, 0.0000,
         0.1131],
        [0.1132, 0.1129, 0.1134, 0.1131, 0.1134, 0.1132, 0.1131, 0.1130, 0.1131,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0368, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65558934
Epoch505: train_loss: 4.0820 recon_acc: 0.7852 val_roc: 0.7561 val_ap: 0.8251 f1: 0.7070 time: 0.2655
difference_matrix tensor([[0.0000, 0.1128, 0.1133, 0.1130, 0.1131, 0.1133, 0.1128, 0.1130, 0.1129,
         0.1132],
        [0.1128, 0.0000, 0.1132, 0.1128, 0.1129, 0.1132, 0.1127, 0.1126, 0.1132,
         0.1129],
        [0.1133, 0.1132, 0.0000, 0.1133, 0.1136, 0.1133, 0.1130, 0.1133, 0.1137,
         0.1133],
        [0.1130, 0.1128, 0.1133, 0.0000, 0.1133, 0.1136, 0.1130, 0.1126, 0.1134,
         0.1131],
        [0.1131, 0.1129, 0.1136, 0.1133, 0.0000, 0.1130, 0.1135, 0.1132, 0.1134,
         0.1134],
        [0.1133, 0.1132, 0.1133, 0.1136, 0.1130, 0.0000, 0.1134, 0.1132, 0.1132,
         0.1132],
        [0.1128, 0.1127, 0.1130, 0.1130, 0.1135, 0.1134, 0.0000, 0.1126, 0.1135,
         0.1130],
        [0.1130, 0.1126, 0.1134, 0.1126, 0.1132, 0.1132, 0.1126, 0.0000, 0.1131,
         0.1130],
        [0.1129, 0.1132, 0.1137, 0.1134, 0.1134, 0.1132, 0.1135, 0.1131, 0.0000,
         0.1131],
        [0.1132, 0.1129, 0.1133, 0.1131, 0.1134, 0.1132, 0.1130, 0.1130, 0.1131,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0369, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.655029
Epoch506: train_loss: 4.0818 recon_acc: 0.7844 val_roc: 0.7560 val_ap: 0.8250 f1: 0.7070 time: 0.2825
difference_matrix tensor([[0.0000, 0.1128, 0.1133, 0.1129, 0.1130, 0.1133, 0.1128, 0.1129, 0.1129,
         0.1131],
        [0.1128, 0.0000, 0.1132, 0.1127, 0.1128, 0.1131, 0.1127, 0.1126, 0.1132,
         0.1129],
        [0.1133, 0.1132, 0.0000, 0.1132, 0.1136, 0.1132, 0.1129, 0.1133, 0.1137,
         0.1133],
        [0.1129, 0.1127, 0.1132, 0.0000, 0.1133, 0.1135, 0.1129, 0.1126, 0.1134,
         0.1130],
        [0.1130, 0.1128, 0.1136, 0.1133, 0.0000, 0.1129, 0.1135, 0.1131, 0.1134,
         0.1133],
        [0.1133, 0.1131, 0.1132, 0.1135, 0.1129, 0.0000, 0.1134, 0.1132, 0.1132,
         0.1132],
        [0.1128, 0.1127, 0.1129, 0.1129, 0.1135, 0.1134, 0.0000, 0.1125, 0.1134,
         0.1130],
        [0.1129, 0.1126, 0.1133, 0.1126, 0.1131, 0.1132, 0.1125, 0.0000, 0.1130,
         0.1130],
        [0.1129, 0.1132, 0.1137, 0.1134, 0.1134, 0.1132, 0.1134, 0.1130, 0.0000,
         0.1130],
        [0.1131, 0.1129, 0.1133, 0.1130, 0.1133, 0.1132, 0.1130, 0.1130, 0.1130,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0369, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6481481
Epoch507: train_loss: 4.0815 recon_acc: 0.7736 val_roc: 0.7562 val_ap: 0.8251 f1: 0.7064 time: 0.3037
difference_matrix tensor([[0.0000, 0.1128, 0.1132, 0.1129, 0.1130, 0.1133, 0.1128, 0.1129, 0.1128,
         0.1131],
        [0.1128, 0.0000, 0.1131, 0.1127, 0.1128, 0.1131, 0.1126, 0.1125, 0.1132,
         0.1128],
        [0.1132, 0.1131, 0.0000, 0.1132, 0.1136, 0.1132, 0.1129, 0.1133, 0.1136,
         0.1133],
        [0.1129, 0.1127, 0.1132, 0.0000, 0.1133, 0.1135, 0.1129, 0.1126, 0.1134,
         0.1130],
        [0.1130, 0.1128, 0.1136, 0.1133, 0.0000, 0.1129, 0.1134, 0.1131, 0.1134,
         0.1133],
        [0.1133, 0.1131, 0.1132, 0.1135, 0.1129, 0.0000, 0.1134, 0.1131, 0.1132,
         0.1131],
        [0.1128, 0.1126, 0.1129, 0.1129, 0.1134, 0.1134, 0.0000, 0.1125, 0.1134,
         0.1130],
        [0.1129, 0.1125, 0.1133, 0.1126, 0.1131, 0.1131, 0.1125, 0.0000, 0.1130,
         0.1129],
        [0.1128, 0.1132, 0.1136, 0.1134, 0.1134, 0.1132, 0.1134, 0.1130, 0.0000,
         0.1130],
        [0.1131, 0.1128, 0.1133, 0.1130, 0.1133, 0.1131, 0.1130, 0.1129, 0.1130,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0369, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6479145
Epoch508: train_loss: 4.0813 recon_acc: 0.7732 val_roc: 0.7564 val_ap: 0.8253 f1: 0.7064 time: 0.2814
difference_matrix tensor([[0.0000, 0.1127, 0.1132, 0.1129, 0.1130, 0.1132, 0.1127, 0.1129, 0.1128,
         0.1131],
        [0.1127, 0.0000, 0.1131, 0.1127, 0.1128, 0.1131, 0.1126, 0.1125, 0.1131,
         0.1128],
        [0.1132, 0.1131, 0.0000, 0.1132, 0.1135, 0.1132, 0.1129, 0.1133, 0.1136,
         0.1132],
        [0.1129, 0.1127, 0.1132, 0.0000, 0.1132, 0.1135, 0.1129, 0.1125, 0.1133,
         0.1130],
        [0.1130, 0.1128, 0.1135, 0.1132, 0.0000, 0.1129, 0.1134, 0.1131, 0.1133,
         0.1133],
        [0.1132, 0.1131, 0.1132, 0.1135, 0.1129, 0.0000, 0.1133, 0.1131, 0.1131,
         0.1131],
        [0.1127, 0.1126, 0.1129, 0.1129, 0.1134, 0.1133, 0.0000, 0.1125, 0.1134,
         0.1129],
        [0.1129, 0.1125, 0.1133, 0.1125, 0.1131, 0.1131, 0.1125, 0.0000, 0.1130,
         0.1129],
        [0.1128, 0.1131, 0.1136, 0.1133, 0.1133, 0.1131, 0.1134, 0.1130, 0.0000,
         0.1130],
        [0.1131, 0.1128, 0.1132, 0.1130, 0.1133, 0.1131, 0.1129, 0.1129, 0.1130,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0370, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6476265
Epoch509: train_loss: 4.0811 recon_acc: 0.7729 val_roc: 0.7567 val_ap: 0.8256 f1: 0.7064 time: 0.2860
difference_matrix tensor([[0.0000, 0.1127, 0.1132, 0.1128, 0.1129, 0.1132, 0.1127, 0.1128, 0.1128,
         0.1130],
        [0.1127, 0.0000, 0.1131, 0.1126, 0.1127, 0.1130, 0.1126, 0.1125, 0.1131,
         0.1128],
        [0.1132, 0.1131, 0.0000, 0.1131, 0.1135, 0.1131, 0.1128, 0.1132, 0.1136,
         0.1132],
        [0.1128, 0.1126, 0.1131, 0.0000, 0.1132, 0.1134, 0.1128, 0.1125, 0.1133,
         0.1129],
        [0.1129, 0.1127, 0.1135, 0.1132, 0.0000, 0.1128, 0.1134, 0.1130, 0.1133,
         0.1132],
        [0.1132, 0.1130, 0.1131, 0.1134, 0.1128, 0.0000, 0.1133, 0.1131, 0.1131,
         0.1131],
        [0.1127, 0.1126, 0.1128, 0.1128, 0.1134, 0.1133, 0.0000, 0.1124, 0.1133,
         0.1129],
        [0.1128, 0.1125, 0.1132, 0.1125, 0.1130, 0.1131, 0.1124, 0.0000, 0.1130,
         0.1129],
        [0.1128, 0.1131, 0.1136, 0.1133, 0.1133, 0.1131, 0.1133, 0.1130, 0.0000,
         0.1129],
        [0.1130, 0.1128, 0.1132, 0.1129, 0.1132, 0.1131, 0.1129, 0.1129, 0.1129,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0370, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6485581
Epoch510: train_loss: 4.0808 recon_acc: 0.7744 val_roc: 0.7569 val_ap: 0.8257 f1: 0.7067 time: 0.2559
difference_matrix tensor([[0.0000, 0.1127, 0.1131, 0.1128, 0.1129, 0.1132, 0.1127, 0.1128, 0.1127,
         0.1130],
        [0.1127, 0.0000, 0.1130, 0.1126, 0.1127, 0.1130, 0.1125, 0.1124, 0.1131,
         0.1127],
        [0.1131, 0.1130, 0.0000, 0.1131, 0.1135, 0.1131, 0.1128, 0.1132, 0.1135,
         0.1132],
        [0.1128, 0.1126, 0.1131, 0.0000, 0.1132, 0.1134, 0.1128, 0.1125, 0.1133,
         0.1129],
        [0.1129, 0.1127, 0.1135, 0.1132, 0.0000, 0.1128, 0.1133, 0.1130, 0.1133,
         0.1132],
        [0.1132, 0.1130, 0.1131, 0.1134, 0.1128, 0.0000, 0.1133, 0.1130, 0.1131,
         0.1130],
        [0.1127, 0.1125, 0.1128, 0.1128, 0.1133, 0.1133, 0.0000, 0.1124, 0.1133,
         0.1129],
        [0.1128, 0.1124, 0.1132, 0.1125, 0.1130, 0.1130, 0.1124, 0.0000, 0.1129,
         0.1128],
        [0.1127, 0.1131, 0.1135, 0.1133, 0.1133, 0.1131, 0.1133, 0.1129, 0.0000,
         0.1129],
        [0.1130, 0.1127, 0.1132, 0.1129, 0.1132, 0.1130, 0.1129, 0.1128, 0.1129,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0370, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6470441
Epoch511: train_loss: 4.0806 recon_acc: 0.7720 val_roc: 0.7570 val_ap: 0.8258 f1: 0.7081 time: 0.2467
difference_matrix tensor([[0.0000, 0.1126, 0.1131, 0.1128, 0.1129, 0.1132, 0.1126, 0.1128, 0.1127,
         0.1130],
        [0.1126, 0.0000, 0.1130, 0.1126, 0.1127, 0.1130, 0.1125, 0.1124, 0.1130,
         0.1127],
        [0.1131, 0.1130, 0.0000, 0.1131, 0.1134, 0.1131, 0.1128, 0.1132, 0.1135,
         0.1131],
        [0.1128, 0.1126, 0.1131, 0.0000, 0.1131, 0.1134, 0.1128, 0.1124, 0.1132,
         0.1129],
        [0.1129, 0.1127, 0.1134, 0.1131, 0.0000, 0.1128, 0.1133, 0.1130, 0.1132,
         0.1132],
        [0.1132, 0.1130, 0.1131, 0.1134, 0.1128, 0.0000, 0.1132, 0.1130, 0.1130,
         0.1130],
        [0.1126, 0.1125, 0.1128, 0.1128, 0.1133, 0.1132, 0.0000, 0.1124, 0.1133,
         0.1128],
        [0.1128, 0.1124, 0.1132, 0.1124, 0.1130, 0.1130, 0.1124, 0.0000, 0.1129,
         0.1128],
        [0.1127, 0.1130, 0.1135, 0.1132, 0.1132, 0.1130, 0.1133, 0.1129, 0.0000,
         0.1129],
        [0.1130, 0.1127, 0.1131, 0.1129, 0.1132, 0.1130, 0.1128, 0.1128, 0.1129,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0371, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64674985
Epoch512: train_loss: 4.0804 recon_acc: 0.7716 val_roc: 0.7571 val_ap: 0.8259 f1: 0.7081 time: 0.2646
difference_matrix tensor([[0.0000, 0.1126, 0.1131, 0.1128, 0.1128, 0.1131, 0.1126, 0.1127, 0.1127,
         0.1129],
        [0.1126, 0.0000, 0.1130, 0.1126, 0.1126, 0.1129, 0.1125, 0.1124, 0.1130,
         0.1127],
        [0.1131, 0.1130, 0.0000, 0.1130, 0.1134, 0.1130, 0.1127, 0.1131, 0.1135,
         0.1131],
        [0.1128, 0.1126, 0.1130, 0.0000, 0.1131, 0.1134, 0.1127, 0.1124, 0.1132,
         0.1128],
        [0.1128, 0.1126, 0.1134, 0.1131, 0.0000, 0.1127, 0.1133, 0.1130, 0.1132,
         0.1132],
        [0.1131, 0.1129, 0.1130, 0.1134, 0.1127, 0.0000, 0.1132, 0.1130, 0.1130,
         0.1130],
        [0.1126, 0.1125, 0.1127, 0.1127, 0.1133, 0.1132, 0.0000, 0.1123, 0.1132,
         0.1128],
        [0.1127, 0.1124, 0.1131, 0.1124, 0.1130, 0.1130, 0.1123, 0.0000, 0.1129,
         0.1128],
        [0.1127, 0.1130, 0.1135, 0.1132, 0.1132, 0.1130, 0.1132, 0.1129, 0.0000,
         0.1129],
        [0.1129, 0.1127, 0.1131, 0.1128, 0.1132, 0.1130, 0.1128, 0.1128, 0.1129,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0371, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6464535
Epoch513: train_loss: 4.0802 recon_acc: 0.7712 val_roc: 0.7571 val_ap: 0.8260 f1: 0.7081 time: 0.2465
difference_matrix tensor([[0.0000, 0.1126, 0.1130, 0.1127, 0.1128, 0.1131, 0.1126, 0.1127, 0.1127,
         0.1129],
        [0.1126, 0.0000, 0.1129, 0.1125, 0.1126, 0.1129, 0.1124, 0.1123, 0.1130,
         0.1126],
        [0.1130, 0.1129, 0.0000, 0.1130, 0.1134, 0.1130, 0.1127, 0.1131, 0.1134,
         0.1131],
        [0.1127, 0.1125, 0.1130, 0.0000, 0.1131, 0.1133, 0.1127, 0.1124, 0.1132,
         0.1128],
        [0.1128, 0.1126, 0.1134, 0.1131, 0.0000, 0.1127, 0.1132, 0.1129, 0.1132,
         0.1131],
        [0.1131, 0.1129, 0.1130, 0.1133, 0.1127, 0.0000, 0.1132, 0.1129, 0.1130,
         0.1129],
        [0.1126, 0.1124, 0.1127, 0.1127, 0.1132, 0.1132, 0.0000, 0.1123, 0.1132,
         0.1128],
        [0.1127, 0.1123, 0.1131, 0.1124, 0.1129, 0.1129, 0.1123, 0.0000, 0.1128,
         0.1127],
        [0.1127, 0.1130, 0.1134, 0.1132, 0.1132, 0.1130, 0.1132, 0.1128, 0.0000,
         0.1128],
        [0.1129, 0.1126, 0.1131, 0.1128, 0.1131, 0.1129, 0.1128, 0.1127, 0.1128,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0371, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6461551
Epoch514: train_loss: 4.0800 recon_acc: 0.7707 val_roc: 0.7572 val_ap: 0.8261 f1: 0.7081 time: 0.2508
difference_matrix tensor([[0.0000, 0.1126, 0.1130, 0.1127, 0.1128, 0.1131, 0.1125, 0.1127, 0.1126,
         0.1129],
        [0.1126, 0.0000, 0.1129, 0.1125, 0.1126, 0.1129, 0.1124, 0.1123, 0.1129,
         0.1126],
        [0.1130, 0.1129, 0.0000, 0.1130, 0.1133, 0.1130, 0.1127, 0.1131, 0.1134,
         0.1131],
        [0.1127, 0.1125, 0.1130, 0.0000, 0.1130, 0.1133, 0.1127, 0.1123, 0.1131,
         0.1128],
        [0.1128, 0.1126, 0.1133, 0.1130, 0.0000, 0.1127, 0.1132, 0.1129, 0.1131,
         0.1131],
        [0.1131, 0.1129, 0.1130, 0.1133, 0.1127, 0.0000, 0.1131, 0.1129, 0.1129,
         0.1129],
        [0.1125, 0.1124, 0.1127, 0.1127, 0.1132, 0.1131, 0.0000, 0.1123, 0.1132,
         0.1127],
        [0.1127, 0.1123, 0.1131, 0.1123, 0.1129, 0.1129, 0.1123, 0.0000, 0.1128,
         0.1127],
        [0.1126, 0.1129, 0.1134, 0.1131, 0.1131, 0.1129, 0.1132, 0.1128, 0.0000,
         0.1128],
        [0.1129, 0.1126, 0.1131, 0.1128, 0.1131, 0.1129, 0.1127, 0.1127, 0.1128,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0372, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64535797
Epoch515: train_loss: 4.0797 recon_acc: 0.7695 val_roc: 0.7573 val_ap: 0.8262 f1: 0.7078 time: 0.2830
difference_matrix tensor([[0.0000, 0.1125, 0.1130, 0.1127, 0.1127, 0.1130, 0.1125, 0.1127, 0.1126,
         0.1128],
        [0.1125, 0.0000, 0.1129, 0.1125, 0.1125, 0.1129, 0.1124, 0.1123, 0.1129,
         0.1126],
        [0.1130, 0.1129, 0.0000, 0.1129, 0.1133, 0.1129, 0.1126, 0.1130, 0.1134,
         0.1130],
        [0.1127, 0.1125, 0.1129, 0.0000, 0.1130, 0.1133, 0.1126, 0.1123, 0.1131,
         0.1128],
        [0.1127, 0.1125, 0.1133, 0.1130, 0.0000, 0.1126, 0.1132, 0.1129, 0.1131,
         0.1131],
        [0.1130, 0.1129, 0.1129, 0.1133, 0.1126, 0.0000, 0.1131, 0.1129, 0.1129,
         0.1129],
        [0.1125, 0.1124, 0.1126, 0.1126, 0.1132, 0.1131, 0.0000, 0.1122, 0.1132,
         0.1127],
        [0.1127, 0.1123, 0.1130, 0.1123, 0.1129, 0.1129, 0.1122, 0.0000, 0.1128,
         0.1127],
        [0.1126, 0.1129, 0.1134, 0.1131, 0.1131, 0.1129, 0.1132, 0.1128, 0.0000,
         0.1128],
        [0.1128, 0.1126, 0.1130, 0.1128, 0.1131, 0.1129, 0.1127, 0.1127, 0.1128,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0372, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64552444
Epoch516: train_loss: 4.0795 recon_acc: 0.7698 val_roc: 0.7574 val_ap: 0.8263 f1: 0.7095 time: 0.2655
difference_matrix tensor([[0.0000, 0.1125, 0.1129, 0.1126, 0.1127, 0.1130, 0.1125, 0.1126, 0.1126,
         0.1128],
        [0.1125, 0.0000, 0.1129, 0.1124, 0.1125, 0.1128, 0.1123, 0.1122, 0.1129,
         0.1125],
        [0.1129, 0.1129, 0.0000, 0.1129, 0.1133, 0.1129, 0.1126, 0.1130, 0.1133,
         0.1130],
        [0.1126, 0.1124, 0.1129, 0.0000, 0.1130, 0.1132, 0.1126, 0.1123, 0.1131,
         0.1127],
        [0.1127, 0.1125, 0.1133, 0.1130, 0.0000, 0.1126, 0.1131, 0.1128, 0.1131,
         0.1130],
        [0.1130, 0.1128, 0.1129, 0.1132, 0.1126, 0.0000, 0.1131, 0.1128, 0.1129,
         0.1128],
        [0.1125, 0.1123, 0.1126, 0.1126, 0.1131, 0.1131, 0.0000, 0.1122, 0.1131,
         0.1127],
        [0.1126, 0.1122, 0.1130, 0.1123, 0.1128, 0.1128, 0.1122, 0.0000, 0.1127,
         0.1127],
        [0.1126, 0.1129, 0.1133, 0.1131, 0.1131, 0.1129, 0.1131, 0.1127, 0.0000,
         0.1127],
        [0.1128, 0.1125, 0.1130, 0.1127, 0.1130, 0.1128, 0.1127, 0.1127, 0.1127,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0372, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64524734
Epoch517: train_loss: 4.0793 recon_acc: 0.7694 val_roc: 0.7575 val_ap: 0.8264 f1: 0.7095 time: 0.3244
difference_matrix tensor([[0.0000, 0.1125, 0.1129, 0.1126, 0.1127, 0.1130, 0.1124, 0.1126, 0.1125,
         0.1128],
        [0.1125, 0.0000, 0.1128, 0.1124, 0.1125, 0.1128, 0.1123, 0.1122, 0.1129,
         0.1125],
        [0.1129, 0.1128, 0.0000, 0.1129, 0.1133, 0.1129, 0.1126, 0.1130, 0.1133,
         0.1130],
        [0.1126, 0.1124, 0.1129, 0.0000, 0.1130, 0.1132, 0.1126, 0.1122, 0.1130,
         0.1127],
        [0.1127, 0.1125, 0.1133, 0.1130, 0.0000, 0.1126, 0.1131, 0.1128, 0.1131,
         0.1130],
        [0.1130, 0.1128, 0.1129, 0.1132, 0.1126, 0.0000, 0.1131, 0.1128, 0.1128,
         0.1128],
        [0.1124, 0.1123, 0.1126, 0.1126, 0.1131, 0.1131, 0.0000, 0.1122, 0.1131,
         0.1127],
        [0.1126, 0.1122, 0.1130, 0.1122, 0.1128, 0.1128, 0.1122, 0.0000, 0.1127,
         0.1126],
        [0.1125, 0.1129, 0.1133, 0.1130, 0.1131, 0.1128, 0.1131, 0.1127, 0.0000,
         0.1127],
        [0.1128, 0.1125, 0.1130, 0.1127, 0.1130, 0.1128, 0.1127, 0.1126, 0.1127,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0372, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6449407
Epoch518: train_loss: 4.0791 recon_acc: 0.7690 val_roc: 0.7577 val_ap: 0.8266 f1: 0.7095 time: 0.2999
difference_matrix tensor([[0.0000, 0.1124, 0.1129, 0.1126, 0.1126, 0.1129, 0.1124, 0.1126, 0.1125,
         0.1128],
        [0.1124, 0.0000, 0.1128, 0.1124, 0.1124, 0.1128, 0.1123, 0.1122, 0.1128,
         0.1125],
        [0.1129, 0.1128, 0.0000, 0.1129, 0.1132, 0.1128, 0.1125, 0.1129, 0.1133,
         0.1129],
        [0.1126, 0.1124, 0.1129, 0.0000, 0.1129, 0.1132, 0.1126, 0.1122, 0.1130,
         0.1127],
        [0.1126, 0.1124, 0.1132, 0.1129, 0.0000, 0.1125, 0.1131, 0.1128, 0.1130,
         0.1130],
        [0.1129, 0.1128, 0.1128, 0.1132, 0.1125, 0.0000, 0.1130, 0.1128, 0.1128,
         0.1128],
        [0.1124, 0.1123, 0.1125, 0.1125, 0.1131, 0.1130, 0.0000, 0.1121, 0.1131,
         0.1126],
        [0.1126, 0.1122, 0.1129, 0.1122, 0.1128, 0.1128, 0.1121, 0.0000, 0.1127,
         0.1126],
        [0.1125, 0.1128, 0.1133, 0.1130, 0.1130, 0.1128, 0.1131, 0.1127, 0.0000,
         0.1127],
        [0.1128, 0.1125, 0.1129, 0.1127, 0.1130, 0.1128, 0.1126, 0.1126, 0.1127,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0373, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64463186
Epoch519: train_loss: 4.0789 recon_acc: 0.7685 val_roc: 0.7578 val_ap: 0.8267 f1: 0.7095 time: 0.2506
difference_matrix tensor([[0.0000, 0.1124, 0.1129, 0.1125, 0.1126, 0.1129, 0.1124, 0.1125, 0.1125,
         0.1127],
        [0.1124, 0.0000, 0.1128, 0.1123, 0.1124, 0.1127, 0.1122, 0.1121, 0.1128,
         0.1124],
        [0.1129, 0.1128, 0.0000, 0.1128, 0.1132, 0.1128, 0.1125, 0.1129, 0.1132,
         0.1129],
        [0.1125, 0.1123, 0.1128, 0.0000, 0.1129, 0.1131, 0.1125, 0.1122, 0.1130,
         0.1126],
        [0.1126, 0.1124, 0.1132, 0.1129, 0.0000, 0.1125, 0.1131, 0.1127, 0.1130,
         0.1129],
        [0.1129, 0.1127, 0.1128, 0.1131, 0.1125, 0.0000, 0.1130, 0.1128, 0.1128,
         0.1127],
        [0.1124, 0.1122, 0.1125, 0.1125, 0.1131, 0.1130, 0.0000, 0.1121, 0.1130,
         0.1126],
        [0.1125, 0.1121, 0.1129, 0.1122, 0.1127, 0.1128, 0.1121, 0.0000, 0.1126,
         0.1126],
        [0.1125, 0.1128, 0.1132, 0.1130, 0.1130, 0.1128, 0.1130, 0.1126, 0.0000,
         0.1126],
        [0.1127, 0.1124, 0.1129, 0.1126, 0.1129, 0.1127, 0.1126, 0.1126, 0.1126,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0373, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6443211
Epoch520: train_loss: 4.0787 recon_acc: 0.7681 val_roc: 0.7581 val_ap: 0.8269 f1: 0.7095 time: 0.2491
difference_matrix tensor([[0.0000, 0.1124, 0.1128, 0.1125, 0.1126, 0.1129, 0.1123, 0.1125, 0.1124,
         0.1127],
        [0.1124, 0.0000, 0.1127, 0.1123, 0.1124, 0.1127, 0.1122, 0.1121, 0.1128,
         0.1124],
        [0.1128, 0.1127, 0.0000, 0.1128, 0.1132, 0.1128, 0.1125, 0.1129, 0.1132,
         0.1129],
        [0.1125, 0.1123, 0.1128, 0.0000, 0.1129, 0.1131, 0.1125, 0.1121, 0.1130,
         0.1126],
        [0.1126, 0.1124, 0.1132, 0.1129, 0.0000, 0.1125, 0.1130, 0.1127, 0.1130,
         0.1129],
        [0.1129, 0.1127, 0.1128, 0.1131, 0.1125, 0.0000, 0.1130, 0.1127, 0.1128,
         0.1127],
        [0.1123, 0.1122, 0.1125, 0.1125, 0.1130, 0.1130, 0.0000, 0.1121, 0.1130,
         0.1126],
        [0.1125, 0.1121, 0.1129, 0.1121, 0.1127, 0.1127, 0.1121, 0.0000, 0.1126,
         0.1125],
        [0.1124, 0.1128, 0.1132, 0.1130, 0.1130, 0.1128, 0.1130, 0.1126, 0.0000,
         0.1126],
        [0.1127, 0.1124, 0.1129, 0.1126, 0.1129, 0.1127, 0.1126, 0.1125, 0.1126,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0373, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64400816
Epoch521: train_loss: 4.0785 recon_acc: 0.7676 val_roc: 0.7582 val_ap: 0.8270 f1: 0.7078 time: 0.2558
difference_matrix tensor([[0.0000, 0.1123, 0.1128, 0.1125, 0.1126, 0.1128, 0.1123, 0.1125, 0.1124,
         0.1127],
        [0.1123, 0.0000, 0.1127, 0.1123, 0.1124, 0.1127, 0.1122, 0.1121, 0.1127,
         0.1124],
        [0.1128, 0.1127, 0.0000, 0.1128, 0.1131, 0.1127, 0.1124, 0.1129, 0.1132,
         0.1128],
        [0.1125, 0.1123, 0.1128, 0.0000, 0.1128, 0.1131, 0.1125, 0.1121, 0.1129,
         0.1126],
        [0.1126, 0.1124, 0.1131, 0.1128, 0.0000, 0.1125, 0.1130, 0.1127, 0.1129,
         0.1129],
        [0.1128, 0.1127, 0.1127, 0.1131, 0.1125, 0.0000, 0.1129, 0.1127, 0.1127,
         0.1127],
        [0.1123, 0.1122, 0.1124, 0.1125, 0.1130, 0.1129, 0.0000, 0.1120, 0.1130,
         0.1125],
        [0.1125, 0.1121, 0.1129, 0.1121, 0.1127, 0.1127, 0.1120, 0.0000, 0.1126,
         0.1125],
        [0.1124, 0.1127, 0.1132, 0.1129, 0.1129, 0.1127, 0.1130, 0.1126, 0.0000,
         0.1126],
        [0.1127, 0.1124, 0.1128, 0.1126, 0.1129, 0.1127, 0.1125, 0.1125, 0.1126,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0374, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64369315
Epoch522: train_loss: 4.0783 recon_acc: 0.7671 val_roc: 0.7583 val_ap: 0.8271 f1: 0.7078 time: 0.2782
difference_matrix tensor([[0.0000, 0.1123, 0.1128, 0.1124, 0.1125, 0.1128, 0.1123, 0.1124, 0.1124,
         0.1126],
        [0.1123, 0.0000, 0.1127, 0.1122, 0.1123, 0.1127, 0.1122, 0.1121, 0.1127,
         0.1123],
        [0.1128, 0.1127, 0.0000, 0.1127, 0.1131, 0.1127, 0.1124, 0.1128, 0.1132,
         0.1128],
        [0.1124, 0.1122, 0.1127, 0.0000, 0.1128, 0.1131, 0.1124, 0.1121, 0.1129,
         0.1125],
        [0.1125, 0.1123, 0.1131, 0.1128, 0.0000, 0.1124, 0.1130, 0.1126, 0.1129,
         0.1128],
        [0.1128, 0.1127, 0.1127, 0.1131, 0.1124, 0.0000, 0.1129, 0.1127, 0.1127,
         0.1126],
        [0.1123, 0.1122, 0.1124, 0.1124, 0.1130, 0.1129, 0.0000, 0.1120, 0.1129,
         0.1125],
        [0.1124, 0.1121, 0.1128, 0.1121, 0.1126, 0.1127, 0.1120, 0.0000, 0.1126,
         0.1125],
        [0.1124, 0.1127, 0.1132, 0.1129, 0.1129, 0.1127, 0.1129, 0.1126, 0.0000,
         0.1126],
        [0.1126, 0.1123, 0.1128, 0.1125, 0.1128, 0.1126, 0.1125, 0.1125, 0.1126,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0374, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6433762
Epoch523: train_loss: 4.0781 recon_acc: 0.7667 val_roc: 0.7584 val_ap: 0.8272 f1: 0.7078 time: 0.2678
difference_matrix tensor([[0.0000, 0.1123, 0.1127, 0.1124, 0.1125, 0.1128, 0.1123, 0.1124, 0.1124,
         0.1126],
        [0.1123, 0.0000, 0.1127, 0.1122, 0.1123, 0.1126, 0.1121, 0.1120, 0.1127,
         0.1123],
        [0.1127, 0.1127, 0.0000, 0.1127, 0.1131, 0.1127, 0.1124, 0.1128, 0.1131,
         0.1128],
        [0.1124, 0.1122, 0.1127, 0.0000, 0.1128, 0.1130, 0.1124, 0.1121, 0.1129,
         0.1125],
        [0.1125, 0.1123, 0.1131, 0.1128, 0.0000, 0.1124, 0.1129, 0.1126, 0.1129,
         0.1128],
        [0.1128, 0.1126, 0.1127, 0.1130, 0.1124, 0.0000, 0.1129, 0.1126, 0.1127,
         0.1126],
        [0.1123, 0.1121, 0.1124, 0.1124, 0.1129, 0.1129, 0.0000, 0.1120, 0.1129,
         0.1125],
        [0.1124, 0.1120, 0.1128, 0.1121, 0.1126, 0.1126, 0.1120, 0.0000, 0.1125,
         0.1124],
        [0.1124, 0.1127, 0.1131, 0.1129, 0.1129, 0.1127, 0.1129, 0.1125, 0.0000,
         0.1125],
        [0.1126, 0.1123, 0.1128, 0.1125, 0.1128, 0.1126, 0.1125, 0.1124, 0.1125,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0374, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6467681
Epoch524: train_loss: 4.0779 recon_acc: 0.7722 val_roc: 0.7586 val_ap: 0.8274 f1: 0.7067 time: 0.2753
difference_matrix tensor([[0.0000, 0.1123, 0.1127, 0.1124, 0.1125, 0.1128, 0.1122, 0.1124, 0.1123,
         0.1126],
        [0.1123, 0.0000, 0.1126, 0.1122, 0.1123, 0.1126, 0.1121, 0.1120, 0.1127,
         0.1123],
        [0.1127, 0.1126, 0.0000, 0.1127, 0.1130, 0.1126, 0.1123, 0.1128, 0.1131,
         0.1128],
        [0.1124, 0.1122, 0.1127, 0.0000, 0.1127, 0.1130, 0.1124, 0.1120, 0.1128,
         0.1125],
        [0.1125, 0.1123, 0.1130, 0.1127, 0.0000, 0.1124, 0.1129, 0.1126, 0.1129,
         0.1128],
        [0.1128, 0.1126, 0.1126, 0.1130, 0.1124, 0.0000, 0.1129, 0.1126, 0.1126,
         0.1126],
        [0.1122, 0.1121, 0.1123, 0.1124, 0.1129, 0.1129, 0.0000, 0.1120, 0.1129,
         0.1124],
        [0.1124, 0.1120, 0.1128, 0.1120, 0.1126, 0.1126, 0.1120, 0.0000, 0.1125,
         0.1124],
        [0.1123, 0.1127, 0.1131, 0.1128, 0.1129, 0.1126, 0.1129, 0.1125, 0.0000,
         0.1125],
        [0.1126, 0.1123, 0.1128, 0.1125, 0.1128, 0.1126, 0.1124, 0.1124, 0.1125,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0375, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6469126
Epoch525: train_loss: 4.0777 recon_acc: 0.7725 val_roc: 0.7587 val_ap: 0.8274 f1: 0.7067 time: 0.2795
difference_matrix tensor([[0.0000, 0.1122, 0.1127, 0.1124, 0.1124, 0.1127, 0.1122, 0.1124, 0.1123,
         0.1126],
        [0.1122, 0.0000, 0.1126, 0.1122, 0.1122, 0.1126, 0.1121, 0.1120, 0.1126,
         0.1123],
        [0.1127, 0.1126, 0.0000, 0.1127, 0.1130, 0.1126, 0.1123, 0.1127, 0.1131,
         0.1127],
        [0.1124, 0.1122, 0.1127, 0.0000, 0.1127, 0.1130, 0.1123, 0.1120, 0.1128,
         0.1125],
        [0.1124, 0.1122, 0.1130, 0.1127, 0.0000, 0.1123, 0.1129, 0.1126, 0.1128,
         0.1128],
        [0.1127, 0.1126, 0.1126, 0.1130, 0.1123, 0.0000, 0.1128, 0.1126, 0.1126,
         0.1126],
        [0.1122, 0.1121, 0.1123, 0.1123, 0.1129, 0.1128, 0.0000, 0.1119, 0.1128,
         0.1124],
        [0.1124, 0.1120, 0.1127, 0.1120, 0.1126, 0.1126, 0.1119, 0.0000, 0.1125,
         0.1124],
        [0.1123, 0.1126, 0.1131, 0.1128, 0.1128, 0.1126, 0.1128, 0.1125, 0.0000,
         0.1125],
        [0.1126, 0.1123, 0.1127, 0.1125, 0.1128, 0.1126, 0.1124, 0.1124, 0.1125,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0375, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64705473
Epoch526: train_loss: 4.0775 recon_acc: 0.7727 val_roc: 0.7588 val_ap: 0.8276 f1: 0.7067 time: 0.2735
difference_matrix tensor([[0.0000, 0.1122, 0.1127, 0.1123, 0.1124, 0.1127, 0.1122, 0.1123, 0.1123,
         0.1125],
        [0.1122, 0.0000, 0.1126, 0.1121, 0.1122, 0.1125, 0.1120, 0.1119, 0.1126,
         0.1122],
        [0.1127, 0.1126, 0.0000, 0.1126, 0.1130, 0.1126, 0.1123, 0.1127, 0.1130,
         0.1127],
        [0.1123, 0.1121, 0.1126, 0.0000, 0.1127, 0.1129, 0.1123, 0.1120, 0.1128,
         0.1124],
        [0.1124, 0.1122, 0.1130, 0.1127, 0.0000, 0.1123, 0.1129, 0.1125, 0.1128,
         0.1127],
        [0.1127, 0.1125, 0.1126, 0.1129, 0.1123, 0.0000, 0.1128, 0.1125, 0.1126,
         0.1125],
        [0.1122, 0.1120, 0.1123, 0.1123, 0.1129, 0.1128, 0.0000, 0.1119, 0.1128,
         0.1124],
        [0.1123, 0.1119, 0.1127, 0.1120, 0.1125, 0.1125, 0.1119, 0.0000, 0.1124,
         0.1124],
        [0.1123, 0.1126, 0.1130, 0.1128, 0.1128, 0.1126, 0.1128, 0.1124, 0.0000,
         0.1124],
        [0.1125, 0.1122, 0.1127, 0.1124, 0.1127, 0.1125, 0.1124, 0.1124, 0.1124,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0375, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6924923
Epoch527: train_loss: 4.0773 recon_acc: 0.8409 val_roc: 0.7590 val_ap: 0.8278 f1: 0.7077 time: 0.2574
difference_matrix tensor([[0.0000, 0.1122, 0.1126, 0.1123, 0.1124, 0.1127, 0.1121, 0.1123, 0.1122,
         0.1125],
        [0.1122, 0.0000, 0.1125, 0.1121, 0.1122, 0.1125, 0.1120, 0.1119, 0.1126,
         0.1122],
        [0.1126, 0.1125, 0.0000, 0.1126, 0.1130, 0.1126, 0.1123, 0.1127, 0.1130,
         0.1127],
        [0.1123, 0.1121, 0.1126, 0.0000, 0.1127, 0.1129, 0.1123, 0.1119, 0.1128,
         0.1124],
        [0.1124, 0.1122, 0.1130, 0.1127, 0.0000, 0.1123, 0.1128, 0.1125, 0.1128,
         0.1127],
        [0.1127, 0.1125, 0.1126, 0.1129, 0.1123, 0.0000, 0.1128, 0.1125, 0.1126,
         0.1125],
        [0.1121, 0.1120, 0.1123, 0.1123, 0.1128, 0.1128, 0.0000, 0.1119, 0.1128,
         0.1124],
        [0.1123, 0.1119, 0.1127, 0.1119, 0.1125, 0.1125, 0.1119, 0.0000, 0.1124,
         0.1123],
        [0.1122, 0.1126, 0.1130, 0.1128, 0.1128, 0.1126, 0.1128, 0.1124, 0.0000,
         0.1124],
        [0.1125, 0.1122, 0.1127, 0.1124, 0.1127, 0.1125, 0.1124, 0.1123, 0.1124,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0375, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.62052417
Epoch528: train_loss: 4.0771 recon_acc: 0.7289 val_roc: 0.7591 val_ap: 0.8278 f1: 0.7080 time: 0.2535
difference_matrix tensor([[0.0000, 0.1121, 0.1126, 0.1123, 0.1124, 0.1126, 0.1121, 0.1123, 0.1122,
         0.1125],
        [0.1121, 0.0000, 0.1125, 0.1121, 0.1122, 0.1125, 0.1120, 0.1119, 0.1125,
         0.1122],
        [0.1126, 0.1125, 0.0000, 0.1126, 0.1129, 0.1125, 0.1122, 0.1127, 0.1130,
         0.1126],
        [0.1123, 0.1121, 0.1126, 0.0000, 0.1126, 0.1129, 0.1123, 0.1119, 0.1127,
         0.1124],
        [0.1124, 0.1122, 0.1129, 0.1126, 0.0000, 0.1122, 0.1128, 0.1125, 0.1127,
         0.1127],
        [0.1127, 0.1125, 0.1125, 0.1129, 0.1122, 0.0000, 0.1127, 0.1125, 0.1125,
         0.1125],
        [0.1121, 0.1120, 0.1122, 0.1123, 0.1128, 0.1127, 0.0000, 0.1118, 0.1128,
         0.1123],
        [0.1123, 0.1119, 0.1127, 0.1119, 0.1125, 0.1125, 0.1118, 0.0000, 0.1124,
         0.1123],
        [0.1122, 0.1125, 0.1130, 0.1127, 0.1127, 0.1125, 0.1128, 0.1124, 0.0000,
         0.1124],
        [0.1125, 0.1122, 0.1126, 0.1124, 0.1127, 0.1125, 0.1123, 0.1123, 0.1124,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0376, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6209583
Epoch529: train_loss: 4.0769 recon_acc: 0.7296 val_roc: 0.7592 val_ap: 0.8280 f1: 0.7080 time: 0.2598
difference_matrix tensor([[0.0000, 0.1121, 0.1126, 0.1122, 0.1123, 0.1126, 0.1121, 0.1122, 0.1122,
         0.1124],
        [0.1121, 0.0000, 0.1125, 0.1120, 0.1121, 0.1125, 0.1119, 0.1119, 0.1125,
         0.1121],
        [0.1126, 0.1125, 0.0000, 0.1126, 0.1129, 0.1125, 0.1122, 0.1126, 0.1130,
         0.1126],
        [0.1122, 0.1120, 0.1126, 0.0000, 0.1126, 0.1129, 0.1122, 0.1119, 0.1127,
         0.1123],
        [0.1123, 0.1121, 0.1129, 0.1126, 0.0000, 0.1122, 0.1128, 0.1124, 0.1127,
         0.1126],
        [0.1126, 0.1125, 0.1125, 0.1129, 0.1122, 0.0000, 0.1127, 0.1125, 0.1125,
         0.1124],
        [0.1121, 0.1119, 0.1122, 0.1122, 0.1128, 0.1127, 0.0000, 0.1118, 0.1127,
         0.1123],
        [0.1122, 0.1119, 0.1126, 0.1119, 0.1124, 0.1125, 0.1118, 0.0000, 0.1124,
         0.1123],
        [0.1122, 0.1125, 0.1130, 0.1127, 0.1127, 0.1125, 0.1127, 0.1124, 0.0000,
         0.1124],
        [0.1124, 0.1121, 0.1126, 0.1123, 0.1126, 0.1124, 0.1123, 0.1123, 0.1124,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0376, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.62100935
Epoch530: train_loss: 4.0767 recon_acc: 0.7298 val_roc: 0.7593 val_ap: 0.8280 f1: 0.7080 time: 0.2568
difference_matrix tensor([[0.0000, 0.1121, 0.1125, 0.1122, 0.1123, 0.1126, 0.1121, 0.1122, 0.1122,
         0.1124],
        [0.1121, 0.0000, 0.1125, 0.1120, 0.1121, 0.1124, 0.1119, 0.1118, 0.1125,
         0.1121],
        [0.1125, 0.1125, 0.0000, 0.1125, 0.1129, 0.1125, 0.1122, 0.1126, 0.1129,
         0.1126],
        [0.1122, 0.1120, 0.1125, 0.0000, 0.1126, 0.1128, 0.1122, 0.1119, 0.1127,
         0.1123],
        [0.1123, 0.1121, 0.1129, 0.1126, 0.0000, 0.1122, 0.1127, 0.1124, 0.1127,
         0.1126],
        [0.1126, 0.1124, 0.1125, 0.1128, 0.1122, 0.0000, 0.1127, 0.1124, 0.1125,
         0.1124],
        [0.1121, 0.1119, 0.1122, 0.1122, 0.1127, 0.1127, 0.0000, 0.1118, 0.1127,
         0.1123],
        [0.1122, 0.1118, 0.1126, 0.1119, 0.1124, 0.1124, 0.1118, 0.0000, 0.1123,
         0.1122],
        [0.1122, 0.1125, 0.1129, 0.1127, 0.1127, 0.1125, 0.1127, 0.1123, 0.0000,
         0.1123],
        [0.1124, 0.1121, 0.1126, 0.1123, 0.1126, 0.1124, 0.1123, 0.1122, 0.1123,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0376, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6206577
Epoch531: train_loss: 4.0765 recon_acc: 0.7292 val_roc: 0.7593 val_ap: 0.8281 f1: 0.7080 time: 0.2521
difference_matrix tensor([[0.0000, 0.1121, 0.1125, 0.1122, 0.1123, 0.1126, 0.1120, 0.1122, 0.1121,
         0.1124],
        [0.1121, 0.0000, 0.1124, 0.1120, 0.1121, 0.1124, 0.1119, 0.1118, 0.1125,
         0.1121],
        [0.1125, 0.1124, 0.0000, 0.1125, 0.1128, 0.1124, 0.1121, 0.1126, 0.1129,
         0.1126],
        [0.1122, 0.1120, 0.1125, 0.0000, 0.1125, 0.1128, 0.1122, 0.1118, 0.1126,
         0.1123],
        [0.1123, 0.1121, 0.1128, 0.1125, 0.0000, 0.1122, 0.1127, 0.1124, 0.1127,
         0.1126],
        [0.1126, 0.1124, 0.1124, 0.1128, 0.1122, 0.0000, 0.1127, 0.1124, 0.1125,
         0.1124],
        [0.1120, 0.1119, 0.1121, 0.1122, 0.1127, 0.1127, 0.0000, 0.1118, 0.1127,
         0.1122],
        [0.1122, 0.1118, 0.1126, 0.1118, 0.1124, 0.1124, 0.1118, 0.0000, 0.1123,
         0.1122],
        [0.1121, 0.1125, 0.1129, 0.1126, 0.1127, 0.1125, 0.1127, 0.1123, 0.0000,
         0.1123],
        [0.1124, 0.1121, 0.1126, 0.1123, 0.1126, 0.1124, 0.1122, 0.1122, 0.1123,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0377, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.62030554
Epoch532: train_loss: 4.0763 recon_acc: 0.7287 val_roc: 0.7595 val_ap: 0.8282 f1: 0.7080 time: 0.2603
difference_matrix tensor([[0.0000, 0.1120, 0.1125, 0.1122, 0.1122, 0.1125, 0.1120, 0.1122, 0.1121,
         0.1124],
        [0.1120, 0.0000, 0.1124, 0.1120, 0.1120, 0.1124, 0.1119, 0.1118, 0.1124,
         0.1121],
        [0.1125, 0.1124, 0.0000, 0.1125, 0.1128, 0.1124, 0.1121, 0.1126, 0.1129,
         0.1125],
        [0.1122, 0.1120, 0.1125, 0.0000, 0.1125, 0.1128, 0.1121, 0.1118, 0.1126,
         0.1123],
        [0.1122, 0.1120, 0.1128, 0.1125, 0.0000, 0.1121, 0.1127, 0.1124, 0.1126,
         0.1126],
        [0.1125, 0.1124, 0.1124, 0.1128, 0.1121, 0.0000, 0.1126, 0.1124, 0.1124,
         0.1124],
        [0.1120, 0.1119, 0.1121, 0.1121, 0.1127, 0.1126, 0.0000, 0.1117, 0.1126,
         0.1122],
        [0.1122, 0.1118, 0.1126, 0.1118, 0.1124, 0.1124, 0.1117, 0.0000, 0.1123,
         0.1122],
        [0.1121, 0.1124, 0.1129, 0.1126, 0.1126, 0.1124, 0.1126, 0.1123, 0.0000,
         0.1123],
        [0.1124, 0.1121, 0.1125, 0.1123, 0.1126, 0.1124, 0.1122, 0.1122, 0.1123,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0377, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6199529
Epoch533: train_loss: 4.0761 recon_acc: 0.7281 val_roc: 0.7596 val_ap: 0.8281 f1: 0.7080 time: 0.2554
difference_matrix tensor([[0.0000, 0.1120, 0.1125, 0.1121, 0.1122, 0.1125, 0.1120, 0.1121, 0.1121,
         0.1123],
        [0.1120, 0.0000, 0.1124, 0.1119, 0.1120, 0.1124, 0.1118, 0.1117, 0.1124,
         0.1120],
        [0.1125, 0.1124, 0.0000, 0.1125, 0.1128, 0.1124, 0.1121, 0.1125, 0.1128,
         0.1125],
        [0.1121, 0.1119, 0.1124, 0.0000, 0.1125, 0.1128, 0.1121, 0.1118, 0.1126,
         0.1122],
        [0.1122, 0.1120, 0.1128, 0.1125, 0.0000, 0.1121, 0.1127, 0.1123, 0.1126,
         0.1125],
        [0.1125, 0.1124, 0.1124, 0.1128, 0.1121, 0.0000, 0.1126, 0.1123, 0.1124,
         0.1123],
        [0.1120, 0.1118, 0.1121, 0.1121, 0.1127, 0.1126, 0.0000, 0.1117, 0.1126,
         0.1122],
        [0.1121, 0.1117, 0.1125, 0.1118, 0.1123, 0.1123, 0.1117, 0.0000, 0.1123,
         0.1122],
        [0.1121, 0.1124, 0.1128, 0.1126, 0.1126, 0.1124, 0.1126, 0.1123, 0.0000,
         0.1123],
        [0.1123, 0.1120, 0.1125, 0.1122, 0.1125, 0.1123, 0.1122, 0.1122, 0.1123,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0377, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6196
Epoch534: train_loss: 4.0759 recon_acc: 0.7276 val_roc: 0.7596 val_ap: 0.8282 f1: 0.7080 time: 0.2399
difference_matrix tensor([[0.0000, 0.1120, 0.1124, 0.1121, 0.1122, 0.1125, 0.1119, 0.1121, 0.1121,
         0.1123],
        [0.1120, 0.0000, 0.1124, 0.1119, 0.1120, 0.1123, 0.1118, 0.1117, 0.1124,
         0.1120],
        [0.1124, 0.1124, 0.0000, 0.1124, 0.1128, 0.1124, 0.1121, 0.1125, 0.1128,
         0.1125],
        [0.1121, 0.1119, 0.1124, 0.0000, 0.1125, 0.1127, 0.1121, 0.1117, 0.1126,
         0.1122],
        [0.1122, 0.1120, 0.1128, 0.1125, 0.0000, 0.1121, 0.1126, 0.1123, 0.1126,
         0.1125],
        [0.1125, 0.1123, 0.1124, 0.1127, 0.1121, 0.0000, 0.1126, 0.1123, 0.1124,
         0.1123],
        [0.1119, 0.1118, 0.1121, 0.1121, 0.1126, 0.1126, 0.0000, 0.1117, 0.1126,
         0.1122],
        [0.1121, 0.1117, 0.1125, 0.1117, 0.1123, 0.1123, 0.1117, 0.0000, 0.1122,
         0.1121],
        [0.1121, 0.1124, 0.1128, 0.1126, 0.1126, 0.1124, 0.1126, 0.1122, 0.0000,
         0.1122],
        [0.1123, 0.1120, 0.1125, 0.1122, 0.1125, 0.1123, 0.1122, 0.1121, 0.1122,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0377, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6192466
Epoch535: train_loss: 4.0757 recon_acc: 0.7270 val_roc: 0.7598 val_ap: 0.8283 f1: 0.7080 time: 0.2614
difference_matrix tensor([[0.0000, 0.1120, 0.1124, 0.1121, 0.1122, 0.1125, 0.1119, 0.1121, 0.1120,
         0.1123],
        [0.1120, 0.0000, 0.1123, 0.1119, 0.1120, 0.1123, 0.1118, 0.1117, 0.1124,
         0.1120],
        [0.1124, 0.1123, 0.0000, 0.1124, 0.1127, 0.1123, 0.1120, 0.1125, 0.1128,
         0.1125],
        [0.1121, 0.1119, 0.1124, 0.0000, 0.1124, 0.1127, 0.1121, 0.1117, 0.1125,
         0.1122],
        [0.1122, 0.1120, 0.1127, 0.1124, 0.0000, 0.1120, 0.1126, 0.1123, 0.1125,
         0.1125],
        [0.1125, 0.1123, 0.1123, 0.1127, 0.1120, 0.0000, 0.1126, 0.1123, 0.1123,
         0.1123],
        [0.1119, 0.1118, 0.1120, 0.1121, 0.1126, 0.1126, 0.0000, 0.1116, 0.1126,
         0.1121],
        [0.1121, 0.1117, 0.1125, 0.1117, 0.1123, 0.1123, 0.1116, 0.0000, 0.1122,
         0.1121],
        [0.1120, 0.1124, 0.1128, 0.1125, 0.1125, 0.1123, 0.1126, 0.1122, 0.0000,
         0.1122],
        [0.1123, 0.1120, 0.1125, 0.1122, 0.1125, 0.1123, 0.1121, 0.1121, 0.1122,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0378, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6188928
Epoch536: train_loss: 4.0755 recon_acc: 0.7264 val_roc: 0.7599 val_ap: 0.8284 f1: 0.7080 time: 0.2654
difference_matrix tensor([[0.0000, 0.1119, 0.1124, 0.1121, 0.1121, 0.1124, 0.1119, 0.1121, 0.1120,
         0.1123],
        [0.1119, 0.0000, 0.1123, 0.1119, 0.1119, 0.1123, 0.1118, 0.1117, 0.1123,
         0.1120],
        [0.1124, 0.1123, 0.0000, 0.1124, 0.1127, 0.1123, 0.1120, 0.1124, 0.1128,
         0.1124],
        [0.1121, 0.1119, 0.1124, 0.0000, 0.1124, 0.1127, 0.1120, 0.1117, 0.1125,
         0.1122],
        [0.1121, 0.1119, 0.1127, 0.1124, 0.0000, 0.1120, 0.1126, 0.1123, 0.1125,
         0.1125],
        [0.1124, 0.1123, 0.1123, 0.1127, 0.1120, 0.0000, 0.1125, 0.1123, 0.1123,
         0.1123],
        [0.1119, 0.1118, 0.1120, 0.1120, 0.1126, 0.1125, 0.0000, 0.1116, 0.1125,
         0.1121],
        [0.1121, 0.1117, 0.1124, 0.1117, 0.1123, 0.1123, 0.1116, 0.0000, 0.1122,
         0.1121],
        [0.1120, 0.1123, 0.1128, 0.1125, 0.1125, 0.1123, 0.1125, 0.1122, 0.0000,
         0.1122],
        [0.1123, 0.1120, 0.1124, 0.1122, 0.1125, 0.1123, 0.1121, 0.1121, 0.1122,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0378, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.61853856
Epoch537: train_loss: 4.0753 recon_acc: 0.7259 val_roc: 0.7601 val_ap: 0.8286 f1: 0.7080 time: 0.2747
difference_matrix tensor([[0.0000, 0.1119, 0.1124, 0.1120, 0.1121, 0.1124, 0.1119, 0.1120, 0.1120,
         0.1122],
        [0.1119, 0.0000, 0.1123, 0.1118, 0.1119, 0.1123, 0.1117, 0.1116, 0.1123,
         0.1119],
        [0.1124, 0.1123, 0.0000, 0.1124, 0.1127, 0.1123, 0.1120, 0.1124, 0.1127,
         0.1124],
        [0.1120, 0.1118, 0.1124, 0.0000, 0.1124, 0.1127, 0.1120, 0.1117, 0.1125,
         0.1121],
        [0.1121, 0.1119, 0.1127, 0.1124, 0.0000, 0.1120, 0.1126, 0.1122, 0.1125,
         0.1124],
        [0.1124, 0.1123, 0.1123, 0.1127, 0.1120, 0.0000, 0.1125, 0.1122, 0.1123,
         0.1122],
        [0.1119, 0.1117, 0.1120, 0.1120, 0.1126, 0.1125, 0.0000, 0.1116, 0.1125,
         0.1121],
        [0.1120, 0.1116, 0.1124, 0.1117, 0.1122, 0.1122, 0.1116, 0.0000, 0.1122,
         0.1120],
        [0.1120, 0.1123, 0.1127, 0.1125, 0.1125, 0.1123, 0.1125, 0.1122, 0.0000,
         0.1122],
        [0.1122, 0.1119, 0.1124, 0.1121, 0.1124, 0.1122, 0.1121, 0.1120, 0.1122,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0378, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.618184
Epoch538: train_loss: 4.0752 recon_acc: 0.7253 val_roc: 0.7602 val_ap: 0.8287 f1: 0.7080 time: 0.2539
difference_matrix tensor([[0.0000, 0.1119, 0.1123, 0.1120, 0.1121, 0.1124, 0.1118, 0.1120, 0.1120,
         0.1122],
        [0.1119, 0.0000, 0.1123, 0.1118, 0.1119, 0.1122, 0.1117, 0.1116, 0.1123,
         0.1119],
        [0.1123, 0.1123, 0.0000, 0.1123, 0.1126, 0.1122, 0.1120, 0.1124, 0.1127,
         0.1124],
        [0.1120, 0.1118, 0.1123, 0.0000, 0.1124, 0.1126, 0.1120, 0.1116, 0.1125,
         0.1121],
        [0.1121, 0.1119, 0.1126, 0.1124, 0.0000, 0.1120, 0.1125, 0.1122, 0.1125,
         0.1124],
        [0.1124, 0.1122, 0.1122, 0.1126, 0.1120, 0.0000, 0.1125, 0.1122, 0.1123,
         0.1122],
        [0.1118, 0.1117, 0.1120, 0.1120, 0.1125, 0.1125, 0.0000, 0.1116, 0.1125,
         0.1121],
        [0.1120, 0.1116, 0.1124, 0.1116, 0.1122, 0.1122, 0.1116, 0.0000, 0.1121,
         0.1120],
        [0.1120, 0.1123, 0.1127, 0.1125, 0.1125, 0.1123, 0.1125, 0.1121, 0.0000,
         0.1121],
        [0.1122, 0.1119, 0.1124, 0.1121, 0.1124, 0.1122, 0.1121, 0.1120, 0.1121,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0378, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.61782885
Epoch539: train_loss: 4.0750 recon_acc: 0.7247 val_roc: 0.7602 val_ap: 0.8287 f1: 0.7080 time: 0.3016
difference_matrix tensor([[0.0000, 0.1119, 0.1123, 0.1120, 0.1121, 0.1124, 0.1118, 0.1120, 0.1119,
         0.1122],
        [0.1119, 0.0000, 0.1122, 0.1118, 0.1119, 0.1122, 0.1117, 0.1116, 0.1123,
         0.1119],
        [0.1123, 0.1122, 0.0000, 0.1123, 0.1126, 0.1122, 0.1119, 0.1124, 0.1127,
         0.1124],
        [0.1120, 0.1118, 0.1123, 0.0000, 0.1123, 0.1126, 0.1120, 0.1116, 0.1124,
         0.1121],
        [0.1121, 0.1119, 0.1126, 0.1123, 0.0000, 0.1119, 0.1125, 0.1122, 0.1124,
         0.1124],
        [0.1124, 0.1122, 0.1122, 0.1126, 0.1119, 0.0000, 0.1125, 0.1122, 0.1122,
         0.1122],
        [0.1118, 0.1117, 0.1119, 0.1120, 0.1125, 0.1125, 0.0000, 0.1115, 0.1125,
         0.1120],
        [0.1120, 0.1116, 0.1124, 0.1116, 0.1122, 0.1122, 0.1115, 0.0000, 0.1121,
         0.1120],
        [0.1119, 0.1123, 0.1127, 0.1124, 0.1124, 0.1122, 0.1125, 0.1121, 0.0000,
         0.1121],
        [0.1122, 0.1119, 0.1124, 0.1121, 0.1124, 0.1122, 0.1120, 0.1120, 0.1121,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0379, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.61110735
Epoch540: train_loss: 4.0748 recon_acc: 0.7132 val_roc: 0.7603 val_ap: 0.8289 f1: 0.7140 time: 0.3080
difference_matrix tensor([[0.0000, 0.1118, 0.1123, 0.1119, 0.1120, 0.1123, 0.1118, 0.1120, 0.1119,
         0.1122],
        [0.1118, 0.0000, 0.1122, 0.1118, 0.1118, 0.1122, 0.1116, 0.1116, 0.1122,
         0.1118],
        [0.1123, 0.1122, 0.0000, 0.1123, 0.1126, 0.1122, 0.1119, 0.1123, 0.1127,
         0.1123],
        [0.1119, 0.1118, 0.1123, 0.0000, 0.1123, 0.1126, 0.1119, 0.1116, 0.1124,
         0.1121],
        [0.1120, 0.1118, 0.1126, 0.1123, 0.0000, 0.1119, 0.1125, 0.1122, 0.1124,
         0.1124],
        [0.1123, 0.1122, 0.1122, 0.1126, 0.1119, 0.0000, 0.1124, 0.1122, 0.1122,
         0.1121],
        [0.1118, 0.1116, 0.1119, 0.1119, 0.1125, 0.1124, 0.0000, 0.1115, 0.1124,
         0.1120],
        [0.1120, 0.1116, 0.1123, 0.1116, 0.1122, 0.1122, 0.1115, 0.0000, 0.1121,
         0.1120],
        [0.1119, 0.1122, 0.1127, 0.1124, 0.1124, 0.1122, 0.1124, 0.1121, 0.0000,
         0.1121],
        [0.1122, 0.1118, 0.1123, 0.1121, 0.1124, 0.1121, 0.1120, 0.1120, 0.1121,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0379, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.61206836
Epoch541: train_loss: 4.0746 recon_acc: 0.7150 val_roc: 0.7605 val_ap: 0.8290 f1: 0.7140 time: 0.2760
difference_matrix tensor([[0.0000, 0.1118, 0.1123, 0.1119, 0.1120, 0.1123, 0.1118, 0.1119, 0.1119,
         0.1121],
        [0.1118, 0.0000, 0.1122, 0.1117, 0.1118, 0.1122, 0.1116, 0.1115, 0.1122,
         0.1118],
        [0.1123, 0.1122, 0.0000, 0.1123, 0.1126, 0.1122, 0.1119, 0.1123, 0.1126,
         0.1123],
        [0.1119, 0.1117, 0.1123, 0.0000, 0.1123, 0.1126, 0.1119, 0.1116, 0.1124,
         0.1120],
        [0.1120, 0.1118, 0.1126, 0.1123, 0.0000, 0.1119, 0.1125, 0.1121, 0.1124,
         0.1123],
        [0.1123, 0.1122, 0.1122, 0.1126, 0.1119, 0.0000, 0.1124, 0.1121, 0.1122,
         0.1121],
        [0.1118, 0.1116, 0.1119, 0.1119, 0.1125, 0.1124, 0.0000, 0.1115, 0.1124,
         0.1120],
        [0.1119, 0.1115, 0.1123, 0.1116, 0.1121, 0.1121, 0.1115, 0.0000, 0.1121,
         0.1119],
        [0.1119, 0.1122, 0.1126, 0.1124, 0.1124, 0.1122, 0.1124, 0.1121, 0.0000,
         0.1121],
        [0.1121, 0.1118, 0.1123, 0.1120, 0.1123, 0.1121, 0.1120, 0.1119, 0.1121,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0379, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.61302763
Epoch542: train_loss: 4.0744 recon_acc: 0.7167 val_roc: 0.7604 val_ap: 0.8291 f1: 0.7140 time: 0.2738
difference_matrix tensor([[0.0000, 0.1118, 0.1122, 0.1119, 0.1120, 0.1123, 0.1117, 0.1119, 0.1119,
         0.1121],
        [0.1118, 0.0000, 0.1122, 0.1117, 0.1118, 0.1121, 0.1116, 0.1115, 0.1122,
         0.1118],
        [0.1122, 0.1122, 0.0000, 0.1122, 0.1125, 0.1121, 0.1118, 0.1123, 0.1126,
         0.1123],
        [0.1119, 0.1117, 0.1122, 0.0000, 0.1123, 0.1125, 0.1119, 0.1115, 0.1124,
         0.1120],
        [0.1120, 0.1118, 0.1125, 0.1123, 0.0000, 0.1119, 0.1124, 0.1121, 0.1124,
         0.1123],
        [0.1123, 0.1121, 0.1121, 0.1125, 0.1119, 0.0000, 0.1124, 0.1121, 0.1122,
         0.1121],
        [0.1117, 0.1116, 0.1118, 0.1119, 0.1124, 0.1124, 0.0000, 0.1115, 0.1124,
         0.1120],
        [0.1119, 0.1115, 0.1123, 0.1115, 0.1121, 0.1121, 0.1115, 0.0000, 0.1120,
         0.1119],
        [0.1119, 0.1122, 0.1126, 0.1124, 0.1124, 0.1122, 0.1124, 0.1120, 0.0000,
         0.1120],
        [0.1121, 0.1118, 0.1123, 0.1120, 0.1123, 0.1121, 0.1120, 0.1119, 0.1120,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0379, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.61398524
Epoch543: train_loss: 4.0743 recon_acc: 0.7183 val_roc: 0.7606 val_ap: 0.8292 f1: 0.7140 time: 0.2512
difference_matrix tensor([[0.0000, 0.1118, 0.1122, 0.1119, 0.1120, 0.1123, 0.1117, 0.1119, 0.1118,
         0.1121],
        [0.1118, 0.0000, 0.1121, 0.1117, 0.1118, 0.1121, 0.1116, 0.1115, 0.1122,
         0.1118],
        [0.1122, 0.1121, 0.0000, 0.1122, 0.1125, 0.1121, 0.1118, 0.1123, 0.1126,
         0.1123],
        [0.1119, 0.1117, 0.1122, 0.0000, 0.1122, 0.1125, 0.1119, 0.1115, 0.1123,
         0.1120],
        [0.1120, 0.1118, 0.1125, 0.1122, 0.0000, 0.1118, 0.1124, 0.1121, 0.1123,
         0.1123],
        [0.1123, 0.1121, 0.1121, 0.1125, 0.1118, 0.0000, 0.1124, 0.1121, 0.1121,
         0.1121],
        [0.1117, 0.1116, 0.1118, 0.1119, 0.1124, 0.1124, 0.0000, 0.1114, 0.1124,
         0.1119],
        [0.1119, 0.1115, 0.1123, 0.1115, 0.1121, 0.1121, 0.1114, 0.0000, 0.1120,
         0.1119],
        [0.1118, 0.1122, 0.1126, 0.1123, 0.1123, 0.1121, 0.1124, 0.1120, 0.0000,
         0.1120],
        [0.1121, 0.1118, 0.1123, 0.1120, 0.1123, 0.1121, 0.1119, 0.1119, 0.1120,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0380, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6149412
Epoch544: train_loss: 4.0741 recon_acc: 0.7200 val_roc: 0.7608 val_ap: 0.8294 f1: 0.7140 time: 0.2599
difference_matrix tensor([[0.0000, 0.1117, 0.1122, 0.1118, 0.1119, 0.1122, 0.1117, 0.1119, 0.1118,
         0.1121],
        [0.1117, 0.0000, 0.1121, 0.1117, 0.1117, 0.1121, 0.1115, 0.1115, 0.1121,
         0.1117],
        [0.1122, 0.1121, 0.0000, 0.1122, 0.1125, 0.1121, 0.1118, 0.1123, 0.1126,
         0.1122],
        [0.1118, 0.1117, 0.1122, 0.0000, 0.1122, 0.1125, 0.1118, 0.1115, 0.1123,
         0.1120],
        [0.1119, 0.1117, 0.1125, 0.1122, 0.0000, 0.1118, 0.1124, 0.1121, 0.1123,
         0.1122],
        [0.1122, 0.1121, 0.1121, 0.1125, 0.1118, 0.0000, 0.1123, 0.1121, 0.1121,
         0.1120],
        [0.1117, 0.1115, 0.1118, 0.1118, 0.1124, 0.1123, 0.0000, 0.1114, 0.1123,
         0.1119],
        [0.1119, 0.1115, 0.1123, 0.1115, 0.1121, 0.1121, 0.1114, 0.0000, 0.1120,
         0.1119],
        [0.1118, 0.1121, 0.1126, 0.1123, 0.1123, 0.1121, 0.1123, 0.1120, 0.0000,
         0.1120],
        [0.1121, 0.1117, 0.1122, 0.1120, 0.1122, 0.1120, 0.1119, 0.1119, 0.1120,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0380, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.615691
Epoch545: train_loss: 4.0739 recon_acc: 0.7213 val_roc: 0.7609 val_ap: 0.8295 f1: 0.7140 time: 0.2645
difference_matrix tensor([[0.0000, 0.1117, 0.1122, 0.1118, 0.1119, 0.1122, 0.1117, 0.1118, 0.1118,
         0.1120],
        [0.1117, 0.0000, 0.1121, 0.1116, 0.1117, 0.1121, 0.1115, 0.1114, 0.1121,
         0.1117],
        [0.1122, 0.1121, 0.0000, 0.1122, 0.1125, 0.1121, 0.1118, 0.1122, 0.1125,
         0.1122],
        [0.1118, 0.1116, 0.1122, 0.0000, 0.1122, 0.1125, 0.1118, 0.1115, 0.1123,
         0.1119],
        [0.1119, 0.1117, 0.1125, 0.1122, 0.0000, 0.1118, 0.1124, 0.1120, 0.1123,
         0.1122],
        [0.1122, 0.1121, 0.1121, 0.1125, 0.1118, 0.0000, 0.1123, 0.1120, 0.1121,
         0.1120],
        [0.1117, 0.1115, 0.1118, 0.1118, 0.1124, 0.1123, 0.0000, 0.1114, 0.1123,
         0.1119],
        [0.1118, 0.1114, 0.1122, 0.1115, 0.1120, 0.1120, 0.1114, 0.0000, 0.1120,
         0.1118],
        [0.1118, 0.1121, 0.1125, 0.1123, 0.1123, 0.1121, 0.1123, 0.1120, 0.0000,
         0.1120],
        [0.1120, 0.1117, 0.1122, 0.1119, 0.1122, 0.1120, 0.1119, 0.1118, 0.1120,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0380, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.61533344
Epoch546: train_loss: 4.0737 recon_acc: 0.7207 val_roc: 0.7609 val_ap: 0.8295 f1: 0.7140 time: 0.2652
difference_matrix tensor([[0.0000, 0.1117, 0.1121, 0.1118, 0.1119, 0.1122, 0.1116, 0.1118, 0.1118,
         0.1120],
        [0.1117, 0.0000, 0.1121, 0.1116, 0.1117, 0.1121, 0.1115, 0.1114, 0.1121,
         0.1117],
        [0.1121, 0.1121, 0.0000, 0.1121, 0.1124, 0.1120, 0.1117, 0.1122, 0.1125,
         0.1122],
        [0.1118, 0.1116, 0.1121, 0.0000, 0.1122, 0.1124, 0.1118, 0.1114, 0.1123,
         0.1119],
        [0.1119, 0.1117, 0.1124, 0.1122, 0.0000, 0.1118, 0.1123, 0.1120, 0.1123,
         0.1122],
        [0.1122, 0.1121, 0.1120, 0.1124, 0.1118, 0.0000, 0.1123, 0.1120, 0.1121,
         0.1120],
        [0.1116, 0.1115, 0.1117, 0.1118, 0.1123, 0.1123, 0.0000, 0.1114, 0.1123,
         0.1119],
        [0.1118, 0.1114, 0.1122, 0.1114, 0.1120, 0.1120, 0.1114, 0.0000, 0.1119,
         0.1118],
        [0.1118, 0.1121, 0.1125, 0.1123, 0.1123, 0.1121, 0.1123, 0.1119, 0.0000,
         0.1119],
        [0.1120, 0.1117, 0.1122, 0.1119, 0.1122, 0.1120, 0.1119, 0.1118, 0.1119,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0380, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6149755
Epoch547: train_loss: 4.0736 recon_acc: 0.7201 val_roc: 0.7610 val_ap: 0.8296 f1: 0.7140 time: 0.2687
difference_matrix tensor([[0.0000, 0.1117, 0.1121, 0.1118, 0.1119, 0.1122, 0.1116, 0.1118, 0.1117,
         0.1120],
        [0.1117, 0.0000, 0.1120, 0.1116, 0.1117, 0.1120, 0.1115, 0.1114, 0.1121,
         0.1117],
        [0.1121, 0.1120, 0.0000, 0.1121, 0.1124, 0.1120, 0.1117, 0.1122, 0.1125,
         0.1122],
        [0.1118, 0.1116, 0.1121, 0.0000, 0.1121, 0.1124, 0.1118, 0.1114, 0.1122,
         0.1119],
        [0.1119, 0.1117, 0.1124, 0.1121, 0.0000, 0.1117, 0.1123, 0.1120, 0.1122,
         0.1122],
        [0.1122, 0.1120, 0.1120, 0.1124, 0.1117, 0.0000, 0.1123, 0.1120, 0.1121,
         0.1120],
        [0.1116, 0.1115, 0.1117, 0.1118, 0.1123, 0.1123, 0.0000, 0.1113, 0.1123,
         0.1118],
        [0.1118, 0.1114, 0.1122, 0.1114, 0.1120, 0.1120, 0.1113, 0.0000, 0.1119,
         0.1118],
        [0.1117, 0.1121, 0.1125, 0.1122, 0.1122, 0.1121, 0.1123, 0.1119, 0.0000,
         0.1119],
        [0.1120, 0.1117, 0.1122, 0.1119, 0.1122, 0.1120, 0.1118, 0.1118, 0.1119,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0381, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6146173
Epoch548: train_loss: 4.0734 recon_acc: 0.7196 val_roc: 0.7611 val_ap: 0.8298 f1: 0.7140 time: 0.2578
difference_matrix tensor([[0.0000, 0.1116, 0.1121, 0.1118, 0.1118, 0.1121, 0.1116, 0.1118, 0.1117,
         0.1120],
        [0.1116, 0.0000, 0.1120, 0.1116, 0.1116, 0.1120, 0.1114, 0.1114, 0.1120,
         0.1117],
        [0.1121, 0.1120, 0.0000, 0.1121, 0.1124, 0.1120, 0.1117, 0.1122, 0.1125,
         0.1121],
        [0.1118, 0.1116, 0.1121, 0.0000, 0.1121, 0.1124, 0.1117, 0.1114, 0.1122,
         0.1119],
        [0.1118, 0.1116, 0.1124, 0.1121, 0.0000, 0.1117, 0.1123, 0.1120, 0.1122,
         0.1122],
        [0.1121, 0.1120, 0.1120, 0.1124, 0.1117, 0.0000, 0.1122, 0.1120, 0.1120,
         0.1119],
        [0.1116, 0.1114, 0.1117, 0.1117, 0.1123, 0.1122, 0.0000, 0.1113, 0.1122,
         0.1118],
        [0.1118, 0.1114, 0.1122, 0.1114, 0.1120, 0.1120, 0.1113, 0.0000, 0.1119,
         0.1118],
        [0.1117, 0.1120, 0.1125, 0.1122, 0.1122, 0.1120, 0.1122, 0.1119, 0.0000,
         0.1119],
        [0.1120, 0.1117, 0.1121, 0.1119, 0.1122, 0.1119, 0.1118, 0.1118, 0.1119,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0381, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.61425877
Epoch549: train_loss: 4.0732 recon_acc: 0.7190 val_roc: 0.7613 val_ap: 0.8299 f1: 0.7140 time: 0.2876
difference_matrix tensor([[0.0000, 0.1116, 0.1121, 0.1117, 0.1118, 0.1121, 0.1116, 0.1117, 0.1117,
         0.1120],
        [0.1116, 0.0000, 0.1120, 0.1115, 0.1116, 0.1120, 0.1114, 0.1113, 0.1120,
         0.1116],
        [0.1121, 0.1120, 0.0000, 0.1121, 0.1124, 0.1120, 0.1117, 0.1121, 0.1124,
         0.1121],
        [0.1117, 0.1115, 0.1121, 0.0000, 0.1121, 0.1124, 0.1117, 0.1114, 0.1122,
         0.1118],
        [0.1118, 0.1116, 0.1124, 0.1121, 0.0000, 0.1117, 0.1123, 0.1119, 0.1122,
         0.1121],
        [0.1121, 0.1120, 0.1120, 0.1124, 0.1117, 0.0000, 0.1122, 0.1119, 0.1120,
         0.1119],
        [0.1116, 0.1114, 0.1117, 0.1117, 0.1123, 0.1122, 0.0000, 0.1113, 0.1122,
         0.1118],
        [0.1117, 0.1113, 0.1121, 0.1114, 0.1119, 0.1119, 0.1113, 0.0000, 0.1119,
         0.1117],
        [0.1117, 0.1120, 0.1124, 0.1122, 0.1122, 0.1120, 0.1122, 0.1119, 0.0000,
         0.1119],
        [0.1120, 0.1116, 0.1121, 0.1118, 0.1121, 0.1119, 0.1118, 0.1117, 0.1119,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0381, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6138999
Epoch550: train_loss: 4.0731 recon_acc: 0.7184 val_roc: 0.7613 val_ap: 0.8300 f1: 0.7140 time: 0.2789
difference_matrix tensor([[0.0000, 0.1116, 0.1120, 0.1117, 0.1118, 0.1121, 0.1115, 0.1117, 0.1117,
         0.1119],
        [0.1116, 0.0000, 0.1120, 0.1115, 0.1116, 0.1120, 0.1114, 0.1113, 0.1120,
         0.1116],
        [0.1120, 0.1120, 0.0000, 0.1120, 0.1123, 0.1119, 0.1116, 0.1121, 0.1124,
         0.1121],
        [0.1117, 0.1115, 0.1120, 0.0000, 0.1121, 0.1123, 0.1117, 0.1113, 0.1122,
         0.1118],
        [0.1118, 0.1116, 0.1123, 0.1121, 0.0000, 0.1117, 0.1122, 0.1119, 0.1122,
         0.1121],
        [0.1121, 0.1120, 0.1119, 0.1123, 0.1117, 0.0000, 0.1122, 0.1119, 0.1120,
         0.1119],
        [0.1115, 0.1114, 0.1116, 0.1117, 0.1122, 0.1122, 0.0000, 0.1113, 0.1122,
         0.1118],
        [0.1117, 0.1113, 0.1121, 0.1113, 0.1119, 0.1119, 0.1113, 0.0000, 0.1119,
         0.1117],
        [0.1117, 0.1120, 0.1124, 0.1122, 0.1122, 0.1120, 0.1122, 0.1119, 0.0000,
         0.1119],
        [0.1119, 0.1116, 0.1121, 0.1118, 0.1121, 0.1119, 0.1118, 0.1117, 0.1119,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0381, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6135407
Epoch551: train_loss: 4.0729 recon_acc: 0.7178 val_roc: 0.7615 val_ap: 0.8301 f1: 0.7140 time: 0.2510
difference_matrix tensor([[0.0000, 0.1116, 0.1120, 0.1117, 0.1118, 0.1121, 0.1115, 0.1117, 0.1117,
         0.1119],
        [0.1116, 0.0000, 0.1120, 0.1115, 0.1116, 0.1119, 0.1114, 0.1113, 0.1120,
         0.1116],
        [0.1120, 0.1120, 0.0000, 0.1120, 0.1123, 0.1119, 0.1116, 0.1121, 0.1124,
         0.1121],
        [0.1117, 0.1115, 0.1120, 0.0000, 0.1120, 0.1123, 0.1117, 0.1113, 0.1121,
         0.1118],
        [0.1118, 0.1116, 0.1123, 0.1120, 0.0000, 0.1116, 0.1122, 0.1119, 0.1122,
         0.1121],
        [0.1121, 0.1119, 0.1119, 0.1123, 0.1116, 0.0000, 0.1122, 0.1119, 0.1120,
         0.1119],
        [0.1115, 0.1114, 0.1116, 0.1117, 0.1122, 0.1122, 0.0000, 0.1112, 0.1122,
         0.1117],
        [0.1117, 0.1113, 0.1121, 0.1113, 0.1119, 0.1119, 0.1112, 0.0000, 0.1118,
         0.1117],
        [0.1117, 0.1120, 0.1124, 0.1121, 0.1122, 0.1120, 0.1122, 0.1118, 0.0000,
         0.1118],
        [0.1119, 0.1116, 0.1121, 0.1118, 0.1121, 0.1119, 0.1117, 0.1117, 0.1118,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0382, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6131812
Epoch552: train_loss: 4.0727 recon_acc: 0.7172 val_roc: 0.7615 val_ap: 0.8301 f1: 0.7140 time: 0.2680
difference_matrix tensor([[0.0000, 0.1115, 0.1120, 0.1117, 0.1118, 0.1120, 0.1115, 0.1117, 0.1116,
         0.1119],
        [0.1115, 0.0000, 0.1119, 0.1115, 0.1115, 0.1119, 0.1113, 0.1113, 0.1119,
         0.1116],
        [0.1120, 0.1119, 0.0000, 0.1120, 0.1123, 0.1119, 0.1116, 0.1121, 0.1124,
         0.1121],
        [0.1117, 0.1115, 0.1120, 0.0000, 0.1120, 0.1123, 0.1116, 0.1113, 0.1121,
         0.1118],
        [0.1118, 0.1115, 0.1123, 0.1120, 0.0000, 0.1116, 0.1122, 0.1119, 0.1121,
         0.1121],
        [0.1120, 0.1119, 0.1119, 0.1123, 0.1116, 0.0000, 0.1122, 0.1119, 0.1119,
         0.1119],
        [0.1115, 0.1113, 0.1116, 0.1116, 0.1122, 0.1122, 0.0000, 0.1112, 0.1121,
         0.1117],
        [0.1117, 0.1113, 0.1121, 0.1113, 0.1119, 0.1119, 0.1112, 0.0000, 0.1118,
         0.1117],
        [0.1116, 0.1119, 0.1124, 0.1121, 0.1121, 0.1119, 0.1121, 0.1118, 0.0000,
         0.1118],
        [0.1119, 0.1116, 0.1121, 0.1118, 0.1121, 0.1119, 0.1117, 0.1117, 0.1118,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0382, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6128214
Epoch553: train_loss: 4.0726 recon_acc: 0.7166 val_roc: 0.7616 val_ap: 0.8301 f1: 0.7140 time: 0.2926
difference_matrix tensor([[0.0000, 0.1115, 0.1120, 0.1116, 0.1117, 0.1120, 0.1115, 0.1116, 0.1116,
         0.1119],
        [0.1115, 0.0000, 0.1119, 0.1115, 0.1115, 0.1119, 0.1113, 0.1112, 0.1119,
         0.1115],
        [0.1120, 0.1119, 0.0000, 0.1120, 0.1123, 0.1119, 0.1116, 0.1120, 0.1123,
         0.1120],
        [0.1116, 0.1115, 0.1120, 0.0000, 0.1120, 0.1123, 0.1116, 0.1113, 0.1121,
         0.1117],
        [0.1117, 0.1115, 0.1123, 0.1120, 0.0000, 0.1116, 0.1122, 0.1118, 0.1121,
         0.1120],
        [0.1120, 0.1119, 0.1119, 0.1123, 0.1116, 0.0000, 0.1121, 0.1118, 0.1119,
         0.1118],
        [0.1115, 0.1113, 0.1116, 0.1116, 0.1122, 0.1121, 0.0000, 0.1112, 0.1121,
         0.1117],
        [0.1116, 0.1112, 0.1120, 0.1113, 0.1118, 0.1118, 0.1112, 0.0000, 0.1118,
         0.1116],
        [0.1116, 0.1119, 0.1123, 0.1121, 0.1121, 0.1119, 0.1121, 0.1118, 0.0000,
         0.1118],
        [0.1119, 0.1115, 0.1120, 0.1117, 0.1120, 0.1118, 0.1117, 0.1116, 0.1118,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0382, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.61246127
Epoch554: train_loss: 4.0724 recon_acc: 0.7160 val_roc: 0.7616 val_ap: 0.8301 f1: 0.7140 time: 0.2879
difference_matrix tensor([[0.0000, 0.1115, 0.1120, 0.1116, 0.1117, 0.1120, 0.1114, 0.1116, 0.1116,
         0.1118],
        [0.1115, 0.0000, 0.1119, 0.1114, 0.1115, 0.1119, 0.1113, 0.1112, 0.1119,
         0.1115],
        [0.1120, 0.1119, 0.0000, 0.1120, 0.1122, 0.1118, 0.1116, 0.1120, 0.1123,
         0.1120],
        [0.1116, 0.1114, 0.1120, 0.0000, 0.1120, 0.1123, 0.1116, 0.1112, 0.1121,
         0.1117],
        [0.1117, 0.1115, 0.1122, 0.1120, 0.0000, 0.1116, 0.1121, 0.1118, 0.1121,
         0.1120],
        [0.1120, 0.1119, 0.1118, 0.1123, 0.1116, 0.0000, 0.1121, 0.1118, 0.1119,
         0.1118],
        [0.1114, 0.1113, 0.1116, 0.1116, 0.1121, 0.1121, 0.0000, 0.1112, 0.1121,
         0.1117],
        [0.1116, 0.1112, 0.1120, 0.1112, 0.1118, 0.1118, 0.1112, 0.0000, 0.1118,
         0.1116],
        [0.1116, 0.1119, 0.1123, 0.1121, 0.1121, 0.1119, 0.1121, 0.1118, 0.0000,
         0.1118],
        [0.1118, 0.1115, 0.1120, 0.1117, 0.1120, 0.1118, 0.1117, 0.1116, 0.1118,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0382, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6121009
Epoch555: train_loss: 4.0722 recon_acc: 0.7155 val_roc: 0.7615 val_ap: 0.8302 f1: 0.7140 time: 0.2832
difference_matrix tensor([[0.0000, 0.1115, 0.1119, 0.1116, 0.1117, 0.1120, 0.1114, 0.1116, 0.1116,
         0.1118],
        [0.1115, 0.0000, 0.1119, 0.1114, 0.1115, 0.1119, 0.1113, 0.1112, 0.1119,
         0.1115],
        [0.1119, 0.1119, 0.0000, 0.1119, 0.1122, 0.1118, 0.1115, 0.1120, 0.1123,
         0.1120],
        [0.1116, 0.1114, 0.1119, 0.0000, 0.1120, 0.1122, 0.1116, 0.1112, 0.1120,
         0.1117],
        [0.1117, 0.1115, 0.1122, 0.1120, 0.0000, 0.1115, 0.1121, 0.1118, 0.1121,
         0.1120],
        [0.1120, 0.1119, 0.1118, 0.1122, 0.1115, 0.0000, 0.1121, 0.1118, 0.1119,
         0.1118],
        [0.1114, 0.1113, 0.1115, 0.1116, 0.1121, 0.1121, 0.0000, 0.1111, 0.1121,
         0.1116],
        [0.1116, 0.1112, 0.1120, 0.1112, 0.1118, 0.1118, 0.1111, 0.0000, 0.1117,
         0.1116],
        [0.1116, 0.1119, 0.1123, 0.1120, 0.1121, 0.1119, 0.1121, 0.1117, 0.0000,
         0.1117],
        [0.1118, 0.1115, 0.1120, 0.1117, 0.1120, 0.1118, 0.1116, 0.1116, 0.1117,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0382, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6117402
Epoch556: train_loss: 4.0721 recon_acc: 0.7149 val_roc: 0.7616 val_ap: 0.8303 f1: 0.7140 time: 0.2575
difference_matrix tensor([[0.0000, 0.1115, 0.1119, 0.1116, 0.1117, 0.1120, 0.1114, 0.1116, 0.1115,
         0.1118],
        [0.1115, 0.0000, 0.1118, 0.1114, 0.1115, 0.1118, 0.1113, 0.1112, 0.1119,
         0.1115],
        [0.1119, 0.1118, 0.0000, 0.1119, 0.1122, 0.1118, 0.1115, 0.1120, 0.1123,
         0.1120],
        [0.1116, 0.1114, 0.1119, 0.0000, 0.1119, 0.1122, 0.1116, 0.1112, 0.1120,
         0.1117],
        [0.1117, 0.1115, 0.1122, 0.1119, 0.0000, 0.1115, 0.1121, 0.1118, 0.1120,
         0.1120],
        [0.1120, 0.1118, 0.1118, 0.1122, 0.1115, 0.0000, 0.1121, 0.1118, 0.1119,
         0.1118],
        [0.1114, 0.1113, 0.1115, 0.1116, 0.1121, 0.1121, 0.0000, 0.1111, 0.1120,
         0.1116],
        [0.1116, 0.1112, 0.1120, 0.1112, 0.1118, 0.1118, 0.1111, 0.0000, 0.1117,
         0.1116],
        [0.1115, 0.1119, 0.1123, 0.1120, 0.1120, 0.1119, 0.1120, 0.1117, 0.0000,
         0.1117],
        [0.1118, 0.1115, 0.1120, 0.1117, 0.1120, 0.1118, 0.1116, 0.1116, 0.1117,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0383, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6238109
Epoch557: train_loss: 4.0719 recon_acc: 0.7356 val_roc: 0.7617 val_ap: 0.8304 f1: 0.7126 time: 0.2480
difference_matrix tensor([[0.0000, 0.1114, 0.1119, 0.1115, 0.1116, 0.1119, 0.1114, 0.1116, 0.1115,
         0.1118],
        [0.1114, 0.0000, 0.1118, 0.1114, 0.1114, 0.1118, 0.1112, 0.1111, 0.1118,
         0.1114],
        [0.1119, 0.1118, 0.0000, 0.1119, 0.1122, 0.1118, 0.1115, 0.1120, 0.1123,
         0.1119],
        [0.1115, 0.1114, 0.1119, 0.0000, 0.1119, 0.1122, 0.1115, 0.1112, 0.1120,
         0.1117],
        [0.1116, 0.1114, 0.1122, 0.1119, 0.0000, 0.1115, 0.1121, 0.1117, 0.1120,
         0.1119],
        [0.1119, 0.1118, 0.1118, 0.1122, 0.1115, 0.0000, 0.1120, 0.1118, 0.1118,
         0.1117],
        [0.1114, 0.1112, 0.1115, 0.1115, 0.1121, 0.1120, 0.0000, 0.1111, 0.1120,
         0.1116],
        [0.1116, 0.1111, 0.1120, 0.1112, 0.1117, 0.1118, 0.1111, 0.0000, 0.1117,
         0.1116],
        [0.1115, 0.1118, 0.1123, 0.1120, 0.1120, 0.1118, 0.1120, 0.1117, 0.0000,
         0.1117],
        [0.1118, 0.1114, 0.1119, 0.1117, 0.1119, 0.1117, 0.1116, 0.1116, 0.1117,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0383, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6237979
Epoch558: train_loss: 4.0717 recon_acc: 0.7356 val_roc: 0.7617 val_ap: 0.8304 f1: 0.7126 time: 0.2521
difference_matrix tensor([[0.0000, 0.1114, 0.1119, 0.1115, 0.1116, 0.1119, 0.1113, 0.1115, 0.1115,
         0.1118],
        [0.1114, 0.0000, 0.1118, 0.1113, 0.1114, 0.1118, 0.1112, 0.1111, 0.1118,
         0.1114],
        [0.1119, 0.1118, 0.0000, 0.1119, 0.1122, 0.1117, 0.1115, 0.1119, 0.1122,
         0.1119],
        [0.1115, 0.1113, 0.1119, 0.0000, 0.1119, 0.1122, 0.1115, 0.1111, 0.1120,
         0.1116],
        [0.1116, 0.1114, 0.1122, 0.1119, 0.0000, 0.1115, 0.1121, 0.1117, 0.1120,
         0.1119],
        [0.1119, 0.1118, 0.1117, 0.1122, 0.1115, 0.0000, 0.1120, 0.1117, 0.1118,
         0.1117],
        [0.1113, 0.1112, 0.1115, 0.1115, 0.1121, 0.1120, 0.0000, 0.1111, 0.1120,
         0.1116],
        [0.1115, 0.1111, 0.1119, 0.1111, 0.1117, 0.1117, 0.1111, 0.0000, 0.1117,
         0.1115],
        [0.1115, 0.1118, 0.1122, 0.1120, 0.1120, 0.1118, 0.1120, 0.1117, 0.0000,
         0.1117],
        [0.1118, 0.1114, 0.1119, 0.1116, 0.1119, 0.1117, 0.1116, 0.1115, 0.1117,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0383, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.62378585
Epoch559: train_loss: 4.0716 recon_acc: 0.7357 val_roc: 0.7619 val_ap: 0.8306 f1: 0.7126 time: 0.2515
difference_matrix tensor([[0.0000, 0.1114, 0.1118, 0.1115, 0.1116, 0.1119, 0.1113, 0.1115, 0.1115,
         0.1117],
        [0.1114, 0.0000, 0.1118, 0.1113, 0.1114, 0.1118, 0.1112, 0.1111, 0.1118,
         0.1114],
        [0.1118, 0.1118, 0.0000, 0.1119, 0.1121, 0.1117, 0.1114, 0.1119, 0.1122,
         0.1119],
        [0.1115, 0.1113, 0.1119, 0.0000, 0.1119, 0.1122, 0.1115, 0.1111, 0.1120,
         0.1116],
        [0.1116, 0.1114, 0.1121, 0.1119, 0.0000, 0.1114, 0.1120, 0.1117, 0.1120,
         0.1119],
        [0.1119, 0.1118, 0.1117, 0.1122, 0.1114, 0.0000, 0.1120, 0.1117, 0.1118,
         0.1117],
        [0.1113, 0.1112, 0.1114, 0.1115, 0.1120, 0.1120, 0.0000, 0.1111, 0.1120,
         0.1116],
        [0.1115, 0.1111, 0.1119, 0.1111, 0.1117, 0.1117, 0.1111, 0.0000, 0.1117,
         0.1115],
        [0.1115, 0.1118, 0.1122, 0.1120, 0.1120, 0.1118, 0.1120, 0.1117, 0.0000,
         0.1117],
        [0.1117, 0.1114, 0.1119, 0.1116, 0.1119, 0.1117, 0.1116, 0.1115, 0.1117,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0383, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64915377
Epoch560: train_loss: 4.0714 recon_acc: 0.7775 val_roc: 0.7621 val_ap: 0.8308 f1: 0.7133 time: 0.2563
difference_matrix tensor([[0.0000, 0.1114, 0.1118, 0.1115, 0.1116, 0.1119, 0.1113, 0.1115, 0.1115,
         0.1117],
        [0.1114, 0.0000, 0.1118, 0.1113, 0.1114, 0.1118, 0.1112, 0.1111, 0.1118,
         0.1114],
        [0.1118, 0.1118, 0.0000, 0.1118, 0.1121, 0.1117, 0.1114, 0.1119, 0.1122,
         0.1119],
        [0.1115, 0.1113, 0.1118, 0.0000, 0.1118, 0.1121, 0.1115, 0.1111, 0.1119,
         0.1116],
        [0.1116, 0.1114, 0.1121, 0.1118, 0.0000, 0.1114, 0.1120, 0.1117, 0.1120,
         0.1119],
        [0.1119, 0.1118, 0.1117, 0.1121, 0.1114, 0.0000, 0.1120, 0.1117, 0.1118,
         0.1117],
        [0.1113, 0.1112, 0.1114, 0.1115, 0.1120, 0.1120, 0.0000, 0.1110, 0.1119,
         0.1115],
        [0.1115, 0.1111, 0.1119, 0.1111, 0.1117, 0.1117, 0.1110, 0.0000, 0.1116,
         0.1115],
        [0.1115, 0.1118, 0.1122, 0.1119, 0.1120, 0.1118, 0.1119, 0.1116, 0.0000,
         0.1116],
        [0.1117, 0.1114, 0.1119, 0.1116, 0.1119, 0.1117, 0.1115, 0.1115, 0.1116,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0384, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6462298
Epoch561: train_loss: 4.0713 recon_acc: 0.7728 val_roc: 0.7623 val_ap: 0.8310 f1: 0.7143 time: 0.2827
difference_matrix tensor([[0.0000, 0.1114, 0.1118, 0.1115, 0.1116, 0.1119, 0.1113, 0.1115, 0.1114,
         0.1117],
        [0.1114, 0.0000, 0.1117, 0.1113, 0.1113, 0.1117, 0.1111, 0.1111, 0.1117,
         0.1114],
        [0.1118, 0.1117, 0.0000, 0.1118, 0.1121, 0.1117, 0.1114, 0.1119, 0.1122,
         0.1119],
        [0.1115, 0.1113, 0.1118, 0.0000, 0.1118, 0.1121, 0.1114, 0.1111, 0.1119,
         0.1116],
        [0.1116, 0.1113, 0.1121, 0.1118, 0.0000, 0.1114, 0.1120, 0.1117, 0.1119,
         0.1119],
        [0.1119, 0.1117, 0.1117, 0.1121, 0.1114, 0.0000, 0.1120, 0.1117, 0.1117,
         0.1116],
        [0.1113, 0.1111, 0.1114, 0.1114, 0.1120, 0.1120, 0.0000, 0.1110, 0.1119,
         0.1115],
        [0.1115, 0.1111, 0.1119, 0.1111, 0.1117, 0.1117, 0.1110, 0.0000, 0.1116,
         0.1115],
        [0.1114, 0.1117, 0.1122, 0.1119, 0.1119, 0.1117, 0.1119, 0.1116, 0.0000,
         0.1116],
        [0.1117, 0.1114, 0.1119, 0.1116, 0.1119, 0.1116, 0.1115, 0.1115, 0.1116,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0384, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64758724
Epoch562: train_loss: 4.0711 recon_acc: 0.7751 val_roc: 0.7624 val_ap: 0.8311 f1: 0.7160 time: 0.2847
difference_matrix tensor([[0.0000, 0.1113, 0.1118, 0.1114, 0.1115, 0.1118, 0.1113, 0.1114, 0.1114,
         0.1117],
        [0.1113, 0.0000, 0.1117, 0.1113, 0.1113, 0.1117, 0.1111, 0.1110, 0.1117,
         0.1113],
        [0.1118, 0.1117, 0.0000, 0.1118, 0.1121, 0.1117, 0.1114, 0.1118, 0.1121,
         0.1118],
        [0.1114, 0.1113, 0.1118, 0.0000, 0.1118, 0.1121, 0.1114, 0.1111, 0.1119,
         0.1115],
        [0.1115, 0.1113, 0.1121, 0.1118, 0.0000, 0.1114, 0.1120, 0.1116, 0.1119,
         0.1118],
        [0.1118, 0.1117, 0.1117, 0.1121, 0.1114, 0.0000, 0.1119, 0.1116, 0.1117,
         0.1116],
        [0.1113, 0.1111, 0.1114, 0.1114, 0.1120, 0.1119, 0.0000, 0.1110, 0.1119,
         0.1115],
        [0.1114, 0.1110, 0.1118, 0.1111, 0.1116, 0.1116, 0.1110, 0.0000, 0.1116,
         0.1114],
        [0.1114, 0.1117, 0.1121, 0.1119, 0.1119, 0.1117, 0.1119, 0.1116, 0.0000,
         0.1116],
        [0.1117, 0.1113, 0.1118, 0.1115, 0.1118, 0.1116, 0.1115, 0.1114, 0.1116,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0384, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6493388
Epoch563: train_loss: 4.0710 recon_acc: 0.7779 val_roc: 0.7625 val_ap: 0.8312 f1: 0.7163 time: 0.2976
difference_matrix tensor([[0.0000, 0.1113, 0.1118, 0.1114, 0.1115, 0.1118, 0.1112, 0.1114, 0.1114,
         0.1117],
        [0.1113, 0.0000, 0.1117, 0.1112, 0.1113, 0.1117, 0.1111, 0.1110, 0.1117,
         0.1113],
        [0.1118, 0.1117, 0.0000, 0.1118, 0.1120, 0.1116, 0.1113, 0.1118, 0.1121,
         0.1118],
        [0.1114, 0.1112, 0.1118, 0.0000, 0.1118, 0.1121, 0.1114, 0.1110, 0.1119,
         0.1115],
        [0.1115, 0.1113, 0.1120, 0.1118, 0.0000, 0.1114, 0.1119, 0.1116, 0.1119,
         0.1118],
        [0.1118, 0.1117, 0.1116, 0.1121, 0.1114, 0.0000, 0.1119, 0.1116, 0.1117,
         0.1116],
        [0.1112, 0.1111, 0.1113, 0.1114, 0.1119, 0.1119, 0.0000, 0.1110, 0.1119,
         0.1115],
        [0.1114, 0.1110, 0.1118, 0.1110, 0.1116, 0.1116, 0.1110, 0.0000, 0.1116,
         0.1114],
        [0.1114, 0.1117, 0.1121, 0.1119, 0.1119, 0.1117, 0.1119, 0.1116, 0.0000,
         0.1116],
        [0.1117, 0.1113, 0.1118, 0.1115, 0.1118, 0.1116, 0.1115, 0.1114, 0.1116,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0384, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6507486
Epoch564: train_loss: 4.0708 recon_acc: 0.7802 val_roc: 0.7627 val_ap: 0.8313 f1: 0.7163 time: 0.2802
difference_matrix tensor([[0.0000, 0.1113, 0.1117, 0.1114, 0.1115, 0.1118, 0.1112, 0.1114, 0.1114,
         0.1116],
        [0.1113, 0.0000, 0.1117, 0.1112, 0.1113, 0.1117, 0.1111, 0.1110, 0.1117,
         0.1113],
        [0.1117, 0.1117, 0.0000, 0.1118, 0.1120, 0.1116, 0.1113, 0.1118, 0.1121,
         0.1118],
        [0.1114, 0.1112, 0.1118, 0.0000, 0.1118, 0.1120, 0.1114, 0.1110, 0.1119,
         0.1115],
        [0.1115, 0.1113, 0.1120, 0.1118, 0.0000, 0.1113, 0.1119, 0.1116, 0.1119,
         0.1118],
        [0.1118, 0.1117, 0.1116, 0.1120, 0.1113, 0.0000, 0.1119, 0.1116, 0.1117,
         0.1116],
        [0.1112, 0.1111, 0.1113, 0.1114, 0.1119, 0.1119, 0.0000, 0.1109, 0.1119,
         0.1114],
        [0.1114, 0.1110, 0.1118, 0.1110, 0.1116, 0.1116, 0.1109, 0.0000, 0.1116,
         0.1114],
        [0.1114, 0.1117, 0.1121, 0.1119, 0.1119, 0.1117, 0.1119, 0.1116, 0.0000,
         0.1116],
        [0.1116, 0.1113, 0.1118, 0.1115, 0.1118, 0.1116, 0.1114, 0.1114, 0.1116,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0384, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65080297
Epoch565: train_loss: 4.0707 recon_acc: 0.7803 val_roc: 0.7627 val_ap: 0.8313 f1: 0.7163 time: 0.2949
difference_matrix tensor([[0.0000, 0.1113, 0.1117, 0.1114, 0.1115, 0.1118, 0.1112, 0.1114, 0.1114,
         0.1116],
        [0.1113, 0.0000, 0.1117, 0.1112, 0.1113, 0.1117, 0.1110, 0.1110, 0.1117,
         0.1113],
        [0.1117, 0.1117, 0.0000, 0.1117, 0.1120, 0.1116, 0.1113, 0.1118, 0.1121,
         0.1118],
        [0.1114, 0.1112, 0.1117, 0.0000, 0.1117, 0.1120, 0.1114, 0.1110, 0.1118,
         0.1115],
        [0.1115, 0.1113, 0.1120, 0.1117, 0.0000, 0.1113, 0.1119, 0.1116, 0.1118,
         0.1118],
        [0.1118, 0.1117, 0.1116, 0.1120, 0.1113, 0.0000, 0.1119, 0.1116, 0.1117,
         0.1116],
        [0.1112, 0.1110, 0.1113, 0.1114, 0.1119, 0.1119, 0.0000, 0.1109, 0.1118,
         0.1114],
        [0.1114, 0.1110, 0.1118, 0.1110, 0.1116, 0.1116, 0.1109, 0.0000, 0.1115,
         0.1114],
        [0.1114, 0.1117, 0.1121, 0.1118, 0.1119, 0.1117, 0.1118, 0.1115, 0.0000,
         0.1115],
        [0.1116, 0.1113, 0.1118, 0.1115, 0.1118, 0.1116, 0.1114, 0.1114, 0.1115,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0385, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65085524
Epoch566: train_loss: 4.0705 recon_acc: 0.7804 val_roc: 0.7628 val_ap: 0.8313 f1: 0.7163 time: 0.2491
difference_matrix tensor([[0.0000, 0.1112, 0.1117, 0.1113, 0.1115, 0.1117, 0.1112, 0.1114, 0.1113,
         0.1116],
        [0.1112, 0.0000, 0.1116, 0.1112, 0.1112, 0.1116, 0.1110, 0.1109, 0.1116,
         0.1112],
        [0.1117, 0.1116, 0.0000, 0.1117, 0.1120, 0.1116, 0.1113, 0.1118, 0.1121,
         0.1118],
        [0.1113, 0.1112, 0.1117, 0.0000, 0.1117, 0.1120, 0.1113, 0.1110, 0.1118,
         0.1115],
        [0.1115, 0.1112, 0.1120, 0.1117, 0.0000, 0.1113, 0.1119, 0.1116, 0.1118,
         0.1117],
        [0.1117, 0.1116, 0.1116, 0.1120, 0.1113, 0.0000, 0.1119, 0.1116, 0.1116,
         0.1115],
        [0.1112, 0.1110, 0.1113, 0.1113, 0.1119, 0.1119, 0.0000, 0.1109, 0.1118,
         0.1114],
        [0.1114, 0.1109, 0.1118, 0.1110, 0.1116, 0.1116, 0.1109, 0.0000, 0.1115,
         0.1114],
        [0.1113, 0.1116, 0.1121, 0.1118, 0.1118, 0.1116, 0.1118, 0.1115, 0.0000,
         0.1115],
        [0.1116, 0.1112, 0.1118, 0.1115, 0.1117, 0.1115, 0.1114, 0.1114, 0.1115,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0385, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6509055
Epoch567: train_loss: 4.0704 recon_acc: 0.7806 val_roc: 0.7629 val_ap: 0.8314 f1: 0.7163 time: 0.2486
difference_matrix tensor([[0.0000, 0.1112, 0.1117, 0.1113, 0.1114, 0.1117, 0.1111, 0.1113, 0.1113,
         0.1116],
        [0.1112, 0.0000, 0.1116, 0.1112, 0.1112, 0.1116, 0.1110, 0.1109, 0.1116,
         0.1112],
        [0.1117, 0.1116, 0.0000, 0.1117, 0.1120, 0.1115, 0.1113, 0.1117, 0.1120,
         0.1117],
        [0.1113, 0.1112, 0.1117, 0.0000, 0.1117, 0.1120, 0.1113, 0.1110, 0.1118,
         0.1114],
        [0.1114, 0.1112, 0.1120, 0.1117, 0.0000, 0.1113, 0.1119, 0.1115, 0.1118,
         0.1117],
        [0.1117, 0.1116, 0.1115, 0.1120, 0.1113, 0.0000, 0.1118, 0.1115, 0.1116,
         0.1115],
        [0.1111, 0.1110, 0.1113, 0.1113, 0.1119, 0.1118, 0.0000, 0.1109, 0.1118,
         0.1114],
        [0.1113, 0.1109, 0.1117, 0.1110, 0.1115, 0.1115, 0.1109, 0.0000, 0.1115,
         0.1113],
        [0.1113, 0.1116, 0.1120, 0.1118, 0.1118, 0.1116, 0.1118, 0.1115, 0.0000,
         0.1115],
        [0.1116, 0.1112, 0.1117, 0.1114, 0.1117, 0.1115, 0.1114, 0.1113, 0.1115,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0385, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65095353
Epoch568: train_loss: 4.0702 recon_acc: 0.7807 val_roc: 0.7630 val_ap: 0.8315 f1: 0.7163 time: 0.2502
difference_matrix tensor([[0.0000, 0.1112, 0.1117, 0.1113, 0.1114, 0.1117, 0.1111, 0.1113, 0.1113,
         0.1116],
        [0.1112, 0.0000, 0.1116, 0.1111, 0.1112, 0.1116, 0.1110, 0.1109, 0.1116,
         0.1112],
        [0.1117, 0.1116, 0.0000, 0.1117, 0.1119, 0.1115, 0.1112, 0.1117, 0.1120,
         0.1117],
        [0.1113, 0.1111, 0.1117, 0.0000, 0.1117, 0.1120, 0.1113, 0.1109, 0.1118,
         0.1114],
        [0.1114, 0.1112, 0.1119, 0.1117, 0.0000, 0.1112, 0.1118, 0.1115, 0.1118,
         0.1117],
        [0.1117, 0.1116, 0.1115, 0.1120, 0.1112, 0.0000, 0.1118, 0.1115, 0.1116,
         0.1115],
        [0.1111, 0.1110, 0.1112, 0.1113, 0.1118, 0.1118, 0.0000, 0.1109, 0.1118,
         0.1114],
        [0.1113, 0.1109, 0.1117, 0.1109, 0.1115, 0.1115, 0.1109, 0.0000, 0.1115,
         0.1113],
        [0.1113, 0.1116, 0.1120, 0.1118, 0.1118, 0.1116, 0.1118, 0.1115, 0.0000,
         0.1115],
        [0.1116, 0.1112, 0.1117, 0.1114, 0.1117, 0.1115, 0.1114, 0.1113, 0.1115,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0385, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65099955
Epoch569: train_loss: 4.0701 recon_acc: 0.7808 val_roc: 0.7630 val_ap: 0.8316 f1: 0.7163 time: 0.2598
difference_matrix tensor([[0.0000, 0.1112, 0.1116, 0.1113, 0.1114, 0.1117, 0.1111, 0.1113, 0.1113,
         0.1115],
        [0.1112, 0.0000, 0.1116, 0.1111, 0.1112, 0.1116, 0.1110, 0.1109, 0.1116,
         0.1112],
        [0.1116, 0.1116, 0.0000, 0.1117, 0.1119, 0.1115, 0.1112, 0.1117, 0.1120,
         0.1117],
        [0.1113, 0.1111, 0.1117, 0.0000, 0.1117, 0.1120, 0.1113, 0.1109, 0.1118,
         0.1114],
        [0.1114, 0.1112, 0.1119, 0.1117, 0.0000, 0.1112, 0.1118, 0.1115, 0.1118,
         0.1117],
        [0.1117, 0.1116, 0.1115, 0.1120, 0.1112, 0.0000, 0.1118, 0.1115, 0.1116,
         0.1115],
        [0.1111, 0.1110, 0.1112, 0.1113, 0.1118, 0.1118, 0.0000, 0.1108, 0.1118,
         0.1113],
        [0.1113, 0.1109, 0.1117, 0.1109, 0.1115, 0.1115, 0.1108, 0.0000, 0.1115,
         0.1113],
        [0.1113, 0.1116, 0.1120, 0.1118, 0.1118, 0.1116, 0.1118, 0.1115, 0.0000,
         0.1115],
        [0.1115, 0.1112, 0.1117, 0.1114, 0.1117, 0.1115, 0.1113, 0.1113, 0.1115,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0385, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65104353
Epoch570: train_loss: 4.0699 recon_acc: 0.7809 val_roc: 0.7631 val_ap: 0.8316 f1: 0.7163 time: 0.2564
difference_matrix tensor([[0.0000, 0.1112, 0.1116, 0.1113, 0.1114, 0.1117, 0.1111, 0.1113, 0.1113,
         0.1115],
        [0.1112, 0.0000, 0.1116, 0.1111, 0.1112, 0.1116, 0.1109, 0.1109, 0.1116,
         0.1112],
        [0.1116, 0.1116, 0.0000, 0.1116, 0.1119, 0.1115, 0.1112, 0.1117, 0.1120,
         0.1117],
        [0.1113, 0.1111, 0.1116, 0.0000, 0.1116, 0.1119, 0.1113, 0.1109, 0.1117,
         0.1114],
        [0.1114, 0.1112, 0.1119, 0.1116, 0.0000, 0.1112, 0.1118, 0.1115, 0.1117,
         0.1117],
        [0.1117, 0.1116, 0.1115, 0.1119, 0.1112, 0.0000, 0.1118, 0.1115, 0.1116,
         0.1115],
        [0.1111, 0.1109, 0.1112, 0.1113, 0.1118, 0.1118, 0.0000, 0.1108, 0.1117,
         0.1113],
        [0.1113, 0.1109, 0.1117, 0.1109, 0.1115, 0.1115, 0.1108, 0.0000, 0.1114,
         0.1113],
        [0.1113, 0.1116, 0.1120, 0.1117, 0.1117, 0.1116, 0.1117, 0.1114, 0.0000,
         0.1114],
        [0.1115, 0.1112, 0.1117, 0.1114, 0.1117, 0.1115, 0.1113, 0.1113, 0.1114,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0386, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6510855
Epoch571: train_loss: 4.0698 recon_acc: 0.7810 val_roc: 0.7631 val_ap: 0.8317 f1: 0.7163 time: 0.2694
difference_matrix tensor([[0.0000, 0.1111, 0.1116, 0.1112, 0.1114, 0.1116, 0.1111, 0.1113, 0.1112,
         0.1115],
        [0.1111, 0.0000, 0.1115, 0.1111, 0.1111, 0.1115, 0.1109, 0.1108, 0.1115,
         0.1111],
        [0.1116, 0.1115, 0.0000, 0.1116, 0.1119, 0.1115, 0.1112, 0.1117, 0.1120,
         0.1117],
        [0.1112, 0.1111, 0.1116, 0.0000, 0.1116, 0.1119, 0.1112, 0.1109, 0.1117,
         0.1114],
        [0.1114, 0.1111, 0.1119, 0.1116, 0.0000, 0.1112, 0.1118, 0.1114, 0.1117,
         0.1116],
        [0.1116, 0.1115, 0.1115, 0.1119, 0.1112, 0.0000, 0.1118, 0.1115, 0.1115,
         0.1114],
        [0.1111, 0.1109, 0.1112, 0.1112, 0.1118, 0.1118, 0.0000, 0.1108, 0.1117,
         0.1113],
        [0.1113, 0.1108, 0.1117, 0.1109, 0.1114, 0.1115, 0.1108, 0.0000, 0.1114,
         0.1113],
        [0.1112, 0.1115, 0.1120, 0.1117, 0.1117, 0.1115, 0.1117, 0.1114, 0.0000,
         0.1114],
        [0.1115, 0.1111, 0.1117, 0.1114, 0.1116, 0.1114, 0.1113, 0.1113, 0.1114,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0386, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65112543
Epoch572: train_loss: 4.0696 recon_acc: 0.7811 val_roc: 0.7631 val_ap: 0.8317 f1: 0.7163 time: 0.2410
difference_matrix tensor([[0.0000, 0.1111, 0.1116, 0.1112, 0.1113, 0.1116, 0.1110, 0.1112, 0.1112,
         0.1115],
        [0.1111, 0.0000, 0.1115, 0.1111, 0.1111, 0.1115, 0.1109, 0.1108, 0.1115,
         0.1111],
        [0.1116, 0.1115, 0.0000, 0.1116, 0.1119, 0.1114, 0.1112, 0.1116, 0.1119,
         0.1116],
        [0.1112, 0.1111, 0.1116, 0.0000, 0.1116, 0.1119, 0.1112, 0.1109, 0.1117,
         0.1113],
        [0.1113, 0.1111, 0.1119, 0.1116, 0.0000, 0.1112, 0.1118, 0.1114, 0.1117,
         0.1116],
        [0.1116, 0.1115, 0.1114, 0.1119, 0.1112, 0.0000, 0.1117, 0.1114, 0.1115,
         0.1114],
        [0.1110, 0.1109, 0.1112, 0.1112, 0.1118, 0.1117, 0.0000, 0.1108, 0.1117,
         0.1113],
        [0.1112, 0.1108, 0.1116, 0.1109, 0.1114, 0.1114, 0.1108, 0.0000, 0.1114,
         0.1112],
        [0.1112, 0.1115, 0.1119, 0.1117, 0.1117, 0.1115, 0.1117, 0.1114, 0.0000,
         0.1114],
        [0.1115, 0.1111, 0.1116, 0.1113, 0.1116, 0.1114, 0.1113, 0.1112, 0.1114,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0386, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64190936
Epoch573: train_loss: 4.0695 recon_acc: 0.7663 val_roc: 0.7633 val_ap: 0.8318 f1: 0.7173 time: 0.2571
difference_matrix tensor([[0.0000, 0.1111, 0.1116, 0.1112, 0.1113, 0.1116, 0.1110, 0.1112, 0.1112,
         0.1115],
        [0.1111, 0.0000, 0.1115, 0.1110, 0.1111, 0.1115, 0.1109, 0.1108, 0.1115,
         0.1111],
        [0.1116, 0.1115, 0.0000, 0.1116, 0.1118, 0.1114, 0.1111, 0.1116, 0.1119,
         0.1116],
        [0.1112, 0.1110, 0.1116, 0.0000, 0.1116, 0.1119, 0.1112, 0.1108, 0.1117,
         0.1113],
        [0.1113, 0.1111, 0.1118, 0.1116, 0.0000, 0.1111, 0.1117, 0.1114, 0.1117,
         0.1116],
        [0.1116, 0.1115, 0.1114, 0.1119, 0.1111, 0.0000, 0.1117, 0.1114, 0.1115,
         0.1114],
        [0.1110, 0.1109, 0.1111, 0.1112, 0.1117, 0.1117, 0.0000, 0.1108, 0.1117,
         0.1113],
        [0.1112, 0.1108, 0.1116, 0.1108, 0.1114, 0.1114, 0.1108, 0.0000, 0.1114,
         0.1112],
        [0.1112, 0.1115, 0.1119, 0.1117, 0.1117, 0.1115, 0.1117, 0.1114, 0.0000,
         0.1114],
        [0.1115, 0.1111, 0.1116, 0.1113, 0.1116, 0.1114, 0.1113, 0.1112, 0.1114,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0386, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.642813
Epoch574: train_loss: 4.0693 recon_acc: 0.7678 val_roc: 0.7634 val_ap: 0.8319 f1: 0.7173 time: 0.2544
difference_matrix tensor([[0.0000, 0.1111, 0.1115, 0.1112, 0.1113, 0.1116, 0.1110, 0.1112, 0.1112,
         0.1114],
        [0.1111, 0.0000, 0.1115, 0.1110, 0.1111, 0.1115, 0.1109, 0.1108, 0.1115,
         0.1111],
        [0.1115, 0.1115, 0.0000, 0.1116, 0.1118, 0.1114, 0.1111, 0.1116, 0.1119,
         0.1116],
        [0.1112, 0.1110, 0.1116, 0.0000, 0.1116, 0.1119, 0.1112, 0.1108, 0.1117,
         0.1113],
        [0.1113, 0.1111, 0.1118, 0.1116, 0.0000, 0.1111, 0.1117, 0.1114, 0.1117,
         0.1116],
        [0.1116, 0.1115, 0.1114, 0.1119, 0.1111, 0.0000, 0.1117, 0.1114, 0.1115,
         0.1114],
        [0.1110, 0.1109, 0.1111, 0.1112, 0.1117, 0.1117, 0.0000, 0.1107, 0.1116,
         0.1112],
        [0.1112, 0.1108, 0.1116, 0.1108, 0.1114, 0.1114, 0.1107, 0.0000, 0.1114,
         0.1112],
        [0.1112, 0.1115, 0.1119, 0.1117, 0.1117, 0.1115, 0.1116, 0.1114, 0.0000,
         0.1114],
        [0.1114, 0.1111, 0.1116, 0.1113, 0.1116, 0.1114, 0.1112, 0.1112, 0.1114,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0386, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6437149
Epoch575: train_loss: 4.0692 recon_acc: 0.7693 val_roc: 0.7634 val_ap: 0.8319 f1: 0.7173 time: 0.2661
difference_matrix tensor([[0.0000, 0.1111, 0.1115, 0.1112, 0.1113, 0.1116, 0.1110, 0.1112, 0.1112,
         0.1114],
        [0.1111, 0.0000, 0.1115, 0.1110, 0.1111, 0.1115, 0.1108, 0.1108, 0.1115,
         0.1111],
        [0.1115, 0.1115, 0.0000, 0.1116, 0.1118, 0.1114, 0.1111, 0.1116, 0.1119,
         0.1116],
        [0.1112, 0.1110, 0.1116, 0.0000, 0.1115, 0.1118, 0.1112, 0.1108, 0.1116,
         0.1113],
        [0.1113, 0.1111, 0.1118, 0.1115, 0.0000, 0.1111, 0.1117, 0.1114, 0.1117,
         0.1116],
        [0.1116, 0.1115, 0.1114, 0.1118, 0.1111, 0.0000, 0.1117, 0.1114, 0.1115,
         0.1114],
        [0.1110, 0.1108, 0.1111, 0.1112, 0.1117, 0.1117, 0.0000, 0.1107, 0.1116,
         0.1112],
        [0.1112, 0.1108, 0.1116, 0.1108, 0.1114, 0.1114, 0.1107, 0.0000, 0.1113,
         0.1112],
        [0.1112, 0.1115, 0.1119, 0.1116, 0.1117, 0.1115, 0.1116, 0.1113, 0.0000,
         0.1113],
        [0.1114, 0.1111, 0.1116, 0.1113, 0.1116, 0.1114, 0.1112, 0.1112, 0.1113,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0387, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64461505
Epoch576: train_loss: 4.0691 recon_acc: 0.7708 val_roc: 0.7635 val_ap: 0.8320 f1: 0.7190 time: 0.2857
difference_matrix tensor([[0.0000, 0.1111, 0.1115, 0.1111, 0.1113, 0.1116, 0.1110, 0.1112, 0.1111,
         0.1114],
        [0.1111, 0.0000, 0.1114, 0.1110, 0.1110, 0.1114, 0.1108, 0.1107, 0.1115,
         0.1110],
        [0.1115, 0.1114, 0.0000, 0.1115, 0.1118, 0.1113, 0.1111, 0.1116, 0.1119,
         0.1116],
        [0.1111, 0.1110, 0.1115, 0.0000, 0.1115, 0.1118, 0.1111, 0.1108, 0.1116,
         0.1113],
        [0.1113, 0.1110, 0.1118, 0.1115, 0.0000, 0.1111, 0.1117, 0.1114, 0.1116,
         0.1115],
        [0.1116, 0.1114, 0.1113, 0.1118, 0.1111, 0.0000, 0.1117, 0.1114, 0.1115,
         0.1113],
        [0.1110, 0.1108, 0.1111, 0.1111, 0.1117, 0.1117, 0.0000, 0.1107, 0.1116,
         0.1112],
        [0.1112, 0.1107, 0.1116, 0.1108, 0.1114, 0.1114, 0.1107, 0.0000, 0.1113,
         0.1112],
        [0.1111, 0.1115, 0.1119, 0.1116, 0.1116, 0.1115, 0.1116, 0.1113, 0.0000,
         0.1113],
        [0.1114, 0.1110, 0.1116, 0.1113, 0.1115, 0.1113, 0.1112, 0.1112, 0.1113,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0387, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6445878
Epoch577: train_loss: 4.0689 recon_acc: 0.7708 val_roc: 0.7636 val_ap: 0.8321 f1: 0.7173 time: 0.2781
difference_matrix tensor([[0.0000, 0.1110, 0.1115, 0.1111, 0.1112, 0.1115, 0.1109, 0.1112, 0.1111,
         0.1114],
        [0.1110, 0.0000, 0.1114, 0.1110, 0.1110, 0.1114, 0.1108, 0.1107, 0.1114,
         0.1110],
        [0.1115, 0.1114, 0.0000, 0.1115, 0.1118, 0.1113, 0.1111, 0.1116, 0.1118,
         0.1115],
        [0.1111, 0.1110, 0.1115, 0.0000, 0.1115, 0.1118, 0.1111, 0.1108, 0.1116,
         0.1112],
        [0.1112, 0.1110, 0.1118, 0.1115, 0.0000, 0.1111, 0.1117, 0.1113, 0.1116,
         0.1115],
        [0.1115, 0.1114, 0.1113, 0.1118, 0.1111, 0.0000, 0.1117, 0.1113, 0.1114,
         0.1113],
        [0.1109, 0.1108, 0.1111, 0.1111, 0.1117, 0.1117, 0.0000, 0.1107, 0.1116,
         0.1112],
        [0.1112, 0.1107, 0.1116, 0.1108, 0.1113, 0.1113, 0.1107, 0.0000, 0.1113,
         0.1111],
        [0.1111, 0.1114, 0.1118, 0.1116, 0.1116, 0.1114, 0.1116, 0.1113, 0.0000,
         0.1113],
        [0.1114, 0.1110, 0.1115, 0.1112, 0.1115, 0.1113, 0.1112, 0.1111, 0.1113,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0387, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64438057
Epoch578: train_loss: 4.0688 recon_acc: 0.7705 val_roc: 0.7637 val_ap: 0.8322 f1: 0.7173 time: 0.2933
difference_matrix tensor([[0.0000, 0.1110, 0.1115, 0.1111, 0.1112, 0.1115, 0.1109, 0.1111, 0.1111,
         0.1114],
        [0.1110, 0.0000, 0.1114, 0.1109, 0.1110, 0.1114, 0.1108, 0.1107, 0.1114,
         0.1110],
        [0.1115, 0.1114, 0.0000, 0.1115, 0.1117, 0.1113, 0.1110, 0.1115, 0.1118,
         0.1115],
        [0.1111, 0.1109, 0.1115, 0.0000, 0.1115, 0.1118, 0.1111, 0.1107, 0.1116,
         0.1112],
        [0.1112, 0.1110, 0.1117, 0.1115, 0.0000, 0.1110, 0.1116, 0.1113, 0.1116,
         0.1115],
        [0.1115, 0.1114, 0.1113, 0.1118, 0.1110, 0.0000, 0.1116, 0.1113, 0.1114,
         0.1113],
        [0.1109, 0.1108, 0.1110, 0.1111, 0.1116, 0.1116, 0.0000, 0.1107, 0.1116,
         0.1112],
        [0.1111, 0.1107, 0.1115, 0.1107, 0.1113, 0.1113, 0.1107, 0.0000, 0.1113,
         0.1111],
        [0.1111, 0.1114, 0.1118, 0.1116, 0.1116, 0.1114, 0.1116, 0.1113, 0.0000,
         0.1113],
        [0.1114, 0.1110, 0.1115, 0.1112, 0.1115, 0.1113, 0.1112, 0.1111, 0.1113,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0387, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6473046
Epoch579: train_loss: 4.0686 recon_acc: 0.7752 val_roc: 0.7637 val_ap: 0.8322 f1: 0.7177 time: 0.2978
difference_matrix tensor([[0.0000, 0.1110, 0.1114, 0.1111, 0.1112, 0.1115, 0.1109, 0.1111, 0.1111,
         0.1113],
        [0.1110, 0.0000, 0.1114, 0.1109, 0.1110, 0.1114, 0.1108, 0.1107, 0.1114,
         0.1110],
        [0.1114, 0.1114, 0.0000, 0.1115, 0.1117, 0.1113, 0.1110, 0.1115, 0.1118,
         0.1115],
        [0.1111, 0.1109, 0.1115, 0.0000, 0.1115, 0.1118, 0.1111, 0.1107, 0.1116,
         0.1112],
        [0.1112, 0.1110, 0.1117, 0.1115, 0.0000, 0.1110, 0.1116, 0.1113, 0.1116,
         0.1115],
        [0.1115, 0.1114, 0.1113, 0.1118, 0.1110, 0.0000, 0.1116, 0.1113, 0.1114,
         0.1113],
        [0.1109, 0.1108, 0.1110, 0.1111, 0.1116, 0.1116, 0.0000, 0.1106, 0.1115,
         0.1111],
        [0.1111, 0.1107, 0.1115, 0.1107, 0.1113, 0.1113, 0.1106, 0.0000, 0.1113,
         0.1111],
        [0.1111, 0.1114, 0.1118, 0.1116, 0.1116, 0.1114, 0.1115, 0.1113, 0.0000,
         0.1113],
        [0.1113, 0.1110, 0.1115, 0.1112, 0.1115, 0.1113, 0.1111, 0.1111, 0.1113,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0387, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64819753
Epoch580: train_loss: 4.0685 recon_acc: 0.7767 val_roc: 0.7638 val_ap: 0.8323 f1: 0.7177 time: 0.2629
difference_matrix tensor([[0.0000, 0.1110, 0.1114, 0.1111, 0.1112, 0.1115, 0.1109, 0.1111, 0.1111,
         0.1113],
        [0.1110, 0.0000, 0.1114, 0.1109, 0.1110, 0.1114, 0.1107, 0.1107, 0.1114,
         0.1110],
        [0.1114, 0.1114, 0.0000, 0.1115, 0.1117, 0.1113, 0.1110, 0.1115, 0.1118,
         0.1115],
        [0.1111, 0.1109, 0.1115, 0.0000, 0.1114, 0.1117, 0.1111, 0.1107, 0.1115,
         0.1112],
        [0.1112, 0.1110, 0.1117, 0.1114, 0.0000, 0.1110, 0.1116, 0.1113, 0.1116,
         0.1115],
        [0.1115, 0.1114, 0.1113, 0.1117, 0.1110, 0.0000, 0.1116, 0.1113, 0.1114,
         0.1113],
        [0.1109, 0.1107, 0.1110, 0.1111, 0.1116, 0.1116, 0.0000, 0.1106, 0.1115,
         0.1111],
        [0.1111, 0.1107, 0.1115, 0.1107, 0.1113, 0.1113, 0.1106, 0.0000, 0.1113,
         0.1111],
        [0.1111, 0.1114, 0.1118, 0.1115, 0.1116, 0.1114, 0.1115, 0.1113, 0.0000,
         0.1113],
        [0.1113, 0.1110, 0.1115, 0.1112, 0.1115, 0.1113, 0.1111, 0.1111, 0.1113,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0388, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6490887
Epoch581: train_loss: 4.0684 recon_acc: 0.7782 val_roc: 0.7640 val_ap: 0.8325 f1: 0.7177 time: 0.2614
difference_matrix tensor([[0.0000, 0.1110, 0.1114, 0.1111, 0.1112, 0.1115, 0.1109, 0.1111, 0.1111,
         0.1113],
        [0.1110, 0.0000, 0.1114, 0.1109, 0.1109, 0.1114, 0.1107, 0.1106, 0.1114,
         0.1109],
        [0.1114, 0.1114, 0.0000, 0.1114, 0.1117, 0.1112, 0.1110, 0.1115, 0.1118,
         0.1115],
        [0.1111, 0.1109, 0.1114, 0.0000, 0.1114, 0.1117, 0.1110, 0.1107, 0.1115,
         0.1112],
        [0.1112, 0.1109, 0.1117, 0.1114, 0.0000, 0.1110, 0.1116, 0.1113, 0.1115,
         0.1115],
        [0.1115, 0.1114, 0.1112, 0.1117, 0.1110, 0.0000, 0.1116, 0.1113, 0.1114,
         0.1112],
        [0.1109, 0.1107, 0.1110, 0.1110, 0.1116, 0.1116, 0.0000, 0.1106, 0.1115,
         0.1111],
        [0.1111, 0.1106, 0.1115, 0.1107, 0.1113, 0.1113, 0.1106, 0.0000, 0.1112,
         0.1111],
        [0.1111, 0.1114, 0.1118, 0.1115, 0.1115, 0.1114, 0.1115, 0.1112, 0.0000,
         0.1112],
        [0.1113, 0.1109, 0.1115, 0.1112, 0.1115, 0.1112, 0.1111, 0.1111, 0.1112,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0388, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64195603
Epoch582: train_loss: 4.0682 recon_acc: 0.7667 val_roc: 0.7641 val_ap: 0.8326 f1: 0.7187 time: 0.2562
difference_matrix tensor([[0.0000, 0.1109, 0.1114, 0.1110, 0.1111, 0.1114, 0.1108, 0.1111, 0.1110,
         0.1113],
        [0.1109, 0.0000, 0.1113, 0.1109, 0.1109, 0.1113, 0.1107, 0.1106, 0.1113,
         0.1109],
        [0.1114, 0.1113, 0.0000, 0.1114, 0.1117, 0.1112, 0.1110, 0.1115, 0.1117,
         0.1115],
        [0.1110, 0.1109, 0.1114, 0.0000, 0.1114, 0.1117, 0.1110, 0.1107, 0.1115,
         0.1111],
        [0.1111, 0.1109, 0.1117, 0.1114, 0.0000, 0.1110, 0.1116, 0.1112, 0.1115,
         0.1114],
        [0.1114, 0.1113, 0.1112, 0.1117, 0.1110, 0.0000, 0.1116, 0.1112, 0.1113,
         0.1112],
        [0.1108, 0.1107, 0.1110, 0.1110, 0.1116, 0.1116, 0.0000, 0.1106, 0.1115,
         0.1111],
        [0.1111, 0.1106, 0.1115, 0.1107, 0.1112, 0.1112, 0.1106, 0.0000, 0.1112,
         0.1110],
        [0.1110, 0.1113, 0.1117, 0.1115, 0.1115, 0.1113, 0.1115, 0.1112, 0.0000,
         0.1112],
        [0.1113, 0.1109, 0.1115, 0.1111, 0.1114, 0.1112, 0.1111, 0.1110, 0.1112,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0388, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6423088
Epoch583: train_loss: 4.0681 recon_acc: 0.7673 val_roc: 0.7642 val_ap: 0.8326 f1: 0.7204 time: 0.2539
difference_matrix tensor([[0.0000, 0.1109, 0.1114, 0.1110, 0.1111, 0.1114, 0.1108, 0.1110, 0.1110,
         0.1113],
        [0.1109, 0.0000, 0.1113, 0.1109, 0.1109, 0.1113, 0.1107, 0.1106, 0.1113,
         0.1109],
        [0.1114, 0.1113, 0.0000, 0.1114, 0.1116, 0.1112, 0.1109, 0.1114, 0.1117,
         0.1114],
        [0.1110, 0.1109, 0.1114, 0.0000, 0.1114, 0.1117, 0.1110, 0.1106, 0.1115,
         0.1111],
        [0.1111, 0.1109, 0.1116, 0.1114, 0.0000, 0.1109, 0.1116, 0.1112, 0.1115,
         0.1114],
        [0.1114, 0.1113, 0.1112, 0.1117, 0.1109, 0.0000, 0.1116, 0.1112, 0.1113,
         0.1112],
        [0.1108, 0.1107, 0.1109, 0.1110, 0.1116, 0.1116, 0.0000, 0.1106, 0.1115,
         0.1111],
        [0.1110, 0.1106, 0.1114, 0.1106, 0.1112, 0.1112, 0.1106, 0.0000, 0.1112,
         0.1110],
        [0.1110, 0.1113, 0.1117, 0.1115, 0.1115, 0.1113, 0.1115, 0.1112, 0.0000,
         0.1112],
        [0.1113, 0.1109, 0.1114, 0.1111, 0.1114, 0.1112, 0.1111, 0.1110, 0.1112,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0388, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64265984
Epoch584: train_loss: 4.0680 recon_acc: 0.7679 val_roc: 0.7642 val_ap: 0.8326 f1: 0.7204 time: 0.2766
difference_matrix tensor([[0.0000, 0.1109, 0.1114, 0.1110, 0.1111, 0.1114, 0.1108, 0.1110, 0.1110,
         0.1113],
        [0.1109, 0.0000, 0.1113, 0.1108, 0.1109, 0.1113, 0.1107, 0.1106, 0.1113,
         0.1109],
        [0.1114, 0.1113, 0.0000, 0.1114, 0.1116, 0.1112, 0.1109, 0.1114, 0.1117,
         0.1114],
        [0.1110, 0.1108, 0.1114, 0.0000, 0.1114, 0.1117, 0.1110, 0.1106, 0.1115,
         0.1111],
        [0.1111, 0.1109, 0.1116, 0.1114, 0.0000, 0.1109, 0.1115, 0.1112, 0.1115,
         0.1114],
        [0.1114, 0.1113, 0.1112, 0.1117, 0.1109, 0.0000, 0.1115, 0.1112, 0.1113,
         0.1112],
        [0.1108, 0.1107, 0.1109, 0.1110, 0.1115, 0.1115, 0.0000, 0.1105, 0.1115,
         0.1111],
        [0.1110, 0.1106, 0.1114, 0.1106, 0.1112, 0.1112, 0.1105, 0.0000, 0.1112,
         0.1110],
        [0.1110, 0.1113, 0.1117, 0.1115, 0.1115, 0.1113, 0.1115, 0.1112, 0.0000,
         0.1112],
        [0.1113, 0.1109, 0.1114, 0.1111, 0.1114, 0.1112, 0.1111, 0.1110, 0.1112,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0388, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6429065
Epoch585: train_loss: 4.0678 recon_acc: 0.7684 val_roc: 0.7642 val_ap: 0.8326 f1: 0.7204 time: 0.2711
difference_matrix tensor([[0.0000, 0.1109, 0.1113, 0.1110, 0.1111, 0.1114, 0.1108, 0.1110, 0.1110,
         0.1112],
        [0.1109, 0.0000, 0.1113, 0.1108, 0.1109, 0.1113, 0.1106, 0.1106, 0.1113,
         0.1109],
        [0.1113, 0.1113, 0.0000, 0.1114, 0.1116, 0.1112, 0.1109, 0.1114, 0.1117,
         0.1114],
        [0.1110, 0.1108, 0.1114, 0.0000, 0.1114, 0.1117, 0.1110, 0.1106, 0.1114,
         0.1111],
        [0.1111, 0.1109, 0.1116, 0.1114, 0.0000, 0.1109, 0.1115, 0.1112, 0.1115,
         0.1114],
        [0.1114, 0.1113, 0.1112, 0.1117, 0.1109, 0.0000, 0.1115, 0.1112, 0.1113,
         0.1112],
        [0.1108, 0.1106, 0.1109, 0.1110, 0.1115, 0.1115, 0.0000, 0.1105, 0.1114,
         0.1110],
        [0.1110, 0.1106, 0.1114, 0.1106, 0.1112, 0.1112, 0.1105, 0.0000, 0.1112,
         0.1110],
        [0.1110, 0.1113, 0.1117, 0.1114, 0.1115, 0.1113, 0.1114, 0.1112, 0.0000,
         0.1112],
        [0.1112, 0.1109, 0.1114, 0.1111, 0.1114, 0.1112, 0.1110, 0.1110, 0.1112,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0388, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64269274
Epoch586: train_loss: 4.0677 recon_acc: 0.7680 val_roc: 0.7642 val_ap: 0.8326 f1: 0.7204 time: 0.2675
difference_matrix tensor([[0.0000, 0.1109, 0.1113, 0.1110, 0.1111, 0.1114, 0.1108, 0.1110, 0.1110,
         0.1112],
        [0.1109, 0.0000, 0.1113, 0.1108, 0.1109, 0.1113, 0.1106, 0.1106, 0.1113,
         0.1109],
        [0.1113, 0.1113, 0.0000, 0.1114, 0.1116, 0.1112, 0.1109, 0.1114, 0.1117,
         0.1114],
        [0.1110, 0.1108, 0.1114, 0.0000, 0.1113, 0.1116, 0.1110, 0.1106, 0.1114,
         0.1111],
        [0.1111, 0.1109, 0.1116, 0.1113, 0.0000, 0.1109, 0.1115, 0.1112, 0.1114,
         0.1114],
        [0.1114, 0.1113, 0.1112, 0.1116, 0.1109, 0.0000, 0.1115, 0.1112, 0.1113,
         0.1112],
        [0.1108, 0.1106, 0.1109, 0.1110, 0.1115, 0.1115, 0.0000, 0.1105, 0.1114,
         0.1110],
        [0.1110, 0.1106, 0.1114, 0.1106, 0.1112, 0.1112, 0.1105, 0.0000, 0.1111,
         0.1110],
        [0.1110, 0.1113, 0.1117, 0.1114, 0.1114, 0.1113, 0.1114, 0.1111, 0.0000,
         0.1112],
        [0.1112, 0.1109, 0.1114, 0.1111, 0.1114, 0.1112, 0.1110, 0.1110, 0.1112,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0389, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6424782
Epoch587: train_loss: 4.0676 recon_acc: 0.7677 val_roc: 0.7642 val_ap: 0.8326 f1: 0.7204 time: 0.2843
difference_matrix tensor([[0.0000, 0.1109, 0.1113, 0.1109, 0.1111, 0.1113, 0.1108, 0.1110, 0.1110,
         0.1112],
        [0.1109, 0.0000, 0.1113, 0.1108, 0.1108, 0.1113, 0.1106, 0.1105, 0.1113,
         0.1108],
        [0.1113, 0.1113, 0.0000, 0.1113, 0.1116, 0.1111, 0.1109, 0.1114, 0.1116,
         0.1114],
        [0.1109, 0.1108, 0.1113, 0.0000, 0.1113, 0.1116, 0.1109, 0.1106, 0.1114,
         0.1111],
        [0.1111, 0.1108, 0.1116, 0.1113, 0.0000, 0.1109, 0.1115, 0.1111, 0.1114,
         0.1113],
        [0.1113, 0.1113, 0.1111, 0.1116, 0.1109, 0.0000, 0.1115, 0.1111, 0.1113,
         0.1111],
        [0.1108, 0.1106, 0.1109, 0.1109, 0.1115, 0.1115, 0.0000, 0.1105, 0.1114,
         0.1110],
        [0.1110, 0.1105, 0.1114, 0.1106, 0.1111, 0.1111, 0.1105, 0.0000, 0.1111,
         0.1109],
        [0.1110, 0.1113, 0.1116, 0.1114, 0.1114, 0.1113, 0.1114, 0.1111, 0.0000,
         0.1111],
        [0.1112, 0.1108, 0.1114, 0.1111, 0.1113, 0.1111, 0.1110, 0.1109, 0.1111,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0389, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.642263
Epoch588: train_loss: 4.0674 recon_acc: 0.7674 val_roc: 0.7642 val_ap: 0.8326 f1: 0.7204 time: 0.2609
difference_matrix tensor([[0.0000, 0.1108, 0.1113, 0.1109, 0.1110, 0.1113, 0.1107, 0.1110, 0.1109,
         0.1112],
        [0.1108, 0.0000, 0.1112, 0.1108, 0.1108, 0.1112, 0.1106, 0.1105, 0.1112,
         0.1108],
        [0.1113, 0.1112, 0.0000, 0.1113, 0.1115, 0.1111, 0.1108, 0.1114, 0.1116,
         0.1114],
        [0.1109, 0.1108, 0.1113, 0.0000, 0.1113, 0.1116, 0.1109, 0.1105, 0.1114,
         0.1110],
        [0.1110, 0.1108, 0.1115, 0.1113, 0.0000, 0.1108, 0.1115, 0.1111, 0.1114,
         0.1113],
        [0.1113, 0.1112, 0.1111, 0.1116, 0.1108, 0.0000, 0.1115, 0.1111, 0.1112,
         0.1111],
        [0.1107, 0.1106, 0.1108, 0.1109, 0.1115, 0.1115, 0.0000, 0.1105, 0.1114,
         0.1110],
        [0.1110, 0.1105, 0.1114, 0.1105, 0.1111, 0.1111, 0.1105, 0.0000, 0.1111,
         0.1109],
        [0.1109, 0.1112, 0.1116, 0.1114, 0.1114, 0.1112, 0.1114, 0.1111, 0.0000,
         0.1111],
        [0.1112, 0.1108, 0.1114, 0.1110, 0.1113, 0.1111, 0.1110, 0.1109, 0.1111,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0389, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64204705
Epoch589: train_loss: 4.0673 recon_acc: 0.7671 val_roc: 0.7643 val_ap: 0.8328 f1: 0.7187 time: 0.3215
difference_matrix tensor([[0.0000, 0.1108, 0.1113, 0.1109, 0.1110, 0.1113, 0.1107, 0.1109, 0.1109,
         0.1112],
        [0.1108, 0.0000, 0.1112, 0.1108, 0.1108, 0.1112, 0.1106, 0.1105, 0.1112,
         0.1108],
        [0.1113, 0.1112, 0.0000, 0.1113, 0.1115, 0.1111, 0.1108, 0.1113, 0.1116,
         0.1113],
        [0.1109, 0.1108, 0.1113, 0.0000, 0.1113, 0.1116, 0.1109, 0.1105, 0.1114,
         0.1110],
        [0.1110, 0.1108, 0.1115, 0.1113, 0.0000, 0.1108, 0.1114, 0.1111, 0.1114,
         0.1113],
        [0.1113, 0.1112, 0.1111, 0.1116, 0.1108, 0.0000, 0.1115, 0.1111, 0.1112,
         0.1111],
        [0.1107, 0.1106, 0.1108, 0.1109, 0.1114, 0.1115, 0.0000, 0.1105, 0.1114,
         0.1110],
        [0.1109, 0.1105, 0.1113, 0.1105, 0.1111, 0.1111, 0.1105, 0.0000, 0.1111,
         0.1109],
        [0.1109, 0.1112, 0.1116, 0.1114, 0.1114, 0.1112, 0.1114, 0.1111, 0.0000,
         0.1111],
        [0.1112, 0.1108, 0.1113, 0.1110, 0.1113, 0.1111, 0.1110, 0.1109, 0.1111,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0389, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.644729
Epoch590: train_loss: 4.0672 recon_acc: 0.7715 val_roc: 0.7644 val_ap: 0.8329 f1: 0.7173 time: 0.2740
difference_matrix tensor([[0.0000, 0.1108, 0.1113, 0.1109, 0.1110, 0.1113, 0.1107, 0.1109, 0.1109,
         0.1112],
        [0.1108, 0.0000, 0.1112, 0.1107, 0.1108, 0.1112, 0.1106, 0.1105, 0.1112,
         0.1108],
        [0.1113, 0.1112, 0.0000, 0.1113, 0.1115, 0.1111, 0.1108, 0.1113, 0.1116,
         0.1113],
        [0.1109, 0.1107, 0.1113, 0.0000, 0.1113, 0.1116, 0.1109, 0.1105, 0.1114,
         0.1110],
        [0.1110, 0.1108, 0.1115, 0.1113, 0.0000, 0.1108, 0.1114, 0.1111, 0.1114,
         0.1113],
        [0.1113, 0.1112, 0.1111, 0.1116, 0.1108, 0.0000, 0.1114, 0.1111, 0.1112,
         0.1111],
        [0.1107, 0.1106, 0.1108, 0.1109, 0.1114, 0.1114, 0.0000, 0.1104, 0.1113,
         0.1109],
        [0.1109, 0.1105, 0.1113, 0.1105, 0.1111, 0.1111, 0.1104, 0.0000, 0.1111,
         0.1109],
        [0.1109, 0.1112, 0.1116, 0.1114, 0.1114, 0.1112, 0.1113, 0.1111, 0.0000,
         0.1111],
        [0.1112, 0.1108, 0.1113, 0.1110, 0.1113, 0.1111, 0.1109, 0.1109, 0.1111,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0389, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64506775
Epoch591: train_loss: 4.0671 recon_acc: 0.7721 val_roc: 0.7645 val_ap: 0.8330 f1: 0.7173 time: 0.2531
difference_matrix tensor([[0.0000, 0.1108, 0.1112, 0.1109, 0.1110, 0.1113, 0.1107, 0.1109, 0.1109,
         0.1111],
        [0.1108, 0.0000, 0.1112, 0.1107, 0.1108, 0.1112, 0.1105, 0.1105, 0.1112,
         0.1108],
        [0.1112, 0.1112, 0.0000, 0.1113, 0.1115, 0.1111, 0.1108, 0.1113, 0.1116,
         0.1113],
        [0.1109, 0.1107, 0.1113, 0.0000, 0.1112, 0.1116, 0.1109, 0.1105, 0.1113,
         0.1110],
        [0.1110, 0.1108, 0.1115, 0.1112, 0.0000, 0.1108, 0.1114, 0.1111, 0.1114,
         0.1113],
        [0.1113, 0.1112, 0.1111, 0.1116, 0.1108, 0.0000, 0.1114, 0.1111, 0.1112,
         0.1111],
        [0.1107, 0.1105, 0.1108, 0.1109, 0.1114, 0.1114, 0.0000, 0.1104, 0.1113,
         0.1109],
        [0.1109, 0.1105, 0.1113, 0.1105, 0.1111, 0.1111, 0.1104, 0.0000, 0.1111,
         0.1109],
        [0.1109, 0.1112, 0.1116, 0.1113, 0.1114, 0.1112, 0.1113, 0.1111, 0.0000,
         0.1111],
        [0.1111, 0.1108, 0.1113, 0.1110, 0.1113, 0.1111, 0.1109, 0.1109, 0.1111,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0390, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6449774
Epoch592: train_loss: 4.0669 recon_acc: 0.7720 val_roc: 0.7646 val_ap: 0.8330 f1: 0.7173 time: 0.2604
difference_matrix tensor([[0.0000, 0.1108, 0.1112, 0.1109, 0.1110, 0.1113, 0.1107, 0.1109, 0.1109,
         0.1111],
        [0.1108, 0.0000, 0.1112, 0.1107, 0.1107, 0.1112, 0.1105, 0.1104, 0.1112,
         0.1107],
        [0.1112, 0.1112, 0.0000, 0.1113, 0.1115, 0.1110, 0.1108, 0.1113, 0.1116,
         0.1113],
        [0.1109, 0.1107, 0.1113, 0.0000, 0.1112, 0.1115, 0.1109, 0.1105, 0.1113,
         0.1110],
        [0.1110, 0.1107, 0.1115, 0.1112, 0.0000, 0.1108, 0.1114, 0.1111, 0.1113,
         0.1113],
        [0.1113, 0.1112, 0.1110, 0.1115, 0.1108, 0.0000, 0.1114, 0.1111, 0.1112,
         0.1110],
        [0.1107, 0.1105, 0.1108, 0.1109, 0.1114, 0.1114, 0.0000, 0.1104, 0.1113,
         0.1109],
        [0.1109, 0.1104, 0.1113, 0.1105, 0.1111, 0.1111, 0.1104, 0.0000, 0.1111,
         0.1109],
        [0.1109, 0.1112, 0.1116, 0.1113, 0.1113, 0.1112, 0.1113, 0.1111, 0.0000,
         0.1111],
        [0.1111, 0.1107, 0.1113, 0.1110, 0.1113, 0.1110, 0.1109, 0.1109, 0.1111,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0390, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.644437
Epoch593: train_loss: 4.0668 recon_acc: 0.7711 val_roc: 0.7646 val_ap: 0.8331 f1: 0.7173 time: 0.2566
difference_matrix tensor([[0.0000, 0.1108, 0.1112, 0.1108, 0.1110, 0.1112, 0.1106, 0.1109, 0.1109,
         0.1111],
        [0.1108, 0.0000, 0.1112, 0.1107, 0.1107, 0.1112, 0.1105, 0.1104, 0.1112,
         0.1107],
        [0.1112, 0.1112, 0.0000, 0.1113, 0.1115, 0.1110, 0.1107, 0.1113, 0.1115,
         0.1113],
        [0.1108, 0.1107, 0.1113, 0.0000, 0.1112, 0.1115, 0.1108, 0.1105, 0.1113,
         0.1110],
        [0.1110, 0.1107, 0.1115, 0.1112, 0.0000, 0.1108, 0.1114, 0.1110, 0.1113,
         0.1112],
        [0.1112, 0.1112, 0.1110, 0.1115, 0.1108, 0.0000, 0.1114, 0.1110, 0.1112,
         0.1110],
        [0.1106, 0.1105, 0.1107, 0.1108, 0.1114, 0.1114, 0.0000, 0.1104, 0.1113,
         0.1109],
        [0.1109, 0.1104, 0.1113, 0.1105, 0.1110, 0.1110, 0.1104, 0.0000, 0.1110,
         0.1108],
        [0.1109, 0.1112, 0.1115, 0.1113, 0.1113, 0.1112, 0.1113, 0.1110, 0.0000,
         0.1110],
        [0.1111, 0.1107, 0.1113, 0.1110, 0.1112, 0.1110, 0.1109, 0.1108, 0.1110,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0390, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64389527
Epoch594: train_loss: 4.0667 recon_acc: 0.7703 val_roc: 0.7647 val_ap: 0.8332 f1: 0.7173 time: 0.2558
difference_matrix tensor([[0.0000, 0.1107, 0.1112, 0.1108, 0.1109, 0.1112, 0.1106, 0.1108, 0.1108,
         0.1111],
        [0.1107, 0.0000, 0.1111, 0.1107, 0.1107, 0.1111, 0.1105, 0.1104, 0.1111,
         0.1107],
        [0.1112, 0.1111, 0.0000, 0.1112, 0.1114, 0.1110, 0.1107, 0.1113, 0.1115,
         0.1113],
        [0.1108, 0.1107, 0.1112, 0.0000, 0.1112, 0.1115, 0.1108, 0.1104, 0.1113,
         0.1109],
        [0.1109, 0.1107, 0.1114, 0.1112, 0.0000, 0.1107, 0.1114, 0.1110, 0.1113,
         0.1112],
        [0.1112, 0.1111, 0.1110, 0.1115, 0.1107, 0.0000, 0.1114, 0.1110, 0.1111,
         0.1110],
        [0.1106, 0.1105, 0.1107, 0.1108, 0.1114, 0.1114, 0.0000, 0.1104, 0.1113,
         0.1109],
        [0.1109, 0.1104, 0.1113, 0.1104, 0.1110, 0.1110, 0.1104, 0.0000, 0.1110,
         0.1108],
        [0.1108, 0.1111, 0.1115, 0.1113, 0.1113, 0.1111, 0.1113, 0.1110, 0.0000,
         0.1110],
        [0.1111, 0.1107, 0.1113, 0.1109, 0.1112, 0.1110, 0.1109, 0.1108, 0.1110,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0390, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64335215
Epoch595: train_loss: 4.0666 recon_acc: 0.7694 val_roc: 0.7647 val_ap: 0.8332 f1: 0.7173 time: 0.2728
difference_matrix tensor([[0.0000, 0.1107, 0.1112, 0.1108, 0.1109, 0.1112, 0.1106, 0.1108, 0.1108,
         0.1111],
        [0.1107, 0.0000, 0.1111, 0.1107, 0.1107, 0.1111, 0.1105, 0.1104, 0.1111,
         0.1107],
        [0.1112, 0.1111, 0.0000, 0.1112, 0.1114, 0.1110, 0.1107, 0.1112, 0.1115,
         0.1112],
        [0.1108, 0.1107, 0.1112, 0.0000, 0.1112, 0.1115, 0.1108, 0.1104, 0.1113,
         0.1109],
        [0.1109, 0.1107, 0.1114, 0.1112, 0.0000, 0.1107, 0.1113, 0.1110, 0.1113,
         0.1112],
        [0.1112, 0.1111, 0.1110, 0.1115, 0.1107, 0.0000, 0.1114, 0.1110, 0.1111,
         0.1110],
        [0.1106, 0.1105, 0.1107, 0.1108, 0.1113, 0.1114, 0.0000, 0.1104, 0.1113,
         0.1109],
        [0.1108, 0.1104, 0.1112, 0.1104, 0.1110, 0.1110, 0.1104, 0.0000, 0.1110,
         0.1108],
        [0.1108, 0.1111, 0.1115, 0.1113, 0.1113, 0.1111, 0.1113, 0.1110, 0.0000,
         0.1110],
        [0.1111, 0.1107, 0.1112, 0.1109, 0.1112, 0.1110, 0.1109, 0.1108, 0.1110,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0390, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6428076
Epoch596: train_loss: 4.0664 recon_acc: 0.7686 val_roc: 0.7649 val_ap: 0.8334 f1: 0.7173 time: 0.2585
difference_matrix tensor([[0.0000, 0.1107, 0.1112, 0.1108, 0.1109, 0.1112, 0.1106, 0.1108, 0.1108,
         0.1111],
        [0.1107, 0.0000, 0.1111, 0.1106, 0.1107, 0.1111, 0.1104, 0.1104, 0.1111,
         0.1107],
        [0.1112, 0.1111, 0.0000, 0.1112, 0.1114, 0.1110, 0.1107, 0.1112, 0.1115,
         0.1112],
        [0.1108, 0.1106, 0.1112, 0.0000, 0.1112, 0.1115, 0.1108, 0.1104, 0.1113,
         0.1109],
        [0.1109, 0.1107, 0.1114, 0.1112, 0.0000, 0.1107, 0.1113, 0.1110, 0.1113,
         0.1112],
        [0.1112, 0.1111, 0.1110, 0.1115, 0.1107, 0.0000, 0.1113, 0.1110, 0.1111,
         0.1110],
        [0.1106, 0.1104, 0.1107, 0.1108, 0.1113, 0.1113, 0.0000, 0.1103, 0.1112,
         0.1108],
        [0.1108, 0.1104, 0.1112, 0.1104, 0.1110, 0.1110, 0.1103, 0.0000, 0.1110,
         0.1108],
        [0.1108, 0.1111, 0.1115, 0.1113, 0.1113, 0.1111, 0.1112, 0.1110, 0.0000,
         0.1110],
        [0.1111, 0.1107, 0.1112, 0.1109, 0.1112, 0.1110, 0.1108, 0.1108, 0.1110,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0390, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6422616
Epoch597: train_loss: 4.0663 recon_acc: 0.7677 val_roc: 0.7650 val_ap: 0.8334 f1: 0.7173 time: 0.2722
difference_matrix tensor([[0.0000, 0.1107, 0.1111, 0.1108, 0.1109, 0.1112, 0.1106, 0.1108, 0.1108,
         0.1110],
        [0.1107, 0.0000, 0.1111, 0.1106, 0.1107, 0.1111, 0.1104, 0.1104, 0.1111,
         0.1107],
        [0.1111, 0.1111, 0.0000, 0.1112, 0.1114, 0.1109, 0.1107, 0.1112, 0.1115,
         0.1112],
        [0.1108, 0.1106, 0.1112, 0.0000, 0.1111, 0.1115, 0.1108, 0.1104, 0.1112,
         0.1109],
        [0.1109, 0.1107, 0.1114, 0.1111, 0.0000, 0.1107, 0.1113, 0.1110, 0.1113,
         0.1112],
        [0.1112, 0.1111, 0.1109, 0.1115, 0.1107, 0.0000, 0.1113, 0.1110, 0.1111,
         0.1110],
        [0.1106, 0.1104, 0.1107, 0.1108, 0.1113, 0.1113, 0.0000, 0.1103, 0.1112,
         0.1108],
        [0.1108, 0.1104, 0.1112, 0.1104, 0.1110, 0.1110, 0.1103, 0.0000, 0.1110,
         0.1108],
        [0.1108, 0.1111, 0.1115, 0.1112, 0.1113, 0.1111, 0.1112, 0.1110, 0.0000,
         0.1110],
        [0.1110, 0.1107, 0.1112, 0.1109, 0.1112, 0.1110, 0.1108, 0.1108, 0.1110,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0391, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64007324
Epoch598: train_loss: 4.0662 recon_acc: 0.7642 val_roc: 0.7652 val_ap: 0.8335 f1: 0.7170 time: 0.2835
difference_matrix tensor([[0.0000, 0.1107, 0.1111, 0.1108, 0.1109, 0.1112, 0.1106, 0.1108, 0.1108,
         0.1110],
        [0.1107, 0.0000, 0.1111, 0.1106, 0.1106, 0.1111, 0.1104, 0.1103, 0.1111,
         0.1106],
        [0.1111, 0.1111, 0.0000, 0.1112, 0.1114, 0.1109, 0.1107, 0.1112, 0.1115,
         0.1112],
        [0.1108, 0.1106, 0.1112, 0.0000, 0.1111, 0.1115, 0.1108, 0.1104, 0.1112,
         0.1109],
        [0.1109, 0.1106, 0.1114, 0.1111, 0.0000, 0.1107, 0.1113, 0.1110, 0.1112,
         0.1112],
        [0.1112, 0.1111, 0.1109, 0.1115, 0.1107, 0.0000, 0.1113, 0.1109, 0.1111,
         0.1109],
        [0.1106, 0.1104, 0.1107, 0.1108, 0.1113, 0.1113, 0.0000, 0.1103, 0.1112,
         0.1108],
        [0.1108, 0.1103, 0.1112, 0.1104, 0.1110, 0.1109, 0.1103, 0.0000, 0.1110,
         0.1108],
        [0.1108, 0.1111, 0.1114, 0.1112, 0.1112, 0.1111, 0.1112, 0.1110, 0.0000,
         0.1110],
        [0.1110, 0.1106, 0.1112, 0.1109, 0.1112, 0.1109, 0.1108, 0.1108, 0.1110,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0391, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.63985085
Epoch599: train_loss: 4.0661 recon_acc: 0.7638 val_roc: 0.7653 val_ap: 0.8336 f1: 0.7170 time: 0.2691
difference_matrix tensor([[0.0000, 0.1107, 0.1111, 0.1107, 0.1109, 0.1111, 0.1105, 0.1108, 0.1108,
         0.1110],
        [0.1107, 0.0000, 0.1111, 0.1106, 0.1106, 0.1111, 0.1104, 0.1103, 0.1111,
         0.1106],
        [0.1111, 0.1111, 0.0000, 0.1112, 0.1114, 0.1109, 0.1106, 0.1112, 0.1114,
         0.1112],
        [0.1107, 0.1106, 0.1112, 0.0000, 0.1111, 0.1114, 0.1107, 0.1104, 0.1112,
         0.1109],
        [0.1109, 0.1106, 0.1114, 0.1111, 0.0000, 0.1107, 0.1113, 0.1109, 0.1112,
         0.1111],
        [0.1111, 0.1111, 0.1109, 0.1114, 0.1107, 0.0000, 0.1113, 0.1109, 0.1111,
         0.1109],
        [0.1105, 0.1104, 0.1106, 0.1107, 0.1113, 0.1113, 0.0000, 0.1103, 0.1112,
         0.1108],
        [0.1108, 0.1103, 0.1112, 0.1104, 0.1109, 0.1109, 0.1103, 0.0000, 0.1109,
         0.1107],
        [0.1108, 0.1111, 0.1114, 0.1112, 0.1112, 0.1111, 0.1112, 0.1109, 0.0000,
         0.1109],
        [0.1110, 0.1106, 0.1112, 0.1109, 0.1111, 0.1109, 0.1108, 0.1107, 0.1109,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0391, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6396279
Epoch600: train_loss: 4.0659 recon_acc: 0.7635 val_roc: 0.7653 val_ap: 0.8337 f1: 0.7170 time: 0.2666
difference_matrix tensor([[0.0000, 0.1106, 0.1111, 0.1107, 0.1108, 0.1111, 0.1105, 0.1108, 0.1107,
         0.1110],
        [0.1106, 0.0000, 0.1110, 0.1106, 0.1106, 0.1111, 0.1104, 0.1103, 0.1110,
         0.1106],
        [0.1111, 0.1110, 0.0000, 0.1111, 0.1113, 0.1109, 0.1106, 0.1112, 0.1114,
         0.1112],
        [0.1107, 0.1106, 0.1111, 0.0000, 0.1111, 0.1114, 0.1107, 0.1103, 0.1112,
         0.1108],
        [0.1108, 0.1106, 0.1113, 0.1111, 0.0000, 0.1106, 0.1113, 0.1109, 0.1112,
         0.1111],
        [0.1111, 0.1111, 0.1109, 0.1114, 0.1106, 0.0000, 0.1113, 0.1109, 0.1110,
         0.1109],
        [0.1105, 0.1104, 0.1106, 0.1107, 0.1113, 0.1113, 0.0000, 0.1103, 0.1112,
         0.1108],
        [0.1108, 0.1103, 0.1112, 0.1103, 0.1109, 0.1109, 0.1103, 0.0000, 0.1109,
         0.1107],
        [0.1107, 0.1110, 0.1114, 0.1112, 0.1112, 0.1110, 0.1112, 0.1109, 0.0000,
         0.1109],
        [0.1110, 0.1106, 0.1112, 0.1108, 0.1111, 0.1109, 0.1108, 0.1107, 0.1109,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0391, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.63940436
Epoch601: train_loss: 4.0658 recon_acc: 0.7632 val_roc: 0.7655 val_ap: 0.8338 f1: 0.7170 time: 0.2819
difference_matrix tensor([[0.0000, 0.1106, 0.1111, 0.1107, 0.1108, 0.1111, 0.1105, 0.1107, 0.1107,
         0.1110],
        [0.1106, 0.0000, 0.1110, 0.1106, 0.1106, 0.1110, 0.1104, 0.1103, 0.1110,
         0.1106],
        [0.1111, 0.1110, 0.0000, 0.1111, 0.1113, 0.1109, 0.1106, 0.1111, 0.1114,
         0.1111],
        [0.1107, 0.1106, 0.1111, 0.0000, 0.1111, 0.1114, 0.1107, 0.1103, 0.1112,
         0.1108],
        [0.1108, 0.1106, 0.1113, 0.1111, 0.0000, 0.1106, 0.1112, 0.1109, 0.1112,
         0.1111],
        [0.1111, 0.1110, 0.1109, 0.1114, 0.1106, 0.0000, 0.1113, 0.1109, 0.1110,
         0.1109],
        [0.1105, 0.1104, 0.1106, 0.1107, 0.1112, 0.1113, 0.0000, 0.1103, 0.1112,
         0.1108],
        [0.1107, 0.1103, 0.1111, 0.1103, 0.1109, 0.1109, 0.1103, 0.0000, 0.1109,
         0.1107],
        [0.1107, 0.1110, 0.1114, 0.1112, 0.1112, 0.1110, 0.1112, 0.1109, 0.0000,
         0.1109],
        [0.1110, 0.1106, 0.1111, 0.1108, 0.1111, 0.1109, 0.1108, 0.1107, 0.1109,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0391, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.63918024
Epoch602: train_loss: 4.0657 recon_acc: 0.7628 val_roc: 0.7655 val_ap: 0.8338 f1: 0.7170 time: 0.3099
difference_matrix tensor([[0.0000, 0.1106, 0.1111, 0.1107, 0.1108, 0.1111, 0.1105, 0.1107, 0.1107,
         0.1110],
        [0.1106, 0.0000, 0.1110, 0.1105, 0.1106, 0.1110, 0.1103, 0.1103, 0.1110,
         0.1106],
        [0.1111, 0.1110, 0.0000, 0.1111, 0.1113, 0.1109, 0.1106, 0.1111, 0.1114,
         0.1111],
        [0.1107, 0.1105, 0.1111, 0.0000, 0.1111, 0.1114, 0.1107, 0.1103, 0.1112,
         0.1108],
        [0.1108, 0.1106, 0.1113, 0.1111, 0.0000, 0.1106, 0.1112, 0.1109, 0.1112,
         0.1111],
        [0.1111, 0.1110, 0.1109, 0.1114, 0.1106, 0.0000, 0.1113, 0.1109, 0.1110,
         0.1109],
        [0.1105, 0.1103, 0.1106, 0.1107, 0.1112, 0.1112, 0.0000, 0.1102, 0.1111,
         0.1107],
        [0.1107, 0.1103, 0.1111, 0.1103, 0.1109, 0.1109, 0.1102, 0.0000, 0.1109,
         0.1107],
        [0.1107, 0.1110, 0.1114, 0.1112, 0.1112, 0.1110, 0.1111, 0.1109, 0.0000,
         0.1109],
        [0.1110, 0.1106, 0.1111, 0.1108, 0.1111, 0.1109, 0.1107, 0.1107, 0.1109,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0391, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6389556
Epoch603: train_loss: 4.0656 recon_acc: 0.7625 val_roc: 0.7656 val_ap: 0.8339 f1: 0.7170 time: 0.2631
difference_matrix tensor([[0.0000, 0.1106, 0.1110, 0.1107, 0.1108, 0.1111, 0.1105, 0.1107, 0.1107,
         0.1110],
        [0.1106, 0.0000, 0.1110, 0.1105, 0.1106, 0.1110, 0.1103, 0.1103, 0.1110,
         0.1106],
        [0.1110, 0.1110, 0.0000, 0.1111, 0.1113, 0.1108, 0.1106, 0.1111, 0.1114,
         0.1111],
        [0.1107, 0.1105, 0.1111, 0.0000, 0.1111, 0.1114, 0.1107, 0.1103, 0.1111,
         0.1108],
        [0.1108, 0.1106, 0.1113, 0.1111, 0.0000, 0.1106, 0.1112, 0.1109, 0.1112,
         0.1111],
        [0.1111, 0.1110, 0.1108, 0.1114, 0.1106, 0.0000, 0.1112, 0.1109, 0.1110,
         0.1109],
        [0.1105, 0.1103, 0.1106, 0.1107, 0.1112, 0.1112, 0.0000, 0.1102, 0.1111,
         0.1107],
        [0.1107, 0.1103, 0.1111, 0.1103, 0.1109, 0.1109, 0.1102, 0.0000, 0.1109,
         0.1107],
        [0.1107, 0.1110, 0.1114, 0.1111, 0.1112, 0.1110, 0.1111, 0.1109, 0.0000,
         0.1109],
        [0.1110, 0.1106, 0.1111, 0.1108, 0.1111, 0.1109, 0.1107, 0.1107, 0.1109,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0391, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.63840127
Epoch604: train_loss: 4.0655 recon_acc: 0.7617 val_roc: 0.7658 val_ap: 0.8340 f1: 0.7170 time: 0.2498
difference_matrix tensor([[0.0000, 0.1106, 0.1110, 0.1107, 0.1108, 0.1111, 0.1105, 0.1107, 0.1107,
         0.1109],
        [0.1106, 0.0000, 0.1110, 0.1105, 0.1106, 0.1110, 0.1103, 0.1102, 0.1110,
         0.1105],
        [0.1110, 0.1110, 0.0000, 0.1111, 0.1113, 0.1108, 0.1106, 0.1111, 0.1114,
         0.1111],
        [0.1107, 0.1105, 0.1111, 0.0000, 0.1110, 0.1114, 0.1107, 0.1103, 0.1111,
         0.1108],
        [0.1108, 0.1106, 0.1113, 0.1110, 0.0000, 0.1106, 0.1112, 0.1109, 0.1112,
         0.1111],
        [0.1111, 0.1110, 0.1108, 0.1114, 0.1106, 0.0000, 0.1112, 0.1108, 0.1110,
         0.1108],
        [0.1105, 0.1103, 0.1106, 0.1107, 0.1112, 0.1112, 0.0000, 0.1102, 0.1111,
         0.1107],
        [0.1107, 0.1102, 0.1111, 0.1103, 0.1109, 0.1108, 0.1102, 0.0000, 0.1109,
         0.1107],
        [0.1107, 0.1110, 0.1114, 0.1111, 0.1112, 0.1110, 0.1111, 0.1109, 0.0000,
         0.1109],
        [0.1109, 0.1105, 0.1111, 0.1108, 0.1111, 0.1108, 0.1107, 0.1107, 0.1109,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0392, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6535146
Epoch605: train_loss: 4.0654 recon_acc: 0.7860 val_roc: 0.7660 val_ap: 0.8341 f1: 0.7167 time: 0.2508
difference_matrix tensor([[0.0000, 0.1106, 0.1110, 0.1106, 0.1108, 0.1111, 0.1104, 0.1107, 0.1107,
         0.1109],
        [0.1106, 0.0000, 0.1110, 0.1105, 0.1105, 0.1110, 0.1103, 0.1102, 0.1110,
         0.1105],
        [0.1110, 0.1110, 0.0000, 0.1111, 0.1113, 0.1108, 0.1105, 0.1111, 0.1113,
         0.1111],
        [0.1106, 0.1105, 0.1111, 0.0000, 0.1110, 0.1113, 0.1106, 0.1103, 0.1111,
         0.1108],
        [0.1108, 0.1105, 0.1113, 0.1110, 0.0000, 0.1106, 0.1112, 0.1108, 0.1111,
         0.1110],
        [0.1111, 0.1110, 0.1108, 0.1113, 0.1106, 0.0000, 0.1112, 0.1108, 0.1110,
         0.1108],
        [0.1104, 0.1103, 0.1105, 0.1106, 0.1112, 0.1112, 0.0000, 0.1102, 0.1111,
         0.1107],
        [0.1107, 0.1102, 0.1111, 0.1103, 0.1108, 0.1108, 0.1102, 0.0000, 0.1109,
         0.1106],
        [0.1107, 0.1110, 0.1113, 0.1111, 0.1111, 0.1110, 0.1111, 0.1109, 0.0000,
         0.1109],
        [0.1109, 0.1105, 0.1111, 0.1108, 0.1110, 0.1108, 0.1107, 0.1106, 0.1109,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0392, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6534892
Epoch606: train_loss: 4.0652 recon_acc: 0.7860 val_roc: 0.7661 val_ap: 0.8342 f1: 0.7167 time: 0.2570
difference_matrix tensor([[0.0000, 0.1105, 0.1110, 0.1106, 0.1108, 0.1110, 0.1104, 0.1107, 0.1107,
         0.1109],
        [0.1105, 0.0000, 0.1110, 0.1105, 0.1105, 0.1110, 0.1103, 0.1102, 0.1110,
         0.1105],
        [0.1110, 0.1110, 0.0000, 0.1111, 0.1112, 0.1108, 0.1105, 0.1111, 0.1113,
         0.1111],
        [0.1106, 0.1105, 0.1111, 0.0000, 0.1110, 0.1113, 0.1106, 0.1102, 0.1111,
         0.1107],
        [0.1108, 0.1105, 0.1112, 0.1110, 0.0000, 0.1105, 0.1112, 0.1108, 0.1111,
         0.1110],
        [0.1110, 0.1110, 0.1108, 0.1113, 0.1105, 0.0000, 0.1112, 0.1108, 0.1110,
         0.1108],
        [0.1104, 0.1103, 0.1105, 0.1106, 0.1112, 0.1112, 0.0000, 0.1102, 0.1111,
         0.1107],
        [0.1107, 0.1102, 0.1111, 0.1102, 0.1108, 0.1108, 0.1102, 0.0000, 0.1108,
         0.1106],
        [0.1107, 0.1110, 0.1113, 0.1111, 0.1111, 0.1110, 0.1111, 0.1108, 0.0000,
         0.1108],
        [0.1109, 0.1105, 0.1111, 0.1107, 0.1110, 0.1108, 0.1107, 0.1106, 0.1108,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0392, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65346456
Epoch607: train_loss: 4.0651 recon_acc: 0.7860 val_roc: 0.7661 val_ap: 0.8341 f1: 0.7167 time: 0.2767
difference_matrix tensor([[0.0000, 0.1105, 0.1110, 0.1106, 0.1107, 0.1110, 0.1104, 0.1106, 0.1106,
         0.1109],
        [0.1105, 0.0000, 0.1109, 0.1105, 0.1105, 0.1110, 0.1103, 0.1102, 0.1109,
         0.1105],
        [0.1110, 0.1109, 0.0000, 0.1110, 0.1112, 0.1108, 0.1105, 0.1111, 0.1113,
         0.1111],
        [0.1106, 0.1105, 0.1110, 0.0000, 0.1110, 0.1113, 0.1106, 0.1102, 0.1111,
         0.1107],
        [0.1107, 0.1105, 0.1112, 0.1110, 0.0000, 0.1105, 0.1112, 0.1108, 0.1111,
         0.1110],
        [0.1110, 0.1110, 0.1108, 0.1113, 0.1105, 0.0000, 0.1112, 0.1108, 0.1109,
         0.1108],
        [0.1104, 0.1103, 0.1105, 0.1106, 0.1112, 0.1112, 0.0000, 0.1102, 0.1111,
         0.1107],
        [0.1106, 0.1102, 0.1111, 0.1102, 0.1108, 0.1108, 0.1102, 0.0000, 0.1108,
         0.1106],
        [0.1106, 0.1109, 0.1113, 0.1111, 0.1111, 0.1109, 0.1111, 0.1108, 0.0000,
         0.1108],
        [0.1109, 0.1105, 0.1111, 0.1107, 0.1110, 0.1108, 0.1107, 0.1106, 0.1108,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0392, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65055436
Epoch608: train_loss: 4.0650 recon_acc: 0.7814 val_roc: 0.7662 val_ap: 0.8342 f1: 0.7177 time: 0.2906
difference_matrix tensor([[0.0000, 0.1105, 0.1110, 0.1106, 0.1107, 0.1110, 0.1104, 0.1106, 0.1106,
         0.1109],
        [0.1105, 0.0000, 0.1109, 0.1105, 0.1105, 0.1109, 0.1103, 0.1102, 0.1109,
         0.1105],
        [0.1110, 0.1109, 0.0000, 0.1110, 0.1112, 0.1108, 0.1105, 0.1110, 0.1113,
         0.1110],
        [0.1106, 0.1105, 0.1110, 0.0000, 0.1110, 0.1113, 0.1106, 0.1102, 0.1111,
         0.1107],
        [0.1107, 0.1105, 0.1112, 0.1110, 0.0000, 0.1105, 0.1111, 0.1108, 0.1111,
         0.1110],
        [0.1110, 0.1109, 0.1108, 0.1113, 0.1105, 0.0000, 0.1112, 0.1108, 0.1109,
         0.1108],
        [0.1104, 0.1103, 0.1105, 0.1106, 0.1111, 0.1112, 0.0000, 0.1101, 0.1110,
         0.1107],
        [0.1106, 0.1102, 0.1110, 0.1102, 0.1108, 0.1108, 0.1101, 0.0000, 0.1108,
         0.1106],
        [0.1106, 0.1109, 0.1113, 0.1111, 0.1111, 0.1109, 0.1110, 0.1108, 0.0000,
         0.1108],
        [0.1109, 0.1105, 0.1110, 0.1107, 0.1110, 0.1108, 0.1107, 0.1106, 0.1108,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0392, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6508611
Epoch609: train_loss: 4.0649 recon_acc: 0.7819 val_roc: 0.7662 val_ap: 0.8342 f1: 0.7194 time: 0.2708
difference_matrix tensor([[0.0000, 0.1105, 0.1110, 0.1106, 0.1107, 0.1110, 0.1104, 0.1106, 0.1106,
         0.1109],
        [0.1105, 0.0000, 0.1109, 0.1104, 0.1105, 0.1109, 0.1102, 0.1102, 0.1109,
         0.1105],
        [0.1110, 0.1109, 0.0000, 0.1110, 0.1112, 0.1107, 0.1105, 0.1110, 0.1113,
         0.1110],
        [0.1106, 0.1104, 0.1110, 0.0000, 0.1110, 0.1113, 0.1106, 0.1102, 0.1111,
         0.1107],
        [0.1107, 0.1105, 0.1112, 0.1110, 0.0000, 0.1105, 0.1111, 0.1108, 0.1111,
         0.1110],
        [0.1110, 0.1109, 0.1107, 0.1113, 0.1105, 0.0000, 0.1111, 0.1108, 0.1109,
         0.1108],
        [0.1104, 0.1102, 0.1105, 0.1106, 0.1111, 0.1111, 0.0000, 0.1101, 0.1110,
         0.1106],
        [0.1106, 0.1102, 0.1110, 0.1102, 0.1108, 0.1108, 0.1101, 0.0000, 0.1108,
         0.1106],
        [0.1106, 0.1109, 0.1113, 0.1111, 0.1111, 0.1109, 0.1110, 0.1108, 0.0000,
         0.1108],
        [0.1109, 0.1105, 0.1110, 0.1107, 0.1110, 0.1108, 0.1106, 0.1106, 0.1108,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0392, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65116596
Epoch610: train_loss: 4.0648 recon_acc: 0.7825 val_roc: 0.7664 val_ap: 0.8343 f1: 0.7194 time: 0.2586
difference_matrix tensor([[0.0000, 0.1105, 0.1109, 0.1106, 0.1107, 0.1110, 0.1104, 0.1106, 0.1106,
         0.1109],
        [0.1105, 0.0000, 0.1109, 0.1104, 0.1105, 0.1109, 0.1102, 0.1102, 0.1109,
         0.1105],
        [0.1109, 0.1109, 0.0000, 0.1110, 0.1112, 0.1107, 0.1105, 0.1110, 0.1113,
         0.1110],
        [0.1106, 0.1104, 0.1110, 0.0000, 0.1109, 0.1113, 0.1106, 0.1102, 0.1110,
         0.1107],
        [0.1107, 0.1105, 0.1112, 0.1109, 0.0000, 0.1105, 0.1111, 0.1108, 0.1111,
         0.1110],
        [0.1110, 0.1109, 0.1107, 0.1113, 0.1105, 0.0000, 0.1111, 0.1108, 0.1109,
         0.1108],
        [0.1104, 0.1102, 0.1105, 0.1106, 0.1111, 0.1111, 0.0000, 0.1101, 0.1110,
         0.1106],
        [0.1106, 0.1102, 0.1110, 0.1102, 0.1108, 0.1108, 0.1101, 0.0000, 0.1108,
         0.1106],
        [0.1106, 0.1109, 0.1113, 0.1110, 0.1111, 0.1109, 0.1110, 0.1108, 0.0000,
         0.1108],
        [0.1109, 0.1105, 0.1110, 0.1107, 0.1110, 0.1108, 0.1106, 0.1106, 0.1108,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0393, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65118104
Epoch611: train_loss: 4.0647 recon_acc: 0.7825 val_roc: 0.7665 val_ap: 0.8344 f1: 0.7194 time: 0.2783
difference_matrix tensor([[0.0000, 0.1105, 0.1109, 0.1106, 0.1107, 0.1110, 0.1103, 0.1106, 0.1106,
         0.1108],
        [0.1105, 0.0000, 0.1109, 0.1104, 0.1104, 0.1109, 0.1102, 0.1101, 0.1109,
         0.1104],
        [0.1109, 0.1109, 0.0000, 0.1110, 0.1112, 0.1107, 0.1104, 0.1110, 0.1112,
         0.1110],
        [0.1106, 0.1104, 0.1110, 0.0000, 0.1109, 0.1113, 0.1106, 0.1102, 0.1110,
         0.1107],
        [0.1107, 0.1104, 0.1112, 0.1109, 0.0000, 0.1105, 0.1111, 0.1108, 0.1110,
         0.1109],
        [0.1110, 0.1109, 0.1107, 0.1113, 0.1105, 0.0000, 0.1111, 0.1107, 0.1109,
         0.1107],
        [0.1103, 0.1102, 0.1104, 0.1106, 0.1111, 0.1111, 0.0000, 0.1101, 0.1110,
         0.1106],
        [0.1106, 0.1101, 0.1110, 0.1102, 0.1108, 0.1107, 0.1101, 0.0000, 0.1108,
         0.1105],
        [0.1106, 0.1109, 0.1112, 0.1110, 0.1110, 0.1109, 0.1110, 0.1108, 0.0000,
         0.1108],
        [0.1108, 0.1104, 0.1110, 0.1107, 0.1109, 0.1107, 0.1106, 0.1105, 0.1108,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0393, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6511463
Epoch612: train_loss: 4.0646 recon_acc: 0.7825 val_roc: 0.7666 val_ap: 0.8344 f1: 0.7194 time: 0.2894
difference_matrix tensor([[0.0000, 0.1105, 0.1109, 0.1105, 0.1107, 0.1109, 0.1103, 0.1106, 0.1106,
         0.1108],
        [0.1105, 0.0000, 0.1109, 0.1104, 0.1104, 0.1109, 0.1102, 0.1101, 0.1109,
         0.1104],
        [0.1109, 0.1109, 0.0000, 0.1110, 0.1111, 0.1107, 0.1104, 0.1110, 0.1112,
         0.1110],
        [0.1105, 0.1104, 0.1110, 0.0000, 0.1109, 0.1112, 0.1105, 0.1102, 0.1110,
         0.1107],
        [0.1107, 0.1104, 0.1111, 0.1109, 0.0000, 0.1104, 0.1111, 0.1107, 0.1110,
         0.1109],
        [0.1109, 0.1109, 0.1107, 0.1112, 0.1104, 0.0000, 0.1111, 0.1107, 0.1109,
         0.1107],
        [0.1103, 0.1102, 0.1104, 0.1105, 0.1111, 0.1111, 0.0000, 0.1101, 0.1110,
         0.1106],
        [0.1106, 0.1101, 0.1110, 0.1102, 0.1107, 0.1107, 0.1101, 0.0000, 0.1108,
         0.1105],
        [0.1106, 0.1109, 0.1112, 0.1110, 0.1110, 0.1109, 0.1110, 0.1108, 0.0000,
         0.1108],
        [0.1108, 0.1104, 0.1110, 0.1107, 0.1109, 0.1107, 0.1106, 0.1105, 0.1108,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0393, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65110976
Epoch613: train_loss: 4.0645 recon_acc: 0.7825 val_roc: 0.7667 val_ap: 0.8345 f1: 0.7194 time: 0.2890
difference_matrix tensor([[0.0000, 0.1104, 0.1109, 0.1105, 0.1106, 0.1109, 0.1103, 0.1106, 0.1106,
         0.1108],
        [0.1104, 0.0000, 0.1109, 0.1104, 0.1104, 0.1109, 0.1102, 0.1101, 0.1109,
         0.1104],
        [0.1109, 0.1109, 0.0000, 0.1110, 0.1111, 0.1107, 0.1104, 0.1110, 0.1112,
         0.1110],
        [0.1105, 0.1104, 0.1110, 0.0000, 0.1109, 0.1112, 0.1105, 0.1101, 0.1110,
         0.1106],
        [0.1106, 0.1104, 0.1111, 0.1109, 0.0000, 0.1104, 0.1111, 0.1107, 0.1110,
         0.1109],
        [0.1109, 0.1109, 0.1107, 0.1112, 0.1104, 0.0000, 0.1111, 0.1107, 0.1109,
         0.1107],
        [0.1103, 0.1102, 0.1104, 0.1105, 0.1111, 0.1111, 0.0000, 0.1101, 0.1110,
         0.1106],
        [0.1106, 0.1101, 0.1110, 0.1101, 0.1107, 0.1107, 0.1101, 0.0000, 0.1107,
         0.1105],
        [0.1106, 0.1109, 0.1112, 0.1110, 0.1110, 0.1109, 0.1110, 0.1107, 0.0000,
         0.1107],
        [0.1108, 0.1104, 0.1110, 0.1106, 0.1109, 0.1107, 0.1106, 0.1105, 0.1107,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0393, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65107155
Epoch614: train_loss: 4.0643 recon_acc: 0.7824 val_roc: 0.7668 val_ap: 0.8345 f1: 0.7194 time: 0.2924
difference_matrix tensor([[0.0000, 0.1104, 0.1109, 0.1105, 0.1106, 0.1109, 0.1103, 0.1105, 0.1105,
         0.1108],
        [0.1104, 0.0000, 0.1108, 0.1104, 0.1104, 0.1109, 0.1102, 0.1101, 0.1108,
         0.1104],
        [0.1109, 0.1108, 0.0000, 0.1110, 0.1111, 0.1107, 0.1104, 0.1110, 0.1112,
         0.1109],
        [0.1105, 0.1104, 0.1110, 0.0000, 0.1109, 0.1112, 0.1105, 0.1101, 0.1110,
         0.1106],
        [0.1106, 0.1104, 0.1111, 0.1109, 0.0000, 0.1104, 0.1111, 0.1107, 0.1110,
         0.1109],
        [0.1109, 0.1109, 0.1107, 0.1112, 0.1104, 0.0000, 0.1111, 0.1107, 0.1108,
         0.1107],
        [0.1103, 0.1102, 0.1104, 0.1105, 0.1111, 0.1111, 0.0000, 0.1100, 0.1109,
         0.1106],
        [0.1105, 0.1101, 0.1110, 0.1101, 0.1107, 0.1107, 0.1100, 0.0000, 0.1107,
         0.1105],
        [0.1105, 0.1108, 0.1112, 0.1110, 0.1110, 0.1108, 0.1109, 0.1107, 0.0000,
         0.1107],
        [0.1108, 0.1104, 0.1109, 0.1106, 0.1109, 0.1107, 0.1106, 0.1105, 0.1107,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0393, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6510317
Epoch615: train_loss: 4.0642 recon_acc: 0.7824 val_roc: 0.7669 val_ap: 0.8346 f1: 0.7194 time: 0.2562
difference_matrix tensor([[0.0000, 0.1104, 0.1109, 0.1105, 0.1106, 0.1109, 0.1103, 0.1105, 0.1105,
         0.1108],
        [0.1104, 0.0000, 0.1108, 0.1104, 0.1104, 0.1108, 0.1101, 0.1101, 0.1108,
         0.1104],
        [0.1109, 0.1108, 0.0000, 0.1109, 0.1111, 0.1106, 0.1104, 0.1109, 0.1112,
         0.1109],
        [0.1105, 0.1104, 0.1109, 0.0000, 0.1109, 0.1112, 0.1105, 0.1101, 0.1110,
         0.1106],
        [0.1106, 0.1104, 0.1111, 0.1109, 0.0000, 0.1104, 0.1110, 0.1107, 0.1110,
         0.1109],
        [0.1109, 0.1108, 0.1106, 0.1112, 0.1104, 0.0000, 0.1111, 0.1107, 0.1108,
         0.1107],
        [0.1103, 0.1101, 0.1104, 0.1105, 0.1110, 0.1111, 0.0000, 0.1100, 0.1109,
         0.1105],
        [0.1105, 0.1101, 0.1109, 0.1101, 0.1107, 0.1107, 0.1100, 0.0000, 0.1107,
         0.1105],
        [0.1105, 0.1108, 0.1112, 0.1110, 0.1110, 0.1108, 0.1109, 0.1107, 0.0000,
         0.1107],
        [0.1108, 0.1104, 0.1109, 0.1106, 0.1109, 0.1107, 0.1105, 0.1105, 0.1107,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0393, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65099
Epoch616: train_loss: 4.0641 recon_acc: 0.7824 val_roc: 0.7670 val_ap: 0.8347 f1: 0.7194 time: 0.2546
difference_matrix tensor([[0.0000, 0.1104, 0.1109, 0.1105, 0.1106, 0.1109, 0.1103, 0.1105, 0.1105,
         0.1108],
        [0.1104, 0.0000, 0.1108, 0.1103, 0.1104, 0.1108, 0.1101, 0.1101, 0.1108,
         0.1104],
        [0.1109, 0.1108, 0.0000, 0.1109, 0.1111, 0.1106, 0.1104, 0.1109, 0.1112,
         0.1109],
        [0.1105, 0.1103, 0.1109, 0.0000, 0.1109, 0.1112, 0.1105, 0.1101, 0.1110,
         0.1106],
        [0.1106, 0.1104, 0.1111, 0.1109, 0.0000, 0.1104, 0.1110, 0.1107, 0.1110,
         0.1109],
        [0.1109, 0.1108, 0.1106, 0.1112, 0.1104, 0.0000, 0.1111, 0.1107, 0.1108,
         0.1107],
        [0.1103, 0.1101, 0.1104, 0.1105, 0.1110, 0.1111, 0.0000, 0.1100, 0.1109,
         0.1105],
        [0.1105, 0.1101, 0.1109, 0.1101, 0.1107, 0.1107, 0.1100, 0.0000, 0.1107,
         0.1105],
        [0.1105, 0.1108, 0.1112, 0.1110, 0.1110, 0.1108, 0.1109, 0.1107, 0.0000,
         0.1107],
        [0.1108, 0.1104, 0.1109, 0.1106, 0.1109, 0.1107, 0.1105, 0.1105, 0.1107,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0393, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6532505
Epoch617: train_loss: 4.0640 recon_acc: 0.7859 val_roc: 0.7671 val_ap: 0.8348 f1: 0.7198 time: 0.2590
difference_matrix tensor([[0.0000, 0.1104, 0.1108, 0.1105, 0.1106, 0.1109, 0.1103, 0.1105, 0.1105,
         0.1108],
        [0.1104, 0.0000, 0.1108, 0.1103, 0.1104, 0.1108, 0.1101, 0.1100, 0.1108,
         0.1103],
        [0.1108, 0.1108, 0.0000, 0.1109, 0.1111, 0.1106, 0.1104, 0.1109, 0.1111,
         0.1109],
        [0.1105, 0.1103, 0.1109, 0.0000, 0.1108, 0.1112, 0.1105, 0.1101, 0.1109,
         0.1106],
        [0.1106, 0.1104, 0.1111, 0.1108, 0.0000, 0.1104, 0.1110, 0.1107, 0.1110,
         0.1109],
        [0.1109, 0.1108, 0.1106, 0.1112, 0.1104, 0.0000, 0.1110, 0.1106, 0.1108,
         0.1106],
        [0.1103, 0.1101, 0.1104, 0.1105, 0.1110, 0.1110, 0.0000, 0.1100, 0.1109,
         0.1105],
        [0.1105, 0.1100, 0.1109, 0.1101, 0.1107, 0.1106, 0.1100, 0.0000, 0.1107,
         0.1105],
        [0.1105, 0.1108, 0.1111, 0.1109, 0.1110, 0.1108, 0.1109, 0.1107, 0.0000,
         0.1107],
        [0.1108, 0.1103, 0.1109, 0.1106, 0.1109, 0.1106, 0.1105, 0.1105, 0.1107,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0394, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6509019
Epoch618: train_loss: 4.0639 recon_acc: 0.7823 val_roc: 0.7671 val_ap: 0.8348 f1: 0.7194 time: 0.2477
difference_matrix tensor([[0.0000, 0.1104, 0.1108, 0.1104, 0.1106, 0.1109, 0.1102, 0.1105, 0.1105,
         0.1107],
        [0.1104, 0.0000, 0.1108, 0.1103, 0.1103, 0.1108, 0.1101, 0.1100, 0.1108,
         0.1103],
        [0.1108, 0.1108, 0.0000, 0.1109, 0.1111, 0.1106, 0.1103, 0.1109, 0.1111,
         0.1109],
        [0.1104, 0.1103, 0.1109, 0.0000, 0.1108, 0.1112, 0.1105, 0.1101, 0.1109,
         0.1106],
        [0.1106, 0.1103, 0.1111, 0.1108, 0.0000, 0.1103, 0.1110, 0.1107, 0.1109,
         0.1108],
        [0.1109, 0.1108, 0.1106, 0.1112, 0.1103, 0.0000, 0.1110, 0.1106, 0.1108,
         0.1106],
        [0.1102, 0.1101, 0.1103, 0.1105, 0.1110, 0.1110, 0.0000, 0.1100, 0.1109,
         0.1105],
        [0.1105, 0.1100, 0.1109, 0.1101, 0.1107, 0.1106, 0.1100, 0.0000, 0.1107,
         0.1104],
        [0.1105, 0.1108, 0.1111, 0.1109, 0.1109, 0.1108, 0.1109, 0.1107, 0.0000,
         0.1107],
        [0.1107, 0.1103, 0.1109, 0.1106, 0.1108, 0.1106, 0.1105, 0.1104, 0.1107,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0394, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6508553
Epoch619: train_loss: 4.0638 recon_acc: 0.7822 val_roc: 0.7672 val_ap: 0.8348 f1: 0.7194 time: 0.2422
difference_matrix tensor([[0.0000, 0.1104, 0.1108, 0.1104, 0.1106, 0.1108, 0.1102, 0.1105, 0.1105,
         0.1107],
        [0.1104, 0.0000, 0.1108, 0.1103, 0.1103, 0.1108, 0.1101, 0.1100, 0.1108,
         0.1103],
        [0.1108, 0.1108, 0.0000, 0.1109, 0.1110, 0.1106, 0.1103, 0.1109, 0.1111,
         0.1109],
        [0.1104, 0.1103, 0.1109, 0.0000, 0.1108, 0.1112, 0.1104, 0.1101, 0.1109,
         0.1106],
        [0.1106, 0.1103, 0.1110, 0.1108, 0.0000, 0.1103, 0.1110, 0.1106, 0.1109,
         0.1108],
        [0.1108, 0.1108, 0.1106, 0.1112, 0.1103, 0.0000, 0.1110, 0.1106, 0.1108,
         0.1106],
        [0.1102, 0.1101, 0.1103, 0.1104, 0.1110, 0.1110, 0.0000, 0.1100, 0.1109,
         0.1105],
        [0.1105, 0.1100, 0.1109, 0.1101, 0.1106, 0.1106, 0.1100, 0.0000, 0.1107,
         0.1104],
        [0.1105, 0.1108, 0.1111, 0.1109, 0.1109, 0.1108, 0.1109, 0.1107, 0.0000,
         0.1107],
        [0.1107, 0.1103, 0.1109, 0.1106, 0.1108, 0.1106, 0.1105, 0.1104, 0.1107,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0394, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6508071
Epoch620: train_loss: 4.0637 recon_acc: 0.7822 val_roc: 0.7674 val_ap: 0.8350 f1: 0.7194 time: 0.2842
difference_matrix tensor([[0.0000, 0.1104, 0.1108, 0.1104, 0.1106, 0.1108, 0.1102, 0.1105, 0.1105,
         0.1107],
        [0.1104, 0.0000, 0.1108, 0.1103, 0.1103, 0.1108, 0.1101, 0.1100, 0.1108,
         0.1103],
        [0.1108, 0.1108, 0.0000, 0.1109, 0.1110, 0.1106, 0.1103, 0.1109, 0.1111,
         0.1109],
        [0.1104, 0.1103, 0.1109, 0.0000, 0.1108, 0.1111, 0.1104, 0.1100, 0.1109,
         0.1105],
        [0.1106, 0.1103, 0.1110, 0.1108, 0.0000, 0.1103, 0.1110, 0.1106, 0.1109,
         0.1108],
        [0.1108, 0.1108, 0.1106, 0.1111, 0.1103, 0.0000, 0.1110, 0.1106, 0.1108,
         0.1106],
        [0.1102, 0.1101, 0.1103, 0.1104, 0.1110, 0.1110, 0.0000, 0.1100, 0.1109,
         0.1105],
        [0.1105, 0.1100, 0.1109, 0.1100, 0.1106, 0.1106, 0.1100, 0.0000, 0.1106,
         0.1104],
        [0.1105, 0.1108, 0.1111, 0.1109, 0.1109, 0.1108, 0.1109, 0.1106, 0.0000,
         0.1107],
        [0.1107, 0.1103, 0.1109, 0.1105, 0.1108, 0.1106, 0.1105, 0.1104, 0.1107,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0394, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6507573
Epoch621: train_loss: 4.0636 recon_acc: 0.7821 val_roc: 0.7675 val_ap: 0.8351 f1: 0.7194 time: 0.2900
thresh 0.73493564
          test_roc: 0.7621 test_ap: 0.8291 test_f1: 0.6979 test_recon_acc: 0.8974
difference_matrix tensor([[0.0000, 0.1103, 0.1108, 0.1104, 0.1105, 0.1108, 0.1102, 0.1104, 0.1104,
         0.1107],
        [0.1103, 0.0000, 0.1108, 0.1103, 0.1103, 0.1108, 0.1101, 0.1100, 0.1107,
         0.1103],
        [0.1108, 0.1108, 0.0000, 0.1109, 0.1110, 0.1106, 0.1103, 0.1109, 0.1111,
         0.1109],
        [0.1104, 0.1103, 0.1109, 0.0000, 0.1108, 0.1111, 0.1104, 0.1100, 0.1109,
         0.1105],
        [0.1105, 0.1103, 0.1110, 0.1108, 0.0000, 0.1103, 0.1110, 0.1106, 0.1109,
         0.1108],
        [0.1108, 0.1108, 0.1106, 0.1111, 0.1103, 0.0000, 0.1110, 0.1106, 0.1108,
         0.1106],
        [0.1102, 0.1101, 0.1103, 0.1104, 0.1110, 0.1110, 0.0000, 0.1099, 0.1108,
         0.1105],
        [0.1104, 0.1100, 0.1109, 0.1100, 0.1106, 0.1106, 0.1099, 0.0000, 0.1106,
         0.1104],
        [0.1104, 0.1107, 0.1111, 0.1109, 0.1109, 0.1108, 0.1108, 0.1106, 0.0000,
         0.1106],
        [0.1107, 0.1103, 0.1109, 0.1105, 0.1108, 0.1106, 0.1105, 0.1104, 0.1106,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0394, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6507058
Epoch622: train_loss: 4.0635 recon_acc: 0.7821 val_roc: 0.7675 val_ap: 0.8351 f1: 0.7194 time: 0.3112
difference_matrix tensor([[0.0000, 0.1103, 0.1108, 0.1104, 0.1105, 0.1108, 0.1102, 0.1104, 0.1104,
         0.1107],
        [0.1103, 0.0000, 0.1107, 0.1103, 0.1103, 0.1108, 0.1100, 0.1100, 0.1107,
         0.1103],
        [0.1108, 0.1107, 0.0000, 0.1109, 0.1110, 0.1105, 0.1103, 0.1108, 0.1111,
         0.1108],
        [0.1104, 0.1103, 0.1109, 0.0000, 0.1108, 0.1111, 0.1104, 0.1100, 0.1109,
         0.1105],
        [0.1105, 0.1103, 0.1110, 0.1108, 0.0000, 0.1103, 0.1109, 0.1106, 0.1109,
         0.1108],
        [0.1108, 0.1108, 0.1105, 0.1111, 0.1103, 0.0000, 0.1110, 0.1106, 0.1107,
         0.1106],
        [0.1102, 0.1100, 0.1103, 0.1104, 0.1109, 0.1110, 0.0000, 0.1099, 0.1108,
         0.1104],
        [0.1104, 0.1100, 0.1108, 0.1100, 0.1106, 0.1106, 0.1099, 0.0000, 0.1106,
         0.1104],
        [0.1104, 0.1107, 0.1111, 0.1109, 0.1109, 0.1107, 0.1108, 0.1106, 0.0000,
         0.1106],
        [0.1107, 0.1103, 0.1108, 0.1105, 0.1108, 0.1106, 0.1104, 0.1104, 0.1106,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0394, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6506527
Epoch623: train_loss: 4.0634 recon_acc: 0.7820 val_roc: 0.7675 val_ap: 0.8351 f1: 0.7194 time: 0.2791
difference_matrix tensor([[0.0000, 0.1103, 0.1108, 0.1104, 0.1105, 0.1108, 0.1102, 0.1104, 0.1104,
         0.1107],
        [0.1103, 0.0000, 0.1107, 0.1102, 0.1103, 0.1107, 0.1100, 0.1100, 0.1107,
         0.1103],
        [0.1108, 0.1107, 0.0000, 0.1108, 0.1110, 0.1105, 0.1103, 0.1108, 0.1111,
         0.1108],
        [0.1104, 0.1102, 0.1108, 0.0000, 0.1108, 0.1111, 0.1104, 0.1100, 0.1109,
         0.1105],
        [0.1105, 0.1103, 0.1110, 0.1108, 0.0000, 0.1103, 0.1109, 0.1106, 0.1109,
         0.1108],
        [0.1108, 0.1107, 0.1105, 0.1111, 0.1103, 0.0000, 0.1110, 0.1106, 0.1107,
         0.1106],
        [0.1102, 0.1100, 0.1103, 0.1104, 0.1109, 0.1110, 0.0000, 0.1099, 0.1108,
         0.1104],
        [0.1104, 0.1100, 0.1108, 0.1100, 0.1106, 0.1106, 0.1099, 0.0000, 0.1106,
         0.1104],
        [0.1104, 0.1107, 0.1111, 0.1109, 0.1109, 0.1107, 0.1108, 0.1106, 0.0000,
         0.1106],
        [0.1107, 0.1103, 0.1108, 0.1105, 0.1108, 0.1106, 0.1104, 0.1104, 0.1106,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0394, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65059793
Epoch624: train_loss: 4.0633 recon_acc: 0.7820 val_roc: 0.7675 val_ap: 0.8351 f1: 0.7194 time: 0.3117
difference_matrix tensor([[0.0000, 0.1103, 0.1107, 0.1104, 0.1105, 0.1108, 0.1102, 0.1104, 0.1104,
         0.1107],
        [0.1103, 0.0000, 0.1107, 0.1102, 0.1103, 0.1107, 0.1100, 0.1100, 0.1107,
         0.1102],
        [0.1107, 0.1107, 0.0000, 0.1108, 0.1110, 0.1105, 0.1103, 0.1108, 0.1110,
         0.1108],
        [0.1104, 0.1102, 0.1108, 0.0000, 0.1108, 0.1111, 0.1104, 0.1100, 0.1108,
         0.1105],
        [0.1105, 0.1103, 0.1110, 0.1108, 0.0000, 0.1103, 0.1109, 0.1106, 0.1109,
         0.1108],
        [0.1108, 0.1107, 0.1105, 0.1111, 0.1103, 0.0000, 0.1110, 0.1105, 0.1107,
         0.1105],
        [0.1102, 0.1100, 0.1103, 0.1104, 0.1109, 0.1110, 0.0000, 0.1099, 0.1108,
         0.1104],
        [0.1104, 0.1100, 0.1108, 0.1100, 0.1106, 0.1105, 0.1099, 0.0000, 0.1106,
         0.1104],
        [0.1104, 0.1107, 0.1110, 0.1108, 0.1109, 0.1107, 0.1108, 0.1106, 0.0000,
         0.1106],
        [0.1107, 0.1102, 0.1108, 0.1105, 0.1108, 0.1105, 0.1104, 0.1104, 0.1106,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0395, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6505416
Epoch625: train_loss: 4.0632 recon_acc: 0.7819 val_roc: 0.7675 val_ap: 0.8351 f1: 0.7194 time: 0.2806
difference_matrix tensor([[0.0000, 0.1103, 0.1107, 0.1104, 0.1105, 0.1108, 0.1101, 0.1104, 0.1104,
         0.1107],
        [0.1103, 0.0000, 0.1107, 0.1102, 0.1102, 0.1107, 0.1100, 0.1099, 0.1107,
         0.1102],
        [0.1107, 0.1107, 0.0000, 0.1108, 0.1110, 0.1105, 0.1102, 0.1108, 0.1110,
         0.1108],
        [0.1104, 0.1102, 0.1108, 0.0000, 0.1107, 0.1111, 0.1104, 0.1100, 0.1108,
         0.1105],
        [0.1105, 0.1102, 0.1110, 0.1107, 0.0000, 0.1102, 0.1109, 0.1106, 0.1109,
         0.1107],
        [0.1108, 0.1107, 0.1105, 0.1111, 0.1102, 0.0000, 0.1109, 0.1105, 0.1107,
         0.1105],
        [0.1101, 0.1100, 0.1102, 0.1104, 0.1109, 0.1109, 0.0000, 0.1099, 0.1108,
         0.1104],
        [0.1104, 0.1099, 0.1108, 0.1100, 0.1106, 0.1105, 0.1099, 0.0000, 0.1106,
         0.1103],
        [0.1104, 0.1107, 0.1110, 0.1108, 0.1109, 0.1107, 0.1108, 0.1106, 0.0000,
         0.1106],
        [0.1107, 0.1102, 0.1108, 0.1105, 0.1107, 0.1105, 0.1104, 0.1103, 0.1106,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0395, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6504836
Epoch626: train_loss: 4.0631 recon_acc: 0.7819 val_roc: 0.7676 val_ap: 0.8352 f1: 0.7194 time: 0.2708
thresh 0.7353428
          test_roc: 0.7623 test_ap: 0.8293 test_f1: 0.6979 test_recon_acc: 0.8980
difference_matrix tensor([[0.0000, 0.1103, 0.1107, 0.1103, 0.1105, 0.1108, 0.1101, 0.1104, 0.1104,
         0.1106],
        [0.1103, 0.0000, 0.1107, 0.1102, 0.1102, 0.1107, 0.1100, 0.1099, 0.1107,
         0.1102],
        [0.1107, 0.1107, 0.0000, 0.1108, 0.1109, 0.1105, 0.1102, 0.1108, 0.1110,
         0.1108],
        [0.1103, 0.1102, 0.1108, 0.0000, 0.1107, 0.1111, 0.1103, 0.1100, 0.1108,
         0.1105],
        [0.1105, 0.1102, 0.1109, 0.1107, 0.0000, 0.1102, 0.1109, 0.1105, 0.1108,
         0.1107],
        [0.1108, 0.1107, 0.1105, 0.1111, 0.1102, 0.0000, 0.1109, 0.1105, 0.1107,
         0.1105],
        [0.1101, 0.1100, 0.1102, 0.1103, 0.1109, 0.1109, 0.0000, 0.1099, 0.1108,
         0.1104],
        [0.1104, 0.1099, 0.1108, 0.1100, 0.1105, 0.1105, 0.1099, 0.0000, 0.1106,
         0.1103],
        [0.1104, 0.1107, 0.1110, 0.1108, 0.1108, 0.1107, 0.1108, 0.1106, 0.0000,
         0.1106],
        [0.1106, 0.1102, 0.1108, 0.1105, 0.1107, 0.1105, 0.1104, 0.1103, 0.1106,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0395, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6504242
Epoch627: train_loss: 4.0630 recon_acc: 0.7818 val_roc: 0.7678 val_ap: 0.8353 f1: 0.7194 time: 0.3100
thresh 0.73543006
          test_roc: 0.7623 test_ap: 0.8294 test_f1: 0.6979 test_recon_acc: 0.8981
difference_matrix tensor([[0.0000, 0.1103, 0.1107, 0.1103, 0.1105, 0.1107, 0.1101, 0.1104, 0.1104,
         0.1106],
        [0.1103, 0.0000, 0.1107, 0.1102, 0.1102, 0.1107, 0.1100, 0.1099, 0.1107,
         0.1102],
        [0.1107, 0.1107, 0.0000, 0.1108, 0.1109, 0.1105, 0.1102, 0.1108, 0.1110,
         0.1108],
        [0.1103, 0.1102, 0.1108, 0.0000, 0.1107, 0.1111, 0.1103, 0.1099, 0.1108,
         0.1104],
        [0.1105, 0.1102, 0.1109, 0.1107, 0.0000, 0.1102, 0.1109, 0.1105, 0.1108,
         0.1107],
        [0.1107, 0.1107, 0.1105, 0.1111, 0.1102, 0.0000, 0.1109, 0.1105, 0.1107,
         0.1105],
        [0.1101, 0.1100, 0.1102, 0.1103, 0.1109, 0.1109, 0.0000, 0.1099, 0.1108,
         0.1104],
        [0.1104, 0.1099, 0.1108, 0.1099, 0.1105, 0.1105, 0.1099, 0.0000, 0.1106,
         0.1103],
        [0.1104, 0.1107, 0.1110, 0.1108, 0.1108, 0.1107, 0.1108, 0.1106, 0.0000,
         0.1106],
        [0.1106, 0.1102, 0.1108, 0.1104, 0.1107, 0.1105, 0.1104, 0.1103, 0.1106,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0395, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65036297
Epoch628: train_loss: 4.0629 recon_acc: 0.7817 val_roc: 0.7678 val_ap: 0.8354 f1: 0.7194 time: 0.2977
thresh 0.7355194
          test_roc: 0.7625 test_ap: 0.8295 test_f1: 0.6979 test_recon_acc: 0.8982
difference_matrix tensor([[0.0000, 0.1102, 0.1107, 0.1103, 0.1104, 0.1107, 0.1101, 0.1104, 0.1104,
         0.1106],
        [0.1102, 0.0000, 0.1107, 0.1102, 0.1102, 0.1107, 0.1100, 0.1099, 0.1107,
         0.1102],
        [0.1107, 0.1107, 0.0000, 0.1108, 0.1109, 0.1105, 0.1102, 0.1108, 0.1110,
         0.1108],
        [0.1103, 0.1102, 0.1108, 0.0000, 0.1107, 0.1110, 0.1103, 0.1099, 0.1108,
         0.1104],
        [0.1104, 0.1102, 0.1109, 0.1107, 0.0000, 0.1102, 0.1109, 0.1105, 0.1108,
         0.1107],
        [0.1107, 0.1107, 0.1105, 0.1110, 0.1102, 0.0000, 0.1109, 0.1105, 0.1107,
         0.1105],
        [0.1101, 0.1100, 0.1102, 0.1103, 0.1109, 0.1109, 0.0000, 0.1099, 0.1107,
         0.1104],
        [0.1104, 0.1099, 0.1108, 0.1099, 0.1105, 0.1105, 0.1099, 0.0000, 0.1105,
         0.1103],
        [0.1104, 0.1107, 0.1110, 0.1108, 0.1108, 0.1107, 0.1107, 0.1105, 0.0000,
         0.1106],
        [0.1106, 0.1102, 0.1108, 0.1104, 0.1107, 0.1105, 0.1104, 0.1103, 0.1106,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0395, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65030026
Epoch629: train_loss: 4.0628 recon_acc: 0.7817 val_roc: 0.7679 val_ap: 0.8355 f1: 0.7194 time: 0.2824
thresh 0.7356107
          test_roc: 0.7625 test_ap: 0.8295 test_f1: 0.6996 test_recon_acc: 0.8984
difference_matrix tensor([[0.0000, 0.1102, 0.1107, 0.1103, 0.1104, 0.1107, 0.1101, 0.1103, 0.1103,
         0.1106],
        [0.1102, 0.0000, 0.1106, 0.1102, 0.1102, 0.1107, 0.1099, 0.1099, 0.1106,
         0.1102],
        [0.1107, 0.1106, 0.0000, 0.1108, 0.1109, 0.1104, 0.1102, 0.1108, 0.1110,
         0.1107],
        [0.1103, 0.1102, 0.1108, 0.0000, 0.1107, 0.1110, 0.1103, 0.1099, 0.1108,
         0.1104],
        [0.1104, 0.1102, 0.1109, 0.1107, 0.0000, 0.1102, 0.1108, 0.1105, 0.1108,
         0.1107],
        [0.1107, 0.1107, 0.1104, 0.1110, 0.1102, 0.0000, 0.1109, 0.1105, 0.1107,
         0.1105],
        [0.1101, 0.1099, 0.1102, 0.1103, 0.1108, 0.1109, 0.0000, 0.1098, 0.1107,
         0.1104],
        [0.1103, 0.1099, 0.1108, 0.1099, 0.1105, 0.1105, 0.1098, 0.0000, 0.1105,
         0.1103],
        [0.1103, 0.1106, 0.1110, 0.1108, 0.1108, 0.1107, 0.1107, 0.1105, 0.0000,
         0.1105],
        [0.1106, 0.1102, 0.1107, 0.1104, 0.1107, 0.1105, 0.1104, 0.1103, 0.1105,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0395, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.650236
Epoch630: train_loss: 4.0627 recon_acc: 0.7816 val_roc: 0.7680 val_ap: 0.8356 f1: 0.7194 time: 0.2682
thresh 0.7357038
          test_roc: 0.7625 test_ap: 0.8296 test_f1: 0.7005 test_recon_acc: 0.8985
difference_matrix tensor([[0.0000, 0.1102, 0.1107, 0.1103, 0.1104, 0.1107, 0.1101, 0.1103, 0.1103,
         0.1106],
        [0.1102, 0.0000, 0.1106, 0.1102, 0.1102, 0.1107, 0.1099, 0.1099, 0.1106,
         0.1102],
        [0.1107, 0.1106, 0.0000, 0.1108, 0.1109, 0.1104, 0.1102, 0.1107, 0.1110,
         0.1107],
        [0.1103, 0.1102, 0.1108, 0.0000, 0.1107, 0.1110, 0.1103, 0.1099, 0.1108,
         0.1104],
        [0.1104, 0.1102, 0.1109, 0.1107, 0.0000, 0.1102, 0.1108, 0.1105, 0.1108,
         0.1107],
        [0.1107, 0.1107, 0.1104, 0.1110, 0.1102, 0.0000, 0.1109, 0.1105, 0.1106,
         0.1105],
        [0.1101, 0.1099, 0.1102, 0.1103, 0.1108, 0.1109, 0.0000, 0.1098, 0.1107,
         0.1103],
        [0.1103, 0.1099, 0.1107, 0.1099, 0.1105, 0.1105, 0.1098, 0.0000, 0.1105,
         0.1103],
        [0.1103, 0.1106, 0.1110, 0.1108, 0.1108, 0.1106, 0.1107, 0.1105, 0.0000,
         0.1105],
        [0.1106, 0.1102, 0.1107, 0.1104, 0.1107, 0.1105, 0.1103, 0.1103, 0.1105,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0395, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.65017015
Epoch631: train_loss: 4.0626 recon_acc: 0.7815 val_roc: 0.7681 val_ap: 0.8357 f1: 0.7194 time: 0.2570
thresh 0.7357988
          test_roc: 0.7625 test_ap: 0.8296 test_f1: 0.7005 test_recon_acc: 0.8986
difference_matrix tensor([[0.0000, 0.1102, 0.1107, 0.1103, 0.1104, 0.1107, 0.1101, 0.1103, 0.1103,
         0.1106],
        [0.1102, 0.0000, 0.1106, 0.1101, 0.1102, 0.1106, 0.1099, 0.1099, 0.1106,
         0.1102],
        [0.1107, 0.1106, 0.0000, 0.1107, 0.1109, 0.1104, 0.1102, 0.1107, 0.1109,
         0.1107],
        [0.1103, 0.1101, 0.1107, 0.0000, 0.1107, 0.1110, 0.1103, 0.1099, 0.1107,
         0.1104],
        [0.1104, 0.1102, 0.1109, 0.1107, 0.0000, 0.1102, 0.1108, 0.1105, 0.1108,
         0.1107],
        [0.1107, 0.1106, 0.1104, 0.1110, 0.1102, 0.0000, 0.1109, 0.1104, 0.1106,
         0.1105],
        [0.1101, 0.1099, 0.1102, 0.1103, 0.1108, 0.1109, 0.0000, 0.1098, 0.1107,
         0.1103],
        [0.1103, 0.1099, 0.1107, 0.1099, 0.1105, 0.1104, 0.1098, 0.0000, 0.1105,
         0.1103],
        [0.1103, 0.1106, 0.1109, 0.1107, 0.1108, 0.1106, 0.1107, 0.1105, 0.0000,
         0.1105],
        [0.1106, 0.1102, 0.1107, 0.1104, 0.1107, 0.1105, 0.1103, 0.1103, 0.1105,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0395, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6501028
Epoch632: train_loss: 4.0625 recon_acc: 0.7815 val_roc: 0.7682 val_ap: 0.8357 f1: 0.7194 time: 0.2607
thresh 0.73589575
          test_roc: 0.7626 test_ap: 0.8297 test_f1: 0.7005 test_recon_acc: 0.8987
difference_matrix tensor([[0.0000, 0.1102, 0.1106, 0.1103, 0.1104, 0.1107, 0.1100, 0.1103, 0.1103,
         0.1106],
        [0.1102, 0.0000, 0.1106, 0.1101, 0.1102, 0.1106, 0.1099, 0.1098, 0.1106,
         0.1101],
        [0.1106, 0.1106, 0.0000, 0.1107, 0.1109, 0.1104, 0.1101, 0.1107, 0.1109,
         0.1107],
        [0.1103, 0.1101, 0.1107, 0.0000, 0.1106, 0.1110, 0.1103, 0.1099, 0.1107,
         0.1104],
        [0.1104, 0.1102, 0.1109, 0.1106, 0.0000, 0.1102, 0.1108, 0.1105, 0.1108,
         0.1107],
        [0.1107, 0.1106, 0.1104, 0.1110, 0.1102, 0.0000, 0.1109, 0.1104, 0.1106,
         0.1104],
        [0.1100, 0.1099, 0.1101, 0.1103, 0.1108, 0.1109, 0.0000, 0.1098, 0.1107,
         0.1103],
        [0.1103, 0.1098, 0.1107, 0.1099, 0.1105, 0.1104, 0.1098, 0.0000, 0.1105,
         0.1102],
        [0.1103, 0.1106, 0.1109, 0.1107, 0.1108, 0.1106, 0.1107, 0.1105, 0.0000,
         0.1105],
        [0.1106, 0.1101, 0.1107, 0.1104, 0.1107, 0.1104, 0.1103, 0.1102, 0.1105,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0396, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6500338
Epoch633: train_loss: 4.0624 recon_acc: 0.7814 val_roc: 0.7683 val_ap: 0.8357 f1: 0.7194 time: 0.2785
thresh 0.73599446
          test_roc: 0.7626 test_ap: 0.8297 test_f1: 0.7005 test_recon_acc: 0.8989
difference_matrix tensor([[0.0000, 0.1102, 0.1106, 0.1102, 0.1104, 0.1107, 0.1100, 0.1103, 0.1103,
         0.1106],
        [0.1102, 0.0000, 0.1106, 0.1101, 0.1101, 0.1106, 0.1099, 0.1098, 0.1106,
         0.1101],
        [0.1106, 0.1106, 0.0000, 0.1107, 0.1108, 0.1104, 0.1101, 0.1107, 0.1109,
         0.1107],
        [0.1102, 0.1101, 0.1107, 0.0000, 0.1106, 0.1110, 0.1103, 0.1099, 0.1107,
         0.1104],
        [0.1104, 0.1101, 0.1108, 0.1106, 0.0000, 0.1101, 0.1108, 0.1105, 0.1107,
         0.1106],
        [0.1107, 0.1106, 0.1104, 0.1110, 0.1101, 0.0000, 0.1108, 0.1104, 0.1106,
         0.1104],
        [0.1100, 0.1099, 0.1101, 0.1103, 0.1108, 0.1108, 0.0000, 0.1098, 0.1107,
         0.1103],
        [0.1103, 0.1098, 0.1107, 0.1099, 0.1105, 0.1104, 0.1098, 0.0000, 0.1105,
         0.1102],
        [0.1103, 0.1106, 0.1109, 0.1107, 0.1107, 0.1106, 0.1107, 0.1105, 0.0000,
         0.1105],
        [0.1106, 0.1101, 0.1107, 0.1104, 0.1106, 0.1104, 0.1103, 0.1102, 0.1105,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0396, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64996326
Epoch634: train_loss: 4.0623 recon_acc: 0.7813 val_roc: 0.7683 val_ap: 0.8357 f1: 0.7194 time: 0.2794
thresh 0.736095
          test_roc: 0.7627 test_ap: 0.8298 test_f1: 0.7005 test_recon_acc: 0.8990
difference_matrix tensor([[0.0000, 0.1102, 0.1106, 0.1102, 0.1104, 0.1106, 0.1100, 0.1103, 0.1103,
         0.1105],
        [0.1102, 0.0000, 0.1106, 0.1101, 0.1101, 0.1106, 0.1099, 0.1098, 0.1106,
         0.1101],
        [0.1106, 0.1106, 0.0000, 0.1107, 0.1108, 0.1104, 0.1101, 0.1107, 0.1109,
         0.1107],
        [0.1102, 0.1101, 0.1107, 0.0000, 0.1106, 0.1110, 0.1102, 0.1099, 0.1107,
         0.1104],
        [0.1104, 0.1101, 0.1108, 0.1106, 0.0000, 0.1101, 0.1108, 0.1104, 0.1107,
         0.1106],
        [0.1106, 0.1106, 0.1104, 0.1110, 0.1101, 0.0000, 0.1108, 0.1104, 0.1106,
         0.1104],
        [0.1100, 0.1099, 0.1101, 0.1102, 0.1108, 0.1108, 0.0000, 0.1098, 0.1107,
         0.1103],
        [0.1103, 0.1098, 0.1107, 0.1099, 0.1104, 0.1104, 0.1098, 0.0000, 0.1105,
         0.1102],
        [0.1103, 0.1106, 0.1109, 0.1107, 0.1107, 0.1106, 0.1107, 0.1105, 0.0000,
         0.1105],
        [0.1105, 0.1101, 0.1107, 0.1104, 0.1106, 0.1104, 0.1103, 0.1102, 0.1105,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0396, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64989126
Epoch635: train_loss: 4.0622 recon_acc: 0.7812 val_roc: 0.7685 val_ap: 0.8358 f1: 0.7194 time: 0.2786
thresh 0.7360923
          test_roc: 0.7628 test_ap: 0.8299 test_f1: 0.7005 test_recon_acc: 0.8990
difference_matrix tensor([[0.0000, 0.1102, 0.1106, 0.1102, 0.1104, 0.1106, 0.1100, 0.1103, 0.1103,
         0.1105],
        [0.1102, 0.0000, 0.1106, 0.1101, 0.1101, 0.1106, 0.1099, 0.1098, 0.1106,
         0.1101],
        [0.1106, 0.1106, 0.0000, 0.1107, 0.1108, 0.1104, 0.1101, 0.1107, 0.1109,
         0.1107],
        [0.1102, 0.1101, 0.1107, 0.0000, 0.1106, 0.1110, 0.1102, 0.1098, 0.1107,
         0.1103],
        [0.1104, 0.1101, 0.1108, 0.1106, 0.0000, 0.1101, 0.1108, 0.1104, 0.1107,
         0.1106],
        [0.1106, 0.1106, 0.1104, 0.1110, 0.1101, 0.0000, 0.1108, 0.1104, 0.1106,
         0.1104],
        [0.1100, 0.1099, 0.1101, 0.1102, 0.1108, 0.1108, 0.0000, 0.1098, 0.1107,
         0.1103],
        [0.1103, 0.1098, 0.1107, 0.1098, 0.1104, 0.1104, 0.1098, 0.0000, 0.1105,
         0.1102],
        [0.1103, 0.1106, 0.1109, 0.1107, 0.1107, 0.1106, 0.1107, 0.1105, 0.0000,
         0.1105],
        [0.1105, 0.1101, 0.1107, 0.1103, 0.1106, 0.1104, 0.1103, 0.1102, 0.1105,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0396, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64981776
Epoch636: train_loss: 4.0621 recon_acc: 0.7811 val_roc: 0.7685 val_ap: 0.8358 f1: 0.7194 time: 0.2654
difference_matrix tensor([[0.0000, 0.1101, 0.1106, 0.1102, 0.1103, 0.1106, 0.1100, 0.1102, 0.1103,
         0.1105],
        [0.1101, 0.0000, 0.1106, 0.1101, 0.1101, 0.1106, 0.1099, 0.1098, 0.1106,
         0.1101],
        [0.1106, 0.1106, 0.0000, 0.1107, 0.1108, 0.1103, 0.1101, 0.1107, 0.1109,
         0.1107],
        [0.1102, 0.1101, 0.1107, 0.0000, 0.1106, 0.1109, 0.1102, 0.1098, 0.1107,
         0.1103],
        [0.1103, 0.1101, 0.1108, 0.1106, 0.0000, 0.1101, 0.1108, 0.1104, 0.1107,
         0.1106],
        [0.1106, 0.1106, 0.1103, 0.1109, 0.1101, 0.0000, 0.1108, 0.1104, 0.1106,
         0.1104],
        [0.1100, 0.1099, 0.1101, 0.1102, 0.1108, 0.1108, 0.0000, 0.1097, 0.1106,
         0.1103],
        [0.1102, 0.1098, 0.1107, 0.1098, 0.1104, 0.1104, 0.1097, 0.0000, 0.1105,
         0.1102],
        [0.1103, 0.1106, 0.1109, 0.1107, 0.1107, 0.1106, 0.1106, 0.1105, 0.0000,
         0.1105],
        [0.1105, 0.1101, 0.1107, 0.1103, 0.1106, 0.1104, 0.1103, 0.1102, 0.1105,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0396, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64974266
Epoch637: train_loss: 4.0620 recon_acc: 0.7811 val_roc: 0.7685 val_ap: 0.8358 f1: 0.7194 time: 0.2494
difference_matrix tensor([[0.0000, 0.1101, 0.1106, 0.1102, 0.1103, 0.1106, 0.1100, 0.1102, 0.1103,
         0.1105],
        [0.1101, 0.0000, 0.1106, 0.1101, 0.1101, 0.1106, 0.1098, 0.1098, 0.1105,
         0.1101],
        [0.1106, 0.1106, 0.0000, 0.1107, 0.1108, 0.1103, 0.1101, 0.1107, 0.1109,
         0.1107],
        [0.1102, 0.1101, 0.1107, 0.0000, 0.1106, 0.1109, 0.1102, 0.1098, 0.1107,
         0.1103],
        [0.1103, 0.1101, 0.1108, 0.1106, 0.0000, 0.1101, 0.1107, 0.1104, 0.1107,
         0.1106],
        [0.1106, 0.1106, 0.1103, 0.1109, 0.1101, 0.0000, 0.1108, 0.1104, 0.1106,
         0.1104],
        [0.1100, 0.1098, 0.1101, 0.1102, 0.1107, 0.1108, 0.0000, 0.1097, 0.1106,
         0.1102],
        [0.1102, 0.1098, 0.1107, 0.1098, 0.1104, 0.1104, 0.1097, 0.0000, 0.1104,
         0.1102],
        [0.1103, 0.1105, 0.1109, 0.1107, 0.1107, 0.1106, 0.1106, 0.1104, 0.0000,
         0.1104],
        [0.1105, 0.1101, 0.1107, 0.1103, 0.1106, 0.1104, 0.1102, 0.1102, 0.1104,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0396, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6496661
Epoch638: train_loss: 4.0619 recon_acc: 0.7810 val_roc: 0.7684 val_ap: 0.8358 f1: 0.7194 time: 0.2648
difference_matrix tensor([[0.0000, 0.1101, 0.1106, 0.1102, 0.1103, 0.1106, 0.1100, 0.1102, 0.1102,
         0.1105],
        [0.1101, 0.0000, 0.1105, 0.1101, 0.1101, 0.1106, 0.1098, 0.1098, 0.1105,
         0.1101],
        [0.1106, 0.1105, 0.0000, 0.1107, 0.1108, 0.1103, 0.1101, 0.1106, 0.1109,
         0.1106],
        [0.1102, 0.1101, 0.1107, 0.0000, 0.1106, 0.1109, 0.1102, 0.1098, 0.1107,
         0.1103],
        [0.1103, 0.1101, 0.1108, 0.1106, 0.0000, 0.1101, 0.1107, 0.1104, 0.1107,
         0.1106],
        [0.1106, 0.1106, 0.1103, 0.1109, 0.1101, 0.0000, 0.1108, 0.1104, 0.1105,
         0.1104],
        [0.1100, 0.1098, 0.1101, 0.1102, 0.1107, 0.1108, 0.0000, 0.1097, 0.1106,
         0.1102],
        [0.1102, 0.1098, 0.1106, 0.1098, 0.1104, 0.1104, 0.1097, 0.0000, 0.1104,
         0.1102],
        [0.1102, 0.1105, 0.1109, 0.1107, 0.1107, 0.1105, 0.1106, 0.1104, 0.0000,
         0.1104],
        [0.1105, 0.1101, 0.1106, 0.1103, 0.1106, 0.1104, 0.1102, 0.1102, 0.1104,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0396, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.649588
Epoch639: train_loss: 4.0618 recon_acc: 0.7809 val_roc: 0.7685 val_ap: 0.8358 f1: 0.7194 time: 0.2675
difference_matrix tensor([[0.0000, 0.1101, 0.1106, 0.1102, 0.1103, 0.1106, 0.1100, 0.1102, 0.1102,
         0.1105],
        [0.1101, 0.0000, 0.1105, 0.1101, 0.1101, 0.1106, 0.1098, 0.1098, 0.1105,
         0.1101],
        [0.1106, 0.1105, 0.0000, 0.1107, 0.1108, 0.1103, 0.1100, 0.1106, 0.1108,
         0.1106],
        [0.1102, 0.1101, 0.1107, 0.0000, 0.1106, 0.1109, 0.1102, 0.1098, 0.1106,
         0.1103],
        [0.1103, 0.1101, 0.1108, 0.1106, 0.0000, 0.1101, 0.1107, 0.1104, 0.1107,
         0.1106],
        [0.1106, 0.1106, 0.1103, 0.1109, 0.1101, 0.0000, 0.1108, 0.1103, 0.1105,
         0.1103],
        [0.1100, 0.1098, 0.1100, 0.1102, 0.1107, 0.1108, 0.0000, 0.1097, 0.1106,
         0.1102],
        [0.1102, 0.1098, 0.1106, 0.1098, 0.1104, 0.1103, 0.1097, 0.0000, 0.1104,
         0.1102],
        [0.1102, 0.1105, 0.1108, 0.1106, 0.1107, 0.1105, 0.1106, 0.1104, 0.0000,
         0.1104],
        [0.1105, 0.1101, 0.1106, 0.1103, 0.1106, 0.1103, 0.1102, 0.1102, 0.1104,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0396, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6495084
Epoch640: train_loss: 4.0617 recon_acc: 0.7808 val_roc: 0.7685 val_ap: 0.8359 f1: 0.7194 time: 0.2711
thresh 0.7429818
          test_roc: 0.7631 test_ap: 0.8301 test_f1: 0.7008 test_recon_acc: 0.9065
difference_matrix tensor([[0.0000, 0.1101, 0.1105, 0.1102, 0.1103, 0.1106, 0.1099, 0.1102, 0.1102,
         0.1105],
        [0.1101, 0.0000, 0.1105, 0.1100, 0.1101, 0.1105, 0.1098, 0.1097, 0.1105,
         0.1100],
        [0.1105, 0.1105, 0.0000, 0.1106, 0.1108, 0.1103, 0.1100, 0.1106, 0.1108,
         0.1106],
        [0.1102, 0.1100, 0.1106, 0.0000, 0.1105, 0.1109, 0.1102, 0.1098, 0.1106,
         0.1103],
        [0.1103, 0.1101, 0.1108, 0.1105, 0.0000, 0.1100, 0.1107, 0.1104, 0.1107,
         0.1105],
        [0.1106, 0.1105, 0.1103, 0.1109, 0.1100, 0.0000, 0.1108, 0.1103, 0.1105,
         0.1103],
        [0.1099, 0.1098, 0.1100, 0.1102, 0.1107, 0.1108, 0.0000, 0.1097, 0.1106,
         0.1102],
        [0.1102, 0.1097, 0.1106, 0.1098, 0.1104, 0.1103, 0.1097, 0.0000, 0.1104,
         0.1101],
        [0.1102, 0.1105, 0.1108, 0.1106, 0.1107, 0.1105, 0.1106, 0.1104, 0.0000,
         0.1104],
        [0.1105, 0.1100, 0.1106, 0.1103, 0.1105, 0.1103, 0.1102, 0.1101, 0.1104,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0397, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64942735
Epoch641: train_loss: 4.0616 recon_acc: 0.7807 val_roc: 0.7687 val_ap: 0.8361 f1: 0.7212 time: 0.2752
thresh 0.74237335
          test_roc: 0.7631 test_ap: 0.8302 test_f1: 0.6999 test_recon_acc: 0.9059
difference_matrix tensor([[0.0000, 0.1101, 0.1105, 0.1101, 0.1103, 0.1106, 0.1099, 0.1102, 0.1102,
         0.1105],
        [0.1101, 0.0000, 0.1105, 0.1100, 0.1100, 0.1105, 0.1098, 0.1097, 0.1105,
         0.1100],
        [0.1105, 0.1105, 0.0000, 0.1106, 0.1107, 0.1103, 0.1100, 0.1106, 0.1108,
         0.1106],
        [0.1101, 0.1100, 0.1106, 0.0000, 0.1105, 0.1109, 0.1102, 0.1098, 0.1106,
         0.1103],
        [0.1103, 0.1100, 0.1107, 0.1105, 0.0000, 0.1100, 0.1107, 0.1104, 0.1107,
         0.1105],
        [0.1106, 0.1105, 0.1103, 0.1109, 0.1100, 0.0000, 0.1108, 0.1103, 0.1105,
         0.1103],
        [0.1099, 0.1098, 0.1100, 0.1102, 0.1107, 0.1108, 0.0000, 0.1097, 0.1106,
         0.1102],
        [0.1102, 0.1097, 0.1106, 0.1098, 0.1104, 0.1103, 0.1097, 0.0000, 0.1104,
         0.1101],
        [0.1102, 0.1105, 0.1108, 0.1106, 0.1107, 0.1105, 0.1106, 0.1104, 0.0000,
         0.1104],
        [0.1105, 0.1100, 0.1106, 0.1103, 0.1105, 0.1103, 0.1102, 0.1101, 0.1104,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0397, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64934486
Epoch642: train_loss: 4.0615 recon_acc: 0.7806 val_roc: 0.7688 val_ap: 0.8362 f1: 0.7212 time: 0.2575
thresh 0.7340231
          test_roc: 0.7631 test_ap: 0.8302 test_f1: 0.6995 test_recon_acc: 0.8968
difference_matrix tensor([[0.0000, 0.1101, 0.1105, 0.1101, 0.1103, 0.1106, 0.1099, 0.1102, 0.1102,
         0.1105],
        [0.1101, 0.0000, 0.1105, 0.1100, 0.1100, 0.1105, 0.1098, 0.1097, 0.1105,
         0.1100],
        [0.1105, 0.1105, 0.0000, 0.1106, 0.1107, 0.1103, 0.1100, 0.1106, 0.1108,
         0.1106],
        [0.1101, 0.1100, 0.1106, 0.0000, 0.1105, 0.1109, 0.1101, 0.1098, 0.1106,
         0.1103],
        [0.1103, 0.1100, 0.1107, 0.1105, 0.0000, 0.1100, 0.1107, 0.1103, 0.1106,
         0.1105],
        [0.1106, 0.1105, 0.1103, 0.1109, 0.1100, 0.0000, 0.1107, 0.1103, 0.1105,
         0.1103],
        [0.1099, 0.1098, 0.1100, 0.1101, 0.1107, 0.1107, 0.0000, 0.1097, 0.1106,
         0.1102],
        [0.1102, 0.1097, 0.1106, 0.1098, 0.1103, 0.1103, 0.1097, 0.0000, 0.1104,
         0.1101],
        [0.1102, 0.1105, 0.1108, 0.1106, 0.1106, 0.1105, 0.1106, 0.1104, 0.0000,
         0.1104],
        [0.1105, 0.1100, 0.1106, 0.1103, 0.1105, 0.1103, 0.1102, 0.1101, 0.1104,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0397, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6492608
Epoch643: train_loss: 4.0614 recon_acc: 0.7805 val_roc: 0.7688 val_ap: 0.8362 f1: 0.7212 time: 0.2491
difference_matrix tensor([[0.0000, 0.1101, 0.1105, 0.1101, 0.1103, 0.1105, 0.1099, 0.1102, 0.1102,
         0.1104],
        [0.1101, 0.0000, 0.1105, 0.1100, 0.1100, 0.1105, 0.1098, 0.1097, 0.1105,
         0.1100],
        [0.1105, 0.1105, 0.0000, 0.1106, 0.1107, 0.1102, 0.1100, 0.1106, 0.1108,
         0.1106],
        [0.1101, 0.1100, 0.1106, 0.0000, 0.1105, 0.1109, 0.1101, 0.1097, 0.1106,
         0.1102],
        [0.1103, 0.1100, 0.1107, 0.1105, 0.0000, 0.1100, 0.1107, 0.1103, 0.1106,
         0.1105],
        [0.1105, 0.1105, 0.1102, 0.1109, 0.1100, 0.0000, 0.1107, 0.1103, 0.1105,
         0.1103],
        [0.1099, 0.1098, 0.1100, 0.1101, 0.1107, 0.1107, 0.0000, 0.1097, 0.1105,
         0.1102],
        [0.1102, 0.1097, 0.1106, 0.1097, 0.1103, 0.1103, 0.1097, 0.0000, 0.1104,
         0.1101],
        [0.1102, 0.1105, 0.1108, 0.1106, 0.1106, 0.1105, 0.1105, 0.1104, 0.0000,
         0.1104],
        [0.1104, 0.1100, 0.1106, 0.1102, 0.1105, 0.1103, 0.1102, 0.1101, 0.1104,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0397, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64917535
Epoch644: train_loss: 4.0613 recon_acc: 0.7803 val_roc: 0.7689 val_ap: 0.8363 f1: 0.7212 time: 0.3011
thresh 0.73719704
          test_roc: 0.7631 test_ap: 0.8303 test_f1: 0.7007 test_recon_acc: 0.9004
difference_matrix tensor([[0.0000, 0.1101, 0.1105, 0.1101, 0.1103, 0.1105, 0.1099, 0.1102, 0.1102,
         0.1104],
        [0.1101, 0.0000, 0.1105, 0.1100, 0.1100, 0.1105, 0.1097, 0.1097, 0.1105,
         0.1100],
        [0.1105, 0.1105, 0.0000, 0.1106, 0.1107, 0.1102, 0.1100, 0.1106, 0.1108,
         0.1106],
        [0.1101, 0.1100, 0.1106, 0.0000, 0.1105, 0.1109, 0.1101, 0.1097, 0.1106,
         0.1102],
        [0.1103, 0.1100, 0.1107, 0.1105, 0.0000, 0.1100, 0.1107, 0.1103, 0.1106,
         0.1105],
        [0.1105, 0.1105, 0.1102, 0.1109, 0.1100, 0.0000, 0.1107, 0.1103, 0.1105,
         0.1103],
        [0.1099, 0.1097, 0.1100, 0.1101, 0.1107, 0.1107, 0.0000, 0.1096, 0.1105,
         0.1102],
        [0.1102, 0.1097, 0.1106, 0.1097, 0.1103, 0.1103, 0.1096, 0.0000, 0.1104,
         0.1101],
        [0.1102, 0.1105, 0.1108, 0.1106, 0.1106, 0.1105, 0.1105, 0.1104, 0.0000,
         0.1104],
        [0.1104, 0.1100, 0.1106, 0.1102, 0.1105, 0.1103, 0.1102, 0.1101, 0.1104,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0397, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6490884
Epoch645: train_loss: 4.0612 recon_acc: 0.7802 val_roc: 0.7690 val_ap: 0.8363 f1: 0.7212 time: 0.3104
thresh 0.73731655
          test_roc: 0.7632 test_ap: 0.8304 test_f1: 0.7007 test_recon_acc: 0.9005
difference_matrix tensor([[0.0000, 0.1100, 0.1105, 0.1101, 0.1102, 0.1105, 0.1099, 0.1101, 0.1102,
         0.1104],
        [0.1100, 0.0000, 0.1105, 0.1100, 0.1100, 0.1105, 0.1097, 0.1097, 0.1104,
         0.1100],
        [0.1105, 0.1105, 0.0000, 0.1106, 0.1107, 0.1102, 0.1100, 0.1106, 0.1108,
         0.1106],
        [0.1101, 0.1100, 0.1106, 0.0000, 0.1105, 0.1108, 0.1101, 0.1097, 0.1106,
         0.1102],
        [0.1102, 0.1100, 0.1107, 0.1105, 0.0000, 0.1100, 0.1107, 0.1103, 0.1106,
         0.1105],
        [0.1105, 0.1105, 0.1102, 0.1108, 0.1100, 0.0000, 0.1107, 0.1103, 0.1105,
         0.1103],
        [0.1099, 0.1097, 0.1100, 0.1101, 0.1107, 0.1107, 0.0000, 0.1096, 0.1105,
         0.1101],
        [0.1101, 0.1097, 0.1106, 0.1097, 0.1103, 0.1103, 0.1096, 0.0000, 0.1104,
         0.1101],
        [0.1102, 0.1104, 0.1108, 0.1106, 0.1106, 0.1105, 0.1105, 0.1104, 0.0000,
         0.1104],
        [0.1104, 0.1100, 0.1106, 0.1102, 0.1105, 0.1103, 0.1101, 0.1101, 0.1104,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0397, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.649
Epoch646: train_loss: 4.0612 recon_acc: 0.7801 val_roc: 0.7691 val_ap: 0.8364 f1: 0.7229 time: 0.2705
thresh 0.7374376
          test_roc: 0.7632 test_ap: 0.8304 test_f1: 0.7007 test_recon_acc: 0.9007
difference_matrix tensor([[0.0000, 0.1100, 0.1105, 0.1101, 0.1102, 0.1105, 0.1099, 0.1101, 0.1102,
         0.1104],
        [0.1100, 0.0000, 0.1105, 0.1100, 0.1100, 0.1105, 0.1097, 0.1097, 0.1104,
         0.1100],
        [0.1105, 0.1105, 0.0000, 0.1106, 0.1107, 0.1102, 0.1100, 0.1106, 0.1107,
         0.1105],
        [0.1101, 0.1100, 0.1106, 0.0000, 0.1105, 0.1108, 0.1101, 0.1097, 0.1106,
         0.1102],
        [0.1102, 0.1100, 0.1107, 0.1105, 0.0000, 0.1100, 0.1106, 0.1103, 0.1106,
         0.1105],
        [0.1105, 0.1105, 0.1102, 0.1108, 0.1100, 0.0000, 0.1107, 0.1103, 0.1105,
         0.1103],
        [0.1099, 0.1097, 0.1100, 0.1101, 0.1106, 0.1107, 0.0000, 0.1096, 0.1105,
         0.1101],
        [0.1101, 0.1097, 0.1106, 0.1097, 0.1103, 0.1103, 0.1096, 0.0000, 0.1103,
         0.1101],
        [0.1102, 0.1104, 0.1107, 0.1106, 0.1106, 0.1105, 0.1105, 0.1103, 0.0000,
         0.1103],
        [0.1104, 0.1100, 0.1105, 0.1102, 0.1105, 0.1103, 0.1101, 0.1101, 0.1103,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0397, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64891016
Epoch647: train_loss: 4.0611 recon_acc: 0.7800 val_roc: 0.7691 val_ap: 0.8363 f1: 0.7229 time: 0.2689
difference_matrix tensor([[0.0000, 0.1100, 0.1105, 0.1101, 0.1102, 0.1105, 0.1098, 0.1101, 0.1101,
         0.1104],
        [0.1100, 0.0000, 0.1104, 0.1100, 0.1100, 0.1105, 0.1097, 0.1097, 0.1104,
         0.1100],
        [0.1105, 0.1104, 0.0000, 0.1106, 0.1107, 0.1102, 0.1099, 0.1105, 0.1107,
         0.1105],
        [0.1101, 0.1100, 0.1106, 0.0000, 0.1105, 0.1108, 0.1101, 0.1097, 0.1106,
         0.1102],
        [0.1102, 0.1100, 0.1107, 0.1105, 0.0000, 0.1100, 0.1106, 0.1103, 0.1106,
         0.1105],
        [0.1105, 0.1105, 0.1102, 0.1108, 0.1100, 0.0000, 0.1107, 0.1102, 0.1104,
         0.1103],
        [0.1098, 0.1097, 0.1099, 0.1101, 0.1106, 0.1107, 0.0000, 0.1096, 0.1105,
         0.1101],
        [0.1101, 0.1097, 0.1105, 0.1097, 0.1103, 0.1102, 0.1096, 0.0000, 0.1103,
         0.1101],
        [0.1101, 0.1104, 0.1107, 0.1106, 0.1106, 0.1104, 0.1105, 0.1103, 0.0000,
         0.1103],
        [0.1104, 0.1100, 0.1105, 0.1102, 0.1105, 0.1103, 0.1101, 0.1101, 0.1103,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0397, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64881897
Epoch648: train_loss: 4.0610 recon_acc: 0.7799 val_roc: 0.7693 val_ap: 0.8364 f1: 0.7229 time: 0.2563
thresh 0.75641006
          test_roc: 0.7633 test_ap: 0.8305 test_f1: 0.7020 test_recon_acc: 0.9205
difference_matrix tensor([[0.0000, 0.1100, 0.1105, 0.1101, 0.1102, 0.1105, 0.1098, 0.1101, 0.1101,
         0.1104],
        [0.1100, 0.0000, 0.1104, 0.1100, 0.1100, 0.1105, 0.1097, 0.1096, 0.1104,
         0.1099],
        [0.1105, 0.1104, 0.0000, 0.1106, 0.1107, 0.1102, 0.1099, 0.1105, 0.1107,
         0.1105],
        [0.1101, 0.1100, 0.1106, 0.0000, 0.1105, 0.1108, 0.1101, 0.1097, 0.1105,
         0.1102],
        [0.1102, 0.1100, 0.1107, 0.1105, 0.0000, 0.1099, 0.1106, 0.1103, 0.1106,
         0.1105],
        [0.1105, 0.1105, 0.1102, 0.1108, 0.1099, 0.0000, 0.1107, 0.1102, 0.1104,
         0.1102],
        [0.1098, 0.1097, 0.1099, 0.1101, 0.1106, 0.1107, 0.0000, 0.1096, 0.1105,
         0.1101],
        [0.1101, 0.1096, 0.1105, 0.1097, 0.1103, 0.1102, 0.1096, 0.0000, 0.1103,
         0.1100],
        [0.1101, 0.1104, 0.1107, 0.1105, 0.1106, 0.1104, 0.1105, 0.1103, 0.0000,
         0.1103],
        [0.1104, 0.1099, 0.1105, 0.1102, 0.1105, 0.1102, 0.1101, 0.1100, 0.1103,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0397, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6487263
Epoch649: train_loss: 4.0609 recon_acc: 0.7798 val_roc: 0.7694 val_ap: 0.8365 f1: 0.7229 time: 0.2550
thresh 0.73547274
          test_roc: 0.7635 test_ap: 0.8306 test_f1: 0.7031 test_recon_acc: 0.8986
difference_matrix tensor([[0.0000, 0.1100, 0.1104, 0.1101, 0.1102, 0.1105, 0.1098, 0.1101, 0.1101,
         0.1104],
        [0.1100, 0.0000, 0.1104, 0.1099, 0.1100, 0.1104, 0.1097, 0.1096, 0.1104,
         0.1099],
        [0.1104, 0.1104, 0.0000, 0.1105, 0.1106, 0.1102, 0.1099, 0.1105, 0.1107,
         0.1105],
        [0.1101, 0.1099, 0.1105, 0.0000, 0.1104, 0.1108, 0.1101, 0.1097, 0.1105,
         0.1102],
        [0.1102, 0.1100, 0.1106, 0.1104, 0.0000, 0.1099, 0.1106, 0.1103, 0.1106,
         0.1104],
        [0.1105, 0.1104, 0.1102, 0.1108, 0.1099, 0.0000, 0.1107, 0.1102, 0.1104,
         0.1102],
        [0.1098, 0.1097, 0.1099, 0.1101, 0.1106, 0.1107, 0.0000, 0.1096, 0.1105,
         0.1101],
        [0.1101, 0.1096, 0.1105, 0.1097, 0.1103, 0.1102, 0.1096, 0.0000, 0.1103,
         0.1100],
        [0.1101, 0.1104, 0.1107, 0.1105, 0.1106, 0.1104, 0.1105, 0.1103, 0.0000,
         0.1103],
        [0.1104, 0.1099, 0.1105, 0.1102, 0.1104, 0.1102, 0.1101, 0.1100, 0.1103,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0398, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6486322
Epoch650: train_loss: 4.0608 recon_acc: 0.7797 val_roc: 0.7693 val_ap: 0.8365 f1: 0.7229 time: 0.2831
difference_matrix tensor([[0.0000, 0.1100, 0.1104, 0.1100, 0.1102, 0.1105, 0.1098, 0.1101, 0.1101,
         0.1104],
        [0.1100, 0.0000, 0.1104, 0.1099, 0.1099, 0.1104, 0.1097, 0.1096, 0.1104,
         0.1099],
        [0.1104, 0.1104, 0.0000, 0.1105, 0.1106, 0.1102, 0.1099, 0.1105, 0.1107,
         0.1105],
        [0.1100, 0.1099, 0.1105, 0.0000, 0.1104, 0.1108, 0.1100, 0.1097, 0.1105,
         0.1102],
        [0.1102, 0.1099, 0.1106, 0.1104, 0.0000, 0.1099, 0.1106, 0.1102, 0.1105,
         0.1104],
        [0.1105, 0.1104, 0.1102, 0.1108, 0.1099, 0.0000, 0.1107, 0.1102, 0.1104,
         0.1102],
        [0.1098, 0.1097, 0.1099, 0.1100, 0.1106, 0.1107, 0.0000, 0.1096, 0.1105,
         0.1101],
        [0.1101, 0.1096, 0.1105, 0.1097, 0.1102, 0.1102, 0.1096, 0.0000, 0.1103,
         0.1100],
        [0.1101, 0.1104, 0.1107, 0.1105, 0.1105, 0.1104, 0.1105, 0.1103, 0.0000,
         0.1103],
        [0.1104, 0.1099, 0.1105, 0.1102, 0.1104, 0.1102, 0.1101, 0.1100, 0.1103,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0398, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6485367
Epoch651: train_loss: 4.0607 recon_acc: 0.7795 val_roc: 0.7695 val_ap: 0.8365 f1: 0.7229 time: 0.2829
thresh 0.73627675
          test_roc: 0.7636 test_ap: 0.8307 test_f1: 0.7031 test_recon_acc: 0.8995
difference_matrix tensor([[0.0000, 0.1100, 0.1104, 0.1100, 0.1102, 0.1104, 0.1098, 0.1101, 0.1101,
         0.1104],
        [0.1100, 0.0000, 0.1104, 0.1099, 0.1099, 0.1104, 0.1097, 0.1096, 0.1104,
         0.1099],
        [0.1104, 0.1104, 0.0000, 0.1105, 0.1106, 0.1101, 0.1099, 0.1105, 0.1107,
         0.1105],
        [0.1100, 0.1099, 0.1105, 0.0000, 0.1104, 0.1108, 0.1100, 0.1097, 0.1105,
         0.1102],
        [0.1102, 0.1099, 0.1106, 0.1104, 0.0000, 0.1099, 0.1106, 0.1102, 0.1105,
         0.1104],
        [0.1104, 0.1104, 0.1101, 0.1108, 0.1099, 0.0000, 0.1106, 0.1102, 0.1104,
         0.1102],
        [0.1098, 0.1097, 0.1099, 0.1100, 0.1106, 0.1106, 0.0000, 0.1096, 0.1105,
         0.1101],
        [0.1101, 0.1096, 0.1105, 0.1097, 0.1102, 0.1102, 0.1096, 0.0000, 0.1103,
         0.1100],
        [0.1101, 0.1104, 0.1107, 0.1105, 0.1105, 0.1104, 0.1105, 0.1103, 0.0000,
         0.1103],
        [0.1104, 0.1099, 0.1105, 0.1102, 0.1104, 0.1102, 0.1101, 0.1100, 0.1103,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0398, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.64843976
Epoch652: train_loss: 4.0606 recon_acc: 0.7794 val_roc: 0.7695 val_ap: 0.8367 f1: 0.7229 time: 0.2565
thresh 0.73566586
          test_roc: 0.7637 test_ap: 0.8308 test_f1: 0.7031 test_recon_acc: 0.8988
difference_matrix tensor([[0.0000, 0.1100, 0.1104, 0.1100, 0.1102, 0.1104, 0.1098, 0.1101, 0.1101,
         0.1103],
        [0.1100, 0.0000, 0.1104, 0.1099, 0.1099, 0.1104, 0.1097, 0.1096, 0.1104,
         0.1099],
        [0.1104, 0.1104, 0.0000, 0.1105, 0.1106, 0.1101, 0.1099, 0.1105, 0.1107,
         0.1105],
        [0.1100, 0.1099, 0.1105, 0.0000, 0.1104, 0.1108, 0.1100, 0.1096, 0.1105,
         0.1101],
        [0.1102, 0.1099, 0.1106, 0.1104, 0.0000, 0.1099, 0.1106, 0.1102, 0.1105,
         0.1104],
        [0.1104, 0.1104, 0.1101, 0.1108, 0.1099, 0.0000, 0.1106, 0.1102, 0.1104,
         0.1102],
        [0.1098, 0.1097, 0.1099, 0.1100, 0.1106, 0.1106, 0.0000, 0.1096, 0.1104,
         0.1101],
        [0.1101, 0.1096, 0.1105, 0.1096, 0.1102, 0.1102, 0.1096, 0.0000, 0.1103,
         0.1100],
        [0.1101, 0.1104, 0.1107, 0.1105, 0.1105, 0.1104, 0.1104, 0.1103, 0.0000,
         0.1103],
        [0.1103, 0.1099, 0.1105, 0.1101, 0.1104, 0.1102, 0.1101, 0.1100, 0.1103,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0398, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6831841
Epoch653: train_loss: 4.0605 recon_acc: 0.8316 val_roc: 0.7538 val_ap: 0.8216 f1: 0.6900 time: 0.2837
difference_matrix tensor([[0.0000, 0.1100, 0.1104, 0.1100, 0.1102, 0.1104, 0.1098, 0.1101, 0.1101,
         0.1103],
        [0.1100, 0.0000, 0.1104, 0.1099, 0.1099, 0.1104, 0.1096, 0.1096, 0.1104,
         0.1099],
        [0.1104, 0.1104, 0.0000, 0.1105, 0.1106, 0.1101, 0.1099, 0.1105, 0.1107,
         0.1105],
        [0.1100, 0.1099, 0.1105, 0.0000, 0.1104, 0.1108, 0.1100, 0.1096, 0.1105,
         0.1101],
        [0.1102, 0.1099, 0.1106, 0.1104, 0.0000, 0.1099, 0.1106, 0.1102, 0.1105,
         0.1104],
        [0.1104, 0.1104, 0.1101, 0.1108, 0.1099, 0.0000, 0.1106, 0.1102, 0.1104,
         0.1102],
        [0.1098, 0.1096, 0.1099, 0.1100, 0.1106, 0.1106, 0.0000, 0.1095, 0.1104,
         0.1101],
        [0.1101, 0.1096, 0.1105, 0.1096, 0.1102, 0.1102, 0.1095, 0.0000, 0.1103,
         0.1100],
        [0.1101, 0.1104, 0.1107, 0.1105, 0.1105, 0.1104, 0.1104, 0.1103, 0.0000,
         0.1103],
        [0.1103, 0.1099, 0.1105, 0.1101, 0.1104, 0.1102, 0.1101, 0.1100, 0.1103,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0398, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6835955
Epoch654: train_loss: 4.0605 recon_acc: 0.8323 val_roc: 0.7538 val_ap: 0.8217 f1: 0.6900 time: 0.2731
difference_matrix tensor([[0.0000, 0.1099, 0.1104, 0.1100, 0.1101, 0.1104, 0.1098, 0.1100, 0.1101,
         0.1103],
        [0.1099, 0.0000, 0.1104, 0.1099, 0.1099, 0.1104, 0.1096, 0.1096, 0.1104,
         0.1099],
        [0.1104, 0.1104, 0.0000, 0.1105, 0.1106, 0.1101, 0.1099, 0.1105, 0.1107,
         0.1105],
        [0.1100, 0.1099, 0.1105, 0.0000, 0.1104, 0.1108, 0.1100, 0.1096, 0.1105,
         0.1101],
        [0.1101, 0.1099, 0.1106, 0.1104, 0.0000, 0.1099, 0.1106, 0.1102, 0.1105,
         0.1104],
        [0.1104, 0.1104, 0.1101, 0.1108, 0.1099, 0.0000, 0.1106, 0.1102, 0.1104,
         0.1102],
        [0.1098, 0.1096, 0.1099, 0.1100, 0.1106, 0.1106, 0.0000, 0.1095, 0.1104,
         0.1100],
        [0.1100, 0.1096, 0.1105, 0.1096, 0.1102, 0.1102, 0.1095, 0.0000, 0.1103,
         0.1100],
        [0.1101, 0.1104, 0.1107, 0.1105, 0.1105, 0.1104, 0.1104, 0.1103, 0.0000,
         0.1103],
        [0.1103, 0.1099, 0.1105, 0.1101, 0.1104, 0.1102, 0.1100, 0.1100, 0.1103,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0398, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6840051
Epoch655: train_loss: 4.0604 recon_acc: 0.8329 val_roc: 0.7538 val_ap: 0.8217 f1: 0.6900 time: 0.2836
difference_matrix tensor([[0.0000, 0.1099, 0.1104, 0.1100, 0.1101, 0.1104, 0.1098, 0.1100, 0.1101,
         0.1103],
        [0.1099, 0.0000, 0.1104, 0.1099, 0.1099, 0.1104, 0.1096, 0.1096, 0.1103,
         0.1099],
        [0.1104, 0.1104, 0.0000, 0.1105, 0.1106, 0.1101, 0.1099, 0.1105, 0.1106,
         0.1104],
        [0.1100, 0.1099, 0.1105, 0.0000, 0.1104, 0.1107, 0.1100, 0.1096, 0.1105,
         0.1101],
        [0.1101, 0.1099, 0.1106, 0.1104, 0.0000, 0.1099, 0.1105, 0.1102, 0.1105,
         0.1104],
        [0.1104, 0.1104, 0.1101, 0.1107, 0.1099, 0.0000, 0.1106, 0.1101, 0.1104,
         0.1102],
        [0.1098, 0.1096, 0.1099, 0.1100, 0.1105, 0.1106, 0.0000, 0.1095, 0.1104,
         0.1100],
        [0.1100, 0.1096, 0.1105, 0.1096, 0.1102, 0.1101, 0.1095, 0.0000, 0.1103,
         0.1100],
        [0.1101, 0.1103, 0.1106, 0.1105, 0.1105, 0.1104, 0.1104, 0.1103, 0.0000,
         0.1103],
        [0.1103, 0.1099, 0.1104, 0.1101, 0.1104, 0.1102, 0.1100, 0.1100, 0.1103,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0398, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68441296
Epoch656: train_loss: 4.0603 recon_acc: 0.8335 val_roc: 0.7539 val_ap: 0.8219 f1: 0.6900 time: 0.2785
difference_matrix tensor([[0.0000, 0.1099, 0.1104, 0.1100, 0.1101, 0.1104, 0.1097, 0.1100, 0.1100,
         0.1103],
        [0.1099, 0.0000, 0.1104, 0.1099, 0.1099, 0.1104, 0.1096, 0.1096, 0.1103,
         0.1098],
        [0.1104, 0.1104, 0.0000, 0.1105, 0.1106, 0.1101, 0.1098, 0.1104, 0.1106,
         0.1104],
        [0.1100, 0.1099, 0.1105, 0.0000, 0.1104, 0.1107, 0.1100, 0.1096, 0.1105,
         0.1101],
        [0.1101, 0.1099, 0.1106, 0.1104, 0.0000, 0.1099, 0.1105, 0.1102, 0.1105,
         0.1104],
        [0.1104, 0.1104, 0.1101, 0.1107, 0.1099, 0.0000, 0.1106, 0.1101, 0.1104,
         0.1101],
        [0.1097, 0.1096, 0.1098, 0.1100, 0.1105, 0.1106, 0.0000, 0.1095, 0.1104,
         0.1100],
        [0.1100, 0.1096, 0.1104, 0.1096, 0.1102, 0.1101, 0.1095, 0.0000, 0.1102,
         0.1100],
        [0.1100, 0.1103, 0.1106, 0.1105, 0.1105, 0.1104, 0.1104, 0.1102, 0.0000,
         0.1102],
        [0.1103, 0.1098, 0.1104, 0.1101, 0.1104, 0.1101, 0.1100, 0.1100, 0.1102,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0398, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6848191
Epoch657: train_loss: 4.0602 recon_acc: 0.8341 val_roc: 0.7540 val_ap: 0.8219 f1: 0.6900 time: 0.2832
difference_matrix tensor([[0.0000, 0.1099, 0.1104, 0.1100, 0.1101, 0.1104, 0.1097, 0.1100, 0.1100,
         0.1103],
        [0.1099, 0.0000, 0.1103, 0.1099, 0.1099, 0.1104, 0.1096, 0.1095, 0.1103,
         0.1098],
        [0.1104, 0.1103, 0.0000, 0.1105, 0.1106, 0.1101, 0.1098, 0.1104, 0.1106,
         0.1104],
        [0.1100, 0.1099, 0.1105, 0.0000, 0.1104, 0.1107, 0.1100, 0.1096, 0.1104,
         0.1101],
        [0.1101, 0.1099, 0.1106, 0.1104, 0.0000, 0.1098, 0.1105, 0.1102, 0.1105,
         0.1103],
        [0.1104, 0.1104, 0.1101, 0.1107, 0.1098, 0.0000, 0.1106, 0.1101, 0.1103,
         0.1101],
        [0.1097, 0.1096, 0.1098, 0.1100, 0.1105, 0.1106, 0.0000, 0.1095, 0.1104,
         0.1100],
        [0.1100, 0.1095, 0.1104, 0.1096, 0.1102, 0.1101, 0.1095, 0.0000, 0.1102,
         0.1099],
        [0.1100, 0.1103, 0.1106, 0.1104, 0.1105, 0.1103, 0.1104, 0.1102, 0.0000,
         0.1102],
        [0.1103, 0.1098, 0.1104, 0.1101, 0.1103, 0.1101, 0.1100, 0.1099, 0.1102,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0398, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6852234
Epoch658: train_loss: 4.0601 recon_acc: 0.8347 val_roc: 0.7541 val_ap: 0.8220 f1: 0.6900 time: 0.2646
difference_matrix tensor([[0.0000, 0.1099, 0.1103, 0.1100, 0.1101, 0.1104, 0.1097, 0.1100, 0.1100,
         0.1103],
        [0.1099, 0.0000, 0.1103, 0.1099, 0.1099, 0.1104, 0.1096, 0.1095, 0.1103,
         0.1098],
        [0.1103, 0.1103, 0.0000, 0.1105, 0.1105, 0.1101, 0.1098, 0.1104, 0.1106,
         0.1104],
        [0.1100, 0.1099, 0.1105, 0.0000, 0.1103, 0.1107, 0.1100, 0.1096, 0.1104,
         0.1101],
        [0.1101, 0.1099, 0.1105, 0.1103, 0.0000, 0.1098, 0.1105, 0.1102, 0.1105,
         0.1103],
        [0.1104, 0.1104, 0.1101, 0.1107, 0.1098, 0.0000, 0.1106, 0.1101, 0.1103,
         0.1101],
        [0.1097, 0.1096, 0.1098, 0.1100, 0.1105, 0.1106, 0.0000, 0.1095, 0.1104,
         0.1100],
        [0.1100, 0.1095, 0.1104, 0.1096, 0.1102, 0.1101, 0.1095, 0.0000, 0.1102,
         0.1099],
        [0.1100, 0.1103, 0.1106, 0.1104, 0.1105, 0.1103, 0.1104, 0.1102, 0.0000,
         0.1102],
        [0.1103, 0.1098, 0.1104, 0.1101, 0.1103, 0.1101, 0.1100, 0.1099, 0.1102,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0399, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.685626
Epoch659: train_loss: 4.0600 recon_acc: 0.8353 val_roc: 0.7543 val_ap: 0.8222 f1: 0.6900 time: 0.2534
difference_matrix tensor([[0.0000, 0.1099, 0.1103, 0.1099, 0.1101, 0.1104, 0.1097, 0.1100, 0.1100,
         0.1103],
        [0.1099, 0.0000, 0.1103, 0.1098, 0.1098, 0.1103, 0.1096, 0.1095, 0.1103,
         0.1098],
        [0.1103, 0.1103, 0.0000, 0.1105, 0.1105, 0.1100, 0.1098, 0.1104, 0.1106,
         0.1104],
        [0.1099, 0.1098, 0.1105, 0.0000, 0.1103, 0.1107, 0.1100, 0.1096, 0.1104,
         0.1101],
        [0.1101, 0.1098, 0.1105, 0.1103, 0.0000, 0.1098, 0.1105, 0.1101, 0.1105,
         0.1103],
        [0.1104, 0.1103, 0.1100, 0.1107, 0.1098, 0.0000, 0.1106, 0.1101, 0.1103,
         0.1101],
        [0.1097, 0.1096, 0.1098, 0.1100, 0.1105, 0.1106, 0.0000, 0.1095, 0.1104,
         0.1100],
        [0.1100, 0.1095, 0.1104, 0.1096, 0.1101, 0.1101, 0.1095, 0.0000, 0.1102,
         0.1099],
        [0.1100, 0.1103, 0.1106, 0.1104, 0.1105, 0.1103, 0.1104, 0.1102, 0.0000,
         0.1102],
        [0.1103, 0.1098, 0.1104, 0.1101, 0.1103, 0.1101, 0.1100, 0.1099, 0.1102,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0399, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6858695
Epoch660: train_loss: 4.0599 recon_acc: 0.8356 val_roc: 0.7543 val_ap: 0.8222 f1: 0.6900 time: 0.2534
difference_matrix tensor([[0.0000, 0.1099, 0.1103, 0.1099, 0.1101, 0.1103, 0.1097, 0.1100, 0.1100,
         0.1103],
        [0.1099, 0.0000, 0.1103, 0.1098, 0.1098, 0.1103, 0.1096, 0.1095, 0.1103,
         0.1098],
        [0.1103, 0.1103, 0.0000, 0.1104, 0.1105, 0.1100, 0.1098, 0.1104, 0.1106,
         0.1104],
        [0.1099, 0.1098, 0.1104, 0.0000, 0.1103, 0.1107, 0.1099, 0.1096, 0.1104,
         0.1101],
        [0.1101, 0.1098, 0.1105, 0.1103, 0.0000, 0.1098, 0.1105, 0.1101, 0.1104,
         0.1103],
        [0.1103, 0.1103, 0.1100, 0.1107, 0.1098, 0.0000, 0.1106, 0.1101, 0.1103,
         0.1101],
        [0.1097, 0.1096, 0.1098, 0.1099, 0.1105, 0.1106, 0.0000, 0.1095, 0.1103,
         0.1100],
        [0.1100, 0.1095, 0.1104, 0.1096, 0.1101, 0.1101, 0.1095, 0.0000, 0.1102,
         0.1099],
        [0.1100, 0.1103, 0.1106, 0.1104, 0.1104, 0.1103, 0.1103, 0.1102, 0.0000,
         0.1102],
        [0.1103, 0.1098, 0.1104, 0.1101, 0.1103, 0.1101, 0.1100, 0.1099, 0.1102,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0399, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68574333
Epoch661: train_loss: 4.0599 recon_acc: 0.8355 val_roc: 0.7543 val_ap: 0.8222 f1: 0.6900 time: 0.2606
difference_matrix tensor([[0.0000, 0.1099, 0.1103, 0.1099, 0.1101, 0.1103, 0.1097, 0.1100, 0.1100,
         0.1103],
        [0.1099, 0.0000, 0.1103, 0.1098, 0.1098, 0.1103, 0.1096, 0.1095, 0.1103,
         0.1098],
        [0.1103, 0.1103, 0.0000, 0.1104, 0.1105, 0.1100, 0.1098, 0.1104, 0.1106,
         0.1104],
        [0.1099, 0.1098, 0.1104, 0.0000, 0.1103, 0.1107, 0.1099, 0.1095, 0.1104,
         0.1100],
        [0.1101, 0.1098, 0.1105, 0.1103, 0.0000, 0.1098, 0.1105, 0.1101, 0.1104,
         0.1103],
        [0.1103, 0.1103, 0.1100, 0.1107, 0.1098, 0.0000, 0.1105, 0.1101, 0.1103,
         0.1101],
        [0.1097, 0.1096, 0.1098, 0.1099, 0.1105, 0.1105, 0.0000, 0.1095, 0.1103,
         0.1100],
        [0.1100, 0.1095, 0.1104, 0.1095, 0.1101, 0.1101, 0.1095, 0.0000, 0.1102,
         0.1099],
        [0.1100, 0.1103, 0.1106, 0.1104, 0.1104, 0.1103, 0.1103, 0.1102, 0.0000,
         0.1102],
        [0.1103, 0.1098, 0.1104, 0.1100, 0.1103, 0.1101, 0.1100, 0.1099, 0.1102,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0399, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6856179
Epoch662: train_loss: 4.0598 recon_acc: 0.8353 val_roc: 0.7543 val_ap: 0.8222 f1: 0.6900 time: 0.2798
difference_matrix tensor([[0.0000, 0.1099, 0.1103, 0.1099, 0.1101, 0.1103, 0.1097, 0.1100, 0.1100,
         0.1102],
        [0.1099, 0.0000, 0.1103, 0.1098, 0.1098, 0.1103, 0.1095, 0.1095, 0.1103,
         0.1098],
        [0.1103, 0.1103, 0.0000, 0.1104, 0.1105, 0.1100, 0.1098, 0.1104, 0.1106,
         0.1104],
        [0.1099, 0.1098, 0.1104, 0.0000, 0.1103, 0.1107, 0.1099, 0.1095, 0.1104,
         0.1100],
        [0.1101, 0.1098, 0.1105, 0.1103, 0.0000, 0.1098, 0.1105, 0.1101, 0.1104,
         0.1103],
        [0.1103, 0.1103, 0.1100, 0.1107, 0.1098, 0.0000, 0.1105, 0.1101, 0.1103,
         0.1101],
        [0.1097, 0.1095, 0.1098, 0.1099, 0.1105, 0.1105, 0.0000, 0.1094, 0.1103,
         0.1100],
        [0.1100, 0.1095, 0.1104, 0.1095, 0.1101, 0.1101, 0.1094, 0.0000, 0.1102,
         0.1099],
        [0.1100, 0.1103, 0.1106, 0.1104, 0.1104, 0.1103, 0.1103, 0.1102, 0.0000,
         0.1102],
        [0.1102, 0.1098, 0.1104, 0.1100, 0.1103, 0.1101, 0.1100, 0.1099, 0.1102,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0399, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68549335
Epoch663: train_loss: 4.0597 recon_acc: 0.8352 val_roc: 0.7544 val_ap: 0.8223 f1: 0.6900 time: 0.2695
difference_matrix tensor([[0.0000, 0.1099, 0.1103, 0.1099, 0.1100, 0.1103, 0.1097, 0.1099, 0.1100,
         0.1102],
        [0.1099, 0.0000, 0.1103, 0.1098, 0.1098, 0.1103, 0.1095, 0.1095, 0.1103,
         0.1098],
        [0.1103, 0.1103, 0.0000, 0.1104, 0.1105, 0.1100, 0.1098, 0.1104, 0.1105,
         0.1104],
        [0.1099, 0.1098, 0.1104, 0.0000, 0.1103, 0.1107, 0.1099, 0.1095, 0.1104,
         0.1100],
        [0.1100, 0.1098, 0.1105, 0.1103, 0.0000, 0.1098, 0.1105, 0.1101, 0.1104,
         0.1103],
        [0.1103, 0.1103, 0.1100, 0.1107, 0.1098, 0.0000, 0.1105, 0.1101, 0.1103,
         0.1101],
        [0.1097, 0.1095, 0.1098, 0.1099, 0.1105, 0.1105, 0.0000, 0.1094, 0.1103,
         0.1099],
        [0.1099, 0.1095, 0.1104, 0.1095, 0.1101, 0.1101, 0.1094, 0.0000, 0.1102,
         0.1099],
        [0.1100, 0.1103, 0.1105, 0.1104, 0.1104, 0.1103, 0.1103, 0.1102, 0.0000,
         0.1102],
        [0.1102, 0.1098, 0.1104, 0.1100, 0.1103, 0.1101, 0.1099, 0.1099, 0.1102,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0399, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68536943
Epoch664: train_loss: 4.0596 recon_acc: 0.8350 val_roc: 0.7545 val_ap: 0.8224 f1: 0.6900 time: 0.2737
difference_matrix tensor([[0.0000, 0.1098, 0.1103, 0.1099, 0.1100, 0.1103, 0.1097, 0.1099, 0.1100,
         0.1102],
        [0.1098, 0.0000, 0.1103, 0.1098, 0.1098, 0.1103, 0.1095, 0.1095, 0.1103,
         0.1098],
        [0.1103, 0.1103, 0.0000, 0.1104, 0.1105, 0.1100, 0.1097, 0.1104, 0.1105,
         0.1104],
        [0.1099, 0.1098, 0.1104, 0.0000, 0.1103, 0.1107, 0.1099, 0.1095, 0.1104,
         0.1100],
        [0.1100, 0.1098, 0.1105, 0.1103, 0.0000, 0.1098, 0.1104, 0.1101, 0.1104,
         0.1103],
        [0.1103, 0.1103, 0.1100, 0.1107, 0.1098, 0.0000, 0.1105, 0.1100, 0.1103,
         0.1101],
        [0.1097, 0.1095, 0.1097, 0.1099, 0.1104, 0.1105, 0.0000, 0.1094, 0.1103,
         0.1099],
        [0.1099, 0.1095, 0.1104, 0.1095, 0.1101, 0.1100, 0.1094, 0.0000, 0.1102,
         0.1099],
        [0.1100, 0.1103, 0.1105, 0.1104, 0.1104, 0.1103, 0.1103, 0.1102, 0.0000,
         0.1102],
        [0.1102, 0.1098, 0.1104, 0.1100, 0.1103, 0.1101, 0.1099, 0.1099, 0.1102,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0399, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6852464
Epoch665: train_loss: 4.0595 recon_acc: 0.8348 val_roc: 0.7544 val_ap: 0.8223 f1: 0.6900 time: 0.2606
difference_matrix tensor([[0.0000, 0.1098, 0.1103, 0.1099, 0.1100, 0.1103, 0.1096, 0.1099, 0.1100,
         0.1102],
        [0.1098, 0.0000, 0.1103, 0.1098, 0.1098, 0.1103, 0.1095, 0.1095, 0.1102,
         0.1098],
        [0.1103, 0.1103, 0.0000, 0.1104, 0.1105, 0.1100, 0.1097, 0.1104, 0.1105,
         0.1103],
        [0.1099, 0.1098, 0.1104, 0.0000, 0.1103, 0.1106, 0.1099, 0.1095, 0.1104,
         0.1100],
        [0.1100, 0.1098, 0.1105, 0.1103, 0.0000, 0.1098, 0.1104, 0.1101, 0.1104,
         0.1103],
        [0.1103, 0.1103, 0.1100, 0.1106, 0.1098, 0.0000, 0.1105, 0.1100, 0.1103,
         0.1101],
        [0.1096, 0.1095, 0.1097, 0.1099, 0.1104, 0.1105, 0.0000, 0.1094, 0.1103,
         0.1099],
        [0.1099, 0.1095, 0.1104, 0.1095, 0.1101, 0.1100, 0.1094, 0.0000, 0.1102,
         0.1099],
        [0.1100, 0.1102, 0.1105, 0.1104, 0.1104, 0.1103, 0.1103, 0.1102, 0.0000,
         0.1102],
        [0.1102, 0.1098, 0.1103, 0.1100, 0.1103, 0.1101, 0.1099, 0.1099, 0.1102,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0399, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68512404
Epoch666: train_loss: 4.0595 recon_acc: 0.8347 val_roc: 0.7544 val_ap: 0.8223 f1: 0.6900 time: 0.2872
difference_matrix tensor([[0.0000, 0.1098, 0.1103, 0.1099, 0.1100, 0.1103, 0.1096, 0.1099, 0.1100,
         0.1102],
        [0.1098, 0.0000, 0.1103, 0.1098, 0.1098, 0.1103, 0.1095, 0.1094, 0.1102,
         0.1097],
        [0.1103, 0.1103, 0.0000, 0.1104, 0.1105, 0.1100, 0.1097, 0.1103, 0.1105,
         0.1103],
        [0.1099, 0.1098, 0.1104, 0.0000, 0.1103, 0.1106, 0.1099, 0.1095, 0.1103,
         0.1100],
        [0.1100, 0.1098, 0.1105, 0.1103, 0.0000, 0.1097, 0.1104, 0.1101, 0.1104,
         0.1103],
        [0.1103, 0.1103, 0.1100, 0.1106, 0.1097, 0.0000, 0.1105, 0.1100, 0.1103,
         0.1100],
        [0.1096, 0.1095, 0.1097, 0.1099, 0.1104, 0.1105, 0.0000, 0.1094, 0.1103,
         0.1099],
        [0.1099, 0.1094, 0.1103, 0.1095, 0.1101, 0.1100, 0.1094, 0.0000, 0.1101,
         0.1098],
        [0.1100, 0.1102, 0.1105, 0.1103, 0.1104, 0.1103, 0.1103, 0.1101, 0.0000,
         0.1102],
        [0.1102, 0.1097, 0.1103, 0.1100, 0.1103, 0.1100, 0.1099, 0.1098, 0.1102,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0399, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68500245
Epoch667: train_loss: 4.0594 recon_acc: 0.8345 val_roc: 0.7544 val_ap: 0.8224 f1: 0.6900 time: 0.2909
difference_matrix tensor([[0.0000, 0.1098, 0.1102, 0.1099, 0.1100, 0.1103, 0.1096, 0.1099, 0.1099,
         0.1102],
        [0.1098, 0.0000, 0.1102, 0.1098, 0.1098, 0.1103, 0.1095, 0.1094, 0.1102,
         0.1097],
        [0.1102, 0.1102, 0.0000, 0.1104, 0.1104, 0.1100, 0.1097, 0.1103, 0.1105,
         0.1103],
        [0.1099, 0.1098, 0.1104, 0.0000, 0.1103, 0.1106, 0.1099, 0.1095, 0.1103,
         0.1100],
        [0.1100, 0.1098, 0.1104, 0.1103, 0.0000, 0.1097, 0.1104, 0.1101, 0.1104,
         0.1102],
        [0.1103, 0.1103, 0.1100, 0.1106, 0.1097, 0.0000, 0.1105, 0.1100, 0.1102,
         0.1100],
        [0.1096, 0.1095, 0.1097, 0.1099, 0.1104, 0.1105, 0.0000, 0.1094, 0.1103,
         0.1099],
        [0.1099, 0.1094, 0.1103, 0.1095, 0.1101, 0.1100, 0.1094, 0.0000, 0.1101,
         0.1098],
        [0.1099, 0.1102, 0.1105, 0.1103, 0.1104, 0.1102, 0.1103, 0.1101, 0.0000,
         0.1101],
        [0.1102, 0.1097, 0.1103, 0.1100, 0.1102, 0.1100, 0.1099, 0.1098, 0.1101,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0399, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6848817
Epoch668: train_loss: 4.0593 recon_acc: 0.8344 val_roc: 0.7545 val_ap: 0.8224 f1: 0.6900 time: 0.2688
difference_matrix tensor([[0.0000, 0.1098, 0.1102, 0.1098, 0.1100, 0.1103, 0.1096, 0.1099, 0.1099,
         0.1102],
        [0.1098, 0.0000, 0.1102, 0.1098, 0.1098, 0.1103, 0.1095, 0.1094, 0.1102,
         0.1097],
        [0.1102, 0.1102, 0.0000, 0.1104, 0.1104, 0.1099, 0.1097, 0.1103, 0.1105,
         0.1103],
        [0.1098, 0.1098, 0.1104, 0.0000, 0.1102, 0.1106, 0.1099, 0.1095, 0.1103,
         0.1100],
        [0.1100, 0.1098, 0.1104, 0.1102, 0.0000, 0.1097, 0.1104, 0.1101, 0.1104,
         0.1102],
        [0.1103, 0.1103, 0.1099, 0.1106, 0.1097, 0.0000, 0.1105, 0.1100, 0.1102,
         0.1100],
        [0.1096, 0.1095, 0.1097, 0.1099, 0.1104, 0.1105, 0.0000, 0.1094, 0.1103,
         0.1099],
        [0.1099, 0.1094, 0.1103, 0.1095, 0.1101, 0.1100, 0.1094, 0.0000, 0.1101,
         0.1098],
        [0.1099, 0.1102, 0.1105, 0.1103, 0.1104, 0.1102, 0.1103, 0.1101, 0.0000,
         0.1101],
        [0.1102, 0.1097, 0.1103, 0.1100, 0.1102, 0.1100, 0.1099, 0.1098, 0.1101,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0400, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6847617
Epoch669: train_loss: 4.0592 recon_acc: 0.8342 val_roc: 0.7546 val_ap: 0.8225 f1: 0.6900 time: 0.2629
difference_matrix tensor([[0.0000, 0.1098, 0.1102, 0.1098, 0.1100, 0.1103, 0.1096, 0.1099, 0.1099,
         0.1102],
        [0.1098, 0.0000, 0.1102, 0.1097, 0.1097, 0.1103, 0.1095, 0.1094, 0.1102,
         0.1097],
        [0.1102, 0.1102, 0.0000, 0.1104, 0.1104, 0.1099, 0.1097, 0.1103, 0.1105,
         0.1103],
        [0.1098, 0.1097, 0.1104, 0.0000, 0.1102, 0.1106, 0.1099, 0.1095, 0.1103,
         0.1100],
        [0.1100, 0.1097, 0.1104, 0.1102, 0.0000, 0.1097, 0.1104, 0.1100, 0.1103,
         0.1102],
        [0.1103, 0.1103, 0.1099, 0.1106, 0.1097, 0.0000, 0.1105, 0.1100, 0.1102,
         0.1100],
        [0.1096, 0.1095, 0.1097, 0.1099, 0.1104, 0.1105, 0.0000, 0.1094, 0.1103,
         0.1099],
        [0.1099, 0.1094, 0.1103, 0.1095, 0.1100, 0.1100, 0.1094, 0.0000, 0.1101,
         0.1098],
        [0.1099, 0.1102, 0.1105, 0.1103, 0.1103, 0.1102, 0.1103, 0.1101, 0.0000,
         0.1101],
        [0.1102, 0.1097, 0.1103, 0.1100, 0.1102, 0.1100, 0.1099, 0.1098, 0.1101,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0400, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6846424
Epoch670: train_loss: 4.0591 recon_acc: 0.8340 val_roc: 0.7547 val_ap: 0.8226 f1: 0.6900 time: 0.2572
difference_matrix tensor([[0.0000, 0.1098, 0.1102, 0.1098, 0.1100, 0.1102, 0.1096, 0.1099, 0.1099,
         0.1102],
        [0.1098, 0.0000, 0.1102, 0.1097, 0.1097, 0.1102, 0.1095, 0.1094, 0.1102,
         0.1097],
        [0.1102, 0.1102, 0.0000, 0.1104, 0.1104, 0.1099, 0.1097, 0.1103, 0.1105,
         0.1103],
        [0.1098, 0.1097, 0.1104, 0.0000, 0.1102, 0.1106, 0.1098, 0.1095, 0.1103,
         0.1100],
        [0.1100, 0.1097, 0.1104, 0.1102, 0.0000, 0.1097, 0.1104, 0.1100, 0.1103,
         0.1102],
        [0.1102, 0.1102, 0.1099, 0.1106, 0.1097, 0.0000, 0.1105, 0.1100, 0.1102,
         0.1100],
        [0.1096, 0.1095, 0.1097, 0.1098, 0.1104, 0.1105, 0.0000, 0.1094, 0.1102,
         0.1099],
        [0.1099, 0.1094, 0.1103, 0.1095, 0.1100, 0.1100, 0.1094, 0.0000, 0.1101,
         0.1098],
        [0.1099, 0.1102, 0.1105, 0.1103, 0.1103, 0.1102, 0.1102, 0.1101, 0.0000,
         0.1101],
        [0.1102, 0.1097, 0.1103, 0.1100, 0.1102, 0.1100, 0.1099, 0.1098, 0.1101,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0400, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68452394
Epoch671: train_loss: 4.0591 recon_acc: 0.8339 val_roc: 0.7547 val_ap: 0.8226 f1: 0.6900 time: 0.2624
difference_matrix tensor([[0.0000, 0.1098, 0.1102, 0.1098, 0.1100, 0.1102, 0.1096, 0.1099, 0.1099,
         0.1102],
        [0.1098, 0.0000, 0.1102, 0.1097, 0.1097, 0.1102, 0.1094, 0.1094, 0.1102,
         0.1097],
        [0.1102, 0.1102, 0.0000, 0.1103, 0.1104, 0.1099, 0.1097, 0.1103, 0.1105,
         0.1103],
        [0.1098, 0.1097, 0.1103, 0.0000, 0.1102, 0.1106, 0.1098, 0.1094, 0.1103,
         0.1099],
        [0.1100, 0.1097, 0.1104, 0.1102, 0.0000, 0.1097, 0.1104, 0.1100, 0.1103,
         0.1102],
        [0.1102, 0.1102, 0.1099, 0.1106, 0.1097, 0.0000, 0.1105, 0.1100, 0.1102,
         0.1100],
        [0.1096, 0.1094, 0.1097, 0.1098, 0.1104, 0.1105, 0.0000, 0.1094, 0.1102,
         0.1099],
        [0.1099, 0.1094, 0.1103, 0.1094, 0.1100, 0.1100, 0.1094, 0.0000, 0.1101,
         0.1098],
        [0.1099, 0.1102, 0.1105, 0.1103, 0.1103, 0.1102, 0.1102, 0.1101, 0.0000,
         0.1101],
        [0.1102, 0.1097, 0.1103, 0.1099, 0.1102, 0.1100, 0.1099, 0.1098, 0.1101,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0400, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7367948
Epoch672: train_loss: 4.0590 recon_acc: 0.9004 val_roc: 0.7548 val_ap: 0.8226 f1: 0.6897 time: 0.2614
difference_matrix tensor([[0.0000, 0.1098, 0.1102, 0.1098, 0.1100, 0.1102, 0.1096, 0.1099, 0.1099,
         0.1102],
        [0.1098, 0.0000, 0.1102, 0.1097, 0.1097, 0.1102, 0.1094, 0.1094, 0.1102,
         0.1097],
        [0.1102, 0.1102, 0.0000, 0.1103, 0.1104, 0.1099, 0.1097, 0.1103, 0.1104,
         0.1103],
        [0.1098, 0.1097, 0.1103, 0.0000, 0.1102, 0.1106, 0.1098, 0.1094, 0.1103,
         0.1099],
        [0.1100, 0.1097, 0.1104, 0.1102, 0.0000, 0.1097, 0.1104, 0.1100, 0.1103,
         0.1102],
        [0.1102, 0.1102, 0.1099, 0.1106, 0.1097, 0.0000, 0.1104, 0.1100, 0.1102,
         0.1100],
        [0.1096, 0.1094, 0.1097, 0.1098, 0.1104, 0.1104, 0.0000, 0.1093, 0.1102,
         0.1099],
        [0.1099, 0.1094, 0.1103, 0.1094, 0.1100, 0.1100, 0.1093, 0.0000, 0.1101,
         0.1098],
        [0.1099, 0.1102, 0.1104, 0.1103, 0.1103, 0.1102, 0.1102, 0.1101, 0.0000,
         0.1101],
        [0.1102, 0.1097, 0.1103, 0.1099, 0.1102, 0.1100, 0.1099, 0.1098, 0.1101,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0400, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.73615354
Epoch673: train_loss: 4.0589 recon_acc: 0.8997 val_roc: 0.7547 val_ap: 0.8226 f1: 0.6897 time: 0.2698
difference_matrix tensor([[0.0000, 0.1098, 0.1102, 0.1098, 0.1099, 0.1102, 0.1096, 0.1098, 0.1099,
         0.1101],
        [0.1098, 0.0000, 0.1102, 0.1097, 0.1097, 0.1102, 0.1094, 0.1094, 0.1102,
         0.1097],
        [0.1102, 0.1102, 0.0000, 0.1103, 0.1104, 0.1099, 0.1097, 0.1103, 0.1104,
         0.1103],
        [0.1098, 0.1097, 0.1103, 0.0000, 0.1102, 0.1106, 0.1098, 0.1094, 0.1103,
         0.1099],
        [0.1099, 0.1097, 0.1104, 0.1102, 0.0000, 0.1097, 0.1104, 0.1100, 0.1103,
         0.1102],
        [0.1102, 0.1102, 0.1099, 0.1106, 0.1097, 0.0000, 0.1104, 0.1099, 0.1102,
         0.1100],
        [0.1096, 0.1094, 0.1097, 0.1098, 0.1104, 0.1104, 0.0000, 0.1093, 0.1102,
         0.1098],
        [0.1098, 0.1094, 0.1103, 0.1094, 0.1100, 0.1099, 0.1093, 0.0000, 0.1101,
         0.1098],
        [0.1099, 0.1102, 0.1104, 0.1103, 0.1103, 0.1102, 0.1102, 0.1101, 0.0000,
         0.1101],
        [0.1101, 0.1097, 0.1103, 0.1099, 0.1102, 0.1100, 0.1098, 0.1098, 0.1101,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0400, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6841731
Epoch674: train_loss: 4.0588 recon_acc: 0.8335 val_roc: 0.7548 val_ap: 0.8227 f1: 0.6883 time: 0.2543
difference_matrix tensor([[0.0000, 0.1097, 0.1102, 0.1098, 0.1099, 0.1102, 0.1095, 0.1098, 0.1099,
         0.1101],
        [0.1097, 0.0000, 0.1102, 0.1097, 0.1097, 0.1102, 0.1094, 0.1094, 0.1102,
         0.1097],
        [0.1102, 0.1102, 0.0000, 0.1103, 0.1104, 0.1099, 0.1096, 0.1103, 0.1104,
         0.1103],
        [0.1098, 0.1097, 0.1103, 0.0000, 0.1102, 0.1106, 0.1098, 0.1094, 0.1103,
         0.1099],
        [0.1099, 0.1097, 0.1104, 0.1102, 0.0000, 0.1097, 0.1103, 0.1100, 0.1103,
         0.1102],
        [0.1102, 0.1102, 0.1099, 0.1106, 0.1097, 0.0000, 0.1104, 0.1099, 0.1102,
         0.1100],
        [0.1095, 0.1094, 0.1096, 0.1098, 0.1103, 0.1104, 0.0000, 0.1093, 0.1102,
         0.1098],
        [0.1098, 0.1094, 0.1103, 0.1094, 0.1100, 0.1099, 0.1093, 0.0000, 0.1101,
         0.1098],
        [0.1099, 0.1102, 0.1104, 0.1103, 0.1103, 0.1102, 0.1102, 0.1101, 0.0000,
         0.1101],
        [0.1101, 0.1097, 0.1103, 0.1099, 0.1102, 0.1100, 0.1098, 0.1098, 0.1101,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0400, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68405765
Epoch675: train_loss: 4.0587 recon_acc: 0.8333 val_roc: 0.7550 val_ap: 0.8229 f1: 0.6883 time: 0.2512
difference_matrix tensor([[0.0000, 0.1097, 0.1102, 0.1098, 0.1099, 0.1102, 0.1095, 0.1098, 0.1099,
         0.1101],
        [0.1097, 0.0000, 0.1102, 0.1097, 0.1097, 0.1102, 0.1094, 0.1094, 0.1101,
         0.1096],
        [0.1102, 0.1102, 0.0000, 0.1103, 0.1104, 0.1099, 0.1096, 0.1103, 0.1104,
         0.1102],
        [0.1098, 0.1097, 0.1103, 0.0000, 0.1102, 0.1106, 0.1098, 0.1094, 0.1103,
         0.1099],
        [0.1099, 0.1097, 0.1104, 0.1102, 0.0000, 0.1096, 0.1103, 0.1100, 0.1103,
         0.1102],
        [0.1102, 0.1102, 0.1099, 0.1106, 0.1096, 0.0000, 0.1104, 0.1099, 0.1102,
         0.1100],
        [0.1095, 0.1094, 0.1096, 0.1098, 0.1103, 0.1104, 0.0000, 0.1093, 0.1102,
         0.1098],
        [0.1098, 0.1094, 0.1103, 0.1094, 0.1100, 0.1099, 0.1093, 0.0000, 0.1101,
         0.1098],
        [0.1099, 0.1101, 0.1104, 0.1103, 0.1103, 0.1102, 0.1102, 0.1101, 0.0000,
         0.1101],
        [0.1101, 0.1096, 0.1102, 0.1099, 0.1102, 0.1100, 0.1098, 0.1098, 0.1101,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0400, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.683943
Epoch676: train_loss: 4.0587 recon_acc: 0.8331 val_roc: 0.7550 val_ap: 0.8229 f1: 0.6883 time: 0.2602
difference_matrix tensor([[0.0000, 0.1097, 0.1102, 0.1098, 0.1099, 0.1102, 0.1095, 0.1098, 0.1099,
         0.1101],
        [0.1097, 0.0000, 0.1102, 0.1097, 0.1097, 0.1102, 0.1094, 0.1093, 0.1101,
         0.1096],
        [0.1102, 0.1102, 0.0000, 0.1103, 0.1104, 0.1099, 0.1096, 0.1102, 0.1104,
         0.1102],
        [0.1098, 0.1097, 0.1103, 0.0000, 0.1102, 0.1106, 0.1098, 0.1094, 0.1102,
         0.1099],
        [0.1099, 0.1097, 0.1104, 0.1102, 0.0000, 0.1096, 0.1103, 0.1100, 0.1103,
         0.1102],
        [0.1102, 0.1102, 0.1099, 0.1106, 0.1096, 0.0000, 0.1104, 0.1099, 0.1102,
         0.1099],
        [0.1095, 0.1094, 0.1096, 0.1098, 0.1103, 0.1104, 0.0000, 0.1093, 0.1102,
         0.1098],
        [0.1098, 0.1093, 0.1102, 0.1094, 0.1100, 0.1099, 0.1093, 0.0000, 0.1101,
         0.1097],
        [0.1099, 0.1101, 0.1104, 0.1102, 0.1103, 0.1102, 0.1102, 0.1101, 0.0000,
         0.1101],
        [0.1101, 0.1096, 0.1102, 0.1099, 0.1102, 0.1099, 0.1098, 0.1097, 0.1101,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0400, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68382907
Epoch677: train_loss: 4.0586 recon_acc: 0.8330 val_roc: 0.7550 val_ap: 0.8229 f1: 0.6883 time: 0.2561
difference_matrix tensor([[0.0000, 0.1097, 0.1102, 0.1098, 0.1099, 0.1102, 0.1095, 0.1098, 0.1099,
         0.1101],
        [0.1097, 0.0000, 0.1102, 0.1097, 0.1097, 0.1102, 0.1094, 0.1093, 0.1101,
         0.1096],
        [0.1102, 0.1102, 0.0000, 0.1103, 0.1103, 0.1098, 0.1096, 0.1102, 0.1104,
         0.1102],
        [0.1098, 0.1097, 0.1103, 0.0000, 0.1102, 0.1105, 0.1098, 0.1094, 0.1102,
         0.1099],
        [0.1099, 0.1097, 0.1103, 0.1102, 0.0000, 0.1096, 0.1103, 0.1100, 0.1103,
         0.1101],
        [0.1102, 0.1102, 0.1098, 0.1105, 0.1096, 0.0000, 0.1104, 0.1099, 0.1102,
         0.1099],
        [0.1095, 0.1094, 0.1096, 0.1098, 0.1103, 0.1104, 0.0000, 0.1093, 0.1102,
         0.1098],
        [0.1098, 0.1093, 0.1102, 0.1094, 0.1100, 0.1099, 0.1093, 0.0000, 0.1101,
         0.1097],
        [0.1099, 0.1101, 0.1104, 0.1102, 0.1103, 0.1102, 0.1102, 0.1101, 0.0000,
         0.1101],
        [0.1101, 0.1096, 0.1102, 0.1099, 0.1101, 0.1099, 0.1098, 0.1097, 0.1101,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0400, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.683716
Epoch678: train_loss: 4.0585 recon_acc: 0.8329 val_roc: 0.7551 val_ap: 0.8230 f1: 0.6883 time: 0.2602
difference_matrix tensor([[0.0000, 0.1097, 0.1101, 0.1097, 0.1099, 0.1102, 0.1095, 0.1098, 0.1098,
         0.1101],
        [0.1097, 0.0000, 0.1101, 0.1097, 0.1097, 0.1102, 0.1094, 0.1093, 0.1101,
         0.1096],
        [0.1101, 0.1101, 0.0000, 0.1103, 0.1103, 0.1098, 0.1096, 0.1102, 0.1104,
         0.1102],
        [0.1097, 0.1097, 0.1103, 0.0000, 0.1101, 0.1105, 0.1098, 0.1094, 0.1102,
         0.1099],
        [0.1099, 0.1097, 0.1103, 0.1101, 0.0000, 0.1096, 0.1103, 0.1100, 0.1103,
         0.1101],
        [0.1102, 0.1102, 0.1098, 0.1105, 0.1096, 0.0000, 0.1104, 0.1099, 0.1102,
         0.1099],
        [0.1095, 0.1094, 0.1096, 0.1098, 0.1103, 0.1104, 0.0000, 0.1093, 0.1102,
         0.1098],
        [0.1098, 0.1093, 0.1102, 0.1094, 0.1100, 0.1099, 0.1093, 0.0000, 0.1100,
         0.1097],
        [0.1098, 0.1101, 0.1104, 0.1102, 0.1103, 0.1102, 0.1102, 0.1100, 0.0000,
         0.1100],
        [0.1101, 0.1096, 0.1102, 0.1099, 0.1101, 0.1099, 0.1098, 0.1097, 0.1100,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0401, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68360364
Epoch679: train_loss: 4.0584 recon_acc: 0.8327 val_roc: 0.7551 val_ap: 0.8231 f1: 0.6883 time: 0.2555
difference_matrix tensor([[0.0000, 0.1097, 0.1101, 0.1097, 0.1099, 0.1102, 0.1095, 0.1098, 0.1098,
         0.1101],
        [0.1097, 0.0000, 0.1101, 0.1097, 0.1097, 0.1102, 0.1094, 0.1093, 0.1101,
         0.1096],
        [0.1101, 0.1101, 0.0000, 0.1103, 0.1103, 0.1098, 0.1096, 0.1102, 0.1104,
         0.1102],
        [0.1097, 0.1097, 0.1103, 0.0000, 0.1101, 0.1105, 0.1098, 0.1094, 0.1102,
         0.1099],
        [0.1099, 0.1097, 0.1103, 0.1101, 0.0000, 0.1096, 0.1103, 0.1099, 0.1103,
         0.1101],
        [0.1102, 0.1102, 0.1098, 0.1105, 0.1096, 0.0000, 0.1104, 0.1099, 0.1101,
         0.1099],
        [0.1095, 0.1094, 0.1096, 0.1098, 0.1103, 0.1104, 0.0000, 0.1093, 0.1101,
         0.1098],
        [0.1098, 0.1093, 0.1102, 0.1094, 0.1099, 0.1099, 0.1093, 0.0000, 0.1100,
         0.1097],
        [0.1098, 0.1101, 0.1104, 0.1102, 0.1103, 0.1101, 0.1101, 0.1100, 0.0000,
         0.1100],
        [0.1101, 0.1096, 0.1102, 0.1099, 0.1101, 0.1099, 0.1098, 0.1097, 0.1100,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0401, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.683492
Epoch680: train_loss: 4.0584 recon_acc: 0.8326 val_roc: 0.7553 val_ap: 0.8231 f1: 0.6883 time: 0.2727
difference_matrix tensor([[0.0000, 0.1097, 0.1101, 0.1097, 0.1099, 0.1101, 0.1095, 0.1098, 0.1098,
         0.1101],
        [0.1097, 0.0000, 0.1101, 0.1097, 0.1096, 0.1102, 0.1094, 0.1093, 0.1101,
         0.1096],
        [0.1101, 0.1101, 0.0000, 0.1103, 0.1103, 0.1098, 0.1096, 0.1102, 0.1104,
         0.1102],
        [0.1097, 0.1097, 0.1103, 0.0000, 0.1101, 0.1105, 0.1097, 0.1094, 0.1102,
         0.1099],
        [0.1099, 0.1096, 0.1103, 0.1101, 0.0000, 0.1096, 0.1103, 0.1099, 0.1102,
         0.1101],
        [0.1101, 0.1102, 0.1098, 0.1105, 0.1096, 0.0000, 0.1104, 0.1099, 0.1101,
         0.1099],
        [0.1095, 0.1094, 0.1096, 0.1097, 0.1103, 0.1104, 0.0000, 0.1093, 0.1101,
         0.1098],
        [0.1098, 0.1093, 0.1102, 0.1094, 0.1099, 0.1099, 0.1093, 0.0000, 0.1100,
         0.1097],
        [0.1098, 0.1101, 0.1104, 0.1102, 0.1102, 0.1101, 0.1101, 0.1100, 0.0000,
         0.1100],
        [0.1101, 0.1096, 0.1102, 0.1099, 0.1101, 0.1099, 0.1098, 0.1097, 0.1100,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0401, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68338114
Epoch681: train_loss: 4.0583 recon_acc: 0.8324 val_roc: 0.7554 val_ap: 0.8233 f1: 0.6883 time: 0.2830
difference_matrix tensor([[0.0000, 0.1097, 0.1101, 0.1097, 0.1099, 0.1101, 0.1095, 0.1098, 0.1098,
         0.1101],
        [0.1097, 0.0000, 0.1101, 0.1096, 0.1096, 0.1101, 0.1093, 0.1093, 0.1101,
         0.1096],
        [0.1101, 0.1101, 0.0000, 0.1103, 0.1103, 0.1098, 0.1096, 0.1102, 0.1104,
         0.1102],
        [0.1097, 0.1096, 0.1103, 0.0000, 0.1101, 0.1105, 0.1097, 0.1093, 0.1102,
         0.1098],
        [0.1099, 0.1096, 0.1103, 0.1101, 0.0000, 0.1096, 0.1103, 0.1099, 0.1102,
         0.1101],
        [0.1101, 0.1101, 0.1098, 0.1105, 0.1096, 0.0000, 0.1104, 0.1099, 0.1101,
         0.1099],
        [0.1095, 0.1093, 0.1096, 0.1097, 0.1103, 0.1104, 0.0000, 0.1093, 0.1101,
         0.1098],
        [0.1098, 0.1093, 0.1102, 0.1093, 0.1099, 0.1099, 0.1093, 0.0000, 0.1100,
         0.1097],
        [0.1098, 0.1101, 0.1104, 0.1102, 0.1102, 0.1101, 0.1101, 0.1100, 0.0000,
         0.1100],
        [0.1101, 0.1096, 0.1102, 0.1098, 0.1101, 0.1099, 0.1098, 0.1097, 0.1100,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0401, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68327105
Epoch682: train_loss: 4.0582 recon_acc: 0.8323 val_roc: 0.7554 val_ap: 0.8233 f1: 0.6883 time: 0.2865
difference_matrix tensor([[0.0000, 0.1097, 0.1101, 0.1097, 0.1099, 0.1101, 0.1095, 0.1098, 0.1098,
         0.1101],
        [0.1097, 0.0000, 0.1101, 0.1096, 0.1096, 0.1101, 0.1093, 0.1093, 0.1101,
         0.1096],
        [0.1101, 0.1101, 0.0000, 0.1103, 0.1103, 0.1098, 0.1096, 0.1102, 0.1103,
         0.1102],
        [0.1097, 0.1096, 0.1103, 0.0000, 0.1101, 0.1105, 0.1097, 0.1093, 0.1102,
         0.1098],
        [0.1099, 0.1096, 0.1103, 0.1101, 0.0000, 0.1096, 0.1103, 0.1099, 0.1102,
         0.1101],
        [0.1101, 0.1101, 0.1098, 0.1105, 0.1096, 0.0000, 0.1104, 0.1099, 0.1101,
         0.1099],
        [0.1095, 0.1093, 0.1096, 0.1097, 0.1103, 0.1104, 0.0000, 0.1092, 0.1101,
         0.1098],
        [0.1098, 0.1093, 0.1102, 0.1093, 0.1099, 0.1099, 0.1092, 0.0000, 0.1100,
         0.1097],
        [0.1098, 0.1101, 0.1103, 0.1102, 0.1102, 0.1101, 0.1101, 0.1100, 0.0000,
         0.1100],
        [0.1101, 0.1096, 0.1102, 0.1098, 0.1101, 0.1099, 0.1098, 0.1097, 0.1100,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0401, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6831617
Epoch683: train_loss: 4.0581 recon_acc: 0.8321 val_roc: 0.7555 val_ap: 0.8234 f1: 0.6883 time: 0.2859
difference_matrix tensor([[0.0000, 0.1097, 0.1101, 0.1097, 0.1099, 0.1101, 0.1095, 0.1098, 0.1098,
         0.1101],
        [0.1097, 0.0000, 0.1101, 0.1096, 0.1096, 0.1101, 0.1093, 0.1093, 0.1101,
         0.1096],
        [0.1101, 0.1101, 0.0000, 0.1102, 0.1103, 0.1098, 0.1096, 0.1102, 0.1103,
         0.1102],
        [0.1097, 0.1096, 0.1102, 0.0000, 0.1101, 0.1105, 0.1097, 0.1093, 0.1102,
         0.1098],
        [0.1099, 0.1096, 0.1103, 0.1101, 0.0000, 0.1096, 0.1103, 0.1099, 0.1102,
         0.1101],
        [0.1101, 0.1101, 0.1098, 0.1105, 0.1096, 0.0000, 0.1104, 0.1098, 0.1101,
         0.1099],
        [0.1095, 0.1093, 0.1096, 0.1097, 0.1103, 0.1104, 0.0000, 0.1092, 0.1101,
         0.1097],
        [0.1098, 0.1093, 0.1102, 0.1093, 0.1099, 0.1098, 0.1092, 0.0000, 0.1100,
         0.1097],
        [0.1098, 0.1101, 0.1103, 0.1102, 0.1102, 0.1101, 0.1101, 0.1100, 0.0000,
         0.1100],
        [0.1101, 0.1096, 0.1102, 0.1098, 0.1101, 0.1099, 0.1097, 0.1097, 0.1100,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0401, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68305314
Epoch684: train_loss: 4.0581 recon_acc: 0.8320 val_roc: 0.7555 val_ap: 0.8234 f1: 0.6883 time: 0.2916
difference_matrix tensor([[0.0000, 0.1097, 0.1101, 0.1097, 0.1098, 0.1101, 0.1094, 0.1097, 0.1098,
         0.1100],
        [0.1097, 0.0000, 0.1101, 0.1096, 0.1096, 0.1101, 0.1093, 0.1093, 0.1101,
         0.1096],
        [0.1101, 0.1101, 0.0000, 0.1102, 0.1103, 0.1098, 0.1095, 0.1102, 0.1103,
         0.1102],
        [0.1097, 0.1096, 0.1102, 0.0000, 0.1101, 0.1105, 0.1097, 0.1093, 0.1102,
         0.1098],
        [0.1098, 0.1096, 0.1103, 0.1101, 0.0000, 0.1096, 0.1103, 0.1099, 0.1102,
         0.1101],
        [0.1101, 0.1101, 0.1098, 0.1105, 0.1096, 0.0000, 0.1103, 0.1098, 0.1101,
         0.1099],
        [0.1094, 0.1093, 0.1095, 0.1097, 0.1103, 0.1103, 0.0000, 0.1092, 0.1101,
         0.1097],
        [0.1097, 0.1093, 0.1102, 0.1093, 0.1099, 0.1098, 0.1092, 0.0000, 0.1100,
         0.1097],
        [0.1098, 0.1101, 0.1103, 0.1102, 0.1102, 0.1101, 0.1101, 0.1100, 0.0000,
         0.1100],
        [0.1100, 0.1096, 0.1102, 0.1098, 0.1101, 0.1099, 0.1097, 0.1097, 0.1100,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0401, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68294525
Epoch685: train_loss: 4.0580 recon_acc: 0.8319 val_roc: 0.7556 val_ap: 0.8234 f1: 0.6883 time: 0.2574
difference_matrix tensor([[0.0000, 0.1096, 0.1101, 0.1097, 0.1098, 0.1101, 0.1094, 0.1097, 0.1098,
         0.1100],
        [0.1096, 0.0000, 0.1101, 0.1096, 0.1096, 0.1101, 0.1093, 0.1093, 0.1101,
         0.1096],
        [0.1101, 0.1101, 0.0000, 0.1102, 0.1103, 0.1098, 0.1095, 0.1102, 0.1103,
         0.1102],
        [0.1097, 0.1096, 0.1102, 0.0000, 0.1101, 0.1105, 0.1097, 0.1093, 0.1102,
         0.1098],
        [0.1098, 0.1096, 0.1103, 0.1101, 0.0000, 0.1096, 0.1102, 0.1099, 0.1102,
         0.1101],
        [0.1101, 0.1101, 0.1098, 0.1105, 0.1096, 0.0000, 0.1103, 0.1098, 0.1101,
         0.1099],
        [0.1094, 0.1093, 0.1095, 0.1097, 0.1102, 0.1103, 0.0000, 0.1092, 0.1101,
         0.1097],
        [0.1097, 0.1093, 0.1102, 0.1093, 0.1099, 0.1098, 0.1092, 0.0000, 0.1100,
         0.1097],
        [0.1098, 0.1101, 0.1103, 0.1102, 0.1102, 0.1101, 0.1101, 0.1100, 0.0000,
         0.1100],
        [0.1100, 0.1096, 0.1102, 0.1098, 0.1101, 0.1099, 0.1097, 0.1097, 0.1100,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0401, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.6828381
Epoch686: train_loss: 4.0579 recon_acc: 0.8318 val_roc: 0.7556 val_ap: 0.8234 f1: 0.6883 time: 0.2956
difference_matrix tensor([[0.0000, 0.1096, 0.1101, 0.1097, 0.1098, 0.1101, 0.1094, 0.1097, 0.1098,
         0.1100],
        [0.1096, 0.0000, 0.1101, 0.1096, 0.1096, 0.1101, 0.1093, 0.1093, 0.1101,
         0.1095],
        [0.1101, 0.1101, 0.0000, 0.1102, 0.1103, 0.1097, 0.1095, 0.1102, 0.1103,
         0.1101],
        [0.1097, 0.1096, 0.1102, 0.0000, 0.1101, 0.1105, 0.1097, 0.1093, 0.1102,
         0.1098],
        [0.1098, 0.1096, 0.1103, 0.1101, 0.0000, 0.1095, 0.1102, 0.1099, 0.1102,
         0.1101],
        [0.1101, 0.1101, 0.1097, 0.1105, 0.1095, 0.0000, 0.1103, 0.1098, 0.1101,
         0.1098],
        [0.1094, 0.1093, 0.1095, 0.1097, 0.1102, 0.1103, 0.0000, 0.1092, 0.1101,
         0.1097],
        [0.1097, 0.1093, 0.1102, 0.1093, 0.1099, 0.1098, 0.1092, 0.0000, 0.1100,
         0.1096],
        [0.1098, 0.1101, 0.1103, 0.1102, 0.1102, 0.1101, 0.1101, 0.1100, 0.0000,
         0.1100],
        [0.1100, 0.1095, 0.1101, 0.1098, 0.1101, 0.1098, 0.1097, 0.1096, 0.1100,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0401, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68273187
Epoch687: train_loss: 4.0579 recon_acc: 0.8316 val_roc: 0.7556 val_ap: 0.8235 f1: 0.6883 time: 0.2527
difference_matrix tensor([[0.0000, 0.1096, 0.1101, 0.1097, 0.1098, 0.1101, 0.1094, 0.1097, 0.1098,
         0.1100],
        [0.1096, 0.0000, 0.1101, 0.1096, 0.1096, 0.1101, 0.1093, 0.1092, 0.1100,
         0.1095],
        [0.1101, 0.1101, 0.0000, 0.1102, 0.1103, 0.1097, 0.1095, 0.1102, 0.1103,
         0.1101],
        [0.1097, 0.1096, 0.1102, 0.0000, 0.1101, 0.1105, 0.1097, 0.1093, 0.1101,
         0.1098],
        [0.1098, 0.1096, 0.1103, 0.1101, 0.0000, 0.1095, 0.1102, 0.1099, 0.1102,
         0.1100],
        [0.1101, 0.1101, 0.1097, 0.1105, 0.1095, 0.0000, 0.1103, 0.1098, 0.1101,
         0.1098],
        [0.1094, 0.1093, 0.1095, 0.1097, 0.1102, 0.1103, 0.0000, 0.1092, 0.1101,
         0.1097],
        [0.1097, 0.1092, 0.1102, 0.1093, 0.1099, 0.1098, 0.1092, 0.0000, 0.1100,
         0.1096],
        [0.1098, 0.1100, 0.1103, 0.1101, 0.1102, 0.1101, 0.1101, 0.1100, 0.0000,
         0.1100],
        [0.1100, 0.1095, 0.1101, 0.1098, 0.1100, 0.1098, 0.1097, 0.1096, 0.1100,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0401, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.68262625
Epoch688: train_loss: 4.0578 recon_acc: 0.8315 val_roc: 0.7557 val_ap: 0.8235 f1: 0.6883 time: 0.2741
difference_matrix tensor([[0.0000, 0.1096, 0.1101, 0.1097, 0.1098, 0.1101, 0.1094, 0.1097, 0.1098,
         0.1100],
        [0.1096, 0.0000, 0.1101, 0.1096, 0.1096, 0.1101, 0.1093, 0.1092, 0.1100,
         0.1095],
        [0.1101, 0.1101, 0.0000, 0.1102, 0.1102, 0.1097, 0.1095, 0.1101, 0.1103,
         0.1101],
        [0.1097, 0.1096, 0.1102, 0.0000, 0.1101, 0.1105, 0.1097, 0.1093, 0.1101,
         0.1098],
        [0.1098, 0.1096, 0.1102, 0.1101, 0.0000, 0.1095, 0.1102, 0.1099, 0.1102,
         0.1100],
        [0.1101, 0.1101, 0.1097, 0.1105, 0.1095, 0.0000, 0.1103, 0.1098, 0.1101,
         0.1098],
        [0.1094, 0.1093, 0.1095, 0.1097, 0.1102, 0.1103, 0.0000, 0.1092, 0.1101,
         0.1097],
        [0.1097, 0.1092, 0.1101, 0.1093, 0.1099, 0.1098, 0.1092, 0.0000, 0.1100,
         0.1096],
        [0.1098, 0.1100, 0.1103, 0.1101, 0.1102, 0.1101, 0.1101, 0.1100, 0.0000,
         0.1100],
        [0.1100, 0.1095, 0.1101, 0.1098, 0.1100, 0.1098, 0.1097, 0.1096, 0.1100,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0401, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7477828
Epoch689: train_loss: 4.0577 recon_acc: 0.9124 val_roc: 0.7557 val_ap: 0.8236 f1: 0.6898 time: 0.2764
difference_matrix tensor([[0.0000, 0.1096, 0.1100, 0.1096, 0.1098, 0.1101, 0.1094, 0.1097, 0.1098,
         0.1100],
        [0.1096, 0.0000, 0.1101, 0.1096, 0.1096, 0.1101, 0.1093, 0.1092, 0.1100,
         0.1095],
        [0.1100, 0.1101, 0.0000, 0.1102, 0.1102, 0.1097, 0.1095, 0.1101, 0.1103,
         0.1101],
        [0.1096, 0.1096, 0.1102, 0.0000, 0.1100, 0.1104, 0.1097, 0.1093, 0.1101,
         0.1098],
        [0.1098, 0.1096, 0.1102, 0.1100, 0.0000, 0.1095, 0.1102, 0.1099, 0.1102,
         0.1100],
        [0.1101, 0.1101, 0.1097, 0.1104, 0.1095, 0.0000, 0.1103, 0.1098, 0.1101,
         0.1098],
        [0.1094, 0.1093, 0.1095, 0.1097, 0.1102, 0.1103, 0.0000, 0.1092, 0.1101,
         0.1097],
        [0.1097, 0.1092, 0.1101, 0.1093, 0.1099, 0.1098, 0.1092, 0.0000, 0.1100,
         0.1096],
        [0.1098, 0.1100, 0.1103, 0.1101, 0.1102, 0.1101, 0.1101, 0.1100, 0.0000,
         0.1100],
        [0.1100, 0.1095, 0.1101, 0.1098, 0.1100, 0.1098, 0.1097, 0.1096, 0.1100,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0402, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.74787885
Epoch690: train_loss: 4.0576 recon_acc: 0.9125 val_roc: 0.7558 val_ap: 0.8236 f1: 0.6898 time: 0.2688
difference_matrix tensor([[0.0000, 0.1096, 0.1100, 0.1096, 0.1098, 0.1101, 0.1094, 0.1097, 0.1097,
         0.1100],
        [0.1096, 0.0000, 0.1100, 0.1096, 0.1096, 0.1101, 0.1093, 0.1092, 0.1100,
         0.1095],
        [0.1100, 0.1100, 0.0000, 0.1102, 0.1102, 0.1097, 0.1095, 0.1101, 0.1103,
         0.1101],
        [0.1096, 0.1096, 0.1102, 0.0000, 0.1100, 0.1104, 0.1097, 0.1093, 0.1101,
         0.1098],
        [0.1098, 0.1096, 0.1102, 0.1100, 0.0000, 0.1095, 0.1102, 0.1098, 0.1102,
         0.1100],
        [0.1101, 0.1101, 0.1097, 0.1104, 0.1095, 0.0000, 0.1103, 0.1098, 0.1101,
         0.1098],
        [0.1094, 0.1093, 0.1095, 0.1097, 0.1102, 0.1103, 0.0000, 0.1092, 0.1100,
         0.1097],
        [0.1097, 0.1092, 0.1101, 0.1093, 0.1098, 0.1098, 0.1092, 0.0000, 0.1099,
         0.1096],
        [0.1097, 0.1100, 0.1103, 0.1101, 0.1102, 0.1101, 0.1100, 0.1099, 0.0000,
         0.1100],
        [0.1100, 0.1095, 0.1101, 0.1098, 0.1100, 0.1098, 0.1097, 0.1096, 0.1100,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0402, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7479746
Epoch691: train_loss: 4.0576 recon_acc: 0.9126 val_roc: 0.7558 val_ap: 0.8237 f1: 0.6898 time: 0.3052
difference_matrix tensor([[0.0000, 0.1096, 0.1100, 0.1096, 0.1098, 0.1100, 0.1094, 0.1097, 0.1097,
         0.1100],
        [0.1096, 0.0000, 0.1100, 0.1096, 0.1095, 0.1101, 0.1093, 0.1092, 0.1100,
         0.1095],
        [0.1100, 0.1100, 0.0000, 0.1102, 0.1102, 0.1097, 0.1095, 0.1101, 0.1103,
         0.1101],
        [0.1096, 0.1096, 0.1102, 0.0000, 0.1100, 0.1104, 0.1097, 0.1093, 0.1101,
         0.1098],
        [0.1098, 0.1095, 0.1102, 0.1100, 0.0000, 0.1095, 0.1102, 0.1098, 0.1101,
         0.1100],
        [0.1100, 0.1101, 0.1097, 0.1104, 0.1095, 0.0000, 0.1103, 0.1098, 0.1100,
         0.1098],
        [0.1094, 0.1093, 0.1095, 0.1097, 0.1102, 0.1103, 0.0000, 0.1092, 0.1100,
         0.1097],
        [0.1097, 0.1092, 0.1101, 0.1093, 0.1098, 0.1098, 0.1092, 0.0000, 0.1099,
         0.1096],
        [0.1097, 0.1100, 0.1103, 0.1101, 0.1101, 0.1100, 0.1100, 0.1099, 0.0000,
         0.1099],
        [0.1100, 0.1095, 0.1101, 0.1098, 0.1100, 0.1098, 0.1097, 0.1096, 0.1099,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0402, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7480697
Epoch692: train_loss: 4.0575 recon_acc: 0.9128 val_roc: 0.7557 val_ap: 0.8237 f1: 0.6898 time: 0.3102
difference_matrix tensor([[0.0000, 0.1096, 0.1100, 0.1096, 0.1098, 0.1100, 0.1094, 0.1097, 0.1097,
         0.1100],
        [0.1096, 0.0000, 0.1100, 0.1096, 0.1095, 0.1101, 0.1092, 0.1092, 0.1100,
         0.1095],
        [0.1100, 0.1100, 0.0000, 0.1102, 0.1102, 0.1097, 0.1095, 0.1101, 0.1102,
         0.1101],
        [0.1096, 0.1096, 0.1102, 0.0000, 0.1100, 0.1104, 0.1096, 0.1093, 0.1101,
         0.1097],
        [0.1098, 0.1095, 0.1102, 0.1100, 0.0000, 0.1095, 0.1102, 0.1098, 0.1101,
         0.1100],
        [0.1100, 0.1101, 0.1097, 0.1104, 0.1095, 0.0000, 0.1103, 0.1098, 0.1100,
         0.1098],
        [0.1094, 0.1092, 0.1095, 0.1096, 0.1102, 0.1103, 0.0000, 0.1092, 0.1100,
         0.1097],
        [0.1097, 0.1092, 0.1101, 0.1093, 0.1098, 0.1098, 0.1092, 0.0000, 0.1099,
         0.1096],
        [0.1097, 0.1100, 0.1102, 0.1101, 0.1101, 0.1100, 0.1100, 0.1099, 0.0000,
         0.1099],
        [0.1100, 0.1095, 0.1101, 0.1097, 0.1100, 0.1098, 0.1097, 0.1096, 0.1099,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0402, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7481644
Epoch693: train_loss: 4.0574 recon_acc: 0.9129 val_roc: 0.7557 val_ap: 0.8237 f1: 0.6898 time: 0.2413
difference_matrix tensor([[0.0000, 0.1096, 0.1100, 0.1096, 0.1098, 0.1100, 0.1094, 0.1097, 0.1097,
         0.1100],
        [0.1096, 0.0000, 0.1100, 0.1095, 0.1095, 0.1100, 0.1092, 0.1092, 0.1100,
         0.1095],
        [0.1100, 0.1100, 0.0000, 0.1102, 0.1102, 0.1097, 0.1095, 0.1101, 0.1102,
         0.1101],
        [0.1096, 0.1095, 0.1102, 0.0000, 0.1100, 0.1104, 0.1096, 0.1092, 0.1101,
         0.1097],
        [0.1098, 0.1095, 0.1102, 0.1100, 0.0000, 0.1095, 0.1102, 0.1098, 0.1101,
         0.1100],
        [0.1100, 0.1100, 0.1097, 0.1104, 0.1095, 0.0000, 0.1103, 0.1097, 0.1100,
         0.1098],
        [0.1094, 0.1092, 0.1095, 0.1096, 0.1102, 0.1103, 0.0000, 0.1091, 0.1100,
         0.1097],
        [0.1097, 0.1092, 0.1101, 0.1092, 0.1098, 0.1097, 0.1091, 0.0000, 0.1099,
         0.1096],
        [0.1097, 0.1100, 0.1102, 0.1101, 0.1101, 0.1100, 0.1100, 0.1099, 0.0000,
         0.1099],
        [0.1100, 0.1095, 0.1101, 0.1097, 0.1100, 0.1098, 0.1097, 0.1096, 0.1099,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0402, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.74825877
Epoch694: train_loss: 4.0574 recon_acc: 0.9130 val_roc: 0.7558 val_ap: 0.8238 f1: 0.6898 time: 0.2440
difference_matrix tensor([[0.0000, 0.1096, 0.1100, 0.1096, 0.1098, 0.1100, 0.1093, 0.1097, 0.1097,
         0.1100],
        [0.1096, 0.0000, 0.1100, 0.1095, 0.1095, 0.1100, 0.1092, 0.1092, 0.1100,
         0.1095],
        [0.1100, 0.1100, 0.0000, 0.1102, 0.1102, 0.1097, 0.1094, 0.1101, 0.1102,
         0.1101],
        [0.1096, 0.1095, 0.1102, 0.0000, 0.1100, 0.1104, 0.1096, 0.1092, 0.1101,
         0.1097],
        [0.1098, 0.1095, 0.1102, 0.1100, 0.0000, 0.1095, 0.1102, 0.1098, 0.1101,
         0.1100],
        [0.1100, 0.1100, 0.1097, 0.1104, 0.1095, 0.0000, 0.1103, 0.1097, 0.1100,
         0.1098],
        [0.1093, 0.1092, 0.1094, 0.1096, 0.1102, 0.1103, 0.0000, 0.1091, 0.1100,
         0.1096],
        [0.1097, 0.1092, 0.1101, 0.1092, 0.1098, 0.1097, 0.1091, 0.0000, 0.1099,
         0.1096],
        [0.1097, 0.1100, 0.1102, 0.1101, 0.1101, 0.1100, 0.1100, 0.1099, 0.0000,
         0.1099],
        [0.1100, 0.1095, 0.1101, 0.1097, 0.1100, 0.1098, 0.1096, 0.1096, 0.1099,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0402, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7483526
Epoch695: train_loss: 4.0573 recon_acc: 0.9131 val_roc: 0.7560 val_ap: 0.8240 f1: 0.6898 time: 0.2431
difference_matrix tensor([[0.0000, 0.1096, 0.1100, 0.1096, 0.1098, 0.1100, 0.1093, 0.1096, 0.1097,
         0.1100],
        [0.1096, 0.0000, 0.1100, 0.1095, 0.1095, 0.1100, 0.1092, 0.1092, 0.1100,
         0.1095],
        [0.1100, 0.1100, 0.0000, 0.1101, 0.1102, 0.1097, 0.1094, 0.1101, 0.1102,
         0.1101],
        [0.1096, 0.1095, 0.1101, 0.0000, 0.1100, 0.1104, 0.1096, 0.1092, 0.1101,
         0.1097],
        [0.1098, 0.1095, 0.1102, 0.1100, 0.0000, 0.1095, 0.1102, 0.1098, 0.1101,
         0.1100],
        [0.1100, 0.1100, 0.1097, 0.1104, 0.1095, 0.0000, 0.1103, 0.1097, 0.1100,
         0.1098],
        [0.1093, 0.1092, 0.1094, 0.1096, 0.1102, 0.1103, 0.0000, 0.1091, 0.1100,
         0.1096],
        [0.1096, 0.1092, 0.1101, 0.1092, 0.1098, 0.1097, 0.1091, 0.0000, 0.1099,
         0.1096],
        [0.1097, 0.1100, 0.1102, 0.1101, 0.1101, 0.1100, 0.1100, 0.1099, 0.0000,
         0.1099],
        [0.1100, 0.1095, 0.1101, 0.1097, 0.1100, 0.1098, 0.1096, 0.1096, 0.1099,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0402, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7500045
Epoch696: train_loss: 4.0572 recon_acc: 0.9148 val_roc: 0.7561 val_ap: 0.8240 f1: 0.6900 time: 0.2480
difference_matrix tensor([[0.0000, 0.1096, 0.1100, 0.1096, 0.1097, 0.1100, 0.1093, 0.1096, 0.1097,
         0.1100],
        [0.1096, 0.0000, 0.1100, 0.1095, 0.1095, 0.1100, 0.1092, 0.1092, 0.1100,
         0.1095],
        [0.1100, 0.1100, 0.0000, 0.1101, 0.1102, 0.1097, 0.1094, 0.1101, 0.1102,
         0.1101],
        [0.1096, 0.1095, 0.1101, 0.0000, 0.1100, 0.1104, 0.1096, 0.1092, 0.1101,
         0.1097],
        [0.1097, 0.1095, 0.1102, 0.1100, 0.0000, 0.1095, 0.1102, 0.1098, 0.1101,
         0.1100],
        [0.1100, 0.1100, 0.1097, 0.1104, 0.1095, 0.0000, 0.1103, 0.1097, 0.1100,
         0.1098],
        [0.1093, 0.1092, 0.1094, 0.1096, 0.1102, 0.1103, 0.0000, 0.1091, 0.1100,
         0.1096],
        [0.1096, 0.1092, 0.1101, 0.1092, 0.1098, 0.1097, 0.1091, 0.0000, 0.1099,
         0.1096],
        [0.1097, 0.1100, 0.1102, 0.1101, 0.1101, 0.1100, 0.1100, 0.1099, 0.0000,
         0.1099],
        [0.1100, 0.1095, 0.1101, 0.1097, 0.1100, 0.1098, 0.1096, 0.1096, 0.1099,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0402, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.748539
Epoch697: train_loss: 4.0572 recon_acc: 0.9133 val_roc: 0.7562 val_ap: 0.8241 f1: 0.6917 time: 0.2565
difference_matrix tensor([[0.0000, 0.1095, 0.1100, 0.1096, 0.1097, 0.1100, 0.1093, 0.1096, 0.1097,
         0.1099],
        [0.1095, 0.0000, 0.1100, 0.1095, 0.1095, 0.1100, 0.1092, 0.1092, 0.1100,
         0.1094],
        [0.1100, 0.1100, 0.0000, 0.1101, 0.1102, 0.1096, 0.1094, 0.1101, 0.1102,
         0.1101],
        [0.1096, 0.1095, 0.1101, 0.0000, 0.1100, 0.1104, 0.1096, 0.1092, 0.1101,
         0.1097],
        [0.1097, 0.1095, 0.1102, 0.1100, 0.0000, 0.1094, 0.1101, 0.1098, 0.1101,
         0.1100],
        [0.1100, 0.1100, 0.1096, 0.1104, 0.1094, 0.0000, 0.1102, 0.1097, 0.1100,
         0.1097],
        [0.1093, 0.1092, 0.1094, 0.1096, 0.1101, 0.1102, 0.0000, 0.1091, 0.1100,
         0.1096],
        [0.1096, 0.1092, 0.1101, 0.1092, 0.1098, 0.1097, 0.1091, 0.0000, 0.1099,
         0.1095],
        [0.1097, 0.1100, 0.1102, 0.1101, 0.1101, 0.1100, 0.1100, 0.1099, 0.0000,
         0.1099],
        [0.1099, 0.1094, 0.1101, 0.1097, 0.1100, 0.1097, 0.1096, 0.1095, 0.1099,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0402, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7486314
Epoch698: train_loss: 4.0571 recon_acc: 0.9134 val_roc: 0.7562 val_ap: 0.8242 f1: 0.6917 time: 0.2473
difference_matrix tensor([[0.0000, 0.1095, 0.1100, 0.1096, 0.1097, 0.1100, 0.1093, 0.1096, 0.1097,
         0.1099],
        [0.1095, 0.0000, 0.1100, 0.1095, 0.1095, 0.1100, 0.1092, 0.1091, 0.1100,
         0.1094],
        [0.1100, 0.1100, 0.0000, 0.1101, 0.1102, 0.1096, 0.1094, 0.1101, 0.1102,
         0.1100],
        [0.1096, 0.1095, 0.1101, 0.0000, 0.1100, 0.1104, 0.1096, 0.1092, 0.1101,
         0.1097],
        [0.1097, 0.1095, 0.1102, 0.1100, 0.0000, 0.1094, 0.1101, 0.1098, 0.1101,
         0.1100],
        [0.1100, 0.1100, 0.1096, 0.1104, 0.1094, 0.0000, 0.1102, 0.1097, 0.1100,
         0.1097],
        [0.1093, 0.1092, 0.1094, 0.1096, 0.1101, 0.1102, 0.0000, 0.1091, 0.1100,
         0.1096],
        [0.1096, 0.1091, 0.1101, 0.1092, 0.1098, 0.1097, 0.1091, 0.0000, 0.1099,
         0.1095],
        [0.1097, 0.1100, 0.1102, 0.1101, 0.1101, 0.1100, 0.1100, 0.1099, 0.0000,
         0.1099],
        [0.1099, 0.1094, 0.1100, 0.1097, 0.1100, 0.1097, 0.1096, 0.1095, 0.1099,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0402, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7487235
Epoch699: train_loss: 4.0570 recon_acc: 0.9135 val_roc: 0.7563 val_ap: 0.8243 f1: 0.6935 time: 0.2623
difference_matrix tensor([[0.0000, 0.1095, 0.1100, 0.1096, 0.1097, 0.1100, 0.1093, 0.1096, 0.1097,
         0.1099],
        [0.1095, 0.0000, 0.1100, 0.1095, 0.1095, 0.1100, 0.1092, 0.1091, 0.1099,
         0.1094],
        [0.1100, 0.1100, 0.0000, 0.1101, 0.1101, 0.1096, 0.1094, 0.1101, 0.1102,
         0.1100],
        [0.1096, 0.1095, 0.1101, 0.0000, 0.1100, 0.1104, 0.1096, 0.1092, 0.1100,
         0.1097],
        [0.1097, 0.1095, 0.1101, 0.1100, 0.0000, 0.1094, 0.1101, 0.1098, 0.1101,
         0.1099],
        [0.1100, 0.1100, 0.1096, 0.1104, 0.1094, 0.0000, 0.1102, 0.1097, 0.1100,
         0.1097],
        [0.1093, 0.1092, 0.1094, 0.1096, 0.1101, 0.1102, 0.0000, 0.1091, 0.1100,
         0.1096],
        [0.1096, 0.1091, 0.1101, 0.1092, 0.1098, 0.1097, 0.1091, 0.0000, 0.1099,
         0.1095],
        [0.1097, 0.1099, 0.1102, 0.1100, 0.1101, 0.1100, 0.1100, 0.1099, 0.0000,
         0.1099],
        [0.1099, 0.1094, 0.1100, 0.1097, 0.1099, 0.1097, 0.1096, 0.1095, 0.1099,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0402, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.748815
Epoch700: train_loss: 4.0570 recon_acc: 0.9136 val_roc: 0.7564 val_ap: 0.8243 f1: 0.6935 time: 0.2557
difference_matrix tensor([[0.0000, 0.1095, 0.1100, 0.1096, 0.1097, 0.1100, 0.1093, 0.1096, 0.1097,
         0.1099],
        [0.1095, 0.0000, 0.1100, 0.1095, 0.1095, 0.1100, 0.1092, 0.1091, 0.1099,
         0.1094],
        [0.1100, 0.1100, 0.0000, 0.1101, 0.1101, 0.1096, 0.1094, 0.1100, 0.1102,
         0.1100],
        [0.1096, 0.1095, 0.1101, 0.0000, 0.1100, 0.1104, 0.1096, 0.1092, 0.1100,
         0.1097],
        [0.1097, 0.1095, 0.1101, 0.1100, 0.0000, 0.1094, 0.1101, 0.1098, 0.1101,
         0.1099],
        [0.1100, 0.1100, 0.1096, 0.1104, 0.1094, 0.0000, 0.1102, 0.1097, 0.1100,
         0.1097],
        [0.1093, 0.1092, 0.1094, 0.1096, 0.1101, 0.1102, 0.0000, 0.1091, 0.1100,
         0.1096],
        [0.1096, 0.1091, 0.1100, 0.1092, 0.1098, 0.1097, 0.1091, 0.0000, 0.1099,
         0.1095],
        [0.1097, 0.1099, 0.1102, 0.1100, 0.1101, 0.1100, 0.1100, 0.1099, 0.0000,
         0.1099],
        [0.1099, 0.1094, 0.1100, 0.1097, 0.1099, 0.1097, 0.1096, 0.1095, 0.1099,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0402, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7489061
Epoch701: train_loss: 4.0569 recon_acc: 0.9137 val_roc: 0.7565 val_ap: 0.8244 f1: 0.6935 time: 0.2535
difference_matrix tensor([[0.0000, 0.1095, 0.1099, 0.1095, 0.1097, 0.1100, 0.1093, 0.1096, 0.1097,
         0.1099],
        [0.1095, 0.0000, 0.1100, 0.1095, 0.1095, 0.1100, 0.1092, 0.1091, 0.1099,
         0.1094],
        [0.1099, 0.1100, 0.0000, 0.1101, 0.1101, 0.1096, 0.1094, 0.1100, 0.1102,
         0.1100],
        [0.1095, 0.1095, 0.1101, 0.0000, 0.1099, 0.1104, 0.1096, 0.1092, 0.1100,
         0.1097],
        [0.1097, 0.1095, 0.1101, 0.1099, 0.0000, 0.1094, 0.1101, 0.1098, 0.1101,
         0.1099],
        [0.1100, 0.1100, 0.1096, 0.1104, 0.1094, 0.0000, 0.1102, 0.1097, 0.1100,
         0.1097],
        [0.1093, 0.1092, 0.1094, 0.1096, 0.1101, 0.1102, 0.0000, 0.1091, 0.1099,
         0.1096],
        [0.1096, 0.1091, 0.1100, 0.1092, 0.1098, 0.1097, 0.1091, 0.0000, 0.1099,
         0.1095],
        [0.1097, 0.1099, 0.1102, 0.1100, 0.1101, 0.1100, 0.1099, 0.1099, 0.0000,
         0.1099],
        [0.1099, 0.1094, 0.1100, 0.1097, 0.1099, 0.1097, 0.1096, 0.1095, 0.1099,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0403, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7489968
Epoch702: train_loss: 4.0568 recon_acc: 0.9138 val_roc: 0.7565 val_ap: 0.8244 f1: 0.6935 time: 0.2564
difference_matrix tensor([[0.0000, 0.1095, 0.1099, 0.1095, 0.1097, 0.1100, 0.1093, 0.1096, 0.1097,
         0.1099],
        [0.1095, 0.0000, 0.1100, 0.1095, 0.1095, 0.1100, 0.1092, 0.1091, 0.1099,
         0.1094],
        [0.1099, 0.1100, 0.0000, 0.1101, 0.1101, 0.1096, 0.1094, 0.1100, 0.1101,
         0.1100],
        [0.1095, 0.1095, 0.1101, 0.0000, 0.1099, 0.1103, 0.1096, 0.1092, 0.1100,
         0.1097],
        [0.1097, 0.1095, 0.1101, 0.1099, 0.0000, 0.1094, 0.1101, 0.1097, 0.1101,
         0.1099],
        [0.1100, 0.1100, 0.1096, 0.1103, 0.1094, 0.0000, 0.1102, 0.1097, 0.1100,
         0.1097],
        [0.1093, 0.1092, 0.1094, 0.1096, 0.1101, 0.1102, 0.0000, 0.1091, 0.1099,
         0.1096],
        [0.1096, 0.1091, 0.1100, 0.1092, 0.1097, 0.1097, 0.1091, 0.0000, 0.1099,
         0.1095],
        [0.1097, 0.1099, 0.1101, 0.1100, 0.1101, 0.1100, 0.1099, 0.1099, 0.0000,
         0.1099],
        [0.1099, 0.1094, 0.1100, 0.1097, 0.1099, 0.1097, 0.1096, 0.1095, 0.1099,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0403, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7490869
Epoch703: train_loss: 4.0568 recon_acc: 0.9139 val_roc: 0.7566 val_ap: 0.8244 f1: 0.6935 time: 0.2603
difference_matrix tensor([[0.0000, 0.1095, 0.1099, 0.1095, 0.1097, 0.1099, 0.1093, 0.1096, 0.1096,
         0.1099],
        [0.1095, 0.0000, 0.1099, 0.1095, 0.1094, 0.1100, 0.1091, 0.1091, 0.1099,
         0.1094],
        [0.1099, 0.1099, 0.0000, 0.1101, 0.1101, 0.1096, 0.1094, 0.1100, 0.1101,
         0.1100],
        [0.1095, 0.1095, 0.1101, 0.0000, 0.1099, 0.1103, 0.1096, 0.1092, 0.1100,
         0.1097],
        [0.1097, 0.1094, 0.1101, 0.1099, 0.0000, 0.1094, 0.1101, 0.1097, 0.1100,
         0.1099],
        [0.1099, 0.1100, 0.1096, 0.1103, 0.1094, 0.0000, 0.1102, 0.1097, 0.1100,
         0.1097],
        [0.1093, 0.1091, 0.1094, 0.1096, 0.1101, 0.1102, 0.0000, 0.1091, 0.1099,
         0.1096],
        [0.1096, 0.1091, 0.1100, 0.1092, 0.1097, 0.1097, 0.1091, 0.0000, 0.1098,
         0.1095],
        [0.1096, 0.1099, 0.1101, 0.1100, 0.1100, 0.1100, 0.1099, 0.1098, 0.0000,
         0.1099],
        [0.1099, 0.1094, 0.1100, 0.1097, 0.1099, 0.1097, 0.1096, 0.1095, 0.1099,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0403, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7491767
Epoch704: train_loss: 4.0567 recon_acc: 0.9140 val_roc: 0.7567 val_ap: 0.8245 f1: 0.6935 time: 0.2512
difference_matrix tensor([[0.0000, 0.1095, 0.1099, 0.1095, 0.1097, 0.1099, 0.1093, 0.1096, 0.1096,
         0.1099],
        [0.1095, 0.0000, 0.1099, 0.1095, 0.1094, 0.1100, 0.1091, 0.1091, 0.1099,
         0.1094],
        [0.1099, 0.1099, 0.0000, 0.1101, 0.1101, 0.1096, 0.1094, 0.1100, 0.1101,
         0.1100],
        [0.1095, 0.1095, 0.1101, 0.0000, 0.1099, 0.1103, 0.1095, 0.1092, 0.1100,
         0.1096],
        [0.1097, 0.1094, 0.1101, 0.1099, 0.0000, 0.1094, 0.1101, 0.1097, 0.1100,
         0.1099],
        [0.1099, 0.1100, 0.1096, 0.1103, 0.1094, 0.0000, 0.1102, 0.1097, 0.1099,
         0.1097],
        [0.1093, 0.1091, 0.1094, 0.1095, 0.1101, 0.1102, 0.0000, 0.1091, 0.1099,
         0.1096],
        [0.1096, 0.1091, 0.1100, 0.1092, 0.1097, 0.1097, 0.1091, 0.0000, 0.1098,
         0.1095],
        [0.1096, 0.1099, 0.1101, 0.1100, 0.1100, 0.1099, 0.1099, 0.1098, 0.0000,
         0.1099],
        [0.1099, 0.1094, 0.1100, 0.1096, 0.1099, 0.1097, 0.1096, 0.1095, 0.1099,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0403, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.74926597
Epoch705: train_loss: 4.0566 recon_acc: 0.9141 val_roc: 0.7568 val_ap: 0.8246 f1: 0.6935 time: 0.2494
difference_matrix tensor([[0.0000, 0.1095, 0.1099, 0.1095, 0.1097, 0.1099, 0.1092, 0.1096, 0.1096,
         0.1099],
        [0.1095, 0.0000, 0.1099, 0.1095, 0.1094, 0.1100, 0.1091, 0.1091, 0.1099,
         0.1094],
        [0.1099, 0.1099, 0.0000, 0.1101, 0.1101, 0.1096, 0.1093, 0.1100, 0.1101,
         0.1100],
        [0.1095, 0.1095, 0.1101, 0.0000, 0.1099, 0.1103, 0.1095, 0.1091, 0.1100,
         0.1096],
        [0.1097, 0.1094, 0.1101, 0.1099, 0.0000, 0.1094, 0.1101, 0.1097, 0.1100,
         0.1099],
        [0.1099, 0.1100, 0.1096, 0.1103, 0.1094, 0.0000, 0.1102, 0.1096, 0.1099,
         0.1097],
        [0.1092, 0.1091, 0.1093, 0.1095, 0.1101, 0.1102, 0.0000, 0.1090, 0.1099,
         0.1096],
        [0.1096, 0.1091, 0.1100, 0.1091, 0.1097, 0.1096, 0.1090, 0.0000, 0.1098,
         0.1095],
        [0.1096, 0.1099, 0.1101, 0.1100, 0.1100, 0.1099, 0.1099, 0.1098, 0.0000,
         0.1098],
        [0.1099, 0.1094, 0.1100, 0.1096, 0.1099, 0.1097, 0.1096, 0.1095, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0403, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7493548
Epoch706: train_loss: 4.0566 recon_acc: 0.9142 val_roc: 0.7568 val_ap: 0.8247 f1: 0.6935 time: 0.2651
difference_matrix tensor([[0.0000, 0.1095, 0.1099, 0.1095, 0.1097, 0.1099, 0.1092, 0.1096, 0.1096,
         0.1099],
        [0.1095, 0.0000, 0.1099, 0.1095, 0.1094, 0.1100, 0.1091, 0.1091, 0.1099,
         0.1094],
        [0.1099, 0.1099, 0.0000, 0.1101, 0.1101, 0.1096, 0.1093, 0.1100, 0.1101,
         0.1100],
        [0.1095, 0.1095, 0.1101, 0.0000, 0.1099, 0.1103, 0.1095, 0.1091, 0.1100,
         0.1096],
        [0.1097, 0.1094, 0.1101, 0.1099, 0.0000, 0.1094, 0.1101, 0.1097, 0.1100,
         0.1099],
        [0.1099, 0.1100, 0.1096, 0.1103, 0.1094, 0.0000, 0.1102, 0.1096, 0.1099,
         0.1097],
        [0.1092, 0.1091, 0.1093, 0.1095, 0.1101, 0.1102, 0.0000, 0.1090, 0.1099,
         0.1095],
        [0.1096, 0.1091, 0.1100, 0.1091, 0.1097, 0.1096, 0.1090, 0.0000, 0.1098,
         0.1095],
        [0.1096, 0.1099, 0.1101, 0.1100, 0.1100, 0.1099, 0.1099, 0.1098, 0.0000,
         0.1098],
        [0.1099, 0.1094, 0.1100, 0.1096, 0.1099, 0.1097, 0.1095, 0.1095, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0403, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.74944323
Epoch707: train_loss: 4.0565 recon_acc: 0.9144 val_roc: 0.7569 val_ap: 0.8248 f1: 0.6935 time: 0.2877
difference_matrix tensor([[0.0000, 0.1095, 0.1099, 0.1095, 0.1097, 0.1099, 0.1092, 0.1096, 0.1096,
         0.1099],
        [0.1095, 0.0000, 0.1099, 0.1094, 0.1094, 0.1099, 0.1091, 0.1091, 0.1099,
         0.1094],
        [0.1099, 0.1099, 0.0000, 0.1101, 0.1101, 0.1095, 0.1093, 0.1100, 0.1101,
         0.1100],
        [0.1095, 0.1094, 0.1101, 0.0000, 0.1099, 0.1103, 0.1095, 0.1091, 0.1100,
         0.1096],
        [0.1097, 0.1094, 0.1101, 0.1099, 0.0000, 0.1094, 0.1101, 0.1097, 0.1100,
         0.1099],
        [0.1099, 0.1099, 0.1095, 0.1103, 0.1094, 0.0000, 0.1102, 0.1096, 0.1099,
         0.1097],
        [0.1092, 0.1091, 0.1093, 0.1095, 0.1101, 0.1102, 0.0000, 0.1090, 0.1099,
         0.1095],
        [0.1096, 0.1091, 0.1100, 0.1091, 0.1097, 0.1096, 0.1090, 0.0000, 0.1098,
         0.1095],
        [0.1096, 0.1099, 0.1101, 0.1100, 0.1100, 0.1099, 0.1099, 0.1098, 0.0000,
         0.1098],
        [0.1099, 0.1094, 0.1100, 0.1096, 0.1099, 0.1097, 0.1095, 0.1095, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0403, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7495311
Epoch708: train_loss: 4.0564 recon_acc: 0.9145 val_roc: 0.7570 val_ap: 0.8248 f1: 0.6935 time: 0.2723
difference_matrix tensor([[0.0000, 0.1095, 0.1099, 0.1095, 0.1097, 0.1099, 0.1092, 0.1095, 0.1096,
         0.1099],
        [0.1095, 0.0000, 0.1099, 0.1094, 0.1094, 0.1099, 0.1091, 0.1091, 0.1099,
         0.1094],
        [0.1099, 0.1099, 0.0000, 0.1101, 0.1101, 0.1095, 0.1093, 0.1100, 0.1101,
         0.1100],
        [0.1095, 0.1094, 0.1101, 0.0000, 0.1099, 0.1103, 0.1095, 0.1091, 0.1100,
         0.1096],
        [0.1097, 0.1094, 0.1101, 0.1099, 0.0000, 0.1093, 0.1101, 0.1097, 0.1100,
         0.1099],
        [0.1099, 0.1099, 0.1095, 0.1103, 0.1093, 0.0000, 0.1102, 0.1096, 0.1099,
         0.1097],
        [0.1092, 0.1091, 0.1093, 0.1095, 0.1101, 0.1102, 0.0000, 0.1090, 0.1099,
         0.1095],
        [0.1095, 0.1091, 0.1100, 0.1091, 0.1097, 0.1096, 0.1090, 0.0000, 0.1098,
         0.1095],
        [0.1096, 0.1099, 0.1101, 0.1100, 0.1100, 0.1099, 0.1099, 0.1098, 0.0000,
         0.1098],
        [0.1099, 0.1094, 0.1100, 0.1096, 0.1099, 0.1097, 0.1095, 0.1095, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0403, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7496186
Epoch709: train_loss: 4.0564 recon_acc: 0.9145 val_roc: 0.7570 val_ap: 0.8248 f1: 0.6935 time: 0.2577
difference_matrix tensor([[0.0000, 0.1095, 0.1099, 0.1095, 0.1096, 0.1099, 0.1092, 0.1095, 0.1096,
         0.1099],
        [0.1095, 0.0000, 0.1099, 0.1094, 0.1094, 0.1099, 0.1091, 0.1091, 0.1099,
         0.1093],
        [0.1099, 0.1099, 0.0000, 0.1101, 0.1101, 0.1095, 0.1093, 0.1100, 0.1101,
         0.1100],
        [0.1095, 0.1094, 0.1101, 0.0000, 0.1099, 0.1103, 0.1095, 0.1091, 0.1100,
         0.1096],
        [0.1096, 0.1094, 0.1101, 0.1099, 0.0000, 0.1093, 0.1101, 0.1097, 0.1100,
         0.1099],
        [0.1099, 0.1099, 0.1095, 0.1103, 0.1093, 0.0000, 0.1102, 0.1096, 0.1099,
         0.1097],
        [0.1092, 0.1091, 0.1093, 0.1095, 0.1101, 0.1102, 0.0000, 0.1090, 0.1099,
         0.1095],
        [0.1095, 0.1091, 0.1100, 0.1091, 0.1097, 0.1096, 0.1090, 0.0000, 0.1098,
         0.1094],
        [0.1096, 0.1099, 0.1101, 0.1100, 0.1100, 0.1099, 0.1099, 0.1098, 0.0000,
         0.1098],
        [0.1099, 0.1093, 0.1100, 0.1096, 0.1099, 0.1097, 0.1095, 0.1094, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0403, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7497055
Epoch710: train_loss: 4.0563 recon_acc: 0.9146 val_roc: 0.7570 val_ap: 0.8248 f1: 0.6935 time: 0.2460
difference_matrix tensor([[0.0000, 0.1094, 0.1099, 0.1095, 0.1096, 0.1099, 0.1092, 0.1095, 0.1096,
         0.1098],
        [0.1094, 0.0000, 0.1099, 0.1094, 0.1094, 0.1099, 0.1091, 0.1090, 0.1099,
         0.1093],
        [0.1099, 0.1099, 0.0000, 0.1100, 0.1101, 0.1095, 0.1093, 0.1100, 0.1101,
         0.1100],
        [0.1095, 0.1094, 0.1100, 0.0000, 0.1099, 0.1103, 0.1095, 0.1091, 0.1100,
         0.1096],
        [0.1096, 0.1094, 0.1101, 0.1099, 0.0000, 0.1093, 0.1100, 0.1097, 0.1100,
         0.1099],
        [0.1099, 0.1099, 0.1095, 0.1103, 0.1093, 0.0000, 0.1102, 0.1096, 0.1099,
         0.1096],
        [0.1092, 0.1091, 0.1093, 0.1095, 0.1100, 0.1102, 0.0000, 0.1090, 0.1099,
         0.1095],
        [0.1095, 0.1090, 0.1100, 0.1091, 0.1097, 0.1096, 0.1090, 0.0000, 0.1098,
         0.1094],
        [0.1096, 0.1099, 0.1101, 0.1100, 0.1100, 0.1099, 0.1099, 0.1098, 0.0000,
         0.1098],
        [0.1098, 0.1093, 0.1100, 0.1096, 0.1099, 0.1096, 0.1095, 0.1094, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0403, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.74979204
Epoch711: train_loss: 4.0562 recon_acc: 0.9147 val_roc: 0.7572 val_ap: 0.8249 f1: 0.6935 time: 0.2357
difference_matrix tensor([[0.0000, 0.1094, 0.1099, 0.1095, 0.1096, 0.1099, 0.1092, 0.1095, 0.1096,
         0.1098],
        [0.1094, 0.0000, 0.1099, 0.1094, 0.1094, 0.1099, 0.1091, 0.1090, 0.1099,
         0.1093],
        [0.1099, 0.1099, 0.0000, 0.1100, 0.1100, 0.1095, 0.1093, 0.1100, 0.1101,
         0.1099],
        [0.1095, 0.1094, 0.1100, 0.0000, 0.1099, 0.1103, 0.1095, 0.1091, 0.1099,
         0.1096],
        [0.1096, 0.1094, 0.1100, 0.1099, 0.0000, 0.1093, 0.1100, 0.1097, 0.1100,
         0.1098],
        [0.1099, 0.1099, 0.1095, 0.1103, 0.1093, 0.0000, 0.1101, 0.1096, 0.1099,
         0.1096],
        [0.1092, 0.1091, 0.1093, 0.1095, 0.1100, 0.1101, 0.0000, 0.1090, 0.1099,
         0.1095],
        [0.1095, 0.1090, 0.1100, 0.1091, 0.1097, 0.1096, 0.1090, 0.0000, 0.1098,
         0.1094],
        [0.1096, 0.1099, 0.1101, 0.1099, 0.1100, 0.1099, 0.1099, 0.1098, 0.0000,
         0.1098],
        [0.1098, 0.1093, 0.1099, 0.1096, 0.1098, 0.1096, 0.1095, 0.1094, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0403, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.74987805
Epoch712: train_loss: 4.0562 recon_acc: 0.9148 val_roc: 0.7572 val_ap: 0.8249 f1: 0.6935 time: 0.2483
difference_matrix tensor([[0.0000, 0.1094, 0.1099, 0.1095, 0.1096, 0.1099, 0.1092, 0.1095, 0.1096,
         0.1098],
        [0.1094, 0.0000, 0.1099, 0.1094, 0.1094, 0.1099, 0.1091, 0.1090, 0.1098,
         0.1093],
        [0.1099, 0.1099, 0.0000, 0.1100, 0.1100, 0.1095, 0.1093, 0.1100, 0.1101,
         0.1099],
        [0.1095, 0.1094, 0.1100, 0.0000, 0.1099, 0.1103, 0.1095, 0.1091, 0.1099,
         0.1096],
        [0.1096, 0.1094, 0.1100, 0.1099, 0.0000, 0.1093, 0.1100, 0.1097, 0.1100,
         0.1098],
        [0.1099, 0.1099, 0.1095, 0.1103, 0.1093, 0.0000, 0.1101, 0.1096, 0.1099,
         0.1096],
        [0.1092, 0.1091, 0.1093, 0.1095, 0.1100, 0.1101, 0.0000, 0.1090, 0.1099,
         0.1095],
        [0.1095, 0.1090, 0.1100, 0.1091, 0.1097, 0.1096, 0.1090, 0.0000, 0.1098,
         0.1094],
        [0.1096, 0.1098, 0.1101, 0.1099, 0.1100, 0.1099, 0.1099, 0.1098, 0.0000,
         0.1098],
        [0.1098, 0.1093, 0.1099, 0.1096, 0.1098, 0.1096, 0.1095, 0.1094, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0403, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7499636
Epoch713: train_loss: 4.0561 recon_acc: 0.9149 val_roc: 0.7573 val_ap: 0.8250 f1: 0.6935 time: 0.2491
difference_matrix tensor([[0.0000, 0.1094, 0.1099, 0.1095, 0.1096, 0.1099, 0.1092, 0.1095, 0.1096,
         0.1098],
        [0.1094, 0.0000, 0.1099, 0.1094, 0.1094, 0.1099, 0.1091, 0.1090, 0.1098,
         0.1093],
        [0.1099, 0.1099, 0.0000, 0.1100, 0.1100, 0.1095, 0.1093, 0.1099, 0.1101,
         0.1099],
        [0.1095, 0.1094, 0.1100, 0.0000, 0.1099, 0.1103, 0.1095, 0.1091, 0.1099,
         0.1096],
        [0.1096, 0.1094, 0.1100, 0.1099, 0.0000, 0.1093, 0.1100, 0.1097, 0.1100,
         0.1098],
        [0.1099, 0.1099, 0.1095, 0.1103, 0.1093, 0.0000, 0.1101, 0.1096, 0.1099,
         0.1096],
        [0.1092, 0.1091, 0.1093, 0.1095, 0.1100, 0.1101, 0.0000, 0.1090, 0.1098,
         0.1095],
        [0.1095, 0.1090, 0.1099, 0.1091, 0.1097, 0.1096, 0.1090, 0.0000, 0.1098,
         0.1094],
        [0.1096, 0.1098, 0.1101, 0.1099, 0.1100, 0.1099, 0.1098, 0.1098, 0.0000,
         0.1098],
        [0.1098, 0.1093, 0.1099, 0.1096, 0.1098, 0.1096, 0.1095, 0.1094, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0403, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.75004876
Epoch714: train_loss: 4.0561 recon_acc: 0.9150 val_roc: 0.7574 val_ap: 0.8251 f1: 0.6935 time: 0.2682
difference_matrix tensor([[0.0000, 0.1094, 0.1098, 0.1094, 0.1096, 0.1099, 0.1092, 0.1095, 0.1096,
         0.1098],
        [0.1094, 0.0000, 0.1099, 0.1094, 0.1094, 0.1099, 0.1091, 0.1090, 0.1098,
         0.1093],
        [0.1098, 0.1099, 0.0000, 0.1100, 0.1100, 0.1095, 0.1093, 0.1099, 0.1100,
         0.1099],
        [0.1094, 0.1094, 0.1100, 0.0000, 0.1098, 0.1103, 0.1095, 0.1091, 0.1099,
         0.1096],
        [0.1096, 0.1094, 0.1100, 0.1098, 0.0000, 0.1093, 0.1100, 0.1097, 0.1100,
         0.1098],
        [0.1099, 0.1099, 0.1095, 0.1103, 0.1093, 0.0000, 0.1101, 0.1096, 0.1099,
         0.1096],
        [0.1092, 0.1091, 0.1093, 0.1095, 0.1100, 0.1101, 0.0000, 0.1090, 0.1098,
         0.1095],
        [0.1095, 0.1090, 0.1099, 0.1091, 0.1097, 0.1096, 0.1090, 0.0000, 0.1098,
         0.1094],
        [0.1096, 0.1098, 0.1100, 0.1099, 0.1100, 0.1099, 0.1098, 0.1098, 0.0000,
         0.1098],
        [0.1098, 0.1093, 0.1099, 0.1096, 0.1098, 0.1096, 0.1095, 0.1094, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0404, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7501334
Epoch715: train_loss: 4.0560 recon_acc: 0.9151 val_roc: 0.7573 val_ap: 0.8251 f1: 0.6935 time: 0.2725
difference_matrix tensor([[0.0000, 0.1094, 0.1098, 0.1094, 0.1096, 0.1098, 0.1092, 0.1095, 0.1096,
         0.1098],
        [0.1094, 0.0000, 0.1099, 0.1094, 0.1094, 0.1099, 0.1090, 0.1090, 0.1098,
         0.1093],
        [0.1098, 0.1099, 0.0000, 0.1100, 0.1100, 0.1095, 0.1093, 0.1099, 0.1100,
         0.1099],
        [0.1094, 0.1094, 0.1100, 0.0000, 0.1098, 0.1103, 0.1095, 0.1091, 0.1099,
         0.1096],
        [0.1096, 0.1094, 0.1100, 0.1098, 0.0000, 0.1093, 0.1100, 0.1096, 0.1100,
         0.1098],
        [0.1098, 0.1099, 0.1095, 0.1103, 0.1093, 0.0000, 0.1101, 0.1096, 0.1099,
         0.1096],
        [0.1092, 0.1090, 0.1093, 0.1095, 0.1100, 0.1101, 0.0000, 0.1090, 0.1098,
         0.1095],
        [0.1095, 0.1090, 0.1099, 0.1091, 0.1096, 0.1096, 0.1090, 0.0000, 0.1098,
         0.1094],
        [0.1096, 0.1098, 0.1100, 0.1099, 0.1100, 0.1099, 0.1098, 0.1098, 0.0000,
         0.1098],
        [0.1098, 0.1093, 0.1099, 0.1096, 0.1098, 0.1096, 0.1095, 0.1094, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0404, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7502175
Epoch716: train_loss: 4.0559 recon_acc: 0.9152 val_roc: 0.7573 val_ap: 0.8250 f1: 0.6935 time: 0.2614
difference_matrix tensor([[0.0000, 0.1094, 0.1098, 0.1094, 0.1096, 0.1098, 0.1092, 0.1095, 0.1096,
         0.1098],
        [0.1094, 0.0000, 0.1099, 0.1094, 0.1094, 0.1099, 0.1090, 0.1090, 0.1098,
         0.1093],
        [0.1098, 0.1099, 0.0000, 0.1100, 0.1100, 0.1095, 0.1093, 0.1099, 0.1100,
         0.1099],
        [0.1094, 0.1094, 0.1100, 0.0000, 0.1098, 0.1103, 0.1095, 0.1091, 0.1099,
         0.1096],
        [0.1096, 0.1094, 0.1100, 0.1098, 0.0000, 0.1093, 0.1100, 0.1096, 0.1100,
         0.1098],
        [0.1098, 0.1099, 0.1095, 0.1103, 0.1093, 0.0000, 0.1101, 0.1095, 0.1099,
         0.1096],
        [0.1092, 0.1090, 0.1093, 0.1095, 0.1100, 0.1101, 0.0000, 0.1090, 0.1098,
         0.1095],
        [0.1095, 0.1090, 0.1099, 0.1091, 0.1096, 0.1095, 0.1090, 0.0000, 0.1098,
         0.1094],
        [0.1096, 0.1098, 0.1100, 0.1099, 0.1100, 0.1099, 0.1098, 0.1098, 0.0000,
         0.1098],
        [0.1098, 0.1093, 0.1099, 0.1096, 0.1098, 0.1096, 0.1095, 0.1094, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0404, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.75030124
Epoch717: train_loss: 4.0559 recon_acc: 0.9153 val_roc: 0.7573 val_ap: 0.8251 f1: 0.6935 time: 0.2913
difference_matrix tensor([[0.0000, 0.1094, 0.1098, 0.1094, 0.1096, 0.1098, 0.1091, 0.1095, 0.1095,
         0.1098],
        [0.1094, 0.0000, 0.1099, 0.1094, 0.1093, 0.1099, 0.1090, 0.1090, 0.1098,
         0.1093],
        [0.1098, 0.1099, 0.0000, 0.1100, 0.1100, 0.1095, 0.1092, 0.1099, 0.1100,
         0.1099],
        [0.1094, 0.1094, 0.1100, 0.0000, 0.1098, 0.1102, 0.1094, 0.1091, 0.1099,
         0.1095],
        [0.1096, 0.1093, 0.1100, 0.1098, 0.0000, 0.1093, 0.1100, 0.1096, 0.1099,
         0.1098],
        [0.1098, 0.1099, 0.1095, 0.1102, 0.1093, 0.0000, 0.1101, 0.1095, 0.1099,
         0.1096],
        [0.1091, 0.1090, 0.1092, 0.1094, 0.1100, 0.1101, 0.0000, 0.1090, 0.1098,
         0.1095],
        [0.1095, 0.1090, 0.1099, 0.1091, 0.1096, 0.1095, 0.1090, 0.0000, 0.1098,
         0.1094],
        [0.1095, 0.1098, 0.1100, 0.1099, 0.1099, 0.1099, 0.1098, 0.1098, 0.0000,
         0.1098],
        [0.1098, 0.1093, 0.1099, 0.1095, 0.1098, 0.1096, 0.1095, 0.1094, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0404, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.75038445
Epoch718: train_loss: 4.0558 recon_acc: 0.9154 val_roc: 0.7573 val_ap: 0.8251 f1: 0.6935 time: 0.2942
difference_matrix tensor([[0.0000, 0.1094, 0.1098, 0.1094, 0.1096, 0.1098, 0.1091, 0.1095, 0.1095,
         0.1098],
        [0.1094, 0.0000, 0.1098, 0.1094, 0.1093, 0.1099, 0.1090, 0.1090, 0.1098,
         0.1093],
        [0.1098, 0.1098, 0.0000, 0.1100, 0.1100, 0.1095, 0.1092, 0.1099, 0.1100,
         0.1099],
        [0.1094, 0.1094, 0.1100, 0.0000, 0.1098, 0.1102, 0.1094, 0.1090, 0.1099,
         0.1095],
        [0.1096, 0.1093, 0.1100, 0.1098, 0.0000, 0.1093, 0.1100, 0.1096, 0.1099,
         0.1098],
        [0.1098, 0.1099, 0.1095, 0.1102, 0.1093, 0.0000, 0.1101, 0.1095, 0.1099,
         0.1096],
        [0.1091, 0.1090, 0.1092, 0.1094, 0.1100, 0.1101, 0.0000, 0.1089, 0.1098,
         0.1095],
        [0.1095, 0.1090, 0.1099, 0.1090, 0.1096, 0.1095, 0.1089, 0.0000, 0.1097,
         0.1094],
        [0.1095, 0.1098, 0.1100, 0.1099, 0.1099, 0.1099, 0.1098, 0.1097, 0.0000,
         0.1098],
        [0.1098, 0.1093, 0.1099, 0.1095, 0.1098, 0.1096, 0.1095, 0.1094, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0404, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7504673
Epoch719: train_loss: 4.0558 recon_acc: 0.9155 val_roc: 0.7574 val_ap: 0.8252 f1: 0.6935 time: 0.2601
difference_matrix tensor([[0.0000, 0.1094, 0.1098, 0.1094, 0.1096, 0.1098, 0.1091, 0.1095, 0.1095,
         0.1098],
        [0.1094, 0.0000, 0.1098, 0.1094, 0.1093, 0.1099, 0.1090, 0.1090, 0.1098,
         0.1093],
        [0.1098, 0.1098, 0.0000, 0.1100, 0.1100, 0.1094, 0.1092, 0.1099, 0.1100,
         0.1099],
        [0.1094, 0.1094, 0.1100, 0.0000, 0.1098, 0.1102, 0.1094, 0.1090, 0.1099,
         0.1095],
        [0.1096, 0.1093, 0.1100, 0.1098, 0.0000, 0.1093, 0.1100, 0.1096, 0.1099,
         0.1098],
        [0.1098, 0.1099, 0.1094, 0.1102, 0.1093, 0.0000, 0.1101, 0.1095, 0.1098,
         0.1096],
        [0.1091, 0.1090, 0.1092, 0.1094, 0.1100, 0.1101, 0.0000, 0.1089, 0.1098,
         0.1094],
        [0.1095, 0.1090, 0.1099, 0.1090, 0.1096, 0.1095, 0.1089, 0.0000, 0.1097,
         0.1094],
        [0.1095, 0.1098, 0.1100, 0.1099, 0.1099, 0.1098, 0.1098, 0.1097, 0.0000,
         0.1098],
        [0.1098, 0.1093, 0.1099, 0.1095, 0.1098, 0.1096, 0.1094, 0.1094, 0.1098,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0404, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.7458067
Epoch720: train_loss: 4.0557 recon_acc: 0.9108 val_roc: 0.7575 val_ap: 0.8253 f1: 0.6952 time: 0.2592
difference_matrix tensor([[0.0000, 0.1094, 0.1098, 0.1094, 0.1096, 0.1098, 0.1091, 0.1095, 0.1095,
         0.1098],
        [0.1094, 0.0000, 0.1098, 0.1094, 0.1093, 0.1099, 0.1090, 0.1090, 0.1098,
         0.1093],
        [0.1098, 0.1098, 0.0000, 0.1100, 0.1100, 0.1094, 0.1092, 0.1099, 0.1100,
         0.1099],
        [0.1094, 0.1094, 0.1100, 0.0000, 0.1098, 0.1102, 0.1094, 0.1090, 0.1099,
         0.1095],
        [0.1096, 0.1093, 0.1100, 0.1098, 0.0000, 0.1093, 0.1100, 0.1096, 0.1099,
         0.1098],
        [0.1098, 0.1099, 0.1094, 0.1102, 0.1093, 0.0000, 0.1101, 0.1095, 0.1098,
         0.1096],
        [0.1091, 0.1090, 0.1092, 0.1094, 0.1100, 0.1101, 0.0000, 0.1089, 0.1098,
         0.1094],
        [0.1095, 0.1090, 0.1099, 0.1090, 0.1096, 0.1095, 0.1089, 0.0000, 0.1097,
         0.1094],
        [0.1095, 0.1098, 0.1100, 0.1099, 0.1099, 0.1098, 0.1098, 0.1097, 0.0000,
         0.1097],
        [0.1098, 0.1093, 0.1099, 0.1095, 0.1098, 0.1096, 0.1094, 0.1094, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0404, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.54453987
Epoch721: train_loss: 4.0556 recon_acc: 0.5957 val_roc: 0.7745 val_ap: 0.8315 f1: 0.7093 time: 0.2562
thresh 0.43978053
          test_roc: 0.7848 test_ap: 0.8386 test_f1: 0.7109 test_recon_acc: 0.3901
difference_matrix tensor([[0.0000, 0.1094, 0.1098, 0.1094, 0.1096, 0.1098, 0.1091, 0.1094, 0.1095,
         0.1098],
        [0.1094, 0.0000, 0.1098, 0.1094, 0.1093, 0.1098, 0.1090, 0.1090, 0.1098,
         0.1093],
        [0.1098, 0.1098, 0.0000, 0.1100, 0.1100, 0.1094, 0.1092, 0.1099, 0.1100,
         0.1099],
        [0.1094, 0.1094, 0.1100, 0.0000, 0.1098, 0.1102, 0.1094, 0.1090, 0.1099,
         0.1095],
        [0.1096, 0.1093, 0.1100, 0.1098, 0.0000, 0.1092, 0.1100, 0.1096, 0.1099,
         0.1098],
        [0.1098, 0.1098, 0.1094, 0.1102, 0.1092, 0.0000, 0.1101, 0.1095, 0.1098,
         0.1096],
        [0.1091, 0.1090, 0.1092, 0.1094, 0.1100, 0.1101, 0.0000, 0.1089, 0.1098,
         0.1094],
        [0.1094, 0.1090, 0.1099, 0.1090, 0.1096, 0.1095, 0.1089, 0.0000, 0.1097,
         0.1094],
        [0.1095, 0.1098, 0.1100, 0.1099, 0.1099, 0.1098, 0.1098, 0.1097, 0.0000,
         0.1097],
        [0.1098, 0.1093, 0.1099, 0.1095, 0.1098, 0.1096, 0.1094, 0.1094, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0404, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5477084
Epoch722: train_loss: 4.0556 recon_acc: 0.6017 val_roc: 0.7745 val_ap: 0.8315 f1: 0.7081 time: 0.2793
difference_matrix tensor([[0.0000, 0.1094, 0.1098, 0.1094, 0.1095, 0.1098, 0.1091, 0.1094, 0.1095,
         0.1098],
        [0.1094, 0.0000, 0.1098, 0.1093, 0.1093, 0.1098, 0.1090, 0.1090, 0.1098,
         0.1092],
        [0.1098, 0.1098, 0.0000, 0.1100, 0.1100, 0.1094, 0.1092, 0.1099, 0.1100,
         0.1099],
        [0.1094, 0.1093, 0.1100, 0.0000, 0.1098, 0.1102, 0.1094, 0.1090, 0.1099,
         0.1095],
        [0.1095, 0.1093, 0.1100, 0.1098, 0.0000, 0.1092, 0.1100, 0.1096, 0.1099,
         0.1098],
        [0.1098, 0.1098, 0.1094, 0.1102, 0.1092, 0.0000, 0.1101, 0.1095, 0.1098,
         0.1096],
        [0.1091, 0.1090, 0.1092, 0.1094, 0.1100, 0.1101, 0.0000, 0.1089, 0.1098,
         0.1094],
        [0.1094, 0.1090, 0.1099, 0.1090, 0.1096, 0.1095, 0.1089, 0.0000, 0.1097,
         0.1093],
        [0.1095, 0.1098, 0.1100, 0.1099, 0.1099, 0.1098, 0.1098, 0.1097, 0.0000,
         0.1097],
        [0.1098, 0.1092, 0.1099, 0.1095, 0.1098, 0.1096, 0.1094, 0.1093, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0404, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5483767
Epoch723: train_loss: 4.0555 recon_acc: 0.6030 val_roc: 0.7745 val_ap: 0.8316 f1: 0.7095 time: 0.2770
difference_matrix tensor([[0.0000, 0.1094, 0.1098, 0.1094, 0.1095, 0.1098, 0.1091, 0.1094, 0.1095,
         0.1098],
        [0.1094, 0.0000, 0.1098, 0.1093, 0.1093, 0.1098, 0.1090, 0.1089, 0.1098,
         0.1092],
        [0.1098, 0.1098, 0.0000, 0.1100, 0.1100, 0.1094, 0.1092, 0.1099, 0.1100,
         0.1099],
        [0.1094, 0.1093, 0.1100, 0.0000, 0.1098, 0.1102, 0.1094, 0.1090, 0.1099,
         0.1095],
        [0.1095, 0.1093, 0.1100, 0.1098, 0.0000, 0.1092, 0.1100, 0.1096, 0.1099,
         0.1098],
        [0.1098, 0.1098, 0.1094, 0.1102, 0.1092, 0.0000, 0.1101, 0.1095, 0.1098,
         0.1095],
        [0.1091, 0.1090, 0.1092, 0.1094, 0.1100, 0.1101, 0.0000, 0.1089, 0.1098,
         0.1094],
        [0.1094, 0.1089, 0.1099, 0.1090, 0.1096, 0.1095, 0.1089, 0.0000, 0.1097,
         0.1093],
        [0.1095, 0.1098, 0.1100, 0.1099, 0.1099, 0.1098, 0.1098, 0.1097, 0.0000,
         0.1097],
        [0.1098, 0.1092, 0.1099, 0.1095, 0.1098, 0.1095, 0.1094, 0.1093, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0404, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.54904515
Epoch724: train_loss: 4.0555 recon_acc: 0.6043 val_roc: 0.7745 val_ap: 0.8316 f1: 0.7095 time: 0.2811
difference_matrix tensor([[0.0000, 0.1094, 0.1098, 0.1094, 0.1095, 0.1098, 0.1091, 0.1094, 0.1095,
         0.1098],
        [0.1094, 0.0000, 0.1098, 0.1093, 0.1093, 0.1098, 0.1090, 0.1089, 0.1098,
         0.1092],
        [0.1098, 0.1098, 0.0000, 0.1100, 0.1099, 0.1094, 0.1092, 0.1099, 0.1100,
         0.1099],
        [0.1094, 0.1093, 0.1100, 0.0000, 0.1098, 0.1102, 0.1094, 0.1090, 0.1099,
         0.1095],
        [0.1095, 0.1093, 0.1099, 0.1098, 0.0000, 0.1092, 0.1099, 0.1096, 0.1099,
         0.1097],
        [0.1098, 0.1098, 0.1094, 0.1102, 0.1092, 0.0000, 0.1101, 0.1095, 0.1098,
         0.1095],
        [0.1091, 0.1090, 0.1092, 0.1094, 0.1099, 0.1101, 0.0000, 0.1089, 0.1098,
         0.1094],
        [0.1094, 0.1089, 0.1099, 0.1090, 0.1096, 0.1095, 0.1089, 0.0000, 0.1097,
         0.1093],
        [0.1095, 0.1098, 0.1100, 0.1099, 0.1099, 0.1098, 0.1098, 0.1097, 0.0000,
         0.1097],
        [0.1098, 0.1092, 0.1099, 0.1095, 0.1097, 0.1095, 0.1094, 0.1093, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0404, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.54971385
Epoch725: train_loss: 4.0554 recon_acc: 0.6056 val_roc: 0.7746 val_ap: 0.8317 f1: 0.7095 time: 0.2697
thresh 0.43804705
          test_roc: 0.7849 test_ap: 0.8387 test_f1: 0.7101 test_recon_acc: 0.3868
difference_matrix tensor([[0.0000, 0.1093, 0.1098, 0.1094, 0.1095, 0.1098, 0.1091, 0.1094, 0.1095,
         0.1097],
        [0.1093, 0.0000, 0.1098, 0.1093, 0.1093, 0.1098, 0.1090, 0.1089, 0.1098,
         0.1092],
        [0.1098, 0.1098, 0.0000, 0.1099, 0.1099, 0.1094, 0.1092, 0.1099, 0.1099,
         0.1098],
        [0.1094, 0.1093, 0.1099, 0.0000, 0.1098, 0.1102, 0.1094, 0.1090, 0.1098,
         0.1095],
        [0.1095, 0.1093, 0.1099, 0.1098, 0.0000, 0.1092, 0.1099, 0.1096, 0.1099,
         0.1097],
        [0.1098, 0.1098, 0.1094, 0.1102, 0.1092, 0.0000, 0.1101, 0.1095, 0.1098,
         0.1095],
        [0.1091, 0.1090, 0.1092, 0.1094, 0.1099, 0.1101, 0.0000, 0.1089, 0.1098,
         0.1094],
        [0.1094, 0.1089, 0.1099, 0.1090, 0.1096, 0.1095, 0.1089, 0.0000, 0.1097,
         0.1093],
        [0.1095, 0.1098, 0.1099, 0.1098, 0.1099, 0.1098, 0.1098, 0.1097, 0.0000,
         0.1097],
        [0.1097, 0.1092, 0.1098, 0.1095, 0.1097, 0.1095, 0.1094, 0.1093, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0404, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5503827
Epoch726: train_loss: 4.0553 recon_acc: 0.6069 val_roc: 0.7746 val_ap: 0.8317 f1: 0.7095 time: 0.2674
difference_matrix tensor([[0.0000, 0.1093, 0.1098, 0.1094, 0.1095, 0.1098, 0.1091, 0.1094, 0.1095,
         0.1097],
        [0.1093, 0.0000, 0.1098, 0.1093, 0.1093, 0.1098, 0.1090, 0.1089, 0.1098,
         0.1092],
        [0.1098, 0.1098, 0.0000, 0.1099, 0.1099, 0.1094, 0.1092, 0.1099, 0.1099,
         0.1098],
        [0.1094, 0.1093, 0.1099, 0.0000, 0.1098, 0.1102, 0.1094, 0.1090, 0.1098,
         0.1095],
        [0.1095, 0.1093, 0.1099, 0.1098, 0.0000, 0.1092, 0.1099, 0.1096, 0.1099,
         0.1097],
        [0.1098, 0.1098, 0.1094, 0.1102, 0.1092, 0.0000, 0.1101, 0.1095, 0.1098,
         0.1095],
        [0.1091, 0.1090, 0.1092, 0.1094, 0.1099, 0.1100, 0.0000, 0.1089, 0.1097,
         0.1094],
        [0.1094, 0.1089, 0.1099, 0.1090, 0.1096, 0.1095, 0.1089, 0.0000, 0.1097,
         0.1093],
        [0.1095, 0.1098, 0.1099, 0.1098, 0.1099, 0.1098, 0.1097, 0.1097, 0.0000,
         0.1097],
        [0.1097, 0.1092, 0.1098, 0.1095, 0.1097, 0.1095, 0.1094, 0.1093, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0404, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5510517
Epoch727: train_loss: 4.0553 recon_acc: 0.6082 val_roc: 0.7746 val_ap: 0.8317 f1: 0.7095 time: 0.3027
thresh 0.43824628
          test_roc: 0.7849 test_ap: 0.8388 test_f1: 0.7108 test_recon_acc: 0.3872
difference_matrix tensor([[0.0000, 0.1093, 0.1098, 0.1094, 0.1095, 0.1098, 0.1091, 0.1094, 0.1095,
         0.1097],
        [0.1093, 0.0000, 0.1098, 0.1093, 0.1093, 0.1098, 0.1090, 0.1089, 0.1097,
         0.1092],
        [0.1098, 0.1098, 0.0000, 0.1099, 0.1099, 0.1094, 0.1092, 0.1098, 0.1099,
         0.1098],
        [0.1094, 0.1093, 0.1099, 0.0000, 0.1098, 0.1102, 0.1094, 0.1090, 0.1098,
         0.1095],
        [0.1095, 0.1093, 0.1099, 0.1098, 0.0000, 0.1092, 0.1099, 0.1096, 0.1099,
         0.1097],
        [0.1098, 0.1098, 0.1094, 0.1102, 0.1092, 0.0000, 0.1100, 0.1095, 0.1098,
         0.1095],
        [0.1091, 0.1090, 0.1092, 0.1094, 0.1099, 0.1100, 0.0000, 0.1089, 0.1097,
         0.1094],
        [0.1094, 0.1089, 0.1098, 0.1090, 0.1096, 0.1095, 0.1089, 0.0000, 0.1097,
         0.1093],
        [0.1095, 0.1097, 0.1099, 0.1098, 0.1099, 0.1098, 0.1097, 0.1097, 0.0000,
         0.1097],
        [0.1097, 0.1092, 0.1098, 0.1095, 0.1097, 0.1095, 0.1094, 0.1093, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0404, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55172086
Epoch728: train_loss: 4.0552 recon_acc: 0.6095 val_roc: 0.7745 val_ap: 0.8317 f1: 0.7110 time: 0.2868
difference_matrix tensor([[0.0000, 0.1093, 0.1097, 0.1093, 0.1095, 0.1097, 0.1091, 0.1094, 0.1095,
         0.1097],
        [0.1093, 0.0000, 0.1098, 0.1093, 0.1093, 0.1098, 0.1089, 0.1089, 0.1097,
         0.1092],
        [0.1097, 0.1098, 0.0000, 0.1099, 0.1099, 0.1094, 0.1092, 0.1098, 0.1099,
         0.1098],
        [0.1093, 0.1093, 0.1099, 0.0000, 0.1097, 0.1102, 0.1094, 0.1090, 0.1098,
         0.1095],
        [0.1095, 0.1093, 0.1099, 0.1097, 0.0000, 0.1092, 0.1099, 0.1095, 0.1099,
         0.1097],
        [0.1097, 0.1098, 0.1094, 0.1102, 0.1092, 0.0000, 0.1100, 0.1095, 0.1098,
         0.1095],
        [0.1091, 0.1089, 0.1092, 0.1094, 0.1099, 0.1100, 0.0000, 0.1089, 0.1097,
         0.1094],
        [0.1094, 0.1089, 0.1098, 0.1090, 0.1095, 0.1095, 0.1089, 0.0000, 0.1097,
         0.1093],
        [0.1095, 0.1097, 0.1099, 0.1098, 0.1099, 0.1098, 0.1097, 0.1097, 0.0000,
         0.1097],
        [0.1097, 0.1092, 0.1098, 0.1095, 0.1097, 0.1095, 0.1094, 0.1093, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55239016
Epoch729: train_loss: 4.0552 recon_acc: 0.6108 val_roc: 0.7746 val_ap: 0.8317 f1: 0.7110 time: 0.2589
difference_matrix tensor([[0.0000, 0.1093, 0.1097, 0.1093, 0.1095, 0.1097, 0.1090, 0.1094, 0.1095,
         0.1097],
        [0.1093, 0.0000, 0.1098, 0.1093, 0.1093, 0.1098, 0.1089, 0.1089, 0.1097,
         0.1092],
        [0.1097, 0.1098, 0.0000, 0.1099, 0.1099, 0.1094, 0.1092, 0.1098, 0.1099,
         0.1098],
        [0.1093, 0.1093, 0.1099, 0.0000, 0.1097, 0.1102, 0.1094, 0.1090, 0.1098,
         0.1095],
        [0.1095, 0.1093, 0.1099, 0.1097, 0.0000, 0.1092, 0.1099, 0.1095, 0.1099,
         0.1097],
        [0.1097, 0.1098, 0.1094, 0.1102, 0.1092, 0.0000, 0.1100, 0.1094, 0.1098,
         0.1095],
        [0.1090, 0.1089, 0.1092, 0.1094, 0.1099, 0.1100, 0.0000, 0.1089, 0.1097,
         0.1094],
        [0.1094, 0.1089, 0.1098, 0.1090, 0.1095, 0.1094, 0.1089, 0.0000, 0.1097,
         0.1093],
        [0.1095, 0.1097, 0.1099, 0.1098, 0.1099, 0.1098, 0.1097, 0.1097, 0.0000,
         0.1097],
        [0.1097, 0.1092, 0.1098, 0.1095, 0.1097, 0.1095, 0.1094, 0.1093, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5530597
Epoch730: train_loss: 4.0551 recon_acc: 0.6121 val_roc: 0.7746 val_ap: 0.8318 f1: 0.7110 time: 0.2657
difference_matrix tensor([[0.0000, 0.1093, 0.1097, 0.1093, 0.1095, 0.1097, 0.1090, 0.1094, 0.1095,
         0.1097],
        [0.1093, 0.0000, 0.1098, 0.1093, 0.1093, 0.1098, 0.1089, 0.1089, 0.1097,
         0.1092],
        [0.1097, 0.1098, 0.0000, 0.1099, 0.1099, 0.1094, 0.1091, 0.1098, 0.1099,
         0.1098],
        [0.1093, 0.1093, 0.1099, 0.0000, 0.1097, 0.1102, 0.1094, 0.1090, 0.1098,
         0.1095],
        [0.1095, 0.1093, 0.1099, 0.1097, 0.0000, 0.1092, 0.1099, 0.1095, 0.1099,
         0.1097],
        [0.1097, 0.1098, 0.1094, 0.1102, 0.1092, 0.0000, 0.1100, 0.1094, 0.1098,
         0.1095],
        [0.1090, 0.1089, 0.1091, 0.1094, 0.1099, 0.1100, 0.0000, 0.1089, 0.1097,
         0.1094],
        [0.1094, 0.1089, 0.1098, 0.1090, 0.1095, 0.1094, 0.1089, 0.0000, 0.1097,
         0.1093],
        [0.1095, 0.1097, 0.1099, 0.1098, 0.1099, 0.1098, 0.1097, 0.1097, 0.0000,
         0.1097],
        [0.1097, 0.1092, 0.1098, 0.1095, 0.1097, 0.1095, 0.1094, 0.1093, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55372924
Epoch731: train_loss: 4.0551 recon_acc: 0.6135 val_roc: 0.7746 val_ap: 0.8319 f1: 0.7110 time: 0.2626
difference_matrix tensor([[0.0000, 0.1093, 0.1097, 0.1093, 0.1095, 0.1097, 0.1090, 0.1094, 0.1095,
         0.1097],
        [0.1093, 0.0000, 0.1098, 0.1093, 0.1092, 0.1098, 0.1089, 0.1089, 0.1097,
         0.1092],
        [0.1097, 0.1098, 0.0000, 0.1099, 0.1099, 0.1093, 0.1091, 0.1098, 0.1099,
         0.1098],
        [0.1093, 0.1093, 0.1099, 0.0000, 0.1097, 0.1102, 0.1094, 0.1090, 0.1098,
         0.1094],
        [0.1095, 0.1092, 0.1099, 0.1097, 0.0000, 0.1092, 0.1099, 0.1095, 0.1098,
         0.1097],
        [0.1097, 0.1098, 0.1093, 0.1102, 0.1092, 0.0000, 0.1100, 0.1094, 0.1098,
         0.1095],
        [0.1090, 0.1089, 0.1091, 0.1094, 0.1099, 0.1100, 0.0000, 0.1089, 0.1097,
         0.1094],
        [0.1094, 0.1089, 0.1098, 0.1090, 0.1095, 0.1094, 0.1089, 0.0000, 0.1097,
         0.1093],
        [0.1095, 0.1097, 0.1099, 0.1098, 0.1098, 0.1098, 0.1097, 0.1097, 0.0000,
         0.1097],
        [0.1097, 0.1092, 0.1098, 0.1094, 0.1097, 0.1095, 0.1094, 0.1093, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5539293
Epoch732: train_loss: 4.0550 recon_acc: 0.6139 val_roc: 0.7747 val_ap: 0.8319 f1: 0.7110 time: 0.2839
thresh 0.43953922
          test_roc: 0.7851 test_ap: 0.8390 test_f1: 0.7096 test_recon_acc: 0.3898
difference_matrix tensor([[0.0000, 0.1093, 0.1097, 0.1093, 0.1095, 0.1097, 0.1090, 0.1094, 0.1095,
         0.1097],
        [0.1093, 0.0000, 0.1098, 0.1093, 0.1092, 0.1098, 0.1089, 0.1089, 0.1097,
         0.1092],
        [0.1097, 0.1098, 0.0000, 0.1099, 0.1099, 0.1093, 0.1091, 0.1098, 0.1099,
         0.1098],
        [0.1093, 0.1093, 0.1099, 0.0000, 0.1097, 0.1102, 0.1093, 0.1090, 0.1098,
         0.1094],
        [0.1095, 0.1092, 0.1099, 0.1097, 0.0000, 0.1092, 0.1099, 0.1095, 0.1098,
         0.1097],
        [0.1097, 0.1098, 0.1093, 0.1102, 0.1092, 0.0000, 0.1100, 0.1094, 0.1098,
         0.1095],
        [0.1090, 0.1089, 0.1091, 0.1093, 0.1099, 0.1100, 0.0000, 0.1088, 0.1097,
         0.1094],
        [0.1094, 0.1089, 0.1098, 0.1090, 0.1095, 0.1094, 0.1088, 0.0000, 0.1097,
         0.1093],
        [0.1095, 0.1097, 0.1099, 0.1098, 0.1098, 0.1098, 0.1097, 0.1097, 0.0000,
         0.1097],
        [0.1097, 0.1092, 0.1098, 0.1094, 0.1097, 0.1095, 0.1094, 0.1093, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5537197
Epoch733: train_loss: 4.0549 recon_acc: 0.6135 val_roc: 0.7747 val_ap: 0.8319 f1: 0.7110 time: 0.3191
difference_matrix tensor([[0.0000, 0.1093, 0.1097, 0.1093, 0.1095, 0.1097, 0.1090, 0.1094, 0.1094,
         0.1097],
        [0.1093, 0.0000, 0.1098, 0.1093, 0.1092, 0.1098, 0.1089, 0.1089, 0.1097,
         0.1092],
        [0.1097, 0.1098, 0.0000, 0.1099, 0.1099, 0.1093, 0.1091, 0.1098, 0.1099,
         0.1098],
        [0.1093, 0.1093, 0.1099, 0.0000, 0.1097, 0.1101, 0.1093, 0.1089, 0.1098,
         0.1094],
        [0.1095, 0.1092, 0.1099, 0.1097, 0.0000, 0.1092, 0.1099, 0.1095, 0.1098,
         0.1097],
        [0.1097, 0.1098, 0.1093, 0.1101, 0.1092, 0.0000, 0.1100, 0.1094, 0.1098,
         0.1095],
        [0.1090, 0.1089, 0.1091, 0.1093, 0.1099, 0.1100, 0.0000, 0.1088, 0.1097,
         0.1093],
        [0.1094, 0.1089, 0.1098, 0.1089, 0.1095, 0.1094, 0.1088, 0.0000, 0.1097,
         0.1093],
        [0.1094, 0.1097, 0.1099, 0.1098, 0.1098, 0.1098, 0.1097, 0.1097, 0.0000,
         0.1097],
        [0.1097, 0.1092, 0.1098, 0.1094, 0.1097, 0.1095, 0.1093, 0.1093, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55351055
Epoch734: train_loss: 4.0549 recon_acc: 0.6131 val_roc: 0.7746 val_ap: 0.8318 f1: 0.7110 time: 0.2636
difference_matrix tensor([[0.0000, 0.1093, 0.1097, 0.1093, 0.1095, 0.1097, 0.1090, 0.1094, 0.1094,
         0.1097],
        [0.1093, 0.0000, 0.1097, 0.1093, 0.1092, 0.1098, 0.1089, 0.1089, 0.1097,
         0.1092],
        [0.1097, 0.1097, 0.0000, 0.1099, 0.1099, 0.1093, 0.1091, 0.1098, 0.1099,
         0.1098],
        [0.1093, 0.1093, 0.1099, 0.0000, 0.1097, 0.1101, 0.1093, 0.1089, 0.1098,
         0.1094],
        [0.1095, 0.1092, 0.1099, 0.1097, 0.0000, 0.1092, 0.1099, 0.1095, 0.1098,
         0.1097],
        [0.1097, 0.1098, 0.1093, 0.1101, 0.1092, 0.0000, 0.1100, 0.1094, 0.1098,
         0.1095],
        [0.1090, 0.1089, 0.1091, 0.1093, 0.1099, 0.1100, 0.0000, 0.1088, 0.1097,
         0.1093],
        [0.1094, 0.1089, 0.1098, 0.1089, 0.1095, 0.1094, 0.1088, 0.0000, 0.1097,
         0.1093],
        [0.1094, 0.1097, 0.1099, 0.1098, 0.1098, 0.1098, 0.1097, 0.1097, 0.0000,
         0.1097],
        [0.1097, 0.1092, 0.1098, 0.1094, 0.1097, 0.1095, 0.1093, 0.1093, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5533017
Epoch735: train_loss: 4.0548 recon_acc: 0.6127 val_roc: 0.7747 val_ap: 0.8319 f1: 0.7110 time: 0.2574
thresh 0.44008482
          test_roc: 0.7852 test_ap: 0.8391 test_f1: 0.7103 test_recon_acc: 0.3909
difference_matrix tensor([[0.0000, 0.1093, 0.1097, 0.1093, 0.1095, 0.1097, 0.1090, 0.1094, 0.1094,
         0.1097],
        [0.1093, 0.0000, 0.1097, 0.1093, 0.1092, 0.1098, 0.1089, 0.1089, 0.1097,
         0.1092],
        [0.1097, 0.1097, 0.0000, 0.1099, 0.1099, 0.1093, 0.1091, 0.1098, 0.1099,
         0.1098],
        [0.1093, 0.1093, 0.1099, 0.0000, 0.1097, 0.1101, 0.1093, 0.1089, 0.1098,
         0.1094],
        [0.1095, 0.1092, 0.1099, 0.1097, 0.0000, 0.1091, 0.1099, 0.1095, 0.1098,
         0.1097],
        [0.1097, 0.1098, 0.1093, 0.1101, 0.1091, 0.0000, 0.1100, 0.1094, 0.1098,
         0.1095],
        [0.1090, 0.1089, 0.1091, 0.1093, 0.1099, 0.1100, 0.0000, 0.1088, 0.1097,
         0.1093],
        [0.1094, 0.1089, 0.1098, 0.1089, 0.1095, 0.1094, 0.1088, 0.0000, 0.1096,
         0.1093],
        [0.1094, 0.1097, 0.1099, 0.1098, 0.1098, 0.1098, 0.1097, 0.1096, 0.0000,
         0.1097],
        [0.1097, 0.1092, 0.1098, 0.1094, 0.1097, 0.1095, 0.1093, 0.1093, 0.1097,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5555324
Epoch736: train_loss: 4.0548 recon_acc: 0.6170 val_roc: 0.7746 val_ap: 0.8319 f1: 0.7098 time: 0.2526
difference_matrix tensor([[0.0000, 0.1093, 0.1097, 0.1093, 0.1095, 0.1097, 0.1090, 0.1093, 0.1094,
         0.1097],
        [0.1093, 0.0000, 0.1097, 0.1093, 0.1092, 0.1098, 0.1089, 0.1089, 0.1097,
         0.1091],
        [0.1097, 0.1097, 0.0000, 0.1099, 0.1099, 0.1093, 0.1091, 0.1098, 0.1099,
         0.1098],
        [0.1093, 0.1093, 0.1099, 0.0000, 0.1097, 0.1101, 0.1093, 0.1089, 0.1098,
         0.1094],
        [0.1095, 0.1092, 0.1099, 0.1097, 0.0000, 0.1091, 0.1099, 0.1095, 0.1098,
         0.1097],
        [0.1097, 0.1098, 0.1093, 0.1101, 0.1091, 0.0000, 0.1100, 0.1094, 0.1097,
         0.1095],
        [0.1090, 0.1089, 0.1091, 0.1093, 0.1099, 0.1100, 0.0000, 0.1088, 0.1097,
         0.1093],
        [0.1093, 0.1089, 0.1098, 0.1089, 0.1095, 0.1094, 0.1088, 0.0000, 0.1096,
         0.1093],
        [0.1094, 0.1097, 0.1099, 0.1098, 0.1098, 0.1097, 0.1097, 0.1096, 0.0000,
         0.1096],
        [0.1097, 0.1091, 0.1098, 0.1094, 0.1097, 0.1095, 0.1093, 0.1093, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5552668
Epoch737: train_loss: 4.0547 recon_acc: 0.6165 val_roc: 0.7746 val_ap: 0.8318 f1: 0.7098 time: 0.2706
difference_matrix tensor([[0.0000, 0.1093, 0.1097, 0.1093, 0.1094, 0.1097, 0.1090, 0.1093, 0.1094,
         0.1097],
        [0.1093, 0.0000, 0.1097, 0.1093, 0.1092, 0.1097, 0.1089, 0.1089, 0.1097,
         0.1091],
        [0.1097, 0.1097, 0.0000, 0.1099, 0.1099, 0.1093, 0.1091, 0.1098, 0.1099,
         0.1098],
        [0.1093, 0.1093, 0.1099, 0.0000, 0.1097, 0.1101, 0.1093, 0.1089, 0.1098,
         0.1094],
        [0.1094, 0.1092, 0.1099, 0.1097, 0.0000, 0.1091, 0.1099, 0.1095, 0.1098,
         0.1097],
        [0.1097, 0.1097, 0.1093, 0.1101, 0.1091, 0.0000, 0.1100, 0.1094, 0.1097,
         0.1094],
        [0.1090, 0.1089, 0.1091, 0.1093, 0.1099, 0.1100, 0.0000, 0.1088, 0.1097,
         0.1093],
        [0.1093, 0.1089, 0.1098, 0.1089, 0.1095, 0.1094, 0.1088, 0.0000, 0.1096,
         0.1092],
        [0.1094, 0.1097, 0.1099, 0.1098, 0.1098, 0.1097, 0.1097, 0.1096, 0.0000,
         0.1096],
        [0.1097, 0.1091, 0.1098, 0.1094, 0.1097, 0.1094, 0.1093, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55267733
Epoch738: train_loss: 4.0547 recon_acc: 0.6116 val_roc: 0.7746 val_ap: 0.8319 f1: 0.7095 time: 0.3068
difference_matrix tensor([[0.0000, 0.1093, 0.1097, 0.1093, 0.1094, 0.1097, 0.1090, 0.1093, 0.1094,
         0.1097],
        [0.1093, 0.0000, 0.1097, 0.1092, 0.1092, 0.1097, 0.1089, 0.1088, 0.1097,
         0.1091],
        [0.1097, 0.1097, 0.0000, 0.1099, 0.1099, 0.1093, 0.1091, 0.1098, 0.1098,
         0.1098],
        [0.1093, 0.1092, 0.1099, 0.0000, 0.1097, 0.1101, 0.1093, 0.1089, 0.1098,
         0.1094],
        [0.1094, 0.1092, 0.1099, 0.1097, 0.0000, 0.1091, 0.1099, 0.1095, 0.1098,
         0.1096],
        [0.1097, 0.1097, 0.1093, 0.1101, 0.1091, 0.0000, 0.1100, 0.1094, 0.1097,
         0.1094],
        [0.1090, 0.1089, 0.1091, 0.1093, 0.1099, 0.1100, 0.0000, 0.1088, 0.1097,
         0.1093],
        [0.1093, 0.1088, 0.1098, 0.1089, 0.1095, 0.1094, 0.1088, 0.0000, 0.1096,
         0.1092],
        [0.1094, 0.1097, 0.1098, 0.1098, 0.1098, 0.1097, 0.1097, 0.1096, 0.0000,
         0.1096],
        [0.1097, 0.1091, 0.1098, 0.1094, 0.1096, 0.1094, 0.1093, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55246985
Epoch739: train_loss: 4.0546 recon_acc: 0.6113 val_roc: 0.7745 val_ap: 0.8319 f1: 0.7095 time: 0.2612
difference_matrix tensor([[0.0000, 0.1093, 0.1097, 0.1093, 0.1094, 0.1097, 0.1090, 0.1093, 0.1094,
         0.1097],
        [0.1093, 0.0000, 0.1097, 0.1092, 0.1092, 0.1097, 0.1089, 0.1088, 0.1097,
         0.1091],
        [0.1097, 0.1097, 0.0000, 0.1099, 0.1098, 0.1093, 0.1091, 0.1098, 0.1098,
         0.1098],
        [0.1093, 0.1092, 0.1099, 0.0000, 0.1097, 0.1101, 0.1093, 0.1089, 0.1098,
         0.1094],
        [0.1094, 0.1092, 0.1098, 0.1097, 0.0000, 0.1091, 0.1098, 0.1095, 0.1098,
         0.1096],
        [0.1097, 0.1097, 0.1093, 0.1101, 0.1091, 0.0000, 0.1100, 0.1094, 0.1097,
         0.1094],
        [0.1090, 0.1089, 0.1091, 0.1093, 0.1098, 0.1100, 0.0000, 0.1088, 0.1097,
         0.1093],
        [0.1093, 0.1088, 0.1098, 0.1089, 0.1095, 0.1094, 0.1088, 0.0000, 0.1096,
         0.1092],
        [0.1094, 0.1097, 0.1098, 0.1098, 0.1098, 0.1097, 0.1097, 0.1096, 0.0000,
         0.1096],
        [0.1097, 0.1091, 0.1098, 0.1094, 0.1096, 0.1094, 0.1093, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5594346
Epoch740: train_loss: 4.0546 recon_acc: 0.6245 val_roc: 0.7745 val_ap: 0.8318 f1: 0.7101 time: 0.2543
difference_matrix tensor([[0.0000, 0.1092, 0.1097, 0.1093, 0.1094, 0.1097, 0.1090, 0.1093, 0.1094,
         0.1097],
        [0.1092, 0.0000, 0.1097, 0.1092, 0.1092, 0.1097, 0.1089, 0.1088, 0.1097,
         0.1091],
        [0.1097, 0.1097, 0.0000, 0.1099, 0.1098, 0.1093, 0.1091, 0.1098, 0.1098,
         0.1097],
        [0.1093, 0.1092, 0.1099, 0.0000, 0.1097, 0.1101, 0.1093, 0.1089, 0.1097,
         0.1094],
        [0.1094, 0.1092, 0.1098, 0.1097, 0.0000, 0.1091, 0.1098, 0.1095, 0.1098,
         0.1096],
        [0.1097, 0.1097, 0.1093, 0.1101, 0.1091, 0.0000, 0.1100, 0.1094, 0.1097,
         0.1094],
        [0.1090, 0.1089, 0.1091, 0.1093, 0.1098, 0.1100, 0.0000, 0.1088, 0.1096,
         0.1093],
        [0.1093, 0.1088, 0.1098, 0.1089, 0.1095, 0.1094, 0.1088, 0.0000, 0.1096,
         0.1092],
        [0.1094, 0.1097, 0.1098, 0.1097, 0.1098, 0.1097, 0.1096, 0.1096, 0.0000,
         0.1096],
        [0.1097, 0.1091, 0.1097, 0.1094, 0.1096, 0.1094, 0.1093, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5594516
Epoch741: train_loss: 4.0545 recon_acc: 0.6246 val_roc: 0.7745 val_ap: 0.8319 f1: 0.7086 time: 0.2554
difference_matrix tensor([[0.0000, 0.1092, 0.1097, 0.1093, 0.1094, 0.1097, 0.1090, 0.1093, 0.1094,
         0.1096],
        [0.1092, 0.0000, 0.1097, 0.1092, 0.1092, 0.1097, 0.1089, 0.1088, 0.1097,
         0.1091],
        [0.1097, 0.1097, 0.0000, 0.1099, 0.1098, 0.1093, 0.1091, 0.1098, 0.1098,
         0.1097],
        [0.1093, 0.1092, 0.1099, 0.0000, 0.1097, 0.1101, 0.1093, 0.1089, 0.1097,
         0.1094],
        [0.1094, 0.1092, 0.1098, 0.1097, 0.0000, 0.1091, 0.1098, 0.1095, 0.1098,
         0.1096],
        [0.1097, 0.1097, 0.1093, 0.1101, 0.1091, 0.0000, 0.1100, 0.1094, 0.1097,
         0.1094],
        [0.1090, 0.1089, 0.1091, 0.1093, 0.1098, 0.1100, 0.0000, 0.1088, 0.1096,
         0.1093],
        [0.1093, 0.1088, 0.1098, 0.1089, 0.1095, 0.1094, 0.1088, 0.0000, 0.1096,
         0.1092],
        [0.1094, 0.1097, 0.1098, 0.1097, 0.1098, 0.1097, 0.1096, 0.1096, 0.0000,
         0.1096],
        [0.1096, 0.1091, 0.1097, 0.1094, 0.1096, 0.1094, 0.1093, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55946773
Epoch742: train_loss: 4.0544 recon_acc: 0.6246 val_roc: 0.7745 val_ap: 0.8319 f1: 0.7086 time: 0.2796
difference_matrix tensor([[0.0000, 0.1092, 0.1097, 0.1092, 0.1094, 0.1097, 0.1090, 0.1093, 0.1094,
         0.1096],
        [0.1092, 0.0000, 0.1097, 0.1092, 0.1092, 0.1097, 0.1089, 0.1088, 0.1097,
         0.1091],
        [0.1097, 0.1097, 0.0000, 0.1098, 0.1098, 0.1093, 0.1091, 0.1098, 0.1098,
         0.1097],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1097, 0.1101, 0.1093, 0.1089, 0.1097,
         0.1094],
        [0.1094, 0.1092, 0.1098, 0.1097, 0.0000, 0.1091, 0.1098, 0.1095, 0.1098,
         0.1096],
        [0.1097, 0.1097, 0.1093, 0.1101, 0.1091, 0.0000, 0.1100, 0.1093, 0.1097,
         0.1094],
        [0.1090, 0.1089, 0.1091, 0.1093, 0.1098, 0.1100, 0.0000, 0.1088, 0.1096,
         0.1093],
        [0.1093, 0.1088, 0.1098, 0.1089, 0.1095, 0.1093, 0.1088, 0.0000, 0.1096,
         0.1092],
        [0.1094, 0.1097, 0.1098, 0.1097, 0.1098, 0.1097, 0.1096, 0.1096, 0.0000,
         0.1096],
        [0.1096, 0.1091, 0.1097, 0.1094, 0.1096, 0.1094, 0.1093, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0405, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55367225
Epoch743: train_loss: 4.0544 recon_acc: 0.6136 val_roc: 0.7744 val_ap: 0.8319 f1: 0.7083 time: 0.2954
difference_matrix tensor([[0.0000, 0.1092, 0.1096, 0.1092, 0.1094, 0.1096, 0.1089, 0.1093, 0.1094,
         0.1096],
        [0.1092, 0.0000, 0.1097, 0.1092, 0.1092, 0.1097, 0.1088, 0.1088, 0.1096,
         0.1091],
        [0.1096, 0.1097, 0.0000, 0.1098, 0.1098, 0.1093, 0.1090, 0.1097, 0.1098,
         0.1097],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1096, 0.1101, 0.1093, 0.1089, 0.1097,
         0.1094],
        [0.1094, 0.1092, 0.1098, 0.1096, 0.0000, 0.1091, 0.1098, 0.1094, 0.1098,
         0.1096],
        [0.1096, 0.1097, 0.1093, 0.1101, 0.1091, 0.0000, 0.1100, 0.1093, 0.1097,
         0.1094],
        [0.1089, 0.1088, 0.1090, 0.1093, 0.1098, 0.1100, 0.0000, 0.1088, 0.1096,
         0.1093],
        [0.1093, 0.1088, 0.1097, 0.1089, 0.1094, 0.1093, 0.1088, 0.0000, 0.1096,
         0.1092],
        [0.1094, 0.1096, 0.1098, 0.1097, 0.1098, 0.1097, 0.1096, 0.1096, 0.0000,
         0.1096],
        [0.1096, 0.1091, 0.1097, 0.1094, 0.1096, 0.1094, 0.1093, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55340624
Epoch744: train_loss: 4.0543 recon_acc: 0.6132 val_roc: 0.7745 val_ap: 0.8320 f1: 0.7083 time: 0.2674
difference_matrix tensor([[0.0000, 0.1092, 0.1096, 0.1092, 0.1094, 0.1096, 0.1089, 0.1093, 0.1094,
         0.1096],
        [0.1092, 0.0000, 0.1097, 0.1092, 0.1092, 0.1097, 0.1088, 0.1088, 0.1096,
         0.1091],
        [0.1096, 0.1097, 0.0000, 0.1098, 0.1098, 0.1092, 0.1090, 0.1097, 0.1098,
         0.1097],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1096, 0.1101, 0.1093, 0.1089, 0.1097,
         0.1094],
        [0.1094, 0.1092, 0.1098, 0.1096, 0.0000, 0.1091, 0.1098, 0.1094, 0.1098,
         0.1096],
        [0.1096, 0.1097, 0.1092, 0.1101, 0.1091, 0.0000, 0.1099, 0.1093, 0.1097,
         0.1094],
        [0.1089, 0.1088, 0.1090, 0.1093, 0.1098, 0.1099, 0.0000, 0.1088, 0.1096,
         0.1093],
        [0.1093, 0.1088, 0.1097, 0.1089, 0.1094, 0.1093, 0.1088, 0.0000, 0.1096,
         0.1092],
        [0.1094, 0.1096, 0.1098, 0.1097, 0.1098, 0.1097, 0.1096, 0.1096, 0.0000,
         0.1096],
        [0.1096, 0.1091, 0.1097, 0.1094, 0.1096, 0.1094, 0.1093, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5531402
Epoch745: train_loss: 4.0543 recon_acc: 0.6127 val_roc: 0.7745 val_ap: 0.8320 f1: 0.7083 time: 0.2634
difference_matrix tensor([[0.0000, 0.1092, 0.1096, 0.1092, 0.1094, 0.1096, 0.1089, 0.1093, 0.1094,
         0.1096],
        [0.1092, 0.0000, 0.1097, 0.1092, 0.1092, 0.1097, 0.1088, 0.1088, 0.1096,
         0.1091],
        [0.1096, 0.1097, 0.0000, 0.1098, 0.1098, 0.1092, 0.1090, 0.1097, 0.1098,
         0.1097],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1096, 0.1101, 0.1093, 0.1089, 0.1097,
         0.1094],
        [0.1094, 0.1092, 0.1098, 0.1096, 0.0000, 0.1091, 0.1098, 0.1094, 0.1098,
         0.1096],
        [0.1096, 0.1097, 0.1092, 0.1101, 0.1091, 0.0000, 0.1099, 0.1093, 0.1097,
         0.1094],
        [0.1089, 0.1088, 0.1090, 0.1093, 0.1098, 0.1099, 0.0000, 0.1088, 0.1096,
         0.1093],
        [0.1093, 0.1088, 0.1097, 0.1089, 0.1094, 0.1093, 0.1088, 0.0000, 0.1096,
         0.1092],
        [0.1094, 0.1096, 0.1098, 0.1097, 0.1098, 0.1097, 0.1096, 0.1096, 0.0000,
         0.1096],
        [0.1096, 0.1091, 0.1097, 0.1094, 0.1096, 0.1094, 0.1093, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5510275
Epoch746: train_loss: 4.0542 recon_acc: 0.6087 val_roc: 0.7746 val_ap: 0.8321 f1: 0.7081 time: 0.2842
difference_matrix tensor([[0.0000, 0.1092, 0.1096, 0.1092, 0.1094, 0.1096, 0.1089, 0.1093, 0.1094,
         0.1096],
        [0.1092, 0.0000, 0.1097, 0.1092, 0.1092, 0.1097, 0.1088, 0.1088, 0.1096,
         0.1091],
        [0.1096, 0.1097, 0.0000, 0.1098, 0.1098, 0.1092, 0.1090, 0.1097, 0.1098,
         0.1097],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1096, 0.1101, 0.1093, 0.1089, 0.1097,
         0.1093],
        [0.1094, 0.1092, 0.1098, 0.1096, 0.0000, 0.1091, 0.1098, 0.1094, 0.1097,
         0.1096],
        [0.1096, 0.1097, 0.1092, 0.1101, 0.1091, 0.0000, 0.1099, 0.1093, 0.1097,
         0.1094],
        [0.1089, 0.1088, 0.1090, 0.1093, 0.1098, 0.1099, 0.0000, 0.1088, 0.1096,
         0.1093],
        [0.1093, 0.1088, 0.1097, 0.1089, 0.1094, 0.1093, 0.1088, 0.0000, 0.1096,
         0.1092],
        [0.1094, 0.1096, 0.1098, 0.1097, 0.1097, 0.1097, 0.1096, 0.1096, 0.0000,
         0.1096],
        [0.1096, 0.1091, 0.1097, 0.1093, 0.1096, 0.1094, 0.1093, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5508228
Epoch747: train_loss: 4.0542 recon_acc: 0.6083 val_roc: 0.7746 val_ap: 0.8321 f1: 0.7081 time: 0.2488
difference_matrix tensor([[0.0000, 0.1092, 0.1096, 0.1092, 0.1094, 0.1096, 0.1089, 0.1093, 0.1094,
         0.1096],
        [0.1092, 0.0000, 0.1097, 0.1092, 0.1091, 0.1097, 0.1088, 0.1088, 0.1096,
         0.1091],
        [0.1096, 0.1097, 0.0000, 0.1098, 0.1098, 0.1092, 0.1090, 0.1097, 0.1098,
         0.1097],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1096, 0.1101, 0.1093, 0.1089, 0.1097,
         0.1093],
        [0.1094, 0.1091, 0.1098, 0.1096, 0.0000, 0.1091, 0.1098, 0.1094, 0.1097,
         0.1096],
        [0.1096, 0.1097, 0.1092, 0.1101, 0.1091, 0.0000, 0.1099, 0.1093, 0.1097,
         0.1094],
        [0.1089, 0.1088, 0.1090, 0.1093, 0.1098, 0.1099, 0.0000, 0.1087, 0.1096,
         0.1093],
        [0.1093, 0.1088, 0.1097, 0.1089, 0.1094, 0.1093, 0.1087, 0.0000, 0.1096,
         0.1092],
        [0.1094, 0.1096, 0.1098, 0.1097, 0.1097, 0.1097, 0.1096, 0.1096, 0.0000,
         0.1096],
        [0.1096, 0.1091, 0.1097, 0.1093, 0.1096, 0.1094, 0.1093, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55061847
Epoch748: train_loss: 4.0541 recon_acc: 0.6080 val_roc: 0.7746 val_ap: 0.8322 f1: 0.7081 time: 0.2800
difference_matrix tensor([[0.0000, 0.1092, 0.1096, 0.1092, 0.1094, 0.1096, 0.1089, 0.1093, 0.1094,
         0.1096],
        [0.1092, 0.0000, 0.1097, 0.1092, 0.1091, 0.1097, 0.1088, 0.1088, 0.1096,
         0.1091],
        [0.1096, 0.1097, 0.0000, 0.1098, 0.1098, 0.1092, 0.1090, 0.1097, 0.1098,
         0.1097],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1096, 0.1101, 0.1092, 0.1089, 0.1097,
         0.1093],
        [0.1094, 0.1091, 0.1098, 0.1096, 0.0000, 0.1091, 0.1098, 0.1094, 0.1097,
         0.1096],
        [0.1096, 0.1097, 0.1092, 0.1101, 0.1091, 0.0000, 0.1099, 0.1093, 0.1097,
         0.1094],
        [0.1089, 0.1088, 0.1090, 0.1092, 0.1098, 0.1099, 0.0000, 0.1087, 0.1096,
         0.1092],
        [0.1093, 0.1088, 0.1097, 0.1089, 0.1094, 0.1093, 0.1087, 0.0000, 0.1096,
         0.1092],
        [0.1094, 0.1096, 0.1098, 0.1097, 0.1097, 0.1097, 0.1096, 0.1096, 0.0000,
         0.1096],
        [0.1096, 0.1091, 0.1097, 0.1093, 0.1096, 0.1094, 0.1092, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5504144
Epoch749: train_loss: 4.0541 recon_acc: 0.6076 val_roc: 0.7746 val_ap: 0.8321 f1: 0.7081 time: 0.2638
difference_matrix tensor([[0.0000, 0.1092, 0.1096, 0.1092, 0.1094, 0.1096, 0.1089, 0.1093, 0.1094,
         0.1096],
        [0.1092, 0.0000, 0.1097, 0.1092, 0.1091, 0.1097, 0.1088, 0.1088, 0.1096,
         0.1091],
        [0.1096, 0.1097, 0.0000, 0.1098, 0.1098, 0.1092, 0.1090, 0.1097, 0.1098,
         0.1097],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1096, 0.1101, 0.1092, 0.1088, 0.1097,
         0.1093],
        [0.1094, 0.1091, 0.1098, 0.1096, 0.0000, 0.1091, 0.1098, 0.1094, 0.1097,
         0.1096],
        [0.1096, 0.1097, 0.1092, 0.1101, 0.1091, 0.0000, 0.1099, 0.1093, 0.1097,
         0.1094],
        [0.1089, 0.1088, 0.1090, 0.1092, 0.1098, 0.1099, 0.0000, 0.1087, 0.1096,
         0.1092],
        [0.1093, 0.1088, 0.1097, 0.1088, 0.1094, 0.1093, 0.1087, 0.0000, 0.1096,
         0.1092],
        [0.1094, 0.1096, 0.1098, 0.1097, 0.1097, 0.1097, 0.1096, 0.1096, 0.0000,
         0.1096],
        [0.1096, 0.1091, 0.1097, 0.1093, 0.1096, 0.1094, 0.1092, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5502108
Epoch750: train_loss: 4.0540 recon_acc: 0.6072 val_roc: 0.7746 val_ap: 0.8321 f1: 0.7081 time: 0.3831
difference_matrix tensor([[0.0000, 0.1092, 0.1096, 0.1092, 0.1094, 0.1096, 0.1089, 0.1093, 0.1094,
         0.1096],
        [0.1092, 0.0000, 0.1097, 0.1092, 0.1091, 0.1097, 0.1088, 0.1088, 0.1096,
         0.1091],
        [0.1096, 0.1097, 0.0000, 0.1098, 0.1098, 0.1092, 0.1090, 0.1097, 0.1098,
         0.1097],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1096, 0.1101, 0.1092, 0.1088, 0.1097,
         0.1093],
        [0.1094, 0.1091, 0.1098, 0.1096, 0.0000, 0.1090, 0.1098, 0.1094, 0.1097,
         0.1096],
        [0.1096, 0.1097, 0.1092, 0.1101, 0.1090, 0.0000, 0.1099, 0.1093, 0.1097,
         0.1094],
        [0.1089, 0.1088, 0.1090, 0.1092, 0.1098, 0.1099, 0.0000, 0.1087, 0.1096,
         0.1092],
        [0.1093, 0.1088, 0.1097, 0.1088, 0.1094, 0.1093, 0.1087, 0.0000, 0.1096,
         0.1092],
        [0.1094, 0.1096, 0.1098, 0.1097, 0.1097, 0.1097, 0.1096, 0.1096, 0.0000,
         0.1096],
        [0.1096, 0.1091, 0.1097, 0.1093, 0.1096, 0.1094, 0.1092, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55000734
Epoch751: train_loss: 4.0540 recon_acc: 0.6069 val_roc: 0.7746 val_ap: 0.8322 f1: 0.7081 time: 0.2581
difference_matrix tensor([[0.0000, 0.1092, 0.1096, 0.1092, 0.1094, 0.1096, 0.1089, 0.1092, 0.1093,
         0.1096],
        [0.1092, 0.0000, 0.1097, 0.1092, 0.1091, 0.1097, 0.1088, 0.1088, 0.1096,
         0.1090],
        [0.1096, 0.1097, 0.0000, 0.1098, 0.1098, 0.1092, 0.1090, 0.1097, 0.1097,
         0.1097],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1096, 0.1100, 0.1092, 0.1088, 0.1097,
         0.1093],
        [0.1094, 0.1091, 0.1098, 0.1096, 0.0000, 0.1090, 0.1098, 0.1094, 0.1097,
         0.1096],
        [0.1096, 0.1097, 0.1092, 0.1100, 0.1090, 0.0000, 0.1099, 0.1093, 0.1097,
         0.1094],
        [0.1089, 0.1088, 0.1090, 0.1092, 0.1098, 0.1099, 0.0000, 0.1087, 0.1096,
         0.1092],
        [0.1092, 0.1088, 0.1097, 0.1088, 0.1094, 0.1093, 0.1087, 0.0000, 0.1096,
         0.1092],
        [0.1093, 0.1096, 0.1097, 0.1097, 0.1097, 0.1097, 0.1096, 0.1096, 0.0000,
         0.1096],
        [0.1096, 0.1090, 0.1097, 0.1093, 0.1096, 0.1094, 0.1092, 0.1092, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5498042
Epoch752: train_loss: 4.0539 recon_acc: 0.6065 val_roc: 0.7746 val_ap: 0.8323 f1: 0.7081 time: 0.2621
difference_matrix tensor([[0.0000, 0.1092, 0.1096, 0.1092, 0.1094, 0.1096, 0.1089, 0.1092, 0.1093,
         0.1096],
        [0.1092, 0.0000, 0.1096, 0.1092, 0.1091, 0.1097, 0.1088, 0.1088, 0.1096,
         0.1090],
        [0.1096, 0.1096, 0.0000, 0.1098, 0.1098, 0.1092, 0.1090, 0.1097, 0.1097,
         0.1097],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1096, 0.1100, 0.1092, 0.1088, 0.1097,
         0.1093],
        [0.1094, 0.1091, 0.1098, 0.1096, 0.0000, 0.1090, 0.1098, 0.1094, 0.1097,
         0.1096],
        [0.1096, 0.1097, 0.1092, 0.1100, 0.1090, 0.0000, 0.1099, 0.1093, 0.1097,
         0.1093],
        [0.1089, 0.1088, 0.1090, 0.1092, 0.1098, 0.1099, 0.0000, 0.1087, 0.1096,
         0.1092],
        [0.1092, 0.1088, 0.1097, 0.1088, 0.1094, 0.1093, 0.1087, 0.0000, 0.1096,
         0.1091],
        [0.1093, 0.1096, 0.1097, 0.1097, 0.1097, 0.1097, 0.1096, 0.1096, 0.0000,
         0.1096],
        [0.1096, 0.1090, 0.1097, 0.1093, 0.1096, 0.1093, 0.1092, 0.1091, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.54960155
Epoch753: train_loss: 4.0539 recon_acc: 0.6062 val_roc: 0.7747 val_ap: 0.8323 f1: 0.7081 time: 0.2602
difference_matrix tensor([[0.0000, 0.1092, 0.1096, 0.1092, 0.1093, 0.1096, 0.1089, 0.1092, 0.1093,
         0.1096],
        [0.1092, 0.0000, 0.1096, 0.1092, 0.1091, 0.1097, 0.1088, 0.1087, 0.1096,
         0.1090],
        [0.1096, 0.1096, 0.0000, 0.1098, 0.1098, 0.1092, 0.1090, 0.1097, 0.1097,
         0.1097],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1096, 0.1100, 0.1092, 0.1088, 0.1097,
         0.1093],
        [0.1093, 0.1091, 0.1098, 0.1096, 0.0000, 0.1090, 0.1098, 0.1094, 0.1097,
         0.1095],
        [0.1096, 0.1097, 0.1092, 0.1100, 0.1090, 0.0000, 0.1099, 0.1093, 0.1097,
         0.1093],
        [0.1089, 0.1088, 0.1090, 0.1092, 0.1098, 0.1099, 0.0000, 0.1087, 0.1096,
         0.1092],
        [0.1092, 0.1087, 0.1097, 0.1088, 0.1094, 0.1093, 0.1087, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1096, 0.1097, 0.1097, 0.1097, 0.1097, 0.1096, 0.1095, 0.0000,
         0.1096],
        [0.1096, 0.1090, 0.1097, 0.1093, 0.1095, 0.1093, 0.1092, 0.1091, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55959564
Epoch754: train_loss: 4.0538 recon_acc: 0.6251 val_roc: 0.7748 val_ap: 0.8325 f1: 0.7071 time: 0.2699
thresh 0.44370872
          test_roc: 0.7855 test_ap: 0.8396 test_f1: 0.7086 test_recon_acc: 0.3983
difference_matrix tensor([[0.0000, 0.1092, 0.1096, 0.1092, 0.1093, 0.1096, 0.1089, 0.1092, 0.1093,
         0.1096],
        [0.1092, 0.0000, 0.1096, 0.1092, 0.1091, 0.1096, 0.1088, 0.1087, 0.1096,
         0.1090],
        [0.1096, 0.1096, 0.0000, 0.1098, 0.1097, 0.1092, 0.1090, 0.1097, 0.1097,
         0.1097],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1096, 0.1100, 0.1092, 0.1088, 0.1097,
         0.1093],
        [0.1093, 0.1091, 0.1097, 0.1096, 0.0000, 0.1090, 0.1098, 0.1094, 0.1097,
         0.1095],
        [0.1096, 0.1096, 0.1092, 0.1100, 0.1090, 0.0000, 0.1099, 0.1093, 0.1096,
         0.1093],
        [0.1089, 0.1088, 0.1090, 0.1092, 0.1098, 0.1099, 0.0000, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1087, 0.1097, 0.1088, 0.1094, 0.1093, 0.1087, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1096, 0.1097, 0.1097, 0.1097, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1096],
        [0.1096, 0.1090, 0.1097, 0.1093, 0.1095, 0.1093, 0.1092, 0.1091, 0.1096,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5596008
Epoch755: train_loss: 4.0538 recon_acc: 0.6252 val_roc: 0.7747 val_ap: 0.8325 f1: 0.7071 time: 0.2803
difference_matrix tensor([[0.0000, 0.1092, 0.1096, 0.1092, 0.1093, 0.1096, 0.1089, 0.1092, 0.1093,
         0.1096],
        [0.1092, 0.0000, 0.1096, 0.1092, 0.1091, 0.1096, 0.1088, 0.1087, 0.1096,
         0.1090],
        [0.1096, 0.1096, 0.0000, 0.1098, 0.1097, 0.1092, 0.1090, 0.1097, 0.1097,
         0.1097],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1096, 0.1100, 0.1092, 0.1088, 0.1097,
         0.1093],
        [0.1093, 0.1091, 0.1097, 0.1096, 0.0000, 0.1090, 0.1097, 0.1094, 0.1097,
         0.1095],
        [0.1096, 0.1096, 0.1092, 0.1100, 0.1090, 0.0000, 0.1099, 0.1093, 0.1096,
         0.1093],
        [0.1089, 0.1088, 0.1090, 0.1092, 0.1097, 0.1099, 0.0000, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1087, 0.1097, 0.1088, 0.1094, 0.1093, 0.1087, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1096, 0.1097, 0.1097, 0.1097, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1096, 0.1090, 0.1097, 0.1093, 0.1095, 0.1093, 0.1092, 0.1091, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55960506
Epoch756: train_loss: 4.0537 recon_acc: 0.6252 val_roc: 0.7748 val_ap: 0.8326 f1: 0.7071 time: 0.2537
difference_matrix tensor([[0.0000, 0.1092, 0.1096, 0.1092, 0.1093, 0.1096, 0.1089, 0.1092, 0.1093,
         0.1096],
        [0.1092, 0.0000, 0.1096, 0.1092, 0.1091, 0.1096, 0.1088, 0.1087, 0.1096,
         0.1090],
        [0.1096, 0.1096, 0.0000, 0.1098, 0.1097, 0.1092, 0.1090, 0.1097, 0.1097,
         0.1096],
        [0.1092, 0.1092, 0.1098, 0.0000, 0.1096, 0.1100, 0.1092, 0.1088, 0.1096,
         0.1093],
        [0.1093, 0.1091, 0.1097, 0.1096, 0.0000, 0.1090, 0.1097, 0.1094, 0.1097,
         0.1095],
        [0.1096, 0.1096, 0.1092, 0.1100, 0.1090, 0.0000, 0.1099, 0.1093, 0.1096,
         0.1093],
        [0.1089, 0.1088, 0.1090, 0.1092, 0.1097, 0.1099, 0.0000, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1087, 0.1097, 0.1088, 0.1094, 0.1093, 0.1087, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1096, 0.1097, 0.1096, 0.1097, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1096, 0.1090, 0.1096, 0.1093, 0.1095, 0.1093, 0.1092, 0.1091, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5596085
Epoch757: train_loss: 4.0537 recon_acc: 0.6253 val_roc: 0.7749 val_ap: 0.8326 f1: 0.7071 time: 0.2542
thresh 0.44421604
          test_roc: 0.7855 test_ap: 0.8397 test_f1: 0.7087 test_recon_acc: 0.3993
difference_matrix tensor([[0.0000, 0.1091, 0.1096, 0.1092, 0.1093, 0.1096, 0.1088, 0.1092, 0.1093,
         0.1096],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1091, 0.1096, 0.1088, 0.1087, 0.1096,
         0.1090],
        [0.1096, 0.1096, 0.0000, 0.1098, 0.1097, 0.1092, 0.1090, 0.1097, 0.1097,
         0.1096],
        [0.1092, 0.1091, 0.1098, 0.0000, 0.1096, 0.1100, 0.1092, 0.1088, 0.1096,
         0.1093],
        [0.1093, 0.1091, 0.1097, 0.1096, 0.0000, 0.1090, 0.1097, 0.1094, 0.1097,
         0.1095],
        [0.1096, 0.1096, 0.1092, 0.1100, 0.1090, 0.0000, 0.1099, 0.1092, 0.1096,
         0.1093],
        [0.1088, 0.1088, 0.1090, 0.1092, 0.1097, 0.1099, 0.0000, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1087, 0.1097, 0.1088, 0.1094, 0.1092, 0.1087, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1096, 0.1097, 0.1096, 0.1097, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1096, 0.1090, 0.1096, 0.1093, 0.1095, 0.1093, 0.1092, 0.1091, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5596111
Epoch758: train_loss: 4.0536 recon_acc: 0.6253 val_roc: 0.7749 val_ap: 0.8326 f1: 0.7071 time: 0.2780
difference_matrix tensor([[0.0000, 0.1091, 0.1096, 0.1092, 0.1093, 0.1095, 0.1088, 0.1092, 0.1093,
         0.1096],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1091, 0.1096, 0.1087, 0.1087, 0.1096,
         0.1090],
        [0.1096, 0.1096, 0.0000, 0.1098, 0.1097, 0.1091, 0.1089, 0.1097, 0.1097,
         0.1096],
        [0.1092, 0.1091, 0.1098, 0.0000, 0.1096, 0.1100, 0.1092, 0.1088, 0.1096,
         0.1093],
        [0.1093, 0.1091, 0.1097, 0.1096, 0.0000, 0.1090, 0.1097, 0.1094, 0.1097,
         0.1095],
        [0.1095, 0.1096, 0.1091, 0.1100, 0.1090, 0.0000, 0.1099, 0.1092, 0.1096,
         0.1093],
        [0.1088, 0.1087, 0.1089, 0.1092, 0.1097, 0.1099, 0.0000, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1087, 0.1097, 0.1088, 0.1094, 0.1092, 0.1087, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1096, 0.1097, 0.1096, 0.1097, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1096, 0.1090, 0.1096, 0.1093, 0.1095, 0.1093, 0.1092, 0.1091, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5596129
Epoch759: train_loss: 4.0536 recon_acc: 0.6253 val_roc: 0.7747 val_ap: 0.8326 f1: 0.7071 time: 0.2782
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1093, 0.1095, 0.1088, 0.1092, 0.1093,
         0.1095],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1091, 0.1096, 0.1087, 0.1087, 0.1096,
         0.1090],
        [0.1095, 0.1096, 0.0000, 0.1098, 0.1097, 0.1091, 0.1089, 0.1097, 0.1097,
         0.1096],
        [0.1091, 0.1091, 0.1098, 0.0000, 0.1095, 0.1100, 0.1092, 0.1088, 0.1096,
         0.1093],
        [0.1093, 0.1091, 0.1097, 0.1095, 0.0000, 0.1090, 0.1097, 0.1093, 0.1097,
         0.1095],
        [0.1095, 0.1096, 0.1091, 0.1100, 0.1090, 0.0000, 0.1099, 0.1092, 0.1096,
         0.1093],
        [0.1088, 0.1087, 0.1089, 0.1092, 0.1097, 0.1099, 0.0000, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1087, 0.1097, 0.1088, 0.1093, 0.1092, 0.1087, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1096, 0.1097, 0.1096, 0.1097, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1090, 0.1096, 0.1093, 0.1095, 0.1093, 0.1092, 0.1091, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0406, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55961376
Epoch760: train_loss: 4.0535 recon_acc: 0.6253 val_roc: 0.7748 val_ap: 0.8327 f1: 0.7071 time: 0.2572
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1093, 0.1095, 0.1088, 0.1092, 0.1093,
         0.1095],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1091, 0.1096, 0.1087, 0.1087, 0.1095,
         0.1090],
        [0.1095, 0.1096, 0.0000, 0.1098, 0.1097, 0.1091, 0.1089, 0.1096, 0.1097,
         0.1096],
        [0.1091, 0.1091, 0.1098, 0.0000, 0.1095, 0.1100, 0.1092, 0.1088, 0.1096,
         0.1093],
        [0.1093, 0.1091, 0.1097, 0.1095, 0.0000, 0.1090, 0.1097, 0.1093, 0.1097,
         0.1095],
        [0.1095, 0.1096, 0.1091, 0.1100, 0.1090, 0.0000, 0.1099, 0.1092, 0.1096,
         0.1093],
        [0.1088, 0.1087, 0.1089, 0.1092, 0.1097, 0.1099, 0.0000, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1087, 0.1096, 0.1088, 0.1093, 0.1092, 0.1087, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1095, 0.1097, 0.1096, 0.1097, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1090, 0.1096, 0.1093, 0.1095, 0.1093, 0.1092, 0.1091, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.564571
Epoch761: train_loss: 4.0535 recon_acc: 0.6348 val_roc: 0.7748 val_ap: 0.8327 f1: 0.7074 time: 0.2539
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1093, 0.1095, 0.1088, 0.1092, 0.1093,
         0.1095],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1091, 0.1096, 0.1087, 0.1087, 0.1095,
         0.1090],
        [0.1095, 0.1096, 0.0000, 0.1097, 0.1097, 0.1091, 0.1089, 0.1096, 0.1097,
         0.1096],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1100, 0.1092, 0.1088, 0.1096,
         0.1093],
        [0.1093, 0.1091, 0.1097, 0.1095, 0.0000, 0.1090, 0.1097, 0.1093, 0.1097,
         0.1095],
        [0.1095, 0.1096, 0.1091, 0.1100, 0.1090, 0.0000, 0.1099, 0.1092, 0.1096,
         0.1093],
        [0.1088, 0.1087, 0.1089, 0.1092, 0.1097, 0.1099, 0.0000, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1087, 0.1096, 0.1088, 0.1093, 0.1092, 0.1087, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1095, 0.1097, 0.1096, 0.1097, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1090, 0.1096, 0.1093, 0.1095, 0.1093, 0.1092, 0.1091, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.56476355
Epoch762: train_loss: 4.0534 recon_acc: 0.6351 val_roc: 0.7747 val_ap: 0.8327 f1: 0.7074 time: 0.2490
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1093, 0.1095, 0.1088, 0.1092, 0.1093,
         0.1095],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1091, 0.1096, 0.1087, 0.1087, 0.1095,
         0.1090],
        [0.1095, 0.1096, 0.0000, 0.1097, 0.1097, 0.1091, 0.1089, 0.1096, 0.1097,
         0.1096],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1100, 0.1092, 0.1088, 0.1096,
         0.1093],
        [0.1093, 0.1091, 0.1097, 0.1095, 0.0000, 0.1090, 0.1097, 0.1093, 0.1097,
         0.1095],
        [0.1095, 0.1096, 0.1091, 0.1100, 0.1090, 0.0000, 0.1099, 0.1092, 0.1096,
         0.1093],
        [0.1088, 0.1087, 0.1089, 0.1092, 0.1097, 0.1099, 0.0000, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1087, 0.1096, 0.1088, 0.1093, 0.1092, 0.1087, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1095, 0.1097, 0.1096, 0.1097, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1090, 0.1096, 0.1093, 0.1095, 0.1093, 0.1092, 0.1091, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.56495595
Epoch763: train_loss: 4.0534 recon_acc: 0.6355 val_roc: 0.7748 val_ap: 0.8327 f1: 0.7074 time: 0.2721
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1093, 0.1095, 0.1088, 0.1092, 0.1093,
         0.1095],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1091, 0.1096, 0.1087, 0.1087, 0.1095,
         0.1090],
        [0.1095, 0.1096, 0.0000, 0.1097, 0.1097, 0.1091, 0.1089, 0.1096, 0.1097,
         0.1096],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1100, 0.1092, 0.1088, 0.1096,
         0.1092],
        [0.1093, 0.1091, 0.1097, 0.1095, 0.0000, 0.1090, 0.1097, 0.1093, 0.1096,
         0.1095],
        [0.1095, 0.1096, 0.1091, 0.1100, 0.1090, 0.0000, 0.1098, 0.1092, 0.1096,
         0.1093],
        [0.1088, 0.1087, 0.1089, 0.1092, 0.1097, 0.1098, 0.0000, 0.1086, 0.1095,
         0.1092],
        [0.1092, 0.1087, 0.1096, 0.1088, 0.1093, 0.1092, 0.1086, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1095, 0.1097, 0.1096, 0.1096, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1090, 0.1096, 0.1092, 0.1095, 0.1093, 0.1092, 0.1091, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.56514823
Epoch764: train_loss: 4.0533 recon_acc: 0.6359 val_roc: 0.7749 val_ap: 0.8328 f1: 0.7074 time: 0.2824
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1093, 0.1095, 0.1088, 0.1092, 0.1093,
         0.1095],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1091, 0.1096, 0.1087, 0.1087, 0.1095,
         0.1090],
        [0.1095, 0.1096, 0.0000, 0.1097, 0.1097, 0.1091, 0.1089, 0.1096, 0.1097,
         0.1096],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1100, 0.1092, 0.1088, 0.1096,
         0.1092],
        [0.1093, 0.1091, 0.1097, 0.1095, 0.0000, 0.1090, 0.1097, 0.1093, 0.1096,
         0.1095],
        [0.1095, 0.1096, 0.1091, 0.1100, 0.1090, 0.0000, 0.1098, 0.1092, 0.1096,
         0.1093],
        [0.1088, 0.1087, 0.1089, 0.1092, 0.1097, 0.1098, 0.0000, 0.1086, 0.1095,
         0.1092],
        [0.1092, 0.1087, 0.1096, 0.1088, 0.1093, 0.1092, 0.1086, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1095, 0.1097, 0.1096, 0.1096, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1090, 0.1096, 0.1092, 0.1095, 0.1093, 0.1092, 0.1091, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.56534034
Epoch765: train_loss: 4.0533 recon_acc: 0.6363 val_roc: 0.7750 val_ap: 0.8330 f1: 0.7074 time: 0.2596
thresh 0.44412655
          test_roc: 0.7855 test_ap: 0.8398 test_f1: 0.7080 test_recon_acc: 0.3993
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1093, 0.1095, 0.1088, 0.1092, 0.1093,
         0.1095],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1090, 0.1096, 0.1087, 0.1087, 0.1095,
         0.1090],
        [0.1095, 0.1096, 0.0000, 0.1097, 0.1097, 0.1091, 0.1089, 0.1096, 0.1096,
         0.1096],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1100, 0.1092, 0.1088, 0.1096,
         0.1092],
        [0.1093, 0.1090, 0.1097, 0.1095, 0.0000, 0.1090, 0.1097, 0.1093, 0.1096,
         0.1095],
        [0.1095, 0.1096, 0.1091, 0.1100, 0.1090, 0.0000, 0.1098, 0.1092, 0.1096,
         0.1093],
        [0.1088, 0.1087, 0.1089, 0.1092, 0.1097, 0.1098, 0.0000, 0.1086, 0.1095,
         0.1091],
        [0.1092, 0.1087, 0.1096, 0.1088, 0.1093, 0.1092, 0.1086, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1095, 0.1096, 0.1096, 0.1096, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1090, 0.1096, 0.1092, 0.1095, 0.1093, 0.1091, 0.1091, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.56553245
Epoch766: train_loss: 4.0532 recon_acc: 0.6367 val_roc: 0.7749 val_ap: 0.8329 f1: 0.7074 time: 0.2525
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1093, 0.1095, 0.1088, 0.1092, 0.1093,
         0.1095],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1090, 0.1096, 0.1087, 0.1087, 0.1095,
         0.1090],
        [0.1095, 0.1096, 0.0000, 0.1097, 0.1097, 0.1091, 0.1089, 0.1096, 0.1096,
         0.1096],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1100, 0.1091, 0.1088, 0.1096,
         0.1092],
        [0.1093, 0.1090, 0.1097, 0.1095, 0.0000, 0.1089, 0.1097, 0.1093, 0.1096,
         0.1095],
        [0.1095, 0.1096, 0.1091, 0.1100, 0.1089, 0.0000, 0.1098, 0.1092, 0.1096,
         0.1093],
        [0.1088, 0.1087, 0.1089, 0.1091, 0.1097, 0.1098, 0.0000, 0.1086, 0.1095,
         0.1091],
        [0.1092, 0.1087, 0.1096, 0.1088, 0.1093, 0.1092, 0.1086, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1095, 0.1096, 0.1096, 0.1096, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1090, 0.1096, 0.1092, 0.1095, 0.1093, 0.1091, 0.1091, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5657243
Epoch767: train_loss: 4.0532 recon_acc: 0.6371 val_roc: 0.7749 val_ap: 0.8328 f1: 0.7074 time: 0.2608
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1093, 0.1095, 0.1088, 0.1092, 0.1093,
         0.1095],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1090, 0.1096, 0.1087, 0.1087, 0.1095,
         0.1089],
        [0.1095, 0.1096, 0.0000, 0.1097, 0.1097, 0.1091, 0.1089, 0.1096, 0.1096,
         0.1096],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1100, 0.1091, 0.1087, 0.1096,
         0.1092],
        [0.1093, 0.1090, 0.1097, 0.1095, 0.0000, 0.1089, 0.1097, 0.1093, 0.1096,
         0.1095],
        [0.1095, 0.1096, 0.1091, 0.1100, 0.1089, 0.0000, 0.1098, 0.1092, 0.1096,
         0.1093],
        [0.1088, 0.1087, 0.1089, 0.1091, 0.1097, 0.1098, 0.0000, 0.1086, 0.1095,
         0.1091],
        [0.1092, 0.1087, 0.1096, 0.1087, 0.1093, 0.1092, 0.1086, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1095, 0.1096, 0.1096, 0.1096, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1089, 0.1096, 0.1092, 0.1095, 0.1093, 0.1091, 0.1091, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5659162
Epoch768: train_loss: 4.0531 recon_acc: 0.6375 val_roc: 0.7750 val_ap: 0.8329 f1: 0.7074 time: 0.2661
thresh 0.44272608
          test_roc: 0.7854 test_ap: 0.8398 test_f1: 0.7086 test_recon_acc: 0.3966
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1093, 0.1095, 0.1088, 0.1092, 0.1093,
         0.1095],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1090, 0.1096, 0.1087, 0.1087, 0.1095,
         0.1089],
        [0.1095, 0.1096, 0.0000, 0.1097, 0.1097, 0.1091, 0.1089, 0.1096, 0.1096,
         0.1096],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1100, 0.1091, 0.1087, 0.1096,
         0.1092],
        [0.1093, 0.1090, 0.1097, 0.1095, 0.0000, 0.1089, 0.1097, 0.1093, 0.1096,
         0.1095],
        [0.1095, 0.1096, 0.1091, 0.1100, 0.1089, 0.0000, 0.1098, 0.1092, 0.1096,
         0.1093],
        [0.1088, 0.1087, 0.1089, 0.1091, 0.1097, 0.1098, 0.0000, 0.1086, 0.1095,
         0.1091],
        [0.1092, 0.1087, 0.1096, 0.1087, 0.1093, 0.1092, 0.1086, 0.0000, 0.1095,
         0.1091],
        [0.1093, 0.1095, 0.1096, 0.1096, 0.1096, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1089, 0.1096, 0.1092, 0.1095, 0.1093, 0.1091, 0.1091, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.56608945
Epoch769: train_loss: 4.0531 recon_acc: 0.6378 val_roc: 0.7751 val_ap: 0.8330 f1: 0.7074 time: 0.2711
thresh 0.44259718
          test_roc: 0.7855 test_ap: 0.8398 test_f1: 0.7086 test_recon_acc: 0.3963
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1093, 0.1095, 0.1088, 0.1091, 0.1093,
         0.1095],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1090, 0.1096, 0.1087, 0.1087, 0.1095,
         0.1089],
        [0.1095, 0.1096, 0.0000, 0.1097, 0.1097, 0.1091, 0.1089, 0.1096, 0.1096,
         0.1096],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1100, 0.1091, 0.1087, 0.1096,
         0.1092],
        [0.1093, 0.1090, 0.1097, 0.1095, 0.0000, 0.1089, 0.1097, 0.1093, 0.1096,
         0.1095],
        [0.1095, 0.1096, 0.1091, 0.1100, 0.1089, 0.0000, 0.1098, 0.1092, 0.1096,
         0.1093],
        [0.1088, 0.1087, 0.1089, 0.1091, 0.1097, 0.1098, 0.0000, 0.1086, 0.1095,
         0.1091],
        [0.1091, 0.1087, 0.1096, 0.1087, 0.1093, 0.1092, 0.1086, 0.0000, 0.1095,
         0.1090],
        [0.1093, 0.1095, 0.1096, 0.1096, 0.1096, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1089, 0.1096, 0.1092, 0.1095, 0.1093, 0.1091, 0.1090, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57900584
Epoch770: train_loss: 4.0530 recon_acc: 0.6618 val_roc: 0.7751 val_ap: 0.8330 f1: 0.7084 time: 0.2517
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1092, 0.1095, 0.1088, 0.1091, 0.1092,
         0.1095],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1090, 0.1096, 0.1087, 0.1086, 0.1095,
         0.1089],
        [0.1095, 0.1096, 0.0000, 0.1097, 0.1097, 0.1091, 0.1089, 0.1096, 0.1096,
         0.1096],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1100, 0.1091, 0.1087, 0.1096,
         0.1092],
        [0.1092, 0.1090, 0.1097, 0.1095, 0.0000, 0.1089, 0.1097, 0.1093, 0.1096,
         0.1094],
        [0.1095, 0.1096, 0.1091, 0.1100, 0.1089, 0.0000, 0.1098, 0.1092, 0.1096,
         0.1092],
        [0.1088, 0.1087, 0.1089, 0.1091, 0.1097, 0.1098, 0.0000, 0.1086, 0.1095,
         0.1091],
        [0.1091, 0.1086, 0.1096, 0.1087, 0.1093, 0.1092, 0.1086, 0.0000, 0.1095,
         0.1090],
        [0.1092, 0.1095, 0.1096, 0.1096, 0.1096, 0.1096, 0.1095, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1089, 0.1096, 0.1092, 0.1094, 0.1092, 0.1091, 0.1090, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5791831
Epoch771: train_loss: 4.0530 recon_acc: 0.6622 val_roc: 0.7750 val_ap: 0.8329 f1: 0.7084 time: 0.2763
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1092, 0.1095, 0.1088, 0.1091, 0.1092,
         0.1095],
        [0.1091, 0.0000, 0.1096, 0.1091, 0.1090, 0.1096, 0.1087, 0.1086, 0.1095,
         0.1089],
        [0.1095, 0.1096, 0.0000, 0.1097, 0.1096, 0.1091, 0.1089, 0.1096, 0.1096,
         0.1096],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1099, 0.1091, 0.1087, 0.1096,
         0.1092],
        [0.1092, 0.1090, 0.1096, 0.1095, 0.0000, 0.1089, 0.1097, 0.1093, 0.1096,
         0.1094],
        [0.1095, 0.1096, 0.1091, 0.1099, 0.1089, 0.0000, 0.1098, 0.1092, 0.1096,
         0.1092],
        [0.1088, 0.1087, 0.1089, 0.1091, 0.1097, 0.1098, 0.0000, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1086, 0.1096, 0.1087, 0.1093, 0.1092, 0.1086, 0.0000, 0.1095,
         0.1090],
        [0.1092, 0.1095, 0.1096, 0.1096, 0.1096, 0.1096, 0.1094, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1089, 0.1096, 0.1092, 0.1094, 0.1092, 0.1091, 0.1090, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57936037
Epoch772: train_loss: 4.0530 recon_acc: 0.6626 val_roc: 0.7750 val_ap: 0.8330 f1: 0.7084 time: 0.2618
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1092, 0.1095, 0.1088, 0.1091, 0.1092,
         0.1095],
        [0.1091, 0.0000, 0.1095, 0.1091, 0.1090, 0.1096, 0.1087, 0.1086, 0.1095,
         0.1089],
        [0.1095, 0.1095, 0.0000, 0.1097, 0.1096, 0.1091, 0.1089, 0.1096, 0.1096,
         0.1096],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1099, 0.1091, 0.1087, 0.1096,
         0.1092],
        [0.1092, 0.1090, 0.1096, 0.1095, 0.0000, 0.1089, 0.1097, 0.1093, 0.1096,
         0.1094],
        [0.1095, 0.1096, 0.1091, 0.1099, 0.1089, 0.0000, 0.1098, 0.1092, 0.1096,
         0.1092],
        [0.1088, 0.1087, 0.1089, 0.1091, 0.1097, 0.1098, 0.0000, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1086, 0.1096, 0.1087, 0.1093, 0.1092, 0.1086, 0.0000, 0.1095,
         0.1090],
        [0.1092, 0.1095, 0.1096, 0.1096, 0.1096, 0.1096, 0.1094, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1089, 0.1096, 0.1092, 0.1094, 0.1092, 0.1091, 0.1090, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57953763
Epoch773: train_loss: 4.0529 recon_acc: 0.6629 val_roc: 0.7749 val_ap: 0.8329 f1: 0.7084 time: 0.2763
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1092, 0.1095, 0.1087, 0.1091, 0.1092,
         0.1095],
        [0.1091, 0.0000, 0.1095, 0.1091, 0.1090, 0.1095, 0.1087, 0.1086, 0.1095,
         0.1089],
        [0.1095, 0.1095, 0.0000, 0.1097, 0.1096, 0.1090, 0.1089, 0.1096, 0.1096,
         0.1096],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1099, 0.1091, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1090, 0.1096, 0.1095, 0.0000, 0.1089, 0.1097, 0.1093, 0.1096,
         0.1094],
        [0.1095, 0.1095, 0.1090, 0.1099, 0.1089, 0.0000, 0.1098, 0.1091, 0.1096,
         0.1092],
        [0.1087, 0.1087, 0.1089, 0.1091, 0.1097, 0.1098, 0.0000, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1086, 0.1096, 0.1087, 0.1093, 0.1091, 0.1086, 0.0000, 0.1095,
         0.1090],
        [0.1092, 0.1095, 0.1096, 0.1095, 0.1096, 0.1096, 0.1094, 0.1095, 0.0000,
         0.1095],
        [0.1095, 0.1089, 0.1096, 0.1092, 0.1094, 0.1092, 0.1091, 0.1090, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5797149
Epoch774: train_loss: 4.0529 recon_acc: 0.6632 val_roc: 0.7749 val_ap: 0.8329 f1: 0.7084 time: 0.2786
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1092, 0.1095, 0.1087, 0.1091, 0.1092,
         0.1095],
        [0.1091, 0.0000, 0.1095, 0.1091, 0.1090, 0.1095, 0.1087, 0.1086, 0.1095,
         0.1089],
        [0.1095, 0.1095, 0.0000, 0.1097, 0.1096, 0.1090, 0.1088, 0.1096, 0.1096,
         0.1095],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1099, 0.1091, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1090, 0.1096, 0.1095, 0.0000, 0.1089, 0.1096, 0.1093, 0.1096,
         0.1094],
        [0.1095, 0.1095, 0.1090, 0.1099, 0.1089, 0.0000, 0.1098, 0.1091, 0.1096,
         0.1092],
        [0.1087, 0.1087, 0.1088, 0.1091, 0.1096, 0.1098, 0.0000, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1086, 0.1096, 0.1087, 0.1093, 0.1091, 0.1086, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1095, 0.1096, 0.1095, 0.1096, 0.1096, 0.1094, 0.1094, 0.0000,
         0.1095],
        [0.1095, 0.1089, 0.1095, 0.1092, 0.1094, 0.1092, 0.1091, 0.1090, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5798921
Epoch775: train_loss: 4.0528 recon_acc: 0.6636 val_roc: 0.7750 val_ap: 0.8329 f1: 0.7084 time: 0.2556
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1092, 0.1094, 0.1087, 0.1091, 0.1092,
         0.1095],
        [0.1091, 0.0000, 0.1095, 0.1091, 0.1090, 0.1095, 0.1086, 0.1086, 0.1095,
         0.1089],
        [0.1095, 0.1095, 0.0000, 0.1097, 0.1096, 0.1090, 0.1088, 0.1096, 0.1096,
         0.1095],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1099, 0.1091, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1090, 0.1096, 0.1095, 0.0000, 0.1089, 0.1096, 0.1093, 0.1096,
         0.1094],
        [0.1094, 0.1095, 0.1090, 0.1099, 0.1089, 0.0000, 0.1098, 0.1091, 0.1095,
         0.1092],
        [0.1087, 0.1086, 0.1088, 0.1091, 0.1096, 0.1098, 0.0000, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1086, 0.1096, 0.1087, 0.1093, 0.1091, 0.1086, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1095, 0.1096, 0.1095, 0.1096, 0.1095, 0.1094, 0.1094, 0.0000,
         0.1095],
        [0.1095, 0.1089, 0.1095, 0.1092, 0.1094, 0.1092, 0.1091, 0.1090, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.56577927
Epoch776: train_loss: 4.0528 recon_acc: 0.6374 val_roc: 0.7749 val_ap: 0.8329 f1: 0.7089 time: 0.2656
difference_matrix tensor([[0.0000, 0.1091, 0.1095, 0.1091, 0.1092, 0.1094, 0.1087, 0.1091, 0.1092,
         0.1095],
        [0.1091, 0.0000, 0.1095, 0.1091, 0.1090, 0.1095, 0.1086, 0.1086, 0.1095,
         0.1089],
        [0.1095, 0.1095, 0.0000, 0.1097, 0.1096, 0.1090, 0.1088, 0.1096, 0.1096,
         0.1095],
        [0.1091, 0.1091, 0.1097, 0.0000, 0.1095, 0.1099, 0.1091, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1090, 0.1096, 0.1095, 0.0000, 0.1089, 0.1096, 0.1093, 0.1096,
         0.1094],
        [0.1094, 0.1095, 0.1090, 0.1099, 0.1089, 0.0000, 0.1098, 0.1091, 0.1095,
         0.1092],
        [0.1087, 0.1086, 0.1088, 0.1091, 0.1096, 0.1098, 0.0000, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1086, 0.1096, 0.1087, 0.1093, 0.1091, 0.1086, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1095, 0.1096, 0.1095, 0.1096, 0.1095, 0.1094, 0.1094, 0.0000,
         0.1095],
        [0.1095, 0.1089, 0.1095, 0.1092, 0.1094, 0.1092, 0.1091, 0.1090, 0.1095,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.565735
Epoch777: train_loss: 4.0527 recon_acc: 0.6373 val_roc: 0.7750 val_ap: 0.8329 f1: 0.7089 time: 0.2685
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1092, 0.1094, 0.1087, 0.1091, 0.1092,
         0.1095],
        [0.1090, 0.0000, 0.1095, 0.1091, 0.1090, 0.1095, 0.1086, 0.1086, 0.1095,
         0.1089],
        [0.1094, 0.1095, 0.0000, 0.1097, 0.1096, 0.1090, 0.1088, 0.1096, 0.1096,
         0.1095],
        [0.1090, 0.1091, 0.1097, 0.0000, 0.1094, 0.1099, 0.1091, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1090, 0.1096, 0.1094, 0.0000, 0.1089, 0.1096, 0.1092, 0.1096,
         0.1094],
        [0.1094, 0.1095, 0.1090, 0.1099, 0.1089, 0.0000, 0.1098, 0.1091, 0.1095,
         0.1092],
        [0.1087, 0.1086, 0.1088, 0.1091, 0.1096, 0.1098, 0.0000, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1086, 0.1096, 0.1087, 0.1092, 0.1091, 0.1086, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1095, 0.1096, 0.1095, 0.1096, 0.1095, 0.1094, 0.1094, 0.0000,
         0.1094],
        [0.1095, 0.1089, 0.1095, 0.1092, 0.1094, 0.1092, 0.1091, 0.1090, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0407, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5656905
Epoch778: train_loss: 4.0527 recon_acc: 0.6373 val_roc: 0.7749 val_ap: 0.8329 f1: 0.7089 time: 0.2810
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1092, 0.1094, 0.1087, 0.1091, 0.1092,
         0.1095],
        [0.1090, 0.0000, 0.1095, 0.1091, 0.1090, 0.1095, 0.1086, 0.1086, 0.1095,
         0.1089],
        [0.1094, 0.1095, 0.0000, 0.1097, 0.1096, 0.1090, 0.1088, 0.1096, 0.1096,
         0.1095],
        [0.1090, 0.1091, 0.1097, 0.0000, 0.1094, 0.1099, 0.1091, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1090, 0.1096, 0.1094, 0.0000, 0.1089, 0.1096, 0.1092, 0.1096,
         0.1094],
        [0.1094, 0.1095, 0.1090, 0.1099, 0.1089, 0.0000, 0.1098, 0.1091, 0.1095,
         0.1092],
        [0.1087, 0.1086, 0.1088, 0.1091, 0.1096, 0.1098, 0.0000, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1086, 0.1096, 0.1087, 0.1092, 0.1091, 0.1086, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1095, 0.1096, 0.1095, 0.1096, 0.1095, 0.1094, 0.1094, 0.0000,
         0.1094],
        [0.1095, 0.1089, 0.1095, 0.1092, 0.1094, 0.1092, 0.1091, 0.1090, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5772113
Epoch779: train_loss: 4.0526 recon_acc: 0.6588 val_roc: 0.7751 val_ap: 0.8330 f1: 0.7097 time: 0.2758
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1092, 0.1094, 0.1087, 0.1091, 0.1092,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1090, 0.1095, 0.1086, 0.1086, 0.1095,
         0.1089],
        [0.1094, 0.1095, 0.0000, 0.1097, 0.1096, 0.1090, 0.1088, 0.1095, 0.1096,
         0.1095],
        [0.1090, 0.1090, 0.1097, 0.0000, 0.1094, 0.1099, 0.1091, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1090, 0.1096, 0.1094, 0.0000, 0.1089, 0.1096, 0.1092, 0.1096,
         0.1094],
        [0.1094, 0.1095, 0.1090, 0.1099, 0.1089, 0.0000, 0.1098, 0.1091, 0.1095,
         0.1092],
        [0.1087, 0.1086, 0.1088, 0.1091, 0.1096, 0.1098, 0.0000, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1086, 0.1095, 0.1087, 0.1092, 0.1091, 0.1086, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1095, 0.1096, 0.1095, 0.1096, 0.1095, 0.1094, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1089, 0.1095, 0.1092, 0.1094, 0.1092, 0.1091, 0.1090, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5772914
Epoch780: train_loss: 4.0526 recon_acc: 0.6589 val_roc: 0.7751 val_ap: 0.8330 f1: 0.7097 time: 0.2568
thresh 0.43716186
          test_roc: 0.7855 test_ap: 0.8399 test_f1: 0.7076 test_recon_acc: 0.3859
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1092, 0.1094, 0.1087, 0.1091, 0.1092,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1090, 0.1095, 0.1086, 0.1086, 0.1094,
         0.1089],
        [0.1094, 0.1095, 0.0000, 0.1097, 0.1096, 0.1090, 0.1088, 0.1095, 0.1096,
         0.1095],
        [0.1090, 0.1090, 0.1097, 0.0000, 0.1094, 0.1099, 0.1091, 0.1087, 0.1095,
         0.1092],
        [0.1092, 0.1090, 0.1096, 0.1094, 0.0000, 0.1089, 0.1096, 0.1092, 0.1096,
         0.1094],
        [0.1094, 0.1095, 0.1090, 0.1099, 0.1089, 0.0000, 0.1098, 0.1091, 0.1095,
         0.1092],
        [0.1087, 0.1086, 0.1088, 0.1091, 0.1096, 0.1098, 0.0000, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1086, 0.1095, 0.1087, 0.1092, 0.1091, 0.1086, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1094, 0.1096, 0.1095, 0.1096, 0.1095, 0.1094, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1089, 0.1095, 0.1092, 0.1094, 0.1092, 0.1091, 0.1090, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5773711
Epoch781: train_loss: 4.0525 recon_acc: 0.6591 val_roc: 0.7751 val_ap: 0.8330 f1: 0.7097 time: 0.2492
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1092, 0.1094, 0.1087, 0.1091, 0.1092,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1090, 0.1095, 0.1086, 0.1086, 0.1094,
         0.1089],
        [0.1094, 0.1095, 0.0000, 0.1097, 0.1096, 0.1090, 0.1088, 0.1095, 0.1095,
         0.1095],
        [0.1090, 0.1090, 0.1097, 0.0000, 0.1094, 0.1099, 0.1091, 0.1087, 0.1095,
         0.1091],
        [0.1092, 0.1090, 0.1096, 0.1094, 0.0000, 0.1089, 0.1096, 0.1092, 0.1096,
         0.1094],
        [0.1094, 0.1095, 0.1090, 0.1099, 0.1089, 0.0000, 0.1098, 0.1091, 0.1095,
         0.1092],
        [0.1087, 0.1086, 0.1088, 0.1091, 0.1096, 0.1098, 0.0000, 0.1085, 0.1094,
         0.1091],
        [0.1091, 0.1086, 0.1095, 0.1087, 0.1092, 0.1091, 0.1085, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1094, 0.1095, 0.1095, 0.1096, 0.1095, 0.1094, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1089, 0.1095, 0.1091, 0.1094, 0.1092, 0.1091, 0.1090, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57745034
Epoch782: train_loss: 4.0525 recon_acc: 0.6593 val_roc: 0.7751 val_ap: 0.8331 f1: 0.7097 time: 0.2685
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1092, 0.1094, 0.1087, 0.1091, 0.1092,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1090, 0.1095, 0.1086, 0.1086, 0.1094,
         0.1089],
        [0.1094, 0.1095, 0.0000, 0.1096, 0.1096, 0.1090, 0.1088, 0.1095, 0.1095,
         0.1095],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1099, 0.1091, 0.1087, 0.1095,
         0.1091],
        [0.1092, 0.1090, 0.1096, 0.1094, 0.0000, 0.1089, 0.1096, 0.1092, 0.1095,
         0.1094],
        [0.1094, 0.1095, 0.1090, 0.1099, 0.1089, 0.0000, 0.1098, 0.1091, 0.1095,
         0.1092],
        [0.1087, 0.1086, 0.1088, 0.1091, 0.1096, 0.1098, 0.0000, 0.1085, 0.1094,
         0.1091],
        [0.1091, 0.1086, 0.1095, 0.1087, 0.1092, 0.1091, 0.1085, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1094, 0.1095, 0.1095, 0.1095, 0.1095, 0.1094, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1089, 0.1095, 0.1091, 0.1094, 0.1092, 0.1091, 0.1090, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57752913
Epoch783: train_loss: 4.0525 recon_acc: 0.6595 val_roc: 0.7750 val_ap: 0.8330 f1: 0.7097 time: 0.2684
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1092, 0.1094, 0.1087, 0.1091, 0.1092,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1090, 0.1095, 0.1086, 0.1086, 0.1094,
         0.1089],
        [0.1094, 0.1095, 0.0000, 0.1096, 0.1096, 0.1090, 0.1088, 0.1095, 0.1095,
         0.1095],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1099, 0.1091, 0.1087, 0.1095,
         0.1091],
        [0.1092, 0.1090, 0.1096, 0.1094, 0.0000, 0.1089, 0.1096, 0.1092, 0.1095,
         0.1094],
        [0.1094, 0.1095, 0.1090, 0.1099, 0.1089, 0.0000, 0.1098, 0.1091, 0.1095,
         0.1092],
        [0.1087, 0.1086, 0.1088, 0.1091, 0.1096, 0.1098, 0.0000, 0.1085, 0.1094,
         0.1090],
        [0.1091, 0.1086, 0.1095, 0.1087, 0.1092, 0.1091, 0.1085, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1094, 0.1095, 0.1095, 0.1095, 0.1095, 0.1094, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1089, 0.1095, 0.1091, 0.1094, 0.1092, 0.1090, 0.1090, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57760745
Epoch784: train_loss: 4.0524 recon_acc: 0.6596 val_roc: 0.7750 val_ap: 0.8331 f1: 0.7097 time: 0.2757
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1092, 0.1094, 0.1087, 0.1091, 0.1092,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1089, 0.1095, 0.1086, 0.1086, 0.1094,
         0.1089],
        [0.1094, 0.1095, 0.0000, 0.1096, 0.1096, 0.1090, 0.1088, 0.1095, 0.1095,
         0.1095],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1099, 0.1091, 0.1087, 0.1095,
         0.1091],
        [0.1092, 0.1089, 0.1096, 0.1094, 0.0000, 0.1089, 0.1096, 0.1092, 0.1095,
         0.1094],
        [0.1094, 0.1095, 0.1090, 0.1099, 0.1089, 0.0000, 0.1098, 0.1091, 0.1095,
         0.1092],
        [0.1087, 0.1086, 0.1088, 0.1091, 0.1096, 0.1098, 0.0000, 0.1085, 0.1094,
         0.1090],
        [0.1091, 0.1086, 0.1095, 0.1087, 0.1092, 0.1091, 0.1085, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1094, 0.1095, 0.1095, 0.1095, 0.1095, 0.1094, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1089, 0.1095, 0.1091, 0.1094, 0.1092, 0.1090, 0.1090, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57768536
Epoch785: train_loss: 4.0524 recon_acc: 0.6598 val_roc: 0.7750 val_ap: 0.8331 f1: 0.7097 time: 0.2575
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1092, 0.1094, 0.1087, 0.1091, 0.1092,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1089, 0.1095, 0.1086, 0.1086, 0.1094,
         0.1088],
        [0.1094, 0.1095, 0.0000, 0.1096, 0.1096, 0.1090, 0.1088, 0.1095, 0.1095,
         0.1095],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1099, 0.1091, 0.1087, 0.1095,
         0.1091],
        [0.1092, 0.1089, 0.1096, 0.1094, 0.0000, 0.1088, 0.1096, 0.1092, 0.1095,
         0.1094],
        [0.1094, 0.1095, 0.1090, 0.1099, 0.1088, 0.0000, 0.1097, 0.1091, 0.1095,
         0.1092],
        [0.1087, 0.1086, 0.1088, 0.1091, 0.1096, 0.1097, 0.0000, 0.1085, 0.1094,
         0.1090],
        [0.1091, 0.1086, 0.1095, 0.1087, 0.1092, 0.1091, 0.1085, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1094, 0.1095, 0.1095, 0.1095, 0.1095, 0.1094, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1095, 0.1091, 0.1094, 0.1092, 0.1090, 0.1090, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5777628
Epoch786: train_loss: 4.0523 recon_acc: 0.6600 val_roc: 0.7750 val_ap: 0.8332 f1: 0.7097 time: 0.2540
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1092, 0.1094, 0.1087, 0.1091, 0.1092,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1089, 0.1095, 0.1086, 0.1086, 0.1094,
         0.1088],
        [0.1094, 0.1095, 0.0000, 0.1096, 0.1096, 0.1090, 0.1088, 0.1095, 0.1095,
         0.1095],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1099, 0.1090, 0.1087, 0.1095,
         0.1091],
        [0.1092, 0.1089, 0.1096, 0.1094, 0.0000, 0.1088, 0.1096, 0.1092, 0.1095,
         0.1094],
        [0.1094, 0.1095, 0.1090, 0.1099, 0.1088, 0.0000, 0.1097, 0.1091, 0.1095,
         0.1092],
        [0.1087, 0.1086, 0.1088, 0.1090, 0.1096, 0.1097, 0.0000, 0.1085, 0.1094,
         0.1090],
        [0.1091, 0.1086, 0.1095, 0.1087, 0.1092, 0.1091, 0.1085, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1094, 0.1095, 0.1095, 0.1095, 0.1095, 0.1094, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1095, 0.1091, 0.1094, 0.1092, 0.1090, 0.1090, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57783973
Epoch787: train_loss: 4.0523 recon_acc: 0.6601 val_roc: 0.7750 val_ap: 0.8332 f1: 0.7097 time: 0.2679
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1092, 0.1094, 0.1087, 0.1091, 0.1092,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1089, 0.1095, 0.1086, 0.1086, 0.1094,
         0.1088],
        [0.1094, 0.1095, 0.0000, 0.1096, 0.1096, 0.1090, 0.1088, 0.1095, 0.1095,
         0.1095],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1099, 0.1090, 0.1087, 0.1095,
         0.1091],
        [0.1092, 0.1089, 0.1096, 0.1094, 0.0000, 0.1088, 0.1096, 0.1092, 0.1095,
         0.1094],
        [0.1094, 0.1095, 0.1090, 0.1099, 0.1088, 0.0000, 0.1097, 0.1091, 0.1095,
         0.1092],
        [0.1087, 0.1086, 0.1088, 0.1090, 0.1096, 0.1097, 0.0000, 0.1085, 0.1094,
         0.1090],
        [0.1091, 0.1086, 0.1095, 0.1087, 0.1092, 0.1091, 0.1085, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1094, 0.1095, 0.1095, 0.1095, 0.1095, 0.1094, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1095, 0.1091, 0.1094, 0.1092, 0.1090, 0.1090, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.56972396
Epoch788: train_loss: 4.0522 recon_acc: 0.6450 val_roc: 0.7751 val_ap: 0.8332 f1: 0.7106 time: 0.2776
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1092, 0.1094, 0.1087, 0.1090, 0.1092,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1089, 0.1095, 0.1086, 0.1086, 0.1094,
         0.1088],
        [0.1094, 0.1095, 0.0000, 0.1096, 0.1096, 0.1090, 0.1088, 0.1095, 0.1095,
         0.1095],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1099, 0.1090, 0.1086, 0.1095,
         0.1091],
        [0.1092, 0.1089, 0.1096, 0.1094, 0.0000, 0.1088, 0.1096, 0.1092, 0.1095,
         0.1094],
        [0.1094, 0.1095, 0.1090, 0.1099, 0.1088, 0.0000, 0.1097, 0.1091, 0.1095,
         0.1092],
        [0.1087, 0.1086, 0.1088, 0.1090, 0.1096, 0.1097, 0.0000, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1086, 0.1095, 0.1086, 0.1092, 0.1091, 0.1085, 0.0000, 0.1094,
         0.1090],
        [0.1092, 0.1094, 0.1095, 0.1095, 0.1095, 0.1095, 0.1093, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1095, 0.1091, 0.1094, 0.1092, 0.1090, 0.1090, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.56991285
Epoch789: train_loss: 4.0522 recon_acc: 0.6454 val_roc: 0.7750 val_ap: 0.8332 f1: 0.7106 time: 0.2846
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1091, 0.1094, 0.1087, 0.1090, 0.1092,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1089, 0.1095, 0.1086, 0.1085, 0.1094,
         0.1088],
        [0.1094, 0.1095, 0.0000, 0.1096, 0.1096, 0.1089, 0.1088, 0.1095, 0.1095,
         0.1095],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1099, 0.1090, 0.1086, 0.1095,
         0.1091],
        [0.1091, 0.1089, 0.1096, 0.1094, 0.0000, 0.1088, 0.1096, 0.1092, 0.1095,
         0.1093],
        [0.1094, 0.1095, 0.1089, 0.1099, 0.1088, 0.0000, 0.1097, 0.1091, 0.1095,
         0.1091],
        [0.1087, 0.1086, 0.1088, 0.1090, 0.1096, 0.1097, 0.0000, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1086, 0.1095, 0.1086, 0.1092, 0.1091, 0.1085, 0.0000, 0.1094,
         0.1089],
        [0.1092, 0.1094, 0.1095, 0.1095, 0.1095, 0.1095, 0.1093, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1095, 0.1091, 0.1093, 0.1091, 0.1090, 0.1089, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5701017
Epoch790: train_loss: 4.0522 recon_acc: 0.6458 val_roc: 0.7750 val_ap: 0.8332 f1: 0.7106 time: 0.2514
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1091, 0.1094, 0.1086, 0.1090, 0.1092,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1089, 0.1095, 0.1086, 0.1085, 0.1094,
         0.1088],
        [0.1094, 0.1095, 0.0000, 0.1096, 0.1095, 0.1089, 0.1088, 0.1095, 0.1095,
         0.1095],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1099, 0.1090, 0.1086, 0.1095,
         0.1091],
        [0.1091, 0.1089, 0.1095, 0.1094, 0.0000, 0.1088, 0.1096, 0.1092, 0.1095,
         0.1093],
        [0.1094, 0.1095, 0.1089, 0.1099, 0.1088, 0.0000, 0.1097, 0.1090, 0.1095,
         0.1091],
        [0.1086, 0.1086, 0.1088, 0.1090, 0.1096, 0.1097, 0.0000, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1085, 0.1095, 0.1086, 0.1092, 0.1090, 0.1085, 0.0000, 0.1094,
         0.1089],
        [0.1092, 0.1094, 0.1095, 0.1095, 0.1095, 0.1095, 0.1093, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1095, 0.1091, 0.1093, 0.1091, 0.1090, 0.1089, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5702903
Epoch791: train_loss: 4.0521 recon_acc: 0.6462 val_roc: 0.7750 val_ap: 0.8332 f1: 0.7106 time: 0.2506
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1091, 0.1094, 0.1086, 0.1090, 0.1092,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1089, 0.1095, 0.1086, 0.1085, 0.1094,
         0.1088],
        [0.1094, 0.1095, 0.0000, 0.1096, 0.1095, 0.1089, 0.1087, 0.1095, 0.1095,
         0.1095],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1099, 0.1090, 0.1086, 0.1095,
         0.1091],
        [0.1091, 0.1089, 0.1095, 0.1094, 0.0000, 0.1088, 0.1096, 0.1092, 0.1095,
         0.1093],
        [0.1094, 0.1095, 0.1089, 0.1099, 0.1088, 0.0000, 0.1097, 0.1090, 0.1095,
         0.1091],
        [0.1086, 0.1086, 0.1087, 0.1090, 0.1096, 0.1097, 0.0000, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1085, 0.1095, 0.1086, 0.1092, 0.1090, 0.1085, 0.0000, 0.1094,
         0.1089],
        [0.1092, 0.1094, 0.1095, 0.1095, 0.1095, 0.1095, 0.1093, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1095, 0.1091, 0.1093, 0.1091, 0.1090, 0.1089, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5739906
Epoch792: train_loss: 4.0521 recon_acc: 0.6531 val_roc: 0.7750 val_ap: 0.8332 f1: 0.7109 time: 0.2654
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1091, 0.1094, 0.1086, 0.1090, 0.1092,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1089, 0.1095, 0.1086, 0.1085, 0.1094,
         0.1088],
        [0.1094, 0.1095, 0.0000, 0.1096, 0.1095, 0.1089, 0.1087, 0.1095, 0.1095,
         0.1095],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1099, 0.1090, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1089, 0.1095, 0.1094, 0.0000, 0.1088, 0.1096, 0.1092, 0.1095,
         0.1093],
        [0.1094, 0.1095, 0.1089, 0.1099, 0.1088, 0.0000, 0.1097, 0.1090, 0.1095,
         0.1091],
        [0.1086, 0.1086, 0.1087, 0.1090, 0.1096, 0.1097, 0.0000, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1085, 0.1095, 0.1086, 0.1092, 0.1090, 0.1085, 0.0000, 0.1094,
         0.1089],
        [0.1092, 0.1094, 0.1095, 0.1094, 0.1095, 0.1095, 0.1093, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1095, 0.1091, 0.1093, 0.1091, 0.1090, 0.1089, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57409704
Epoch793: train_loss: 4.0520 recon_acc: 0.6533 val_roc: 0.7751 val_ap: 0.8333 f1: 0.7124 time: 0.2435
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1089, 0.1095, 0.1085, 0.1085, 0.1094,
         0.1088],
        [0.1094, 0.1095, 0.0000, 0.1096, 0.1095, 0.1089, 0.1087, 0.1095, 0.1095,
         0.1095],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1099, 0.1090, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1089, 0.1095, 0.1094, 0.0000, 0.1088, 0.1096, 0.1092, 0.1095,
         0.1093],
        [0.1093, 0.1095, 0.1089, 0.1099, 0.1088, 0.0000, 0.1097, 0.1090, 0.1095,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1096, 0.1097, 0.0000, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1085, 0.1095, 0.1086, 0.1092, 0.1090, 0.1085, 0.0000, 0.1094,
         0.1089],
        [0.1091, 0.1094, 0.1095, 0.1094, 0.1095, 0.1095, 0.1093, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1095, 0.1091, 0.1093, 0.1091, 0.1090, 0.1089, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5742032
Epoch794: train_loss: 4.0520 recon_acc: 0.6535 val_roc: 0.7752 val_ap: 0.8334 f1: 0.7124 time: 0.2700
thresh 0.41855627
          test_roc: 0.7855 test_ap: 0.8401 test_f1: 0.7064 test_recon_acc: 0.3497
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1094],
        [0.1090, 0.0000, 0.1095, 0.1090, 0.1089, 0.1094, 0.1085, 0.1085, 0.1094,
         0.1088],
        [0.1094, 0.1095, 0.0000, 0.1096, 0.1095, 0.1089, 0.1087, 0.1095, 0.1095,
         0.1094],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1089, 0.1095, 0.1094, 0.0000, 0.1088, 0.1095, 0.1092, 0.1095,
         0.1093],
        [0.1093, 0.1094, 0.1089, 0.1098, 0.1088, 0.0000, 0.1097, 0.1090, 0.1095,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1085, 0.1095, 0.1086, 0.1092, 0.1090, 0.1085, 0.0000, 0.1094,
         0.1089],
        [0.1091, 0.1094, 0.1095, 0.1094, 0.1095, 0.1095, 0.1093, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1094, 0.1091, 0.1093, 0.1091, 0.1090, 0.1089, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57430905
Epoch795: train_loss: 4.0519 recon_acc: 0.6538 val_roc: 0.7752 val_ap: 0.8334 f1: 0.7124 time: 0.2748
thresh 0.42010492
          test_roc: 0.7855 test_ap: 0.8402 test_f1: 0.7066 test_recon_acc: 0.3527
difference_matrix tensor([[0.0000, 0.1090, 0.1094, 0.1090, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1094],
        [0.1090, 0.0000, 0.1094, 0.1090, 0.1089, 0.1094, 0.1085, 0.1085, 0.1094,
         0.1088],
        [0.1094, 0.1094, 0.0000, 0.1096, 0.1095, 0.1089, 0.1087, 0.1095, 0.1095,
         0.1094],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1089, 0.1095, 0.1094, 0.0000, 0.1088, 0.1095, 0.1092, 0.1095,
         0.1093],
        [0.1093, 0.1094, 0.1089, 0.1098, 0.1088, 0.0000, 0.1097, 0.1090, 0.1095,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1085, 0.1095, 0.1086, 0.1092, 0.1090, 0.1085, 0.0000, 0.1094,
         0.1089],
        [0.1091, 0.1094, 0.1095, 0.1094, 0.1095, 0.1095, 0.1093, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1094, 0.1091, 0.1093, 0.1091, 0.1090, 0.1089, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57441455
Epoch796: train_loss: 4.0519 recon_acc: 0.6540 val_roc: 0.7753 val_ap: 0.8335 f1: 0.7124 time: 0.2633
thresh 0.42005065
          test_roc: 0.7855 test_ap: 0.8402 test_f1: 0.7066 test_recon_acc: 0.3526
difference_matrix tensor([[0.0000, 0.1090, 0.1093, 0.1090, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1094],
        [0.1090, 0.0000, 0.1094, 0.1090, 0.1089, 0.1094, 0.1085, 0.1085, 0.1094,
         0.1088],
        [0.1093, 0.1094, 0.0000, 0.1096, 0.1095, 0.1089, 0.1087, 0.1095, 0.1095,
         0.1094],
        [0.1090, 0.1090, 0.1096, 0.0000, 0.1094, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1089, 0.1095, 0.1094, 0.0000, 0.1088, 0.1095, 0.1092, 0.1095,
         0.1093],
        [0.1093, 0.1094, 0.1089, 0.1098, 0.1088, 0.0000, 0.1097, 0.1090, 0.1095,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1085, 0.1095, 0.1086, 0.1092, 0.1090, 0.1085, 0.0000, 0.1094,
         0.1089],
        [0.1091, 0.1094, 0.1095, 0.1094, 0.1095, 0.1095, 0.1093, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1094, 0.1091, 0.1093, 0.1091, 0.1090, 0.1089, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57451975
Epoch797: train_loss: 4.0519 recon_acc: 0.6542 val_roc: 0.7753 val_ap: 0.8335 f1: 0.7124 time: 0.2722
thresh 0.41999668
          test_roc: 0.7855 test_ap: 0.8402 test_f1: 0.7066 test_recon_acc: 0.3525
difference_matrix tensor([[0.0000, 0.1090, 0.1093, 0.1089, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1094],
        [0.1090, 0.0000, 0.1094, 0.1090, 0.1089, 0.1094, 0.1085, 0.1085, 0.1094,
         0.1088],
        [0.1093, 0.1094, 0.0000, 0.1096, 0.1095, 0.1089, 0.1087, 0.1095, 0.1094,
         0.1094],
        [0.1089, 0.1090, 0.1096, 0.0000, 0.1093, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1089, 0.1095, 0.1093, 0.0000, 0.1088, 0.1095, 0.1091, 0.1095,
         0.1093],
        [0.1093, 0.1094, 0.1089, 0.1098, 0.1088, 0.0000, 0.1097, 0.1090, 0.1095,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1085, 0.1095, 0.1086, 0.1091, 0.1090, 0.1085, 0.0000, 0.1094,
         0.1089],
        [0.1091, 0.1094, 0.1094, 0.1094, 0.1095, 0.1095, 0.1093, 0.1094, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1094, 0.1091, 0.1093, 0.1091, 0.1090, 0.1089, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0408, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5746246
Epoch798: train_loss: 4.0518 recon_acc: 0.6544 val_roc: 0.7753 val_ap: 0.8336 f1: 0.7124 time: 0.2607
thresh 0.41994295
          test_roc: 0.7855 test_ap: 0.8402 test_f1: 0.7066 test_recon_acc: 0.3525
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1094],
        [0.1089, 0.0000, 0.1094, 0.1090, 0.1089, 0.1094, 0.1085, 0.1085, 0.1094,
         0.1088],
        [0.1093, 0.1094, 0.0000, 0.1096, 0.1095, 0.1089, 0.1087, 0.1095, 0.1094,
         0.1094],
        [0.1089, 0.1090, 0.1096, 0.0000, 0.1093, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1089, 0.1095, 0.1093, 0.0000, 0.1088, 0.1095, 0.1091, 0.1095,
         0.1093],
        [0.1093, 0.1094, 0.1089, 0.1098, 0.1088, 0.0000, 0.1097, 0.1090, 0.1095,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1085, 0.1095, 0.1086, 0.1091, 0.1090, 0.1085, 0.0000, 0.1093,
         0.1089],
        [0.1091, 0.1094, 0.1094, 0.1094, 0.1095, 0.1095, 0.1093, 0.1093, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1094, 0.1091, 0.1093, 0.1091, 0.1090, 0.1089, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5747292
Epoch799: train_loss: 4.0518 recon_acc: 0.6547 val_roc: 0.7754 val_ap: 0.8336 f1: 0.7124 time: 0.2659
thresh 0.41988954
          test_roc: 0.7856 test_ap: 0.8403 test_f1: 0.7066 test_recon_acc: 0.3524
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1094],
        [0.1089, 0.0000, 0.1094, 0.1090, 0.1089, 0.1094, 0.1085, 0.1085, 0.1094,
         0.1088],
        [0.1093, 0.1094, 0.0000, 0.1096, 0.1095, 0.1089, 0.1087, 0.1095, 0.1094,
         0.1094],
        [0.1089, 0.1090, 0.1096, 0.0000, 0.1093, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1089, 0.1095, 0.1093, 0.0000, 0.1088, 0.1095, 0.1091, 0.1095,
         0.1093],
        [0.1093, 0.1094, 0.1089, 0.1098, 0.1088, 0.0000, 0.1097, 0.1090, 0.1094,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1085, 0.1095, 0.1086, 0.1091, 0.1090, 0.1085, 0.0000, 0.1093,
         0.1089],
        [0.1091, 0.1094, 0.1094, 0.1094, 0.1095, 0.1094, 0.1093, 0.1093, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1094, 0.1091, 0.1093, 0.1091, 0.1090, 0.1089, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5748335
Epoch800: train_loss: 4.0517 recon_acc: 0.6549 val_roc: 0.7754 val_ap: 0.8336 f1: 0.7124 time: 0.2954
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1094],
        [0.1089, 0.0000, 0.1094, 0.1090, 0.1089, 0.1094, 0.1085, 0.1085, 0.1094,
         0.1088],
        [0.1093, 0.1094, 0.0000, 0.1096, 0.1095, 0.1089, 0.1087, 0.1095, 0.1094,
         0.1094],
        [0.1089, 0.1090, 0.1096, 0.0000, 0.1093, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1091],
        [0.1091, 0.1089, 0.1095, 0.1093, 0.0000, 0.1088, 0.1095, 0.1091, 0.1095,
         0.1093],
        [0.1093, 0.1094, 0.1089, 0.1098, 0.1088, 0.0000, 0.1097, 0.1090, 0.1094,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1085, 0.1095, 0.1086, 0.1091, 0.1090, 0.1085, 0.0000, 0.1093,
         0.1089],
        [0.1091, 0.1094, 0.1094, 0.1094, 0.1095, 0.1094, 0.1093, 0.1093, 0.0000,
         0.1094],
        [0.1094, 0.1088, 0.1094, 0.1091, 0.1093, 0.1091, 0.1090, 0.1089, 0.1094,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5721684
Epoch801: train_loss: 4.0517 recon_acc: 0.6499 val_roc: 0.7754 val_ap: 0.8337 f1: 0.7137 time: 0.2566
thresh 0.41968268
          test_roc: 0.7856 test_ap: 0.8403 test_f1: 0.7060 test_recon_acc: 0.3520
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1090, 0.1089, 0.1094, 0.1085, 0.1085, 0.1093,
         0.1088],
        [0.1093, 0.1094, 0.0000, 0.1096, 0.1095, 0.1089, 0.1087, 0.1094, 0.1094,
         0.1094],
        [0.1089, 0.1090, 0.1096, 0.0000, 0.1093, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1090],
        [0.1091, 0.1089, 0.1095, 0.1093, 0.0000, 0.1088, 0.1095, 0.1091, 0.1095,
         0.1093],
        [0.1093, 0.1094, 0.1089, 0.1098, 0.1088, 0.0000, 0.1097, 0.1090, 0.1094,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1084, 0.1093,
         0.1090],
        [0.1090, 0.1085, 0.1094, 0.1086, 0.1091, 0.1090, 0.1084, 0.0000, 0.1093,
         0.1089],
        [0.1091, 0.1093, 0.1094, 0.1094, 0.1095, 0.1094, 0.1093, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1088, 0.1094, 0.1090, 0.1093, 0.1091, 0.1090, 0.1089, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5723554
Epoch802: train_loss: 4.0517 recon_acc: 0.6503 val_roc: 0.7754 val_ap: 0.8337 f1: 0.7152 time: 0.2686
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1090, 0.1089, 0.1094, 0.1085, 0.1085, 0.1093,
         0.1088],
        [0.1093, 0.1094, 0.0000, 0.1096, 0.1095, 0.1089, 0.1087, 0.1094, 0.1094,
         0.1094],
        [0.1089, 0.1090, 0.1096, 0.0000, 0.1093, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1090],
        [0.1091, 0.1089, 0.1095, 0.1093, 0.0000, 0.1088, 0.1095, 0.1091, 0.1095,
         0.1093],
        [0.1093, 0.1094, 0.1089, 0.1098, 0.1088, 0.0000, 0.1097, 0.1090, 0.1094,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1084, 0.1093,
         0.1089],
        [0.1090, 0.1085, 0.1094, 0.1086, 0.1091, 0.1090, 0.1084, 0.0000, 0.1093,
         0.1089],
        [0.1091, 0.1093, 0.1094, 0.1094, 0.1095, 0.1094, 0.1093, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1088, 0.1094, 0.1090, 0.1093, 0.1091, 0.1089, 0.1089, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5725422
Epoch803: train_loss: 4.0516 recon_acc: 0.6507 val_roc: 0.7753 val_ap: 0.8337 f1: 0.7152 time: 0.2727
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1090, 0.1089, 0.1094, 0.1085, 0.1085, 0.1093,
         0.1088],
        [0.1093, 0.1094, 0.0000, 0.1096, 0.1095, 0.1089, 0.1087, 0.1094, 0.1094,
         0.1094],
        [0.1089, 0.1090, 0.1096, 0.0000, 0.1093, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1090],
        [0.1091, 0.1089, 0.1095, 0.1093, 0.0000, 0.1088, 0.1095, 0.1091, 0.1094,
         0.1093],
        [0.1093, 0.1094, 0.1089, 0.1098, 0.1088, 0.0000, 0.1097, 0.1090, 0.1094,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1084, 0.1093,
         0.1089],
        [0.1090, 0.1085, 0.1094, 0.1086, 0.1091, 0.1090, 0.1084, 0.0000, 0.1093,
         0.1089],
        [0.1091, 0.1093, 0.1094, 0.1094, 0.1094, 0.1094, 0.1093, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1088, 0.1094, 0.1090, 0.1093, 0.1091, 0.1089, 0.1089, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57272893
Epoch804: train_loss: 4.0516 recon_acc: 0.6511 val_roc: 0.7753 val_ap: 0.8337 f1: 0.7152 time: 0.2650
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1090, 0.1089, 0.1094, 0.1085, 0.1085, 0.1093,
         0.1088],
        [0.1093, 0.1094, 0.0000, 0.1096, 0.1095, 0.1089, 0.1087, 0.1094, 0.1094,
         0.1094],
        [0.1089, 0.1090, 0.1096, 0.0000, 0.1093, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1090],
        [0.1091, 0.1089, 0.1095, 0.1093, 0.0000, 0.1088, 0.1095, 0.1091, 0.1094,
         0.1093],
        [0.1093, 0.1094, 0.1089, 0.1098, 0.1088, 0.0000, 0.1097, 0.1090, 0.1094,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1084, 0.1093,
         0.1089],
        [0.1090, 0.1085, 0.1094, 0.1086, 0.1091, 0.1090, 0.1084, 0.0000, 0.1093,
         0.1089],
        [0.1091, 0.1093, 0.1094, 0.1094, 0.1094, 0.1094, 0.1093, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1088, 0.1094, 0.1090, 0.1093, 0.1091, 0.1089, 0.1089, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57291543
Epoch805: train_loss: 4.0515 recon_acc: 0.6514 val_roc: 0.7753 val_ap: 0.8337 f1: 0.7152 time: 0.2525
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1089, 0.1094, 0.1085, 0.1085, 0.1093,
         0.1087],
        [0.1093, 0.1094, 0.0000, 0.1095, 0.1095, 0.1089, 0.1087, 0.1094, 0.1094,
         0.1094],
        [0.1089, 0.1089, 0.1095, 0.0000, 0.1093, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1090],
        [0.1091, 0.1089, 0.1095, 0.1093, 0.0000, 0.1087, 0.1095, 0.1091, 0.1094,
         0.1093],
        [0.1093, 0.1094, 0.1089, 0.1098, 0.1087, 0.0000, 0.1097, 0.1090, 0.1094,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1084, 0.1093,
         0.1089],
        [0.1090, 0.1085, 0.1094, 0.1086, 0.1091, 0.1090, 0.1084, 0.0000, 0.1093,
         0.1089],
        [0.1091, 0.1093, 0.1094, 0.1094, 0.1094, 0.1094, 0.1093, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1094, 0.1090, 0.1093, 0.1091, 0.1089, 0.1089, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5731018
Epoch806: train_loss: 4.0515 recon_acc: 0.6518 val_roc: 0.7753 val_ap: 0.8337 f1: 0.7152 time: 0.2529
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1094, 0.1085, 0.1085, 0.1093,
         0.1087],
        [0.1093, 0.1094, 0.0000, 0.1095, 0.1095, 0.1089, 0.1087, 0.1094, 0.1094,
         0.1094],
        [0.1089, 0.1089, 0.1095, 0.0000, 0.1093, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1090],
        [0.1091, 0.1088, 0.1095, 0.1093, 0.0000, 0.1087, 0.1095, 0.1091, 0.1094,
         0.1093],
        [0.1093, 0.1094, 0.1089, 0.1098, 0.1087, 0.0000, 0.1097, 0.1090, 0.1094,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1084, 0.1093,
         0.1089],
        [0.1090, 0.1085, 0.1094, 0.1086, 0.1091, 0.1090, 0.1084, 0.0000, 0.1093,
         0.1089],
        [0.1091, 0.1093, 0.1094, 0.1094, 0.1094, 0.1094, 0.1093, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1094, 0.1090, 0.1093, 0.1091, 0.1089, 0.1089, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57328796
Epoch807: train_loss: 4.0515 recon_acc: 0.6522 val_roc: 0.7753 val_ap: 0.8337 f1: 0.7152 time: 0.2606
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1091, 0.1093, 0.1086, 0.1090, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1094, 0.1085, 0.1085, 0.1093,
         0.1087],
        [0.1093, 0.1094, 0.0000, 0.1095, 0.1095, 0.1088, 0.1087, 0.1094, 0.1094,
         0.1094],
        [0.1089, 0.1089, 0.1095, 0.0000, 0.1093, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1090],
        [0.1091, 0.1088, 0.1095, 0.1093, 0.0000, 0.1087, 0.1095, 0.1091, 0.1094,
         0.1093],
        [0.1093, 0.1094, 0.1088, 0.1098, 0.1087, 0.0000, 0.1097, 0.1090, 0.1094,
         0.1091],
        [0.1086, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1084, 0.1093,
         0.1089],
        [0.1090, 0.1085, 0.1094, 0.1086, 0.1091, 0.1090, 0.1084, 0.0000, 0.1093,
         0.1089],
        [0.1091, 0.1093, 0.1094, 0.1094, 0.1094, 0.1094, 0.1093, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1094, 0.1090, 0.1093, 0.1091, 0.1089, 0.1089, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57347405
Epoch808: train_loss: 4.0514 recon_acc: 0.6525 val_roc: 0.7753 val_ap: 0.8337 f1: 0.7152 time: 0.2595
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1091, 0.1093, 0.1085, 0.1090, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1094, 0.1085, 0.1085, 0.1093,
         0.1087],
        [0.1093, 0.1094, 0.0000, 0.1095, 0.1095, 0.1088, 0.1087, 0.1094, 0.1094,
         0.1094],
        [0.1089, 0.1089, 0.1095, 0.0000, 0.1093, 0.1098, 0.1090, 0.1086, 0.1094,
         0.1090],
        [0.1091, 0.1088, 0.1095, 0.1093, 0.0000, 0.1087, 0.1095, 0.1091, 0.1094,
         0.1093],
        [0.1093, 0.1094, 0.1088, 0.1098, 0.1087, 0.0000, 0.1097, 0.1089, 0.1094,
         0.1091],
        [0.1085, 0.1085, 0.1087, 0.1090, 0.1095, 0.1097, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1090, 0.1085, 0.1094, 0.1086, 0.1091, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1089],
        [0.1091, 0.1093, 0.1094, 0.1094, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1094, 0.1090, 0.1093, 0.1091, 0.1089, 0.1089, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5736599
Epoch809: train_loss: 4.0514 recon_acc: 0.6529 val_roc: 0.7753 val_ap: 0.8337 f1: 0.7152 time: 0.2818
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1091, 0.1093, 0.1085, 0.1089, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1094, 0.1085, 0.1085, 0.1093,
         0.1087],
        [0.1093, 0.1094, 0.0000, 0.1095, 0.1095, 0.1088, 0.1087, 0.1094, 0.1094,
         0.1094],
        [0.1089, 0.1089, 0.1095, 0.0000, 0.1093, 0.1098, 0.1089, 0.1086, 0.1094,
         0.1090],
        [0.1091, 0.1088, 0.1095, 0.1093, 0.0000, 0.1087, 0.1095, 0.1091, 0.1094,
         0.1092],
        [0.1093, 0.1094, 0.1088, 0.1098, 0.1087, 0.0000, 0.1097, 0.1089, 0.1094,
         0.1091],
        [0.1085, 0.1085, 0.1087, 0.1089, 0.1095, 0.1097, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1085, 0.1094, 0.1086, 0.1091, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1089],
        [0.1091, 0.1093, 0.1094, 0.1094, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1094, 0.1090, 0.1092, 0.1091, 0.1089, 0.1089, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5738457
Epoch810: train_loss: 4.0513 recon_acc: 0.6533 val_roc: 0.7753 val_ap: 0.8337 f1: 0.7152 time: 0.2750
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1090, 0.1093, 0.1085, 0.1089, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1094, 0.1085, 0.1085, 0.1093,
         0.1087],
        [0.1093, 0.1094, 0.0000, 0.1095, 0.1095, 0.1088, 0.1086, 0.1094, 0.1094,
         0.1094],
        [0.1089, 0.1089, 0.1095, 0.0000, 0.1093, 0.1098, 0.1089, 0.1086, 0.1094,
         0.1090],
        [0.1090, 0.1088, 0.1095, 0.1093, 0.0000, 0.1087, 0.1095, 0.1091, 0.1094,
         0.1092],
        [0.1093, 0.1094, 0.1088, 0.1098, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1085, 0.1086, 0.1089, 0.1095, 0.1096, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1085, 0.1094, 0.1086, 0.1091, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1088],
        [0.1091, 0.1093, 0.1094, 0.1094, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1094, 0.1090, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57403123
Epoch811: train_loss: 4.0513 recon_acc: 0.6537 val_roc: 0.7752 val_ap: 0.8336 f1: 0.7152 time: 0.2746
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1090, 0.1093, 0.1085, 0.1089, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1094, 0.1085, 0.1084, 0.1093,
         0.1087],
        [0.1093, 0.1094, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1094, 0.1094,
         0.1094],
        [0.1089, 0.1089, 0.1095, 0.0000, 0.1093, 0.1098, 0.1089, 0.1085, 0.1094,
         0.1090],
        [0.1090, 0.1088, 0.1094, 0.1093, 0.0000, 0.1087, 0.1095, 0.1091, 0.1094,
         0.1092],
        [0.1093, 0.1094, 0.1088, 0.1098, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1085, 0.1086, 0.1089, 0.1095, 0.1096, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1084, 0.1094, 0.1085, 0.1091, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1088],
        [0.1091, 0.1093, 0.1094, 0.1094, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1094, 0.1090, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5742167
Epoch812: train_loss: 4.0513 recon_acc: 0.6540 val_roc: 0.7752 val_ap: 0.8337 f1: 0.7152 time: 0.2640
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1090, 0.1093, 0.1085, 0.1089, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1094, 0.1085, 0.1084, 0.1093,
         0.1087],
        [0.1093, 0.1094, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1094, 0.1094,
         0.1094],
        [0.1089, 0.1089, 0.1095, 0.0000, 0.1093, 0.1098, 0.1089, 0.1085, 0.1094,
         0.1090],
        [0.1090, 0.1088, 0.1094, 0.1093, 0.0000, 0.1087, 0.1095, 0.1091, 0.1094,
         0.1092],
        [0.1093, 0.1094, 0.1088, 0.1098, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1085, 0.1086, 0.1089, 0.1095, 0.1096, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1084, 0.1094, 0.1085, 0.1091, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1088],
        [0.1091, 0.1093, 0.1094, 0.1094, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1094, 0.1090, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.574402
Epoch813: train_loss: 4.0512 recon_acc: 0.6544 val_roc: 0.7751 val_ap: 0.8336 f1: 0.7167 time: 0.2569
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1090, 0.1092, 0.1085, 0.1089, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1094, 0.1084, 0.1084, 0.1093,
         0.1087],
        [0.1093, 0.1094, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1094, 0.1094,
         0.1094],
        [0.1089, 0.1089, 0.1095, 0.0000, 0.1093, 0.1098, 0.1089, 0.1085, 0.1094,
         0.1090],
        [0.1090, 0.1088, 0.1094, 0.1093, 0.0000, 0.1087, 0.1095, 0.1091, 0.1094,
         0.1092],
        [0.1092, 0.1094, 0.1088, 0.1098, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1095, 0.1096, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1084, 0.1094, 0.1085, 0.1091, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1088],
        [0.1091, 0.1093, 0.1094, 0.1094, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1094, 0.1090, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57458705
Epoch814: train_loss: 4.0512 recon_acc: 0.6547 val_roc: 0.7751 val_ap: 0.8336 f1: 0.7167 time: 0.2725
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1090, 0.1092, 0.1085, 0.1089, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1094, 0.1084, 0.1084, 0.1093,
         0.1087],
        [0.1093, 0.1094, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1094, 0.1093,
         0.1094],
        [0.1089, 0.1089, 0.1095, 0.0000, 0.1093, 0.1098, 0.1089, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1088, 0.1094, 0.1093, 0.0000, 0.1087, 0.1095, 0.1091, 0.1094,
         0.1092],
        [0.1092, 0.1094, 0.1088, 0.1098, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1095, 0.1096, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1084, 0.1094, 0.1085, 0.1091, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1088],
        [0.1091, 0.1093, 0.1093, 0.1093, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1094, 0.1090, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.574772
Epoch815: train_loss: 4.0512 recon_acc: 0.6551 val_roc: 0.7750 val_ap: 0.8337 f1: 0.7167 time: 0.2654
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1090, 0.1092, 0.1085, 0.1089, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1094, 0.1084, 0.1084, 0.1093,
         0.1087],
        [0.1093, 0.1094, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1094, 0.1093,
         0.1094],
        [0.1089, 0.1089, 0.1095, 0.0000, 0.1093, 0.1098, 0.1089, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1088, 0.1094, 0.1093, 0.0000, 0.1087, 0.1095, 0.1091, 0.1094,
         0.1092],
        [0.1092, 0.1094, 0.1088, 0.1098, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1095, 0.1096, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1084, 0.1094, 0.1085, 0.1091, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1088],
        [0.1091, 0.1093, 0.1093, 0.1093, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1094, 0.1090, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5749568
Epoch816: train_loss: 4.0511 recon_acc: 0.6555 val_roc: 0.7750 val_ap: 0.8336 f1: 0.7167 time: 0.2689
difference_matrix tensor([[0.0000, 0.1089, 0.1093, 0.1089, 0.1090, 0.1092, 0.1085, 0.1089, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1094, 0.1084, 0.1084, 0.1093,
         0.1087],
        [0.1093, 0.1094, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1094, 0.1093,
         0.1093],
        [0.1089, 0.1089, 0.1095, 0.0000, 0.1093, 0.1098, 0.1089, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1088, 0.1094, 0.1093, 0.0000, 0.1087, 0.1095, 0.1091, 0.1094,
         0.1092],
        [0.1092, 0.1094, 0.1088, 0.1098, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1095, 0.1096, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1084, 0.1094, 0.1085, 0.1091, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1088],
        [0.1091, 0.1093, 0.1093, 0.1093, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1093, 0.1090, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57514143
Epoch817: train_loss: 4.0511 recon_acc: 0.6558 val_roc: 0.7750 val_ap: 0.8337 f1: 0.7167 time: 0.2740
difference_matrix tensor([[0.0000, 0.1089, 0.1092, 0.1089, 0.1090, 0.1092, 0.1085, 0.1089, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1093, 0.1084, 0.1084, 0.1093,
         0.1087],
        [0.1092, 0.1094, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1094, 0.1093,
         0.1093],
        [0.1089, 0.1089, 0.1095, 0.0000, 0.1093, 0.1098, 0.1089, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1088, 0.1094, 0.1093, 0.0000, 0.1087, 0.1094, 0.1091, 0.1094,
         0.1092],
        [0.1092, 0.1093, 0.1088, 0.1098, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1094, 0.1096, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1084, 0.1094, 0.1085, 0.1091, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1088],
        [0.1091, 0.1093, 0.1093, 0.1093, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1093, 0.1090, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5753259
Epoch818: train_loss: 4.0510 recon_acc: 0.6562 val_roc: 0.7749 val_ap: 0.8336 f1: 0.7167 time: 0.2625
difference_matrix tensor([[0.0000, 0.1089, 0.1092, 0.1089, 0.1090, 0.1092, 0.1085, 0.1089, 0.1091,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1093, 0.1084, 0.1084, 0.1093,
         0.1087],
        [0.1092, 0.1094, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1094, 0.1093,
         0.1093],
        [0.1089, 0.1089, 0.1095, 0.0000, 0.1093, 0.1098, 0.1089, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1088, 0.1094, 0.1093, 0.0000, 0.1087, 0.1094, 0.1091, 0.1094,
         0.1092],
        [0.1092, 0.1093, 0.1088, 0.1098, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1094, 0.1096, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1084, 0.1094, 0.1085, 0.1091, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1088],
        [0.1091, 0.1093, 0.1093, 0.1093, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1093, 0.1090, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57551014
Epoch819: train_loss: 4.0510 recon_acc: 0.6566 val_roc: 0.7750 val_ap: 0.8337 f1: 0.7167 time: 0.2818
difference_matrix tensor([[0.0000, 0.1089, 0.1092, 0.1088, 0.1090, 0.1092, 0.1085, 0.1089, 0.1090,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1093, 0.1084, 0.1084, 0.1093,
         0.1087],
        [0.1092, 0.1094, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1094, 0.1093,
         0.1093],
        [0.1088, 0.1089, 0.1095, 0.0000, 0.1092, 0.1098, 0.1089, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1088, 0.1094, 0.1092, 0.0000, 0.1087, 0.1094, 0.1090, 0.1094,
         0.1092],
        [0.1092, 0.1093, 0.1088, 0.1098, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1094, 0.1096, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1084, 0.1094, 0.1085, 0.1090, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1088],
        [0.1090, 0.1093, 0.1093, 0.1093, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1093, 0.1090, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5756943
Epoch820: train_loss: 4.0510 recon_acc: 0.6569 val_roc: 0.7751 val_ap: 0.8338 f1: 0.7167 time: 0.2664
difference_matrix tensor([[0.0000, 0.1089, 0.1092, 0.1088, 0.1090, 0.1092, 0.1085, 0.1089, 0.1090,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1093, 0.1084, 0.1084, 0.1093,
         0.1087],
        [0.1092, 0.1094, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1094, 0.1093,
         0.1093],
        [0.1088, 0.1089, 0.1095, 0.0000, 0.1092, 0.1098, 0.1089, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1088, 0.1094, 0.1092, 0.0000, 0.1087, 0.1094, 0.1090, 0.1094,
         0.1092],
        [0.1092, 0.1093, 0.1088, 0.1098, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1094, 0.1096, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1084, 0.1094, 0.1085, 0.1090, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1088],
        [0.1090, 0.1093, 0.1093, 0.1093, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1093, 0.1090, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0409, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57587826
Epoch821: train_loss: 4.0509 recon_acc: 0.6573 val_roc: 0.7751 val_ap: 0.8339 f1: 0.7167 time: 0.2654
difference_matrix tensor([[0.0000, 0.1089, 0.1092, 0.1088, 0.1090, 0.1092, 0.1085, 0.1089, 0.1090,
         0.1093],
        [0.1089, 0.0000, 0.1094, 0.1089, 0.1088, 0.1093, 0.1084, 0.1084, 0.1093,
         0.1087],
        [0.1092, 0.1094, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1094, 0.1093,
         0.1093],
        [0.1088, 0.1089, 0.1095, 0.0000, 0.1092, 0.1097, 0.1089, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1088, 0.1094, 0.1092, 0.0000, 0.1087, 0.1094, 0.1090, 0.1094,
         0.1092],
        [0.1092, 0.1093, 0.1088, 0.1097, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1094, 0.1096, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1084, 0.1094, 0.1085, 0.1090, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1088],
        [0.1090, 0.1093, 0.1093, 0.1093, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1093, 0.1090, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57606214
Epoch822: train_loss: 4.0509 recon_acc: 0.6577 val_roc: 0.7750 val_ap: 0.8339 f1: 0.7167 time: 0.2731
difference_matrix tensor([[0.0000, 0.1089, 0.1092, 0.1088, 0.1090, 0.1092, 0.1085, 0.1089, 0.1090,
         0.1093],
        [0.1089, 0.0000, 0.1093, 0.1089, 0.1088, 0.1093, 0.1084, 0.1084, 0.1093,
         0.1087],
        [0.1092, 0.1093, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1094, 0.1093,
         0.1093],
        [0.1088, 0.1089, 0.1095, 0.0000, 0.1092, 0.1097, 0.1089, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1088, 0.1094, 0.1092, 0.0000, 0.1087, 0.1094, 0.1090, 0.1094,
         0.1092],
        [0.1092, 0.1093, 0.1088, 0.1097, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1094, 0.1096, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1084, 0.1094, 0.1085, 0.1090, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1088],
        [0.1090, 0.1093, 0.1093, 0.1093, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1093, 0.1090, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5762458
Epoch823: train_loss: 4.0509 recon_acc: 0.6580 val_roc: 0.7750 val_ap: 0.8339 f1: 0.7167 time: 0.2616
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1090, 0.1092, 0.1085, 0.1089, 0.1090,
         0.1093],
        [0.1088, 0.0000, 0.1093, 0.1089, 0.1088, 0.1093, 0.1084, 0.1084, 0.1093,
         0.1087],
        [0.1092, 0.1093, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1094, 0.1093,
         0.1093],
        [0.1088, 0.1089, 0.1095, 0.0000, 0.1092, 0.1097, 0.1089, 0.1085, 0.1093,
         0.1090],
        [0.1090, 0.1088, 0.1094, 0.1092, 0.0000, 0.1087, 0.1094, 0.1090, 0.1094,
         0.1092],
        [0.1092, 0.1093, 0.1088, 0.1097, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1094, 0.1096, 0.0000, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1084, 0.1094, 0.1085, 0.1090, 0.1089, 0.1084, 0.0000, 0.1093,
         0.1088],
        [0.1090, 0.1093, 0.1093, 0.1093, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1093, 0.1090, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57642925
Epoch824: train_loss: 4.0508 recon_acc: 0.6584 val_roc: 0.7749 val_ap: 0.8339 f1: 0.7167 time: 0.2484
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1090, 0.1092, 0.1085, 0.1089, 0.1090,
         0.1093],
        [0.1088, 0.0000, 0.1093, 0.1089, 0.1088, 0.1093, 0.1084, 0.1084, 0.1093,
         0.1087],
        [0.1092, 0.1093, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1094, 0.1093,
         0.1093],
        [0.1088, 0.1089, 0.1095, 0.0000, 0.1092, 0.1097, 0.1089, 0.1085, 0.1093,
         0.1089],
        [0.1090, 0.1088, 0.1094, 0.1092, 0.0000, 0.1087, 0.1094, 0.1090, 0.1094,
         0.1092],
        [0.1092, 0.1093, 0.1088, 0.1097, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1094, 0.1096, 0.0000, 0.1083, 0.1092,
         0.1089],
        [0.1089, 0.1084, 0.1094, 0.1085, 0.1090, 0.1089, 0.1083, 0.0000, 0.1093,
         0.1088],
        [0.1090, 0.1093, 0.1093, 0.1093, 0.1094, 0.1094, 0.1092, 0.1093, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1093, 0.1089, 0.1092, 0.1090, 0.1089, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57661265
Epoch825: train_loss: 4.0508 recon_acc: 0.6587 val_roc: 0.7750 val_ap: 0.8339 f1: 0.7167 time: 0.2551
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1090, 0.1092, 0.1085, 0.1089, 0.1090,
         0.1093],
        [0.1088, 0.0000, 0.1093, 0.1089, 0.1088, 0.1093, 0.1084, 0.1084, 0.1093,
         0.1087],
        [0.1092, 0.1093, 0.0000, 0.1095, 0.1094, 0.1088, 0.1086, 0.1093, 0.1093,
         0.1093],
        [0.1088, 0.1089, 0.1095, 0.0000, 0.1092, 0.1097, 0.1089, 0.1085, 0.1093,
         0.1089],
        [0.1090, 0.1088, 0.1094, 0.1092, 0.0000, 0.1087, 0.1094, 0.1090, 0.1094,
         0.1092],
        [0.1092, 0.1093, 0.1088, 0.1097, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1094, 0.1096, 0.0000, 0.1083, 0.1092,
         0.1088],
        [0.1089, 0.1084, 0.1093, 0.1085, 0.1090, 0.1089, 0.1083, 0.0000, 0.1092,
         0.1088],
        [0.1090, 0.1093, 0.1093, 0.1093, 0.1094, 0.1094, 0.1092, 0.1092, 0.0000,
         0.1093],
        [0.1093, 0.1087, 0.1093, 0.1089, 0.1092, 0.1090, 0.1088, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57665855
Epoch826: train_loss: 4.0507 recon_acc: 0.6588 val_roc: 0.7749 val_ap: 0.8339 f1: 0.7167 time: 0.2651
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1090, 0.1092, 0.1085, 0.1089, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1089, 0.1088, 0.1093, 0.1084, 0.1084, 0.1092,
         0.1087],
        [0.1092, 0.1093, 0.0000, 0.1095, 0.1094, 0.1087, 0.1086, 0.1093, 0.1093,
         0.1093],
        [0.1088, 0.1089, 0.1095, 0.0000, 0.1092, 0.1097, 0.1089, 0.1085, 0.1093,
         0.1089],
        [0.1090, 0.1088, 0.1094, 0.1092, 0.0000, 0.1087, 0.1094, 0.1090, 0.1094,
         0.1092],
        [0.1092, 0.1093, 0.1087, 0.1097, 0.1087, 0.0000, 0.1096, 0.1089, 0.1094,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1094, 0.1096, 0.0000, 0.1083, 0.1092,
         0.1088],
        [0.1089, 0.1084, 0.1093, 0.1085, 0.1090, 0.1089, 0.1083, 0.0000, 0.1092,
         0.1088],
        [0.1090, 0.1092, 0.1093, 0.1093, 0.1094, 0.1094, 0.1092, 0.1092, 0.0000,
         0.1093],
        [0.1092, 0.1087, 0.1093, 0.1089, 0.1092, 0.1090, 0.1088, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57630944
Epoch827: train_loss: 4.0507 recon_acc: 0.6582 val_roc: 0.7749 val_ap: 0.8338 f1: 0.7167 time: 0.2527
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1090, 0.1092, 0.1085, 0.1089, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1089, 0.1088, 0.1093, 0.1084, 0.1084, 0.1092,
         0.1087],
        [0.1092, 0.1093, 0.0000, 0.1095, 0.1094, 0.1087, 0.1086, 0.1093, 0.1093,
         0.1093],
        [0.1088, 0.1089, 0.1095, 0.0000, 0.1092, 0.1097, 0.1089, 0.1085, 0.1093,
         0.1089],
        [0.1090, 0.1088, 0.1094, 0.1092, 0.0000, 0.1087, 0.1094, 0.1090, 0.1093,
         0.1092],
        [0.1092, 0.1093, 0.1087, 0.1097, 0.1087, 0.0000, 0.1096, 0.1089, 0.1093,
         0.1090],
        [0.1085, 0.1084, 0.1086, 0.1089, 0.1094, 0.1096, 0.0000, 0.1083, 0.1092,
         0.1088],
        [0.1089, 0.1084, 0.1093, 0.1085, 0.1090, 0.1089, 0.1083, 0.0000, 0.1092,
         0.1088],
        [0.1090, 0.1092, 0.1093, 0.1093, 0.1093, 0.1093, 0.1092, 0.1092, 0.0000,
         0.1093],
        [0.1092, 0.1087, 0.1093, 0.1089, 0.1092, 0.1090, 0.1088, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5759607
Epoch828: train_loss: 4.0507 recon_acc: 0.6576 val_roc: 0.7749 val_ap: 0.8339 f1: 0.7167 time: 0.2707
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1090, 0.1092, 0.1084, 0.1089, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1089, 0.1088, 0.1093, 0.1084, 0.1084, 0.1092,
         0.1086],
        [0.1092, 0.1093, 0.0000, 0.1095, 0.1094, 0.1087, 0.1086, 0.1093, 0.1093,
         0.1093],
        [0.1088, 0.1089, 0.1095, 0.0000, 0.1092, 0.1097, 0.1089, 0.1085, 0.1093,
         0.1089],
        [0.1090, 0.1088, 0.1094, 0.1092, 0.0000, 0.1086, 0.1094, 0.1090, 0.1093,
         0.1092],
        [0.1092, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1096, 0.1088, 0.1093,
         0.1090],
        [0.1084, 0.1084, 0.1086, 0.1089, 0.1094, 0.1096, 0.0000, 0.1083, 0.1092,
         0.1088],
        [0.1089, 0.1084, 0.1093, 0.1085, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1088],
        [0.1090, 0.1092, 0.1093, 0.1093, 0.1093, 0.1093, 0.1092, 0.1092, 0.0000,
         0.1093],
        [0.1092, 0.1086, 0.1093, 0.1089, 0.1092, 0.1090, 0.1088, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5756123
Epoch829: train_loss: 4.0506 recon_acc: 0.6570 val_roc: 0.7749 val_ap: 0.8339 f1: 0.7167 time: 0.2829
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1090, 0.1092, 0.1084, 0.1089, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1089, 0.1088, 0.1093, 0.1084, 0.1084, 0.1092,
         0.1086],
        [0.1092, 0.1093, 0.0000, 0.1095, 0.1094, 0.1087, 0.1086, 0.1093, 0.1093,
         0.1093],
        [0.1088, 0.1089, 0.1095, 0.0000, 0.1092, 0.1097, 0.1089, 0.1085, 0.1093,
         0.1089],
        [0.1090, 0.1088, 0.1094, 0.1092, 0.0000, 0.1086, 0.1094, 0.1090, 0.1093,
         0.1092],
        [0.1092, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1096, 0.1088, 0.1093,
         0.1090],
        [0.1084, 0.1084, 0.1086, 0.1089, 0.1094, 0.1096, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1089, 0.1084, 0.1093, 0.1085, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1088],
        [0.1090, 0.1092, 0.1093, 0.1093, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1093],
        [0.1092, 0.1086, 0.1093, 0.1089, 0.1092, 0.1090, 0.1088, 0.1088, 0.1093,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5752643
Epoch830: train_loss: 4.0506 recon_acc: 0.6564 val_roc: 0.7749 val_ap: 0.8339 f1: 0.7167 time: 0.2523
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1090, 0.1092, 0.1084, 0.1089, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1089, 0.1088, 0.1093, 0.1084, 0.1084, 0.1092,
         0.1086],
        [0.1092, 0.1093, 0.0000, 0.1095, 0.1094, 0.1087, 0.1085, 0.1093, 0.1093,
         0.1093],
        [0.1088, 0.1089, 0.1095, 0.0000, 0.1092, 0.1097, 0.1089, 0.1085, 0.1093,
         0.1089],
        [0.1090, 0.1088, 0.1094, 0.1092, 0.0000, 0.1086, 0.1094, 0.1090, 0.1093,
         0.1092],
        [0.1092, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1096, 0.1088, 0.1093,
         0.1090],
        [0.1084, 0.1084, 0.1085, 0.1089, 0.1094, 0.1096, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1089, 0.1084, 0.1093, 0.1085, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1088],
        [0.1090, 0.1092, 0.1093, 0.1093, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1093, 0.1089, 0.1092, 0.1090, 0.1088, 0.1088, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5749164
Epoch831: train_loss: 4.0506 recon_acc: 0.6558 val_roc: 0.7748 val_ap: 0.8338 f1: 0.7167 time: 0.2557
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1090, 0.1092, 0.1084, 0.1089, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1089, 0.1087, 0.1093, 0.1084, 0.1084, 0.1092,
         0.1086],
        [0.1092, 0.1093, 0.0000, 0.1095, 0.1094, 0.1087, 0.1085, 0.1093, 0.1093,
         0.1093],
        [0.1088, 0.1089, 0.1095, 0.0000, 0.1092, 0.1097, 0.1089, 0.1085, 0.1093,
         0.1089],
        [0.1090, 0.1087, 0.1094, 0.1092, 0.0000, 0.1086, 0.1094, 0.1090, 0.1093,
         0.1092],
        [0.1092, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1096, 0.1088, 0.1093,
         0.1090],
        [0.1084, 0.1084, 0.1085, 0.1089, 0.1094, 0.1096, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1089, 0.1084, 0.1093, 0.1085, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1088],
        [0.1090, 0.1092, 0.1093, 0.1093, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1093, 0.1089, 0.1092, 0.1090, 0.1088, 0.1088, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57456905
Epoch832: train_loss: 4.0505 recon_acc: 0.6551 val_roc: 0.7749 val_ap: 0.8339 f1: 0.7167 time: 0.2653
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1090, 0.1092, 0.1084, 0.1089, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1089, 0.1087, 0.1093, 0.1084, 0.1084, 0.1092,
         0.1086],
        [0.1092, 0.1093, 0.0000, 0.1094, 0.1094, 0.1087, 0.1085, 0.1093, 0.1093,
         0.1093],
        [0.1088, 0.1089, 0.1094, 0.0000, 0.1092, 0.1097, 0.1089, 0.1085, 0.1093,
         0.1089],
        [0.1090, 0.1087, 0.1094, 0.1092, 0.0000, 0.1086, 0.1094, 0.1090, 0.1093,
         0.1091],
        [0.1092, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1096, 0.1088, 0.1093,
         0.1090],
        [0.1084, 0.1084, 0.1085, 0.1089, 0.1094, 0.1096, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1084, 0.1093, 0.1085, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1088],
        [0.1090, 0.1092, 0.1093, 0.1093, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1093, 0.1089, 0.1091, 0.1090, 0.1088, 0.1088, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5742219
Epoch833: train_loss: 4.0505 recon_acc: 0.6545 val_roc: 0.7748 val_ap: 0.8339 f1: 0.7167 time: 0.2685
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1090, 0.1092, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1089, 0.1087, 0.1093, 0.1084, 0.1084, 0.1092,
         0.1086],
        [0.1092, 0.1093, 0.0000, 0.1094, 0.1094, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1093],
        [0.1088, 0.1089, 0.1094, 0.0000, 0.1092, 0.1097, 0.1089, 0.1085, 0.1093,
         0.1089],
        [0.1090, 0.1087, 0.1094, 0.1092, 0.0000, 0.1086, 0.1094, 0.1090, 0.1093,
         0.1091],
        [0.1092, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1096, 0.1088, 0.1093,
         0.1090],
        [0.1084, 0.1084, 0.1085, 0.1089, 0.1094, 0.1096, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1084, 0.1093, 0.1085, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1088],
        [0.1090, 0.1092, 0.1092, 0.1093, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1093, 0.1089, 0.1091, 0.1090, 0.1088, 0.1088, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5738751
Epoch834: train_loss: 4.0505 recon_acc: 0.6539 val_roc: 0.7748 val_ap: 0.8339 f1: 0.7167 time: 0.2691
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1089, 0.1092, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1089, 0.1087, 0.1093, 0.1084, 0.1084, 0.1092,
         0.1086],
        [0.1092, 0.1093, 0.0000, 0.1094, 0.1094, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1093],
        [0.1088, 0.1089, 0.1094, 0.0000, 0.1092, 0.1097, 0.1089, 0.1085, 0.1093,
         0.1089],
        [0.1089, 0.1087, 0.1094, 0.1092, 0.0000, 0.1086, 0.1094, 0.1090, 0.1093,
         0.1091],
        [0.1092, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1096, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1084, 0.1085, 0.1089, 0.1094, 0.1096, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1084, 0.1093, 0.1085, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1088],
        [0.1090, 0.1092, 0.1092, 0.1093, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1093, 0.1089, 0.1091, 0.1089, 0.1088, 0.1088, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57352865
Epoch835: train_loss: 4.0504 recon_acc: 0.6533 val_roc: 0.7749 val_ap: 0.8340 f1: 0.7167 time: 0.3017
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1089, 0.1091, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1093, 0.1084, 0.1083, 0.1092,
         0.1086],
        [0.1092, 0.1093, 0.0000, 0.1094, 0.1093, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1093],
        [0.1088, 0.1088, 0.1094, 0.0000, 0.1092, 0.1097, 0.1088, 0.1085, 0.1093,
         0.1089],
        [0.1089, 0.1087, 0.1093, 0.1092, 0.0000, 0.1086, 0.1094, 0.1090, 0.1093,
         0.1091],
        [0.1091, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1096, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1084, 0.1085, 0.1088, 0.1094, 0.1096, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1083, 0.1093, 0.1085, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1087],
        [0.1090, 0.1092, 0.1092, 0.1093, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1093, 0.1089, 0.1091, 0.1089, 0.1088, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5731825
Epoch836: train_loss: 4.0504 recon_acc: 0.6527 val_roc: 0.7750 val_ap: 0.8340 f1: 0.7167 time: 0.2593
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1089, 0.1091, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1093, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1092, 0.1093, 0.0000, 0.1094, 0.1093, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1093],
        [0.1088, 0.1088, 0.1094, 0.0000, 0.1092, 0.1097, 0.1088, 0.1085, 0.1093,
         0.1089],
        [0.1089, 0.1087, 0.1093, 0.1092, 0.0000, 0.1086, 0.1094, 0.1090, 0.1093,
         0.1091],
        [0.1091, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1096, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1083, 0.1085, 0.1088, 0.1094, 0.1096, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1083, 0.1093, 0.1085, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1087],
        [0.1090, 0.1092, 0.1092, 0.1093, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1093, 0.1089, 0.1091, 0.1089, 0.1088, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57283676
Epoch837: train_loss: 4.0504 recon_acc: 0.6521 val_roc: 0.7751 val_ap: 0.8341 f1: 0.7167 time: 0.2517
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1089, 0.1091, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1093, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1092, 0.1093, 0.0000, 0.1094, 0.1093, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1093],
        [0.1088, 0.1088, 0.1094, 0.0000, 0.1092, 0.1097, 0.1088, 0.1085, 0.1092,
         0.1089],
        [0.1089, 0.1087, 0.1093, 0.1092, 0.0000, 0.1086, 0.1094, 0.1090, 0.1093,
         0.1091],
        [0.1091, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1096, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1083, 0.1085, 0.1088, 0.1094, 0.1096, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1083, 0.1093, 0.1085, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1087],
        [0.1090, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1093, 0.1089, 0.1091, 0.1089, 0.1088, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5724913
Epoch838: train_loss: 4.0503 recon_acc: 0.6515 val_roc: 0.7751 val_ap: 0.8341 f1: 0.7167 time: 0.2564
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1089, 0.1091, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1093, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1092, 0.1093, 0.0000, 0.1094, 0.1093, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1093],
        [0.1088, 0.1088, 0.1094, 0.0000, 0.1092, 0.1097, 0.1088, 0.1085, 0.1092,
         0.1089],
        [0.1089, 0.1087, 0.1093, 0.1092, 0.0000, 0.1086, 0.1094, 0.1090, 0.1093,
         0.1091],
        [0.1091, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1096, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1083, 0.1085, 0.1088, 0.1094, 0.1096, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1083, 0.1093, 0.1085, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1087],
        [0.1090, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1093, 0.1089, 0.1091, 0.1089, 0.1088, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5721462
Epoch839: train_loss: 4.0503 recon_acc: 0.6508 val_roc: 0.7751 val_ap: 0.8342 f1: 0.7167 time: 0.2540
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1089, 0.1091, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1093, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1092, 0.1093, 0.0000, 0.1094, 0.1093, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1093],
        [0.1088, 0.1088, 0.1094, 0.0000, 0.1092, 0.1097, 0.1088, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1087, 0.1093, 0.1092, 0.0000, 0.1086, 0.1094, 0.1090, 0.1093,
         0.1091],
        [0.1091, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1095, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1083, 0.1085, 0.1088, 0.1094, 0.1095, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1083, 0.1093, 0.1084, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1087],
        [0.1090, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1093, 0.1089, 0.1091, 0.1089, 0.1088, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5718014
Epoch840: train_loss: 4.0503 recon_acc: 0.6502 val_roc: 0.7751 val_ap: 0.8341 f1: 0.7167 time: 0.2656
difference_matrix tensor([[0.0000, 0.1088, 0.1092, 0.1088, 0.1089, 0.1091, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1093, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1092, 0.1093, 0.0000, 0.1094, 0.1093, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1092],
        [0.1088, 0.1088, 0.1094, 0.0000, 0.1092, 0.1097, 0.1088, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1087, 0.1093, 0.1092, 0.0000, 0.1086, 0.1094, 0.1090, 0.1093,
         0.1091],
        [0.1091, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1095, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1083, 0.1085, 0.1088, 0.1094, 0.1095, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1083, 0.1093, 0.1084, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1087],
        [0.1090, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1092, 0.1089, 0.1091, 0.1089, 0.1088, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57145697
Epoch841: train_loss: 4.0502 recon_acc: 0.6496 val_roc: 0.7751 val_ap: 0.8341 f1: 0.7167 time: 0.2668
difference_matrix tensor([[0.0000, 0.1088, 0.1091, 0.1088, 0.1089, 0.1091, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1093, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1091, 0.1093, 0.0000, 0.1094, 0.1093, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1092],
        [0.1088, 0.1088, 0.1094, 0.0000, 0.1092, 0.1097, 0.1088, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1087, 0.1093, 0.1092, 0.0000, 0.1086, 0.1094, 0.1090, 0.1093,
         0.1091],
        [0.1091, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1095, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1083, 0.1085, 0.1088, 0.1094, 0.1095, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1083, 0.1093, 0.1084, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1087],
        [0.1090, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1092, 0.1089, 0.1091, 0.1089, 0.1088, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5711129
Epoch842: train_loss: 4.0502 recon_acc: 0.6490 val_roc: 0.7752 val_ap: 0.8342 f1: 0.7167 time: 0.2755
difference_matrix tensor([[0.0000, 0.1088, 0.1091, 0.1088, 0.1089, 0.1091, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1093, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1091, 0.1093, 0.0000, 0.1094, 0.1093, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1092],
        [0.1088, 0.1088, 0.1094, 0.0000, 0.1092, 0.1097, 0.1088, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1087, 0.1093, 0.1092, 0.0000, 0.1086, 0.1093, 0.1090, 0.1093,
         0.1091],
        [0.1091, 0.1093, 0.1087, 0.1097, 0.1086, 0.0000, 0.1095, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1083, 0.1085, 0.1088, 0.1093, 0.1095, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1083, 0.1093, 0.1084, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1087],
        [0.1090, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1092, 0.1089, 0.1091, 0.1089, 0.1088, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5707691
Epoch843: train_loss: 4.0501 recon_acc: 0.6484 val_roc: 0.7752 val_ap: 0.8342 f1: 0.7167 time: 0.2753
difference_matrix tensor([[0.0000, 0.1088, 0.1091, 0.1088, 0.1089, 0.1091, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1091, 0.1093, 0.0000, 0.1094, 0.1093, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1092],
        [0.1088, 0.1088, 0.1094, 0.0000, 0.1092, 0.1097, 0.1088, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1087, 0.1093, 0.1092, 0.0000, 0.1086, 0.1093, 0.1090, 0.1093,
         0.1091],
        [0.1091, 0.1092, 0.1087, 0.1097, 0.1086, 0.0000, 0.1095, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1083, 0.1085, 0.1088, 0.1093, 0.1095, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1083, 0.1093, 0.1084, 0.1090, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1087],
        [0.1090, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1092, 0.1089, 0.1091, 0.1089, 0.1088, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5704257
Epoch844: train_loss: 4.0501 recon_acc: 0.6478 val_roc: 0.7753 val_ap: 0.8343 f1: 0.7167 time: 0.2506
difference_matrix tensor([[0.0000, 0.1088, 0.1091, 0.1087, 0.1089, 0.1091, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1091, 0.1093, 0.0000, 0.1094, 0.1093, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1097, 0.1088, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1086, 0.1093, 0.1089, 0.1093,
         0.1091],
        [0.1091, 0.1092, 0.1087, 0.1097, 0.1086, 0.0000, 0.1095, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1083, 0.1085, 0.1088, 0.1093, 0.1095, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1083, 0.1093, 0.1084, 0.1089, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1087],
        [0.1090, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1092, 0.1089, 0.1091, 0.1089, 0.1088, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5700826
Epoch845: train_loss: 4.0501 recon_acc: 0.6472 val_roc: 0.7753 val_ap: 0.8343 f1: 0.7167 time: 0.2570
difference_matrix tensor([[0.0000, 0.1088, 0.1091, 0.1087, 0.1089, 0.1091, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1091, 0.1093, 0.0000, 0.1094, 0.1093, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1097, 0.1088, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1086, 0.1093, 0.1089, 0.1093,
         0.1091],
        [0.1091, 0.1092, 0.1087, 0.1097, 0.1086, 0.0000, 0.1095, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1083, 0.1085, 0.1088, 0.1093, 0.1095, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1083, 0.1093, 0.1084, 0.1089, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1087],
        [0.1090, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1092, 0.1089, 0.1091, 0.1089, 0.1088, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5697399
Epoch846: train_loss: 4.0500 recon_acc: 0.6466 val_roc: 0.7754 val_ap: 0.8344 f1: 0.7167 time: 0.2717
difference_matrix tensor([[0.0000, 0.1088, 0.1091, 0.1087, 0.1089, 0.1091, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1091, 0.1093, 0.0000, 0.1094, 0.1093, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1097, 0.1088, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1086, 0.1093, 0.1089, 0.1093,
         0.1091],
        [0.1091, 0.1092, 0.1087, 0.1097, 0.1086, 0.0000, 0.1095, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1083, 0.1085, 0.1088, 0.1093, 0.1095, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1083, 0.1093, 0.1084, 0.1089, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1087],
        [0.1090, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1092, 0.1089, 0.1091, 0.1089, 0.1088, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0410, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5693975
Epoch847: train_loss: 4.0500 recon_acc: 0.6459 val_roc: 0.7754 val_ap: 0.8344 f1: 0.7152 time: 0.2550
thresh 0.4115545
          test_roc: 0.7856 test_ap: 0.8408 test_f1: 0.7038 test_recon_acc: 0.3368
difference_matrix tensor([[0.0000, 0.1088, 0.1091, 0.1087, 0.1089, 0.1091, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1091, 0.1093, 0.0000, 0.1094, 0.1093, 0.1087, 0.1085, 0.1093, 0.1092,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1097, 0.1088, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1086, 0.1093, 0.1089, 0.1093,
         0.1091],
        [0.1091, 0.1092, 0.1087, 0.1097, 0.1086, 0.0000, 0.1095, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1083, 0.1085, 0.1088, 0.1093, 0.1095, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1083, 0.1093, 0.1084, 0.1089, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1087],
        [0.1090, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1092, 0.1089, 0.1091, 0.1089, 0.1088, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5794259
Epoch848: train_loss: 4.0500 recon_acc: 0.6645 val_roc: 0.7754 val_ap: 0.8345 f1: 0.7140 time: 0.3260
thresh 0.4110283
          test_roc: 0.7856 test_ap: 0.8408 test_f1: 0.7038 test_recon_acc: 0.3358
difference_matrix tensor([[0.0000, 0.1088, 0.1091, 0.1087, 0.1089, 0.1091, 0.1084, 0.1088, 0.1090,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1091, 0.1093, 0.0000, 0.1094, 0.1093, 0.1086, 0.1085, 0.1093, 0.1092,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1097, 0.1088, 0.1084, 0.1092,
         0.1089],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1086, 0.1093, 0.1089, 0.1093,
         0.1091],
        [0.1091, 0.1092, 0.1086, 0.1097, 0.1086, 0.0000, 0.1095, 0.1088, 0.1093,
         0.1089],
        [0.1084, 0.1083, 0.1085, 0.1088, 0.1093, 0.1095, 0.0000, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1083, 0.1093, 0.1084, 0.1089, 0.1088, 0.1083, 0.0000, 0.1092,
         0.1087],
        [0.1090, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1092, 0.1089, 0.1091, 0.1089, 0.1088, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.579512
Epoch849: train_loss: 4.0500 recon_acc: 0.6646 val_roc: 0.7757 val_ap: 0.8346 f1: 0.7140 time: 0.2457
thresh 0.40685448
          test_roc: 0.7856 test_ap: 0.8408 test_f1: 0.7037 test_recon_acc: 0.3277
difference_matrix tensor([[0.0000, 0.1088, 0.1091, 0.1087, 0.1089, 0.1091, 0.1083, 0.1088, 0.1089,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1091, 0.1093, 0.0000, 0.1094, 0.1093, 0.1086, 0.1085, 0.1093, 0.1092,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1097, 0.1088, 0.1084, 0.1092,
         0.1088],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1086, 0.1093, 0.1089, 0.1093,
         0.1091],
        [0.1091, 0.1092, 0.1086, 0.1097, 0.1086, 0.0000, 0.1095, 0.1088, 0.1093,
         0.1089],
        [0.1083, 0.1083, 0.1085, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1091,
         0.1087],
        [0.1088, 0.1083, 0.1093, 0.1084, 0.1089, 0.1088, 0.1082, 0.0000, 0.1092,
         0.1087],
        [0.1089, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1092, 0.1088, 0.1091, 0.1089, 0.1087, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5795977
Epoch850: train_loss: 4.0499 recon_acc: 0.6648 val_roc: 0.7756 val_ap: 0.8346 f1: 0.7140 time: 0.2530
difference_matrix tensor([[0.0000, 0.1088, 0.1091, 0.1087, 0.1089, 0.1091, 0.1083, 0.1088, 0.1089,
         0.1092],
        [0.1088, 0.0000, 0.1093, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1091, 0.1093, 0.0000, 0.1094, 0.1093, 0.1086, 0.1085, 0.1093, 0.1092,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1097, 0.1088, 0.1084, 0.1092,
         0.1088],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1086, 0.1093, 0.1089, 0.1093,
         0.1091],
        [0.1091, 0.1092, 0.1086, 0.1097, 0.1086, 0.0000, 0.1095, 0.1087, 0.1093,
         0.1089],
        [0.1083, 0.1083, 0.1085, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1091,
         0.1087],
        [0.1088, 0.1083, 0.1093, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1092,
         0.1087],
        [0.1089, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1092, 0.1088, 0.1091, 0.1089, 0.1087, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57968295
Epoch851: train_loss: 4.0499 recon_acc: 0.6650 val_roc: 0.7755 val_ap: 0.8346 f1: 0.7140 time: 0.2501
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1089, 0.1091, 0.1083, 0.1088, 0.1089,
         0.1092],
        [0.1087, 0.0000, 0.1093, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1091, 0.1093, 0.0000, 0.1094, 0.1093, 0.1086, 0.1085, 0.1093, 0.1092,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1097, 0.1088, 0.1084, 0.1092,
         0.1088],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1086, 0.1093, 0.1089, 0.1093,
         0.1091],
        [0.1091, 0.1092, 0.1086, 0.1097, 0.1086, 0.0000, 0.1095, 0.1087, 0.1093,
         0.1089],
        [0.1083, 0.1083, 0.1085, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1091,
         0.1087],
        [0.1088, 0.1083, 0.1093, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1092,
         0.1087],
        [0.1089, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1092, 0.1088, 0.1091, 0.1089, 0.1087, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5797677
Epoch852: train_loss: 4.0499 recon_acc: 0.6652 val_roc: 0.7755 val_ap: 0.8345 f1: 0.7140 time: 0.2605
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1089, 0.1091, 0.1083, 0.1088, 0.1089,
         0.1092],
        [0.1087, 0.0000, 0.1093, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1092,
         0.1086],
        [0.1091, 0.1093, 0.0000, 0.1094, 0.1093, 0.1086, 0.1085, 0.1093, 0.1092,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1096, 0.1088, 0.1084, 0.1092,
         0.1088],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1086, 0.1093, 0.1089, 0.1093,
         0.1091],
        [0.1091, 0.1092, 0.1086, 0.1096, 0.1086, 0.0000, 0.1095, 0.1087, 0.1093,
         0.1089],
        [0.1083, 0.1083, 0.1085, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1091,
         0.1087],
        [0.1088, 0.1083, 0.1093, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1092,
         0.1087],
        [0.1089, 0.1092, 0.1092, 0.1092, 0.1093, 0.1093, 0.1091, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1086, 0.1092, 0.1088, 0.1091, 0.1089, 0.1087, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57985216
Epoch853: train_loss: 4.0498 recon_acc: 0.6654 val_roc: 0.7756 val_ap: 0.8346 f1: 0.7140 time: 0.2588
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1089, 0.1091, 0.1083, 0.1088, 0.1089,
         0.1092],
        [0.1087, 0.0000, 0.1093, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1092,
         0.1085],
        [0.1091, 0.1093, 0.0000, 0.1094, 0.1093, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1096, 0.1088, 0.1084, 0.1092,
         0.1088],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1086, 0.1093, 0.1089, 0.1092,
         0.1091],
        [0.1091, 0.1092, 0.1086, 0.1096, 0.1086, 0.0000, 0.1095, 0.1087, 0.1093,
         0.1089],
        [0.1083, 0.1083, 0.1084, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1088, 0.1083, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1092,
         0.1087],
        [0.1089, 0.1092, 0.1091, 0.1092, 0.1092, 0.1093, 0.1090, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1085, 0.1092, 0.1088, 0.1091, 0.1089, 0.1087, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.579936
Epoch854: train_loss: 4.0498 recon_acc: 0.6655 val_roc: 0.7756 val_ap: 0.8347 f1: 0.7140 time: 0.2773
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1089, 0.1091, 0.1083, 0.1088, 0.1089,
         0.1092],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1091,
         0.1085],
        [0.1091, 0.1092, 0.0000, 0.1094, 0.1093, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1096, 0.1088, 0.1084, 0.1092,
         0.1088],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1086, 0.1093, 0.1089, 0.1092,
         0.1091],
        [0.1091, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1093,
         0.1089],
        [0.1083, 0.1083, 0.1084, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1088, 0.1083, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1092,
         0.1087],
        [0.1089, 0.1091, 0.1091, 0.1092, 0.1092, 0.1093, 0.1090, 0.1092, 0.0000,
         0.1092],
        [0.1092, 0.1085, 0.1092, 0.1088, 0.1091, 0.1089, 0.1087, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5800196
Epoch855: train_loss: 4.0498 recon_acc: 0.6657 val_roc: 0.7756 val_ap: 0.8347 f1: 0.7140 time: 0.2733
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1089, 0.1091, 0.1083, 0.1088, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1091,
         0.1085],
        [0.1091, 0.1092, 0.0000, 0.1094, 0.1093, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1096, 0.1088, 0.1084, 0.1092,
         0.1088],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1091],
        [0.1091, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1093,
         0.1089],
        [0.1083, 0.1083, 0.1084, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1088, 0.1083, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1092,
         0.1087],
        [0.1089, 0.1091, 0.1091, 0.1092, 0.1092, 0.1093, 0.1090, 0.1092, 0.0000,
         0.1092],
        [0.1091, 0.1085, 0.1092, 0.1088, 0.1091, 0.1089, 0.1087, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5801026
Epoch856: train_loss: 4.0497 recon_acc: 0.6659 val_roc: 0.7756 val_ap: 0.8347 f1: 0.7140 time: 0.2591
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1089, 0.1091, 0.1083, 0.1088, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1091,
         0.1085],
        [0.1091, 0.1092, 0.0000, 0.1094, 0.1093, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1096, 0.1088, 0.1084, 0.1092,
         0.1088],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1091],
        [0.1091, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1093,
         0.1089],
        [0.1083, 0.1083, 0.1084, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1088, 0.1083, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1092,
         0.1087],
        [0.1089, 0.1091, 0.1091, 0.1092, 0.1092, 0.1093, 0.1090, 0.1092, 0.0000,
         0.1092],
        [0.1091, 0.1085, 0.1092, 0.1088, 0.1091, 0.1089, 0.1087, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58018523
Epoch857: train_loss: 4.0497 recon_acc: 0.6661 val_roc: 0.7755 val_ap: 0.8347 f1: 0.7140 time: 0.2595
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1089, 0.1091, 0.1083, 0.1088, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1091,
         0.1085],
        [0.1091, 0.1092, 0.0000, 0.1094, 0.1093, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1096, 0.1088, 0.1084, 0.1092,
         0.1088],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1091],
        [0.1091, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1093,
         0.1089],
        [0.1083, 0.1083, 0.1084, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1088, 0.1083, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1087],
        [0.1089, 0.1091, 0.1091, 0.1092, 0.1092, 0.1093, 0.1090, 0.1091, 0.0000,
         0.1092],
        [0.1091, 0.1085, 0.1092, 0.1088, 0.1091, 0.1089, 0.1087, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5802674
Epoch858: train_loss: 4.0497 recon_acc: 0.6662 val_roc: 0.7755 val_ap: 0.8347 f1: 0.7140 time: 0.2660
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1089, 0.1091, 0.1083, 0.1088, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1087, 0.1092, 0.1083, 0.1083, 0.1091,
         0.1085],
        [0.1091, 0.1092, 0.0000, 0.1094, 0.1093, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1096, 0.1088, 0.1084, 0.1092,
         0.1088],
        [0.1089, 0.1087, 0.1093, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1090],
        [0.1091, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1093,
         0.1089],
        [0.1083, 0.1083, 0.1084, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1088, 0.1083, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1087],
        [0.1089, 0.1091, 0.1091, 0.1092, 0.1092, 0.1093, 0.1090, 0.1091, 0.0000,
         0.1092],
        [0.1091, 0.1085, 0.1092, 0.1088, 0.1090, 0.1089, 0.1087, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5803491
Epoch859: train_loss: 4.0496 recon_acc: 0.6664 val_roc: 0.7754 val_ap: 0.8347 f1: 0.7140 time: 0.2689
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1088, 0.1090, 0.1083, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1086, 0.1092, 0.1083, 0.1083, 0.1091,
         0.1085],
        [0.1091, 0.1092, 0.0000, 0.1094, 0.1093, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1096, 0.1088, 0.1084, 0.1092,
         0.1088],
        [0.1088, 0.1086, 0.1093, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1090],
        [0.1090, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1093,
         0.1089],
        [0.1083, 0.1083, 0.1084, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1083, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1087],
        [0.1089, 0.1091, 0.1091, 0.1092, 0.1092, 0.1093, 0.1090, 0.1091, 0.0000,
         0.1092],
        [0.1091, 0.1085, 0.1092, 0.1088, 0.1090, 0.1089, 0.1087, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58043045
Epoch860: train_loss: 4.0496 recon_acc: 0.6666 val_roc: 0.7754 val_ap: 0.8347 f1: 0.7140 time: 0.2542
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1088, 0.1090, 0.1083, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1086, 0.1092, 0.1083, 0.1083, 0.1091,
         0.1085],
        [0.1091, 0.1092, 0.0000, 0.1094, 0.1093, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1096, 0.1088, 0.1084, 0.1092,
         0.1088],
        [0.1088, 0.1086, 0.1093, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1090],
        [0.1090, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1092,
         0.1089],
        [0.1083, 0.1083, 0.1084, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1083, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1087],
        [0.1089, 0.1091, 0.1091, 0.1092, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1092],
        [0.1091, 0.1085, 0.1092, 0.1088, 0.1090, 0.1089, 0.1087, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5805112
Epoch861: train_loss: 4.0496 recon_acc: 0.6668 val_roc: 0.7755 val_ap: 0.8347 f1: 0.7140 time: 0.2533
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1088, 0.1090, 0.1083, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1086, 0.1092, 0.1082, 0.1083, 0.1091,
         0.1085],
        [0.1091, 0.1092, 0.0000, 0.1094, 0.1093, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1094, 0.0000, 0.1091, 0.1096, 0.1088, 0.1084, 0.1092,
         0.1088],
        [0.1088, 0.1086, 0.1093, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1090],
        [0.1090, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1092,
         0.1088],
        [0.1083, 0.1082, 0.1084, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1083, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1087],
        [0.1089, 0.1091, 0.1091, 0.1092, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1092],
        [0.1091, 0.1085, 0.1092, 0.1088, 0.1090, 0.1088, 0.1087, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5805916
Epoch862: train_loss: 4.0495 recon_acc: 0.6669 val_roc: 0.7755 val_ap: 0.8347 f1: 0.7140 time: 0.2556
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1088, 0.1090, 0.1083, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1086, 0.1092, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1091, 0.1092, 0.0000, 0.1093, 0.1093, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1093, 0.0000, 0.1091, 0.1096, 0.1088, 0.1084, 0.1092,
         0.1088],
        [0.1088, 0.1086, 0.1093, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1090],
        [0.1090, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1092,
         0.1088],
        [0.1083, 0.1082, 0.1084, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1087],
        [0.1089, 0.1091, 0.1091, 0.1092, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1092],
        [0.1091, 0.1085, 0.1092, 0.1088, 0.1090, 0.1088, 0.1087, 0.1087, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5806715
Epoch863: train_loss: 4.0495 recon_acc: 0.6671 val_roc: 0.7754 val_ap: 0.8347 f1: 0.7140 time: 0.2504
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1088, 0.1090, 0.1083, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1086, 0.1092, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1091, 0.1092, 0.0000, 0.1093, 0.1092, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1093, 0.0000, 0.1091, 0.1096, 0.1088, 0.1084, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1090],
        [0.1090, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1092,
         0.1088],
        [0.1083, 0.1082, 0.1084, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1091, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1092],
        [0.1091, 0.1085, 0.1092, 0.1088, 0.1090, 0.1088, 0.1087, 0.1086, 0.1092,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58075094
Epoch864: train_loss: 4.0495 recon_acc: 0.6673 val_roc: 0.7754 val_ap: 0.8347 f1: 0.7140 time: 0.2571
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1088, 0.1090, 0.1083, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1086, 0.1092, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1091, 0.1092, 0.0000, 0.1093, 0.1092, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1093, 0.0000, 0.1091, 0.1096, 0.1088, 0.1084, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1090],
        [0.1090, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1092,
         0.1088],
        [0.1083, 0.1082, 0.1084, 0.1088, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1091, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1092, 0.1088, 0.1090, 0.1088, 0.1087, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58083
Epoch865: train_loss: 4.0494 recon_acc: 0.6674 val_roc: 0.7754 val_ap: 0.8347 f1: 0.7140 time: 0.2662
difference_matrix tensor([[0.0000, 0.1087, 0.1091, 0.1087, 0.1088, 0.1090, 0.1083, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1086, 0.1092, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1091, 0.1092, 0.0000, 0.1093, 0.1092, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1093, 0.0000, 0.1091, 0.1096, 0.1087, 0.1084, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1090],
        [0.1090, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1092,
         0.1088],
        [0.1083, 0.1082, 0.1084, 0.1087, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1091, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1092, 0.1088, 0.1090, 0.1088, 0.1087, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5809085
Epoch866: train_loss: 4.0494 recon_acc: 0.6676 val_roc: 0.7755 val_ap: 0.8347 f1: 0.7140 time: 0.2631
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1087, 0.1088, 0.1090, 0.1083, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1086, 0.1092, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1093, 0.0000, 0.1091, 0.1096, 0.1087, 0.1084, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1090],
        [0.1090, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1092,
         0.1088],
        [0.1083, 0.1082, 0.1084, 0.1087, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1091, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1092, 0.1088, 0.1090, 0.1088, 0.1087, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5809866
Epoch867: train_loss: 4.0494 recon_acc: 0.6678 val_roc: 0.7756 val_ap: 0.8348 f1: 0.7140 time: 0.2738
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1087, 0.1088, 0.1090, 0.1083, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1086, 0.1092, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1092],
        [0.1087, 0.1088, 0.1093, 0.0000, 0.1091, 0.1096, 0.1087, 0.1084, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1090],
        [0.1090, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1092,
         0.1088],
        [0.1083, 0.1082, 0.1084, 0.1087, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1091, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1092, 0.1088, 0.1090, 0.1088, 0.1087, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5810643
Epoch868: train_loss: 4.0494 recon_acc: 0.6680 val_roc: 0.7756 val_ap: 0.8348 f1: 0.7155 time: 0.2585
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1087, 0.1088, 0.1090, 0.1083, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1086, 0.1092, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1091],
        [0.1087, 0.1088, 0.1093, 0.0000, 0.1091, 0.1096, 0.1087, 0.1084, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1090],
        [0.1090, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1092,
         0.1088],
        [0.1083, 0.1082, 0.1084, 0.1087, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1091, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1091, 0.1088, 0.1090, 0.1088, 0.1087, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5811414
Epoch869: train_loss: 4.0493 recon_acc: 0.6681 val_roc: 0.7755 val_ap: 0.8347 f1: 0.7155 time: 0.2605
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1087, 0.1088, 0.1090, 0.1083, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1086, 0.1092, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1091],
        [0.1087, 0.1088, 0.1093, 0.0000, 0.1091, 0.1096, 0.1087, 0.1084, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1090],
        [0.1090, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1092,
         0.1088],
        [0.1083, 0.1082, 0.1084, 0.1087, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1091, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1091, 0.1088, 0.1090, 0.1088, 0.1087, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5812181
Epoch870: train_loss: 4.0493 recon_acc: 0.6683 val_roc: 0.7755 val_ap: 0.8348 f1: 0.7155 time: 0.2660
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1087, 0.1088, 0.1090, 0.1083, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1086, 0.1092, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1086, 0.1084, 0.1092, 0.1091,
         0.1091],
        [0.1087, 0.1088, 0.1093, 0.0000, 0.1091, 0.1096, 0.1087, 0.1084, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1091, 0.0000, 0.1085, 0.1093, 0.1089, 0.1092,
         0.1090],
        [0.1090, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1092,
         0.1088],
        [0.1083, 0.1082, 0.1084, 0.1087, 0.1093, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1084, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1091, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1091, 0.1088, 0.1090, 0.1088, 0.1087, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58129436
Epoch871: train_loss: 4.0493 recon_acc: 0.6685 val_roc: 0.7756 val_ap: 0.8348 f1: 0.7155 time: 0.2692
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1087, 0.1088, 0.1090, 0.1083, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1086, 0.1092, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1084, 0.1092, 0.1091,
         0.1091],
        [0.1087, 0.1088, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1085, 0.1092, 0.1089, 0.1092,
         0.1090],
        [0.1090, 0.1092, 0.1086, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1092,
         0.1088],
        [0.1083, 0.1082, 0.1084, 0.1087, 0.1092, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1089, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1091, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1091, 0.1088, 0.1090, 0.1088, 0.1087, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5813702
Epoch872: train_loss: 4.0492 recon_acc: 0.6686 val_roc: 0.7756 val_ap: 0.8349 f1: 0.7155 time: 0.2631
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1086, 0.1088, 0.1090, 0.1083, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1088, 0.1086, 0.1091, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1084, 0.1092, 0.1091,
         0.1091],
        [0.1086, 0.1088, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1085, 0.1092, 0.1088, 0.1092,
         0.1090],
        [0.1090, 0.1091, 0.1085, 0.1096, 0.1085, 0.0000, 0.1095, 0.1087, 0.1092,
         0.1088],
        [0.1083, 0.1082, 0.1084, 0.1087, 0.1092, 0.1095, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1088, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1091, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1091, 0.1088, 0.1090, 0.1088, 0.1087, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58144546
Epoch873: train_loss: 4.0492 recon_acc: 0.6688 val_roc: 0.7757 val_ap: 0.8349 f1: 0.7155 time: 0.2474
thresh 0.40663415
          test_roc: 0.7857 test_ap: 0.8411 test_f1: 0.7032 test_recon_acc: 0.3276
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1086, 0.1088, 0.1090, 0.1082, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1084, 0.1092, 0.1091,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1085, 0.1092, 0.1088, 0.1092,
         0.1090],
        [0.1090, 0.1091, 0.1085, 0.1096, 0.1085, 0.0000, 0.1094, 0.1087, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1084, 0.1087, 0.1092, 0.1094, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1088, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1091, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1091, 0.1088, 0.1090, 0.1088, 0.1087, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58152026
Epoch874: train_loss: 4.0492 recon_acc: 0.6690 val_roc: 0.7755 val_ap: 0.8349 f1: 0.7155 time: 0.2473
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1086, 0.1088, 0.1090, 0.1082, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1084, 0.1092, 0.1091,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1085, 0.1092, 0.1088, 0.1092,
         0.1090],
        [0.1090, 0.1091, 0.1085, 0.1096, 0.1085, 0.0000, 0.1094, 0.1087, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1084, 0.1087, 0.1092, 0.1094, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1088, 0.1087, 0.1082, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1090, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1091, 0.1088, 0.1090, 0.1088, 0.1087, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58159465
Epoch875: train_loss: 4.0491 recon_acc: 0.6691 val_roc: 0.7756 val_ap: 0.8350 f1: 0.7171 time: 0.2717
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1086, 0.1088, 0.1090, 0.1082, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1084, 0.1092, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1085, 0.1092, 0.1088, 0.1092,
         0.1090],
        [0.1090, 0.1091, 0.1085, 0.1096, 0.1085, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1084, 0.1087, 0.1092, 0.1094, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1088, 0.1086, 0.1082, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1090, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1091, 0.1088, 0.1090, 0.1088, 0.1087, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0411, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5816685
Epoch876: train_loss: 4.0491 recon_acc: 0.6693 val_roc: 0.7756 val_ap: 0.8350 f1: 0.7171 time: 0.2836
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1086, 0.1088, 0.1090, 0.1082, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1084, 0.1092, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1085, 0.1092, 0.1088, 0.1092,
         0.1090],
        [0.1090, 0.1091, 0.1085, 0.1096, 0.1085, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1084, 0.1087, 0.1092, 0.1094, 0.0000, 0.1082, 0.1090,
         0.1087],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1088, 0.1086, 0.1082, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1090, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1091, 0.1088, 0.1090, 0.1088, 0.1087, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58174187
Epoch877: train_loss: 4.0491 recon_acc: 0.6694 val_roc: 0.7756 val_ap: 0.8350 f1: 0.7171 time: 0.2680
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1086, 0.1088, 0.1090, 0.1082, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1092, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1088],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1085, 0.1092, 0.1088, 0.1092,
         0.1090],
        [0.1090, 0.1091, 0.1085, 0.1096, 0.1085, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1090,
         0.1086],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1090, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1091, 0.1088, 0.1090, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5817513
Epoch878: train_loss: 4.0491 recon_acc: 0.6695 val_roc: 0.7755 val_ap: 0.8349 f1: 0.7171 time: 0.2499
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1086, 0.1088, 0.1090, 0.1082, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1092, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1085, 0.1092, 0.1088, 0.1092,
         0.1090],
        [0.1090, 0.1091, 0.1085, 0.1096, 0.1085, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1090,
         0.1086],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1090, 0.1091, 0.1092, 0.1092, 0.1090, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1091, 0.1087, 0.1090, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58165014
Epoch879: train_loss: 4.0490 recon_acc: 0.6693 val_roc: 0.7755 val_ap: 0.8349 f1: 0.7171 time: 0.2450
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1086, 0.1088, 0.1090, 0.1082, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1092, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1085, 0.1092, 0.1088, 0.1092,
         0.1090],
        [0.1090, 0.1091, 0.1085, 0.1096, 0.1085, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1090, 0.1091, 0.1092, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1091, 0.1087, 0.1090, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58154917
Epoch880: train_loss: 4.0490 recon_acc: 0.6691 val_roc: 0.7754 val_ap: 0.8349 f1: 0.7171 time: 0.2515
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1086, 0.1088, 0.1090, 0.1082, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1091,
         0.1085],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1092, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1085, 0.1092, 0.1088, 0.1092,
         0.1090],
        [0.1090, 0.1091, 0.1085, 0.1096, 0.1085, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1090, 0.1091, 0.1092, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1085, 0.1091, 0.1087, 0.1090, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5814484
Epoch881: train_loss: 4.0490 recon_acc: 0.6690 val_roc: 0.7754 val_ap: 0.8349 f1: 0.7171 time: 0.2609
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1086, 0.1088, 0.1090, 0.1082, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1091,
         0.1084],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1092, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1085, 0.1092, 0.1088, 0.1092,
         0.1090],
        [0.1090, 0.1091, 0.1085, 0.1096, 0.1085, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1090, 0.1091, 0.1092, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1084, 0.1091, 0.1087, 0.1090, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5813477
Epoch882: train_loss: 4.0489 recon_acc: 0.6688 val_roc: 0.7754 val_ap: 0.8349 f1: 0.7171 time: 0.2765
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1086, 0.1088, 0.1090, 0.1082, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1091,
         0.1084],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1092, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1085, 0.1092, 0.1088, 0.1092,
         0.1090],
        [0.1090, 0.1091, 0.1085, 0.1096, 0.1085, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1090, 0.1091, 0.1092, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1084, 0.1091, 0.1087, 0.1090, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5812472
Epoch883: train_loss: 4.0489 recon_acc: 0.6686 val_roc: 0.7753 val_ap: 0.8349 f1: 0.7171 time: 0.2674
difference_matrix tensor([[0.0000, 0.1087, 0.1090, 0.1086, 0.1088, 0.1090, 0.1082, 0.1087, 0.1089,
         0.1091],
        [0.1087, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1091,
         0.1084],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1092, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1085, 0.1092, 0.1088, 0.1091,
         0.1090],
        [0.1090, 0.1091, 0.1085, 0.1096, 0.1085, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1090, 0.1091, 0.1091, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1084, 0.1091, 0.1087, 0.1090, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5811469
Epoch884: train_loss: 4.0489 recon_acc: 0.6685 val_roc: 0.7754 val_ap: 0.8349 f1: 0.7171 time: 0.2521
difference_matrix tensor([[0.0000, 0.1086, 0.1090, 0.1086, 0.1088, 0.1090, 0.1082, 0.1087, 0.1089,
         0.1091],
        [0.1086, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1091,
         0.1084],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1092, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1085, 0.1092, 0.1088, 0.1091,
         0.1090],
        [0.1090, 0.1091, 0.1085, 0.1096, 0.1085, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1089, 0.1091, 0.1090, 0.1091, 0.1091, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1084, 0.1091, 0.1087, 0.1090, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5810468
Epoch885: train_loss: 4.0489 recon_acc: 0.6683 val_roc: 0.7753 val_ap: 0.8348 f1: 0.7171 time: 0.2529
difference_matrix tensor([[0.0000, 0.1086, 0.1090, 0.1086, 0.1088, 0.1090, 0.1082, 0.1087, 0.1088,
         0.1091],
        [0.1086, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1090,
         0.1084],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1092, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1090],
        [0.1090, 0.1091, 0.1085, 0.1096, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1087, 0.1082, 0.1092, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1088, 0.1090, 0.1090, 0.1091, 0.1091, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1084, 0.1091, 0.1087, 0.1090, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58094686
Epoch886: train_loss: 4.0488 recon_acc: 0.6682 val_roc: 0.7753 val_ap: 0.8348 f1: 0.7171 time: 0.2561
difference_matrix tensor([[0.0000, 0.1086, 0.1090, 0.1086, 0.1088, 0.1089, 0.1082, 0.1087, 0.1088,
         0.1091],
        [0.1086, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1090,
         0.1084],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1091, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1090],
        [0.1089, 0.1091, 0.1085, 0.1096, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1087, 0.1082, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1088, 0.1090, 0.1090, 0.1091, 0.1091, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1091, 0.1084, 0.1091, 0.1087, 0.1090, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.580847
Epoch887: train_loss: 4.0488 recon_acc: 0.6680 val_roc: 0.7752 val_ap: 0.8348 f1: 0.7171 time: 0.2702
difference_matrix tensor([[0.0000, 0.1086, 0.1090, 0.1086, 0.1088, 0.1089, 0.1082, 0.1087, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1090,
         0.1084],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1091, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1096, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1088, 0.1086, 0.1092, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1090],
        [0.1089, 0.1091, 0.1085, 0.1096, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1087, 0.1082, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1088, 0.1090, 0.1090, 0.1091, 0.1091, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1091, 0.1087, 0.1090, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58074737
Epoch888: train_loss: 4.0488 recon_acc: 0.6679 val_roc: 0.7753 val_ap: 0.8349 f1: 0.7171 time: 0.2674
difference_matrix tensor([[0.0000, 0.1086, 0.1090, 0.1086, 0.1087, 0.1089, 0.1082, 0.1087, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1082, 0.1082, 0.1090,
         0.1084],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1091, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1095, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1087, 0.1086, 0.1092, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1085, 0.1095, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1082, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1087, 0.1082, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1088, 0.1090, 0.1090, 0.1091, 0.1091, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1091, 0.1087, 0.1089, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5806479
Epoch889: train_loss: 4.0487 recon_acc: 0.6677 val_roc: 0.7753 val_ap: 0.8349 f1: 0.7171 time: 0.2603
difference_matrix tensor([[0.0000, 0.1086, 0.1090, 0.1086, 0.1087, 0.1089, 0.1082, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1081, 0.1082, 0.1090,
         0.1084],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1091, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1095, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1087, 0.1086, 0.1092, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1085, 0.1095, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1081, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1082, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1088, 0.1090, 0.1090, 0.1091, 0.1091, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1091, 0.1087, 0.1089, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5805486
Epoch890: train_loss: 4.0487 recon_acc: 0.6676 val_roc: 0.7752 val_ap: 0.8349 f1: 0.7171 time: 0.2469
difference_matrix tensor([[0.0000, 0.1086, 0.1090, 0.1086, 0.1087, 0.1089, 0.1082, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1081, 0.1082, 0.1090,
         0.1084],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1091, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1095, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1087, 0.1086, 0.1092, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1085, 0.1095, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1081, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1082, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1088, 0.1090, 0.1090, 0.1091, 0.1091, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1091, 0.1087, 0.1089, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5804494
Epoch891: train_loss: 4.0487 recon_acc: 0.6674 val_roc: 0.7752 val_ap: 0.8349 f1: 0.7171 time: 0.2582
difference_matrix tensor([[0.0000, 0.1086, 0.1090, 0.1086, 0.1087, 0.1089, 0.1082, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1092, 0.1087, 0.1086, 0.1091, 0.1081, 0.1082, 0.1090,
         0.1084],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1091, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1095, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1087, 0.1086, 0.1092, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1085, 0.1095, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1081, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1082, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1088, 0.1090, 0.1090, 0.1091, 0.1091, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1091, 0.1087, 0.1089, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58035046
Epoch892: train_loss: 4.0487 recon_acc: 0.6673 val_roc: 0.7753 val_ap: 0.8350 f1: 0.7171 time: 0.2669
difference_matrix tensor([[0.0000, 0.1086, 0.1090, 0.1086, 0.1087, 0.1089, 0.1082, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1092, 0.1087, 0.1085, 0.1091, 0.1081, 0.1082, 0.1090,
         0.1084],
        [0.1090, 0.1092, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1091, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1095, 0.1087, 0.1083, 0.1091,
         0.1087],
        [0.1087, 0.1085, 0.1092, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1085, 0.1095, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1081, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1082, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1088, 0.1090, 0.1090, 0.1091, 0.1091, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1091, 0.1087, 0.1089, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5802516
Epoch893: train_loss: 4.0486 recon_acc: 0.6671 val_roc: 0.7753 val_ap: 0.8350 f1: 0.7171 time: 0.2763
difference_matrix tensor([[0.0000, 0.1086, 0.1090, 0.1086, 0.1087, 0.1089, 0.1082, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1091, 0.1081, 0.1082, 0.1090,
         0.1084],
        [0.1090, 0.1091, 0.0000, 0.1093, 0.1092, 0.1085, 0.1083, 0.1091, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1095, 0.1087, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1092, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1085, 0.1095, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1088],
        [0.1082, 0.1081, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1082, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1088, 0.1090, 0.1090, 0.1090, 0.1091, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1091, 0.1087, 0.1089, 0.1088, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57311094
Epoch894: train_loss: 4.0486 recon_acc: 0.6540 val_roc: 0.7753 val_ap: 0.8350 f1: 0.7183 time: 0.2713
difference_matrix tensor([[0.0000, 0.1086, 0.1090, 0.1086, 0.1087, 0.1089, 0.1082, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1091, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1090, 0.1091, 0.0000, 0.1093, 0.1091, 0.1085, 0.1083, 0.1091, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1093, 0.0000, 0.1090, 0.1095, 0.1087, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1085, 0.1095, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1087],
        [0.1082, 0.1081, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1088, 0.1090, 0.1090, 0.1090, 0.1091, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1091, 0.1087, 0.1089, 0.1087, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57365423
Epoch895: train_loss: 4.0486 recon_acc: 0.6550 val_roc: 0.7752 val_ap: 0.8350 f1: 0.7183 time: 0.2702
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1086, 0.1087, 0.1089, 0.1082, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1091, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1093, 0.1091, 0.1085, 0.1083, 0.1091, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1092, 0.0000, 0.1090, 0.1095, 0.1087, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1085, 0.1095, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1087],
        [0.1082, 0.1081, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1091,
         0.1086],
        [0.1088, 0.1090, 0.1090, 0.1090, 0.1091, 0.1092, 0.1089, 0.1091, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1091, 0.1087, 0.1089, 0.1087, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57419866
Epoch896: train_loss: 4.0486 recon_acc: 0.6560 val_roc: 0.7752 val_ap: 0.8350 f1: 0.7183 time: 0.2623
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1086, 0.1087, 0.1089, 0.1082, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1091, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1085, 0.1083, 0.1091, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1092, 0.0000, 0.1090, 0.1095, 0.1087, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1085, 0.1095, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1087],
        [0.1082, 0.1081, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1090,
         0.1086],
        [0.1088, 0.1090, 0.1090, 0.1090, 0.1091, 0.1092, 0.1089, 0.1090, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1091, 0.1087, 0.1089, 0.1087, 0.1086, 0.1086, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5747439
Epoch897: train_loss: 4.0485 recon_acc: 0.6570 val_roc: 0.7752 val_ap: 0.8350 f1: 0.7183 time: 0.2797
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1086, 0.1087, 0.1089, 0.1082, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1091, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1085, 0.1083, 0.1091, 0.1090,
         0.1091],
        [0.1086, 0.1087, 0.1092, 0.0000, 0.1090, 0.1095, 0.1087, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1085, 0.1095, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1087],
        [0.1082, 0.1081, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1090, 0.1090, 0.1091, 0.1092, 0.1089, 0.1090, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1091, 0.1087, 0.1089, 0.1087, 0.1086, 0.1085, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57529014
Epoch898: train_loss: 4.0485 recon_acc: 0.6581 val_roc: 0.7752 val_ap: 0.8350 f1: 0.7183 time: 0.2712
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1086, 0.1087, 0.1089, 0.1082, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1091, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1083, 0.1091, 0.1089,
         0.1091],
        [0.1086, 0.1087, 0.1092, 0.0000, 0.1090, 0.1095, 0.1087, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1087],
        [0.1082, 0.1081, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1092, 0.1089, 0.1090, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1091, 0.1087, 0.1089, 0.1087, 0.1086, 0.1085, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57583725
Epoch899: train_loss: 4.0485 recon_acc: 0.6591 val_roc: 0.7752 val_ap: 0.8351 f1: 0.7183 time: 0.2551
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1086, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1091, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1083, 0.1091, 0.1089,
         0.1090],
        [0.1086, 0.1087, 0.1092, 0.0000, 0.1090, 0.1095, 0.1087, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1086, 0.1092,
         0.1087],
        [0.1081, 0.1081, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1092, 0.1089, 0.1090, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1090, 0.1087, 0.1089, 0.1087, 0.1086, 0.1085, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57638544
Epoch900: train_loss: 4.0484 recon_acc: 0.6601 val_roc: 0.7752 val_ap: 0.8351 f1: 0.7198 time: 0.2680
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1086, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1091, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1083, 0.1091, 0.1089,
         0.1090],
        [0.1086, 0.1087, 0.1092, 0.0000, 0.1090, 0.1095, 0.1087, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1086, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1089, 0.1090, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1090, 0.1087, 0.1089, 0.1087, 0.1086, 0.1085, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5769345
Epoch901: train_loss: 4.0484 recon_acc: 0.6611 val_roc: 0.7751 val_ap: 0.8350 f1: 0.7198 time: 0.2421
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1086, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1091, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1083, 0.1091, 0.1089,
         0.1090],
        [0.1086, 0.1087, 0.1092, 0.0000, 0.1090, 0.1095, 0.1087, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1090, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1086, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1083, 0.1087, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1088, 0.1086, 0.1081, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1089, 0.1090, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1090, 0.1087, 0.1089, 0.1087, 0.1086, 0.1085, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5774845
Epoch902: train_loss: 4.0484 recon_acc: 0.6622 val_roc: 0.7751 val_ap: 0.8350 f1: 0.7198 time: 0.2629
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1086, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1091, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1083, 0.1091, 0.1089,
         0.1090],
        [0.1086, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1083, 0.1086, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1088, 0.1085, 0.1081, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1089, 0.1090, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1090, 0.1087, 0.1089, 0.1087, 0.1086, 0.1085, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5780353
Epoch903: train_loss: 4.0484 recon_acc: 0.6633 val_roc: 0.7752 val_ap: 0.8351 f1: 0.7198 time: 0.2710
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1086, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1091, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1083, 0.1091, 0.1089,
         0.1090],
        [0.1086, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1092, 0.1088, 0.1091,
         0.1089],
        [0.1089, 0.1091, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1083, 0.1086, 0.1092, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1088, 0.1085, 0.1081, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1089, 0.1090, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1090, 0.1087, 0.1089, 0.1087, 0.1086, 0.1085, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.578587
Epoch904: train_loss: 4.0483 recon_acc: 0.6643 val_roc: 0.7751 val_ap: 0.8352 f1: 0.7198 time: 0.2616
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1086, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1086, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1091,
         0.1089],
        [0.1089, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1087, 0.1085, 0.1081, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1089, 0.1090, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1090, 0.1087, 0.1089, 0.1087, 0.1086, 0.1085, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5790775
Epoch905: train_loss: 4.0483 recon_acc: 0.6652 val_roc: 0.7751 val_ap: 0.8351 f1: 0.7198 time: 0.2527
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1091,
         0.1089],
        [0.1089, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1087, 0.1085, 0.1081, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1089, 0.1090, 0.0000,
         0.1091],
        [0.1090, 0.1084, 0.1090, 0.1087, 0.1089, 0.1087, 0.1086, 0.1085, 0.1091,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5789806
Epoch906: train_loss: 4.0483 recon_acc: 0.6650 val_roc: 0.7751 val_ap: 0.8352 f1: 0.7198 time: 0.2541
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1091,
         0.1089],
        [0.1089, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1087, 0.1085, 0.1081, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1089, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1084, 0.1090, 0.1087, 0.1089, 0.1087, 0.1086, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57888395
Epoch907: train_loss: 4.0483 recon_acc: 0.6649 val_roc: 0.7751 val_ap: 0.8352 f1: 0.7198 time: 0.2668
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1091,
         0.1089],
        [0.1089, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1087, 0.1085, 0.1081, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1089, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1084, 0.1090, 0.1087, 0.1089, 0.1087, 0.1086, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57878727
Epoch908: train_loss: 4.0482 recon_acc: 0.6647 val_roc: 0.7751 val_ap: 0.8352 f1: 0.7198 time: 0.2762
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1091,
         0.1089],
        [0.1089, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1094, 0.0000, 0.1081, 0.1089,
         0.1086],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1087, 0.1085, 0.1081, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1089, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1084, 0.1090, 0.1087, 0.1089, 0.1087, 0.1086, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5786908
Epoch909: train_loss: 4.0482 recon_acc: 0.6646 val_roc: 0.7752 val_ap: 0.8353 f1: 0.7198 time: 0.2785
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1091,
         0.1089],
        [0.1089, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1094, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1084, 0.1090, 0.1087, 0.1089, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0412, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5785946
Epoch910: train_loss: 4.0482 recon_acc: 0.6644 val_roc: 0.7752 val_ap: 0.8353 f1: 0.7198 time: 0.2519
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1083, 0.1090,
         0.1087],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1091,
         0.1089],
        [0.1089, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1094, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1086, 0.1081, 0.1091, 0.1083, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1084, 0.1090, 0.1087, 0.1089, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5784984
Epoch911: train_loss: 4.0482 recon_acc: 0.6643 val_roc: 0.7751 val_ap: 0.8353 f1: 0.7198 time: 0.2495
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1091,
         0.1089],
        [0.1089, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1094, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1086, 0.1081, 0.1091, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1084, 0.1090, 0.1086, 0.1089, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5784024
Epoch912: train_loss: 4.0481 recon_acc: 0.6641 val_roc: 0.7752 val_ap: 0.8354 f1: 0.7198 time: 0.2528
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1091,
         0.1089],
        [0.1089, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1094, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1094, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1086, 0.1081, 0.1091, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1084, 0.1090, 0.1086, 0.1089, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57830656
Epoch913: train_loss: 4.0481 recon_acc: 0.6640 val_roc: 0.7753 val_ap: 0.8355 f1: 0.7198 time: 0.2418
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1084],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1091,
         0.1089],
        [0.1089, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1086, 0.1081, 0.1091, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1084, 0.1090, 0.1086, 0.1089, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5841065
Epoch914: train_loss: 4.0481 recon_acc: 0.6746 val_roc: 0.7753 val_ap: 0.8355 f1: 0.7202 time: 0.2638
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1087, 0.1089, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1083],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1091,
         0.1089],
        [0.1089, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1086, 0.1081, 0.1091, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1083, 0.1090, 0.1086, 0.1089, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58416057
Epoch915: train_loss: 4.0481 recon_acc: 0.6747 val_roc: 0.7753 val_ap: 0.8355 f1: 0.7202 time: 0.2685
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1087, 0.1088, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1083],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1091,
         0.1089],
        [0.1088, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1086, 0.1081, 0.1091, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1083, 0.1090, 0.1086, 0.1089, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58421415
Epoch916: train_loss: 4.0480 recon_acc: 0.6748 val_roc: 0.7753 val_ap: 0.8355 f1: 0.7202 time: 0.2851
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1087, 0.1088, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1083],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1091,
         0.1089],
        [0.1088, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1086, 0.1081, 0.1091, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1083, 0.1090, 0.1086, 0.1089, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5842672
Epoch917: train_loss: 4.0480 recon_acc: 0.6749 val_roc: 0.7753 val_ap: 0.8355 f1: 0.7202 time: 0.2658
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1087, 0.1088, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1083],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1091,
         0.1089],
        [0.1088, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1086, 0.1081, 0.1091, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1091, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1083, 0.1090, 0.1086, 0.1089, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5843196
Epoch918: train_loss: 4.0480 recon_acc: 0.6750 val_roc: 0.7753 val_ap: 0.8355 f1: 0.7202 time: 0.2430
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1087, 0.1088, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1083],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1087, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1090,
         0.1089],
        [0.1088, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1086, 0.1081, 0.1091, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1083, 0.1090, 0.1086, 0.1089, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58437157
Epoch919: train_loss: 4.0480 recon_acc: 0.6751 val_roc: 0.7753 val_ap: 0.8355 f1: 0.7202 time: 0.2516
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1086, 0.1088, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1081, 0.1081, 0.1090,
         0.1083],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1086, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1090,
         0.1089],
        [0.1088, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1081, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1086, 0.1081, 0.1091, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1083, 0.1090, 0.1086, 0.1089, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58442295
Epoch920: train_loss: 4.0479 recon_acc: 0.6753 val_roc: 0.7754 val_ap: 0.8356 f1: 0.7202 time: 0.2562
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1086, 0.1088, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1080, 0.1081, 0.1090,
         0.1083],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1086, 0.1085, 0.1091, 0.1089, 0.0000, 0.1084, 0.1091, 0.1087, 0.1090,
         0.1089],
        [0.1088, 0.1090, 0.1084, 0.1095, 0.1084, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1080, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1086, 0.1081, 0.1091, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1083, 0.1090, 0.1086, 0.1089, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58447385
Epoch921: train_loss: 4.0479 recon_acc: 0.6754 val_roc: 0.7752 val_ap: 0.8355 f1: 0.7202 time: 0.2472
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1086, 0.1088, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1087, 0.1085, 0.1090, 0.1080, 0.1081, 0.1090,
         0.1083],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1086, 0.1085, 0.1091, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1089],
        [0.1088, 0.1090, 0.1084, 0.1095, 0.1083, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1080, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1086, 0.1081, 0.1091, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1090, 0.1089, 0.1090, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1083, 0.1090, 0.1086, 0.1089, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5845241
Epoch922: train_loss: 4.0479 recon_acc: 0.6755 val_roc: 0.7753 val_ap: 0.8355 f1: 0.7202 time: 0.2773
difference_matrix tensor([[0.0000, 0.1086, 0.1089, 0.1085, 0.1086, 0.1088, 0.1081, 0.1086, 0.1088,
         0.1090],
        [0.1086, 0.0000, 0.1091, 0.1086, 0.1085, 0.1090, 0.1080, 0.1081, 0.1089,
         0.1083],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1089,
         0.1090],
        [0.1085, 0.1087, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1086, 0.1085, 0.1091, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1084, 0.1095, 0.1083, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1080, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1086, 0.1081, 0.1091, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1089, 0.1089, 0.1090, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1083, 0.1090, 0.1086, 0.1088, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5845739
Epoch923: train_loss: 4.0479 recon_acc: 0.6756 val_roc: 0.7754 val_ap: 0.8356 f1: 0.7202 time: 0.2875
difference_matrix tensor([[0.0000, 0.1085, 0.1089, 0.1085, 0.1086, 0.1088, 0.1081, 0.1085, 0.1088,
         0.1090],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1085, 0.1090, 0.1080, 0.1081, 0.1089,
         0.1083],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1091, 0.1088,
         0.1090],
        [0.1085, 0.1086, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1086, 0.1085, 0.1091, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1084, 0.1095, 0.1083, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1080, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1081, 0.1091, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1089, 0.1088, 0.1090, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1083, 0.1090, 0.1086, 0.1088, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58462316
Epoch924: train_loss: 4.0478 recon_acc: 0.6757 val_roc: 0.7755 val_ap: 0.8356 f1: 0.7202 time: 0.2660
difference_matrix tensor([[0.0000, 0.1085, 0.1089, 0.1085, 0.1086, 0.1088, 0.1081, 0.1085, 0.1088,
         0.1090],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1085, 0.1090, 0.1080, 0.1081, 0.1089,
         0.1083],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1090, 0.1088,
         0.1090],
        [0.1085, 0.1086, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1086, 0.1085, 0.1091, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1084, 0.1095, 0.1083, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1080, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1081, 0.1090, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1089, 0.1088, 0.1090, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1090, 0.1083, 0.1090, 0.1086, 0.1088, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5846719
Epoch925: train_loss: 4.0478 recon_acc: 0.6758 val_roc: 0.7755 val_ap: 0.8357 f1: 0.7202 time: 0.2429
difference_matrix tensor([[0.0000, 0.1085, 0.1089, 0.1085, 0.1086, 0.1088, 0.1081, 0.1085, 0.1088,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1085, 0.1090, 0.1080, 0.1081, 0.1089,
         0.1083],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1090, 0.1088,
         0.1090],
        [0.1085, 0.1086, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1090,
         0.1086],
        [0.1086, 0.1085, 0.1091, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1084, 0.1095, 0.1083, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1080, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1081, 0.1090, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1089, 0.1088, 0.1090, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1090, 0.1086, 0.1088, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58471996
Epoch926: train_loss: 4.0478 recon_acc: 0.6759 val_roc: 0.7756 val_ap: 0.8357 f1: 0.7202 time: 0.2527
difference_matrix tensor([[0.0000, 0.1085, 0.1089, 0.1085, 0.1086, 0.1088, 0.1081, 0.1085, 0.1088,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1085, 0.1090, 0.1080, 0.1081, 0.1089,
         0.1083],
        [0.1089, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1090, 0.1088,
         0.1090],
        [0.1085, 0.1086, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1085, 0.1091, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1084, 0.1095, 0.1083, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1081, 0.1080, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1081, 0.1090, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1090, 0.1086, 0.1088, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5847676
Epoch927: train_loss: 4.0478 recon_acc: 0.6760 val_roc: 0.7756 val_ap: 0.8358 f1: 0.7202 time: 0.2626
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1088,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1085, 0.1090, 0.1080, 0.1081, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1092, 0.1091, 0.1084, 0.1082, 0.1090, 0.1088,
         0.1090],
        [0.1085, 0.1086, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1085, 0.1091, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1084, 0.1095, 0.1083, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1080, 0.1080, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1081, 0.1090, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1090, 0.1086, 0.1088, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5848146
Epoch928: train_loss: 4.0477 recon_acc: 0.6761 val_roc: 0.7758 val_ap: 0.8359 f1: 0.7217 time: 0.2776
thresh 0.48359734
          test_roc: 0.7856 test_ap: 0.8417 test_f1: 0.7042 test_recon_acc: 0.4810
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1088,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1085, 0.1090, 0.1080, 0.1081, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1092, 0.1091, 0.1083, 0.1082, 0.1090, 0.1088,
         0.1090],
        [0.1085, 0.1086, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1085, 0.1091, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1083, 0.1095, 0.1083, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1080, 0.1080, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1081, 0.1090, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1088, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1090, 0.1086, 0.1088, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58486116
Epoch929: train_loss: 4.0477 recon_acc: 0.6762 val_roc: 0.7757 val_ap: 0.8359 f1: 0.7217 time: 0.2541
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1084, 0.1090, 0.1080, 0.1081, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1092, 0.1091, 0.1083, 0.1082, 0.1090, 0.1088,
         0.1090],
        [0.1085, 0.1086, 0.1092, 0.0000, 0.1089, 0.1095, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1091, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1083, 0.1095, 0.1083, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1080, 0.1080, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1081, 0.1090, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1090, 0.1086, 0.1088, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58490705
Epoch930: train_loss: 4.0477 recon_acc: 0.6763 val_roc: 0.7757 val_ap: 0.8359 f1: 0.7217 time: 0.2553
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1084, 0.1090, 0.1080, 0.1081, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1092, 0.1091, 0.1083, 0.1082, 0.1090, 0.1088,
         0.1090],
        [0.1085, 0.1086, 0.1092, 0.0000, 0.1089, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1091, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1080, 0.1080, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1081, 0.1090, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1090, 0.1086, 0.1088, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5849525
Epoch931: train_loss: 4.0477 recon_acc: 0.6764 val_roc: 0.7756 val_ap: 0.8358 f1: 0.7217 time: 0.2604
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1084, 0.1090, 0.1080, 0.1081, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1092, 0.1091, 0.1083, 0.1082, 0.1090, 0.1088,
         0.1090],
        [0.1085, 0.1086, 0.1092, 0.0000, 0.1089, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1091, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1085, 0.1091,
         0.1087],
        [0.1080, 0.1080, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1081, 0.1090, 0.1082, 0.1087, 0.1085, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1090, 0.1086, 0.1088, 0.1087, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58499736
Epoch932: train_loss: 4.0476 recon_acc: 0.6765 val_roc: 0.7757 val_ap: 0.8359 f1: 0.7217 time: 0.2718
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1084, 0.1090, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1092, 0.1090, 0.1083, 0.1082, 0.1090, 0.1088,
         0.1090],
        [0.1085, 0.1086, 0.1092, 0.0000, 0.1089, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1087, 0.1084, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1090, 0.1086, 0.1088, 0.1086, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58504164
Epoch933: train_loss: 4.0476 recon_acc: 0.6766 val_roc: 0.7758 val_ap: 0.8360 f1: 0.7217 time: 0.2781
thresh 0.48843446
          test_roc: 0.7856 test_ap: 0.8417 test_f1: 0.7046 test_recon_acc: 0.4907
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1084, 0.1090, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1092, 0.1090, 0.1083, 0.1082, 0.1090, 0.1088,
         0.1090],
        [0.1085, 0.1086, 0.1092, 0.0000, 0.1089, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1082, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1087, 0.1084, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1090, 0.1086, 0.1088, 0.1086, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5850854
Epoch934: train_loss: 4.0476 recon_acc: 0.6767 val_roc: 0.7757 val_ap: 0.8360 f1: 0.7217 time: 0.2532
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1084, 0.1090, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1085, 0.1086, 0.1091, 0.0000, 0.1089, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1087, 0.1084, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58512855
Epoch935: train_loss: 4.0476 recon_acc: 0.6768 val_roc: 0.7757 val_ap: 0.8360 f1: 0.7217 time: 0.2650
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1084, 0.1090, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1085, 0.1086, 0.1091, 0.0000, 0.1089, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1087, 0.1084, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58517116
Epoch936: train_loss: 4.0475 recon_acc: 0.6769 val_roc: 0.7757 val_ap: 0.8360 f1: 0.7217 time: 0.2426
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1084, 0.1090, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1085, 0.1086, 0.1091, 0.0000, 0.1089, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1089, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1087, 0.1084, 0.1080, 0.0000, 0.1090,
         0.1085],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1085, 0.1085, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5852133
Epoch937: train_loss: 4.0475 recon_acc: 0.6771 val_roc: 0.7757 val_ap: 0.8360 f1: 0.7217 time: 0.2651
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1084, 0.1090, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1085, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1087, 0.1084, 0.1080, 0.0000, 0.1090,
         0.1084],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1085, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5852548
Epoch938: train_loss: 4.0475 recon_acc: 0.6772 val_roc: 0.7757 val_ap: 0.8360 f1: 0.7233 time: 0.2589
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1084, 0.1090, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1085, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1087, 0.1084, 0.1080, 0.0000, 0.1090,
         0.1084],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1085, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5852958
Epoch939: train_loss: 4.0475 recon_acc: 0.6773 val_roc: 0.7757 val_ap: 0.8360 f1: 0.7233 time: 0.2672
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1084, 0.1090, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1085, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1090, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1087, 0.1084, 0.1080, 0.0000, 0.1090,
         0.1084],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1085, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5853362
Epoch940: train_loss: 4.0475 recon_acc: 0.6774 val_roc: 0.7757 val_ap: 0.8360 f1: 0.7233 time: 0.2879
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1085, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1087, 0.1084, 0.1080, 0.0000, 0.1090,
         0.1084],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1085, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5853761
Epoch941: train_loss: 4.0474 recon_acc: 0.6774 val_roc: 0.7758 val_ap: 0.8361 f1: 0.7249 time: 0.2591
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1091, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1091, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1085, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1091, 0.1087, 0.1090,
         0.1088],
        [0.1088, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1086, 0.1091, 0.1093, 0.0000, 0.1080, 0.1088,
         0.1085],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1087, 0.1084, 0.1080, 0.0000, 0.1090,
         0.1084],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1088, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1085, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58541536
Epoch942: train_loss: 4.0474 recon_acc: 0.6775 val_roc: 0.7758 val_ap: 0.8361 f1: 0.7249 time: 0.2592
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1085, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1085, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1088, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1086, 0.1090, 0.1093, 0.0000, 0.1080, 0.1087,
         0.1085],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1080, 0.0000, 0.1090,
         0.1084],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1087, 0.1090, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1085, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58536655
Epoch943: train_loss: 4.0474 recon_acc: 0.6775 val_roc: 0.7760 val_ap: 0.8363 f1: 0.7249 time: 0.2651
thresh 0.48717138
          test_roc: 0.7858 test_ap: 0.8419 test_f1: 0.7064 test_recon_acc: 0.4885
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1088, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1086, 0.1090, 0.1093, 0.0000, 0.1080, 0.1087,
         0.1085],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1080, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1085, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5852076
Epoch944: train_loss: 4.0474 recon_acc: 0.6772 val_roc: 0.7760 val_ap: 0.8363 f1: 0.7249 time: 0.2576
thresh 0.48703924
          test_roc: 0.7857 test_ap: 0.8419 test_f1: 0.7064 test_recon_acc: 0.4883
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1088, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1086, 0.1090, 0.1093, 0.0000, 0.1080, 0.1087,
         0.1085],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1080, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1085, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5850486
Epoch945: train_loss: 4.0473 recon_acc: 0.6769 val_roc: 0.7760 val_ap: 0.8363 f1: 0.7249 time: 0.2462
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1088, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1086, 0.1090, 0.1093, 0.0000, 0.1080, 0.1087,
         0.1085],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1080, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1085, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58556706
Epoch946: train_loss: 4.0473 recon_acc: 0.6779 val_roc: 0.7760 val_ap: 0.8363 f1: 0.7221 time: 0.2550
thresh 0.48677164
          test_roc: 0.7857 test_ap: 0.8419 test_f1: 0.7064 test_recon_acc: 0.4878
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1086, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1088, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1086, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1084, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5856035
Epoch947: train_loss: 4.0473 recon_acc: 0.6780 val_roc: 0.7761 val_ap: 0.8364 f1: 0.7221 time: 0.2799
thresh 0.48663622
          test_roc: 0.7857 test_ap: 0.8419 test_f1: 0.7064 test_recon_acc: 0.4875
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1088, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1084, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58457077
Epoch948: train_loss: 4.0473 recon_acc: 0.6761 val_roc: 0.7761 val_ap: 0.8364 f1: 0.7217 time: 0.2642
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1086, 0.1088, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1088, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1091,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1084, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0413, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58567476
Epoch949: train_loss: 4.0473 recon_acc: 0.6782 val_roc: 0.7760 val_ap: 0.8364 f1: 0.7205 time: 0.2612
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1086, 0.1087, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1086],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1087, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1090,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1091, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1086, 0.1088, 0.1086, 0.1084, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5857096
Epoch950: train_loss: 4.0472 recon_acc: 0.6783 val_roc: 0.7759 val_ap: 0.8363 f1: 0.7205 time: 0.2713
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1086, 0.1087, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1088,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1085],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1087, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1090,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1088, 0.1089, 0.1090, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1085, 0.1088, 0.1086, 0.1084, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58534724
Epoch951: train_loss: 4.0472 recon_acc: 0.6776 val_roc: 0.7758 val_ap: 0.8363 f1: 0.7205 time: 0.2731
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1086, 0.1087, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1085],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1087, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1090,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1087, 0.1089, 0.1090, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1085, 0.1088, 0.1086, 0.1084, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58485824
Epoch952: train_loss: 4.0472 recon_acc: 0.6767 val_roc: 0.7759 val_ap: 0.8363 f1: 0.7190 time: 0.2637
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1086, 0.1087, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1085],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1087, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1090,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1087, 0.1089, 0.1090, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1085, 0.1088, 0.1086, 0.1084, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58377177
Epoch953: train_loss: 4.0472 recon_acc: 0.6748 val_roc: 0.7760 val_ap: 0.8364 f1: 0.7186 time: 0.2469
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1086, 0.1087, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1083],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1085],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1087, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1090,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1087, 0.1089, 0.1090, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1083, 0.1089, 0.1085, 0.1088, 0.1086, 0.1084, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5836116
Epoch954: train_loss: 4.0471 recon_acc: 0.6745 val_roc: 0.7759 val_ap: 0.8363 f1: 0.7186 time: 0.2504
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1086, 0.1087, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1080, 0.1080, 0.1089,
         0.1082],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1085],
        [0.1086, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1087, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1090,
         0.1086],
        [0.1080, 0.1080, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1087, 0.1089, 0.1090, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1088, 0.1086, 0.1084, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58339643
Epoch955: train_loss: 4.0471 recon_acc: 0.6742 val_roc: 0.7758 val_ap: 0.8363 f1: 0.7186 time: 0.2487
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1085, 0.1087, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1089,
         0.1082],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1087, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1090,
         0.1086],
        [0.1080, 0.1079, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1087, 0.1089, 0.1090, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1088, 0.1086, 0.1084, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58291084
Epoch956: train_loss: 4.0471 recon_acc: 0.6733 val_roc: 0.7758 val_ap: 0.8363 f1: 0.7186 time: 0.2750
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1085, 0.1087, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1089,
         0.1082],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1087, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1090,
         0.1086],
        [0.1080, 0.1079, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1087, 0.1089, 0.1090, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1088, 0.1086, 0.1084, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58242613
Epoch957: train_loss: 4.0471 recon_acc: 0.6724 val_roc: 0.7758 val_ap: 0.8364 f1: 0.7171 time: 0.2709
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1085, 0.1087, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1089,
         0.1082],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1087, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1090,
         0.1086],
        [0.1080, 0.1079, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1087, 0.1089, 0.1090, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1088, 0.1086, 0.1084, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5819423
Epoch958: train_loss: 4.0471 recon_acc: 0.6716 val_roc: 0.7758 val_ap: 0.8363 f1: 0.7171 time: 0.2553
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1085, 0.1087, 0.1080, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1089,
         0.1082],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1090,
         0.1088],
        [0.1087, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1090,
         0.1086],
        [0.1080, 0.1079, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1087, 0.1089, 0.1090, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1090],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1088, 0.1086, 0.1084, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5814594
Epoch959: train_loss: 4.0470 recon_acc: 0.6707 val_roc: 0.7757 val_ap: 0.8363 f1: 0.7171 time: 0.2416
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1085, 0.1087, 0.1079, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1089,
         0.1082],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1089,
         0.1088],
        [0.1087, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1087, 0.1089, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1088, 0.1086, 0.1084, 0.1084, 0.1090,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5809773
Epoch960: train_loss: 4.0470 recon_acc: 0.6698 val_roc: 0.7757 val_ap: 0.8363 f1: 0.7171 time: 0.2683
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1085, 0.1087, 0.1079, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1089,
         0.1082],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1089,
         0.1088],
        [0.1087, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1087, 0.1089, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1088, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58049613
Epoch961: train_loss: 4.0470 recon_acc: 0.6690 val_roc: 0.7756 val_ap: 0.8362 f1: 0.7171 time: 0.2585
difference_matrix tensor([[0.0000, 0.1085, 0.1088, 0.1084, 0.1085, 0.1087, 0.1079, 0.1085, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1089,
         0.1082],
        [0.1088, 0.1090, 0.0000, 0.1091, 0.1090, 0.1083, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1082, 0.1089,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1089,
         0.1088],
        [0.1087, 0.1089, 0.1083, 0.1094, 0.1083, 0.0000, 0.1093, 0.1084, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1081, 0.1085, 0.1090, 0.1093, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1085, 0.1080, 0.1090, 0.1082, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1087, 0.1089, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1088, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58001584
Epoch962: train_loss: 4.0470 recon_acc: 0.6681 val_roc: 0.7756 val_ap: 0.8362 f1: 0.7155 time: 0.2613
difference_matrix tensor([[0.0000, 0.1085, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1089,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1091, 0.1090, 0.1082, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1089,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1083, 0.0000, 0.1092, 0.1084, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1081, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1090, 0.1081, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1089, 0.1087, 0.1089, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5795365
Epoch963: train_loss: 4.0469 recon_acc: 0.6673 val_roc: 0.7756 val_ap: 0.8362 f1: 0.7155 time: 0.2669
difference_matrix tensor([[0.0000, 0.1085, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1091, 0.1090, 0.1082, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1083, 0.0000, 0.1092, 0.1084, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1081, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1090, 0.1081, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57905805
Epoch964: train_loss: 4.0469 recon_acc: 0.6664 val_roc: 0.7756 val_ap: 0.8363 f1: 0.7155 time: 0.2739
difference_matrix tensor([[0.0000, 0.1085, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1091, 0.1090, 0.1082, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1083, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1083, 0.0000, 0.1092, 0.1084, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1081, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1090, 0.1081, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5785805
Epoch965: train_loss: 4.0469 recon_acc: 0.6655 val_roc: 0.7755 val_ap: 0.8362 f1: 0.7155 time: 0.2785
difference_matrix tensor([[0.0000, 0.1085, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1091, 0.1090, 0.1082, 0.1081, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1084, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1081, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1090, 0.1081, 0.1086, 0.1084, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5781039
Epoch966: train_loss: 4.0469 recon_acc: 0.6647 val_roc: 0.7754 val_ap: 0.8362 f1: 0.7155 time: 0.2477
difference_matrix tensor([[0.0000, 0.1085, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1091, 0.1090, 0.1082, 0.1080, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1090, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5862141
Epoch967: train_loss: 4.0469 recon_acc: 0.6795 val_roc: 0.7754 val_ap: 0.8361 f1: 0.7146 time: 0.2487
difference_matrix tensor([[0.0000, 0.1085, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1091, 0.1090, 0.1082, 0.1080, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1090, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58623886
Epoch968: train_loss: 4.0468 recon_acc: 0.6796 val_roc: 0.7754 val_ap: 0.8361 f1: 0.7146 time: 0.2467
difference_matrix tensor([[0.0000, 0.1085, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1091, 0.1090, 0.1082, 0.1080, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1090, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5862628
Epoch969: train_loss: 4.0468 recon_acc: 0.6796 val_roc: 0.7752 val_ap: 0.8360 f1: 0.7146 time: 0.2749
difference_matrix tensor([[0.0000, 0.1085, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1089],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1091, 0.1090, 0.1082, 0.1080, 0.1090, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1090, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1089, 0.1082, 0.1089, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58628625
Epoch970: train_loss: 4.0468 recon_acc: 0.6797 val_roc: 0.7753 val_ap: 0.8361 f1: 0.7146 time: 0.2771
difference_matrix tensor([[0.0000, 0.1085, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1088],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1084, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1091, 0.1090, 0.1082, 0.1080, 0.1089, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1084, 0.1090, 0.1088, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1089, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.586309
Epoch971: train_loss: 4.0468 recon_acc: 0.6798 val_roc: 0.7753 val_ap: 0.8361 f1: 0.7146 time: 0.2781
difference_matrix tensor([[0.0000, 0.1085, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1088],
        [0.1085, 0.0000, 0.1090, 0.1086, 0.1083, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1091, 0.1090, 0.1082, 0.1080, 0.1089, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1090, 0.1088, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1089, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58633125
Epoch972: train_loss: 4.0468 recon_acc: 0.6798 val_roc: 0.7752 val_ap: 0.8361 f1: 0.7146 time: 0.2490
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1091, 0.1090, 0.1082, 0.1080, 0.1089, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1090, 0.1088, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1089, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58635294
Epoch973: train_loss: 4.0467 recon_acc: 0.6799 val_roc: 0.7752 val_ap: 0.8360 f1: 0.7146 time: 0.2463
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1091, 0.1090, 0.1082, 0.1080, 0.1089, 0.1087,
         0.1089],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1090, 0.1088, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1089, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5863741
Epoch974: train_loss: 4.0467 recon_acc: 0.6800 val_roc: 0.7753 val_ap: 0.8361 f1: 0.7146 time: 0.2512
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1091, 0.1090, 0.1082, 0.1080, 0.1089, 0.1087,
         0.1088],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1090, 0.1088, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5863946
Epoch975: train_loss: 4.0467 recon_acc: 0.6800 val_roc: 0.7753 val_ap: 0.8361 f1: 0.7146 time: 0.2536
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1091, 0.1090, 0.1082, 0.1080, 0.1089, 0.1087,
         0.1088],
        [0.1084, 0.1086, 0.1091, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1090, 0.1088, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58628017
Epoch976: train_loss: 4.0467 recon_acc: 0.6798 val_roc: 0.7754 val_ap: 0.8361 f1: 0.7146 time: 0.2589
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1087,
         0.1088],
        [0.1084, 0.1086, 0.1090, 0.0000, 0.1088, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1088, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5859766
Epoch977: train_loss: 4.0467 recon_acc: 0.6793 val_roc: 0.7754 val_ap: 0.8361 f1: 0.7146 time: 0.2675
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1089, 0.1079, 0.1080, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1087,
         0.1088],
        [0.1084, 0.1086, 0.1090, 0.0000, 0.1087, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1080, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5797354
Epoch978: train_loss: 4.0466 recon_acc: 0.6679 val_roc: 0.7754 val_ap: 0.8361 f1: 0.7143 time: 0.2798
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1089, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1087,
         0.1088],
        [0.1084, 0.1086, 0.1090, 0.0000, 0.1087, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1087,
         0.1084],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1087, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58536994
Epoch979: train_loss: 4.0466 recon_acc: 0.6782 val_roc: 0.7754 val_ap: 0.8361 f1: 0.7130 time: 0.2834
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1089, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1087,
         0.1088],
        [0.1084, 0.1086, 0.1090, 0.0000, 0.1087, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1086],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1086,
         0.1084],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1086, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58506685
Epoch980: train_loss: 4.0466 recon_acc: 0.6777 val_roc: 0.7754 val_ap: 0.8361 f1: 0.7130 time: 0.2569
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1089, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1087,
         0.1088],
        [0.1084, 0.1086, 0.1090, 0.0000, 0.1087, 0.1094, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1089, 0.1082, 0.1094, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1086,
         0.1084],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1087, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58476394
Epoch981: train_loss: 4.0466 recon_acc: 0.6772 val_roc: 0.7755 val_ap: 0.8362 f1: 0.7130 time: 0.2522
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1084, 0.1086, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1086,
         0.1084],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5844611
Epoch982: train_loss: 4.0466 recon_acc: 0.6767 val_roc: 0.7755 val_ap: 0.8363 f1: 0.7130 time: 0.2578
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1084, 0.1086, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1086,
         0.1084],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5841585
Epoch983: train_loss: 4.0465 recon_acc: 0.6761 val_roc: 0.7755 val_ap: 0.8363 f1: 0.7130 time: 0.2455
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1087,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1084, 0.1086, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1086,
         0.1084],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1087, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.583856
Epoch984: train_loss: 4.0465 recon_acc: 0.6756 val_roc: 0.7755 val_ap: 0.8363 f1: 0.7130 time: 0.2672
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1084, 0.1086, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1086,
         0.1084],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5835536
Epoch985: train_loss: 4.0465 recon_acc: 0.6751 val_roc: 0.7755 val_ap: 0.8364 f1: 0.7130 time: 0.2727
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1087, 0.1079, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1084, 0.1086, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1090, 0.1086, 0.1089,
         0.1087],
        [0.1087, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1090, 0.1092, 0.0000, 0.1079, 0.1086,
         0.1084],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1086, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58325154
Epoch986: train_loss: 4.0465 recon_acc: 0.6746 val_roc: 0.7756 val_ap: 0.8364 f1: 0.7130 time: 0.2751
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1084, 0.1085, 0.1086, 0.1079, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1084, 0.1086, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1086, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1079, 0.1086,
         0.1084],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1084],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1084, 0.1084, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5829496
Epoch987: train_loss: 4.0465 recon_acc: 0.6740 val_roc: 0.7756 val_ap: 0.8364 f1: 0.7130 time: 0.2459
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1083, 0.1085, 0.1086, 0.1079, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1086, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1079, 0.1086,
         0.1084],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1079, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1084, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58264756
Epoch988: train_loss: 4.0464 recon_acc: 0.6735 val_roc: 0.7756 val_ap: 0.8364 f1: 0.7130 time: 0.2527
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1083, 0.1085, 0.1086, 0.1079, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1086, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1084],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1084, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5823461
Epoch989: train_loss: 4.0464 recon_acc: 0.6730 val_roc: 0.7755 val_ap: 0.8364 f1: 0.7130 time: 0.2566
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1083, 0.1085, 0.1086, 0.1079, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1086, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5820444
Epoch990: train_loss: 4.0464 recon_acc: 0.6724 val_roc: 0.7755 val_ap: 0.8364 f1: 0.7130 time: 0.2638
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1083, 0.1085, 0.1086, 0.1079, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1086, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58174336
Epoch991: train_loss: 4.0464 recon_acc: 0.6719 val_roc: 0.7754 val_ap: 0.8364 f1: 0.7130 time: 0.2649
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1083, 0.1085, 0.1086, 0.1079, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1086, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5814418
Epoch992: train_loss: 4.0464 recon_acc: 0.6714 val_roc: 0.7755 val_ap: 0.8365 f1: 0.7115 time: 0.2643
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1083, 0.1085, 0.1086, 0.1079, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1086, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1086, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5866656
Epoch993: train_loss: 4.0463 recon_acc: 0.6810 val_roc: 0.7755 val_ap: 0.8365 f1: 0.7102 time: 0.2684
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1083, 0.1085, 0.1086, 0.1079, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1085, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1085, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1079, 0.1079, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58667487
Epoch994: train_loss: 4.0463 recon_acc: 0.6810 val_roc: 0.7754 val_ap: 0.8364 f1: 0.7102 time: 0.2828
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1083, 0.1084, 0.1086, 0.1078, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1085, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1078, 0.1079, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0414, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5866842
Epoch995: train_loss: 4.0463 recon_acc: 0.6810 val_roc: 0.7754 val_ap: 0.8364 f1: 0.7102 time: 0.2470
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1083, 0.1084, 0.1086, 0.1078, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1085, 0.1083, 0.1088, 0.1079, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1078, 0.1079, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58669215
Epoch996: train_loss: 4.0463 recon_acc: 0.6811 val_roc: 0.7754 val_ap: 0.8364 f1: 0.7102 time: 0.2465
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1083, 0.1084, 0.1086, 0.1078, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1085],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1078, 0.1078, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1085, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58670044
Epoch997: train_loss: 4.0463 recon_acc: 0.6811 val_roc: 0.7754 val_ap: 0.8365 f1: 0.7102 time: 0.2649
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1083, 0.1084, 0.1086, 0.1078, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1078, 0.1078, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1084, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58670694
Epoch998: train_loss: 4.0463 recon_acc: 0.6811 val_roc: 0.7754 val_ap: 0.8365 f1: 0.7102 time: 0.2678
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1083, 0.1084, 0.1086, 0.1078, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1078, 0.1078, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1084, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58671457
Epoch999: train_loss: 4.0462 recon_acc: 0.6812 val_roc: 0.7755 val_ap: 0.8365 f1: 0.7102 time: 0.2713
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1083, 0.1084, 0.1086, 0.1078, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1078, 0.1078, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1084, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58671945
Epoch1000: train_loss: 4.0462 recon_acc: 0.6812 val_roc: 0.7755 val_ap: 0.8365 f1: 0.7102 time: 0.2774
difference_matrix tensor([[0.0000, 0.1084, 0.1087, 0.1083, 0.1084, 0.1086, 0.1078, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1082],
        [0.1087, 0.1090, 0.0000, 0.1090, 0.1089, 0.1082, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1082, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1078, 0.1078, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1082, 0.1088, 0.1084, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5867265
Epoch1001: train_loss: 4.0462 recon_acc: 0.6812 val_roc: 0.7754 val_ap: 0.8365 f1: 0.7102 time: 0.2500
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1081],
        [0.1086, 0.1090, 0.0000, 0.1090, 0.1089, 0.1081, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1078, 0.1078, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1089,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1089, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5867293
Epoch1002: train_loss: 4.0462 recon_acc: 0.6812 val_roc: 0.7754 val_ap: 0.8365 f1: 0.7102 time: 0.2439
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1081],
        [0.1086, 0.1090, 0.0000, 0.1090, 0.1089, 0.1081, 0.1080, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1078, 0.1078, 0.1080, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5867364
Epoch1003: train_loss: 4.0462 recon_acc: 0.6813 val_roc: 0.7754 val_ap: 0.8364 f1: 0.7102 time: 0.2513
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1081],
        [0.1086, 0.1090, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1085, 0.1081, 0.1088,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1085, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58673656
Epoch1004: train_loss: 4.0461 recon_acc: 0.6813 val_roc: 0.7754 val_ap: 0.8365 f1: 0.7102 time: 0.2566
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1081],
        [0.1086, 0.1090, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1088,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1083, 0.1090,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1083, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1088, 0.1089, 0.1090, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58674455
Epoch1005: train_loss: 4.0461 recon_acc: 0.6813 val_roc: 0.7755 val_ap: 0.8365 f1: 0.7102 time: 0.2638
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1081],
        [0.1086, 0.1090, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1082, 0.1090,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1087, 0.1089, 0.1090, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58674073
Epoch1006: train_loss: 4.0461 recon_acc: 0.6813 val_roc: 0.7755 val_ap: 0.8366 f1: 0.7102 time: 0.2735
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1090, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1081],
        [0.1086, 0.1090, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1089,
         0.1087],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1082, 0.1090,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1084, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1087, 0.1089, 0.1090, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58675134
Epoch1007: train_loss: 4.0461 recon_acc: 0.6814 val_roc: 0.7754 val_ap: 0.8365 f1: 0.7102 time: 0.2695
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1084, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1088,
         0.1087],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1082, 0.1090,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1087, 0.1088, 0.1090, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58674127
Epoch1008: train_loss: 4.0461 recon_acc: 0.6814 val_roc: 0.7754 val_ap: 0.8365 f1: 0.7102 time: 0.2749
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1088,
         0.1087],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1082, 0.1090,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1087, 0.1088, 0.1090, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5867578
Epoch1009: train_loss: 4.0461 recon_acc: 0.6815 val_roc: 0.7754 val_ap: 0.8365 f1: 0.7102 time: 0.2516
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1088,
         0.1087],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1082, 0.1090,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1087, 0.1088, 0.1090, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1087, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58673674
Epoch1010: train_loss: 4.0460 recon_acc: 0.6814 val_roc: 0.7754 val_ap: 0.8365 f1: 0.7102 time: 0.2529
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1088,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1088, 0.1086, 0.1087, 0.1088, 0.1089, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58676565
Epoch1011: train_loss: 4.0460 recon_acc: 0.6815 val_roc: 0.7753 val_ap: 0.8365 f1: 0.7102 time: 0.2572
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1086, 0.1087, 0.1088, 0.1089, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5867247
Epoch1012: train_loss: 4.0460 recon_acc: 0.6814 val_roc: 0.7753 val_ap: 0.8365 f1: 0.7102 time: 0.2500
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1086, 0.1087, 0.1088, 0.1089, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58677846
Epoch1013: train_loss: 4.0460 recon_acc: 0.6816 val_roc: 0.7753 val_ap: 0.8365 f1: 0.7118 time: 0.2555
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1086,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1086, 0.1087, 0.1088, 0.1089, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58669996
Epoch1014: train_loss: 4.0460 recon_acc: 0.6814 val_roc: 0.7753 val_ap: 0.8364 f1: 0.7102 time: 0.2650
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1085,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5868035
Epoch1015: train_loss: 4.0459 recon_acc: 0.6816 val_roc: 0.7752 val_ap: 0.8364 f1: 0.7118 time: 0.2805
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1085,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5866529
Epoch1016: train_loss: 4.0459 recon_acc: 0.6814 val_roc: 0.7752 val_ap: 0.8365 f1: 0.7102 time: 0.2636
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1085,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5868542
Epoch1017: train_loss: 4.0459 recon_acc: 0.6818 val_roc: 0.7752 val_ap: 0.8364 f1: 0.7102 time: 0.2460
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1083, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1085,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1082, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1082, 0.0000, 0.1092, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58656645
Epoch1018: train_loss: 4.0459 recon_acc: 0.6813 val_roc: 0.7752 val_ap: 0.8364 f1: 0.7102 time: 0.2579
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1085,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1089, 0.1087, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1081, 0.0000, 0.1092, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58761257
Epoch1019: train_loss: 4.0459 recon_acc: 0.6832 val_roc: 0.7751 val_ap: 0.8364 f1: 0.7105 time: 0.2618
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1085,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1083, 0.1089, 0.1087, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1081, 0.0000, 0.1092, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1092, 0.0000, 0.1078, 0.1086,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1086, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58642894
Epoch1020: train_loss: 4.0459 recon_acc: 0.6811 val_roc: 0.7752 val_ap: 0.8364 f1: 0.7102 time: 0.2709
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1089, 0.1087, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58707666
Epoch1021: train_loss: 4.0459 recon_acc: 0.6823 val_roc: 0.7752 val_ap: 0.8365 f1: 0.7118 time: 0.2533
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1085,
         0.1088],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1089, 0.1087, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1088, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5863049
Epoch1022: train_loss: 4.0459 recon_acc: 0.6809 val_roc: 0.7752 val_ap: 0.8365 f1: 0.7102 time: 0.2466
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1087],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1089, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1089, 0.1086, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1079, 0.1088, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1089],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5870932
Epoch1023: train_loss: 4.0458 recon_acc: 0.6823 val_roc: 0.7752 val_ap: 0.8365 f1: 0.7118 time: 0.2485
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1088],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1090, 0.1089, 0.1081, 0.1079, 0.1089, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1090, 0.0000, 0.1087, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1089, 0.1087, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1079, 0.1089, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1089],
        [0.1088, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58639026
Epoch1024: train_loss: 4.0458 recon_acc: 0.6811 val_roc: 0.7752 val_ap: 0.8366 f1: 0.7102 time: 0.2521
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1087],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1089, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1089, 0.1086, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1079, 0.1088, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1089],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5868281
Epoch1025: train_loss: 4.0458 recon_acc: 0.6819 val_roc: 0.7751 val_ap: 0.8365 f1: 0.7118 time: 0.2598
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1087],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1089, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1089, 0.1086, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1079, 0.1088, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1089],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5867167
Epoch1026: train_loss: 4.0458 recon_acc: 0.6817 val_roc: 0.7751 val_ap: 0.8365 f1: 0.7118 time: 0.2759
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1087],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1088, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1089, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1089, 0.1086, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1088, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1079, 0.1088, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1089],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5864613
Epoch1027: train_loss: 4.0457 recon_acc: 0.6813 val_roc: 0.7751 val_ap: 0.8365 f1: 0.7118 time: 0.2767
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1085, 0.1078, 0.1083, 0.1086,
         0.1087],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1089, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1089, 0.1086, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1079, 0.1088, 0.1080, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58694464
Epoch1028: train_loss: 4.0457 recon_acc: 0.6822 val_roc: 0.7751 val_ap: 0.8365 f1: 0.7118 time: 0.2532
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1086, 0.1078, 0.1083, 0.1086,
         0.1087],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1089, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1089, 0.1086, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1086, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1079, 0.1088, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1089],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1089,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58637136
Epoch1029: train_loss: 4.0457 recon_acc: 0.6812 val_roc: 0.7751 val_ap: 0.8365 f1: 0.7118 time: 0.2468
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1085, 0.1078, 0.1083, 0.1086,
         0.1087],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1079, 0.1088, 0.1080, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5868034
Epoch1030: train_loss: 4.0457 recon_acc: 0.6820 val_roc: 0.7750 val_ap: 0.8364 f1: 0.7118 time: 0.2614
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1085, 0.1078, 0.1083, 0.1086,
         0.1087],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1089, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1089, 0.1086, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1079, 0.1088, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58660555
Epoch1031: train_loss: 4.0457 recon_acc: 0.6816 val_roc: 0.7750 val_ap: 0.8364 f1: 0.7118 time: 0.2456
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1085, 0.1078, 0.1083, 0.1086,
         0.1087],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1079, 0.1088, 0.1080, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5864821
Epoch1032: train_loss: 4.0457 recon_acc: 0.6814 val_roc: 0.7750 val_ap: 0.8365 f1: 0.7118 time: 0.2614
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1077, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1079, 0.1088, 0.1080, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5868111
Epoch1033: train_loss: 4.0456 recon_acc: 0.6820 val_roc: 0.7750 val_ap: 0.8365 f1: 0.7118 time: 0.2745
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1085, 0.1078, 0.1083, 0.1086,
         0.1087],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1079, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1081, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1078, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1079, 0.1088, 0.1081, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5863699
Epoch1034: train_loss: 4.0456 recon_acc: 0.6812 val_roc: 0.7750 val_ap: 0.8365 f1: 0.7102 time: 0.2883
difference_matrix tensor([[0.0000, 0.1083, 0.1086, 0.1083, 0.1084, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1078, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1077, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58670914
Epoch1035: train_loss: 4.0456 recon_acc: 0.6819 val_roc: 0.7750 val_ap: 0.8365 f1: 0.7102 time: 0.2453
difference_matrix tensor([[0.0000, 0.1084, 0.1086, 0.1083, 0.1084, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1084, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1078, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1089, 0.1085, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1077, 0.1078, 0.1079, 0.1084, 0.1089, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5865349
Epoch1036: train_loss: 4.0456 recon_acc: 0.6816 val_roc: 0.7749 val_ap: 0.8365 f1: 0.7102 time: 0.2460
difference_matrix tensor([[0.0000, 0.1083, 0.1086, 0.1083, 0.1084, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1078, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1085, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1077, 0.1078, 0.1079, 0.1084, 0.1088, 0.1091, 0.0000, 0.1078, 0.1085,
         0.1083],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1085, 0.1082, 0.1078, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58644396
Epoch1037: train_loss: 4.0456 recon_acc: 0.6814 val_roc: 0.7749 val_ap: 0.8365 f1: 0.7102 time: 0.2438
difference_matrix tensor([[0.0000, 0.1083, 0.1086, 0.1083, 0.1084, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1078, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1085, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1077, 0.1078, 0.1079, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1083],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1085, 0.1082, 0.1077, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5866897
Epoch1038: train_loss: 4.0456 recon_acc: 0.6819 val_roc: 0.7749 val_ap: 0.8365 f1: 0.7102 time: 0.2453
difference_matrix tensor([[0.0000, 0.1083, 0.1086, 0.1083, 0.1084, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1078, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1084, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1085, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1077, 0.1078, 0.1079, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1083],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1085, 0.1082, 0.1077, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1083, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5863401
Epoch1039: train_loss: 4.0455 recon_acc: 0.6813 val_roc: 0.7749 val_ap: 0.8365 f1: 0.7102 time: 0.2552
difference_matrix tensor([[0.0000, 0.1083, 0.1086, 0.1083, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1078, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1077, 0.1078, 0.1079, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1082, 0.1077, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1082, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58659697
Epoch1040: train_loss: 4.0455 recon_acc: 0.6818 val_roc: 0.7750 val_ap: 0.8366 f1: 0.7102 time: 0.2426
difference_matrix tensor([[0.0000, 0.1083, 0.1086, 0.1083, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1078, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1083, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1077, 0.1078, 0.1079, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1082, 0.1077, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1082, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58645725
Epoch1041: train_loss: 4.0455 recon_acc: 0.6816 val_roc: 0.7750 val_ap: 0.8366 f1: 0.7102 time: 0.2504
difference_matrix tensor([[0.0000, 0.1083, 0.1086, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1078, 0.1078, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1079, 0.1088, 0.1085,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1093, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1093, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1085],
        [0.1077, 0.1078, 0.1079, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1082, 0.1077, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1085, 0.1082, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5863778
Epoch1042: train_loss: 4.0455 recon_acc: 0.6815 val_roc: 0.7750 val_ap: 0.8366 f1: 0.7102 time: 0.2645
difference_matrix tensor([[0.0000, 0.1083, 0.1086, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1078, 0.1088, 0.1085,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1092, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1082, 0.1077, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1084, 0.1082, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.586566
Epoch1043: train_loss: 4.0455 recon_acc: 0.6818 val_roc: 0.7750 val_ap: 0.8366 f1: 0.7102 time: 0.2626
difference_matrix tensor([[0.0000, 0.1083, 0.1086, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1086, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1078, 0.1088, 0.1085,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1092, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1082, 0.1077, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1084, 0.1082, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5862802
Epoch1044: train_loss: 4.0455 recon_acc: 0.6813 val_roc: 0.7750 val_ap: 0.8367 f1: 0.7102 time: 0.2690
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1078, 0.1088, 0.1085,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1092, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1082, 0.1077, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1084, 0.1082, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58648074
Epoch1045: train_loss: 4.0454 recon_acc: 0.6817 val_roc: 0.7750 val_ap: 0.8367 f1: 0.7102 time: 0.2739
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1078, 0.1088, 0.1085,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1092, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1082, 0.1077, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1084, 0.1082, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.586366
Epoch1046: train_loss: 4.0454 recon_acc: 0.6815 val_roc: 0.7751 val_ap: 0.8367 f1: 0.7102 time: 0.2467
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1081, 0.1078, 0.1088, 0.1085,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1081, 0.1092, 0.1081, 0.0000, 0.1091, 0.1082, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1082, 0.1077, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1084, 0.1082, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58628625
Epoch1047: train_loss: 4.0454 recon_acc: 0.6814 val_roc: 0.7751 val_ap: 0.8368 f1: 0.7102 time: 0.2591
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1085,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1084, 0.1082, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5864401
Epoch1048: train_loss: 4.0454 recon_acc: 0.6817 val_roc: 0.7751 val_ap: 0.8368 f1: 0.7118 time: 0.2492
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1085,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1083],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1084, 0.1082, 0.1083, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0415, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5862038
Epoch1049: train_loss: 4.0454 recon_acc: 0.6813 val_roc: 0.7752 val_ap: 0.8368 f1: 0.7102 time: 0.2732
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1085,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58590764
Epoch1050: train_loss: 4.0454 recon_acc: 0.6807 val_roc: 0.7751 val_ap: 0.8368 f1: 0.7102 time: 0.2681
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1085,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1087,
         0.1084],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1086, 0.1087, 0.1085, 0.1087, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5856065
Epoch1051: train_loss: 4.0453 recon_acc: 0.6802 val_roc: 0.7751 val_ap: 0.8368 f1: 0.7102 time: 0.2556
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1084],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1086, 0.1087, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1084, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58530223
Epoch1052: train_loss: 4.0453 recon_acc: 0.6797 val_roc: 0.7751 val_ap: 0.8368 f1: 0.7102 time: 0.2479
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1086, 0.1087, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58489543
Epoch1053: train_loss: 4.0453 recon_acc: 0.6789 val_roc: 0.7751 val_ap: 0.8368 f1: 0.7102 time: 0.2493
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1086, 0.1087, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5846516
Epoch1054: train_loss: 4.0453 recon_acc: 0.6785 val_roc: 0.7753 val_ap: 0.8368 f1: 0.7102 time: 0.2579
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1086, 0.1087, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5842487
Epoch1055: train_loss: 4.0453 recon_acc: 0.6778 val_roc: 0.7752 val_ap: 0.8368 f1: 0.7102 time: 0.2592
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1086, 0.1087, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5839488
Epoch1056: train_loss: 4.0453 recon_acc: 0.6773 val_roc: 0.7753 val_ap: 0.8369 f1: 0.7102 time: 0.2754
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1086,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1086, 0.1087, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58363587
Epoch1057: train_loss: 4.0453 recon_acc: 0.6768 val_roc: 0.7753 val_ap: 0.8369 f1: 0.7102 time: 0.2820
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1087, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5832511
Epoch1058: train_loss: 4.0452 recon_acc: 0.6761 val_roc: 0.7754 val_ap: 0.8369 f1: 0.7102 time: 0.2878
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1083, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1083, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1087, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58299226
Epoch1059: train_loss: 4.0452 recon_acc: 0.6756 val_roc: 0.7755 val_ap: 0.8370 f1: 0.7102 time: 0.2562
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1081],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1087, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1081, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58260614
Epoch1060: train_loss: 4.0452 recon_acc: 0.6750 val_roc: 0.7755 val_ap: 0.8370 f1: 0.7102 time: 0.2483
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1087, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58230567
Epoch1061: train_loss: 4.0452 recon_acc: 0.6745 val_roc: 0.7754 val_ap: 0.8370 f1: 0.7102 time: 0.2594
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1087, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5819884
Epoch1062: train_loss: 4.0452 recon_acc: 0.6739 val_roc: 0.7755 val_ap: 0.8370 f1: 0.7102 time: 0.2673
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1087, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5859868
Epoch1063: train_loss: 4.0452 recon_acc: 0.6811 val_roc: 0.7755 val_ap: 0.8371 f1: 0.7090 time: 0.2638
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1087, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58586425
Epoch1064: train_loss: 4.0451 recon_acc: 0.6809 val_roc: 0.7756 val_ap: 0.8372 f1: 0.7090 time: 0.2730
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1087,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1087, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5858806
Epoch1065: train_loss: 4.0451 recon_acc: 0.6810 val_roc: 0.7756 val_ap: 0.8372 f1: 0.7090 time: 0.2535
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1088,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1088, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5857779
Epoch1066: train_loss: 4.0451 recon_acc: 0.6809 val_roc: 0.7757 val_ap: 0.8373 f1: 0.7090 time: 0.2672
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1085,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1085, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58559066
Epoch1067: train_loss: 4.0451 recon_acc: 0.6805 val_roc: 0.7757 val_ap: 0.8373 f1: 0.7090 time: 0.2761
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1086],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1086, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58531374
Epoch1068: train_loss: 4.0451 recon_acc: 0.6801 val_roc: 0.7757 val_ap: 0.8373 f1: 0.7090 time: 0.2625
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58524764
Epoch1069: train_loss: 4.0451 recon_acc: 0.6800 val_roc: 0.7757 val_ap: 0.8374 f1: 0.7090 time: 0.2695
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5849329
Epoch1070: train_loss: 4.0451 recon_acc: 0.6794 val_roc: 0.7757 val_ap: 0.8373 f1: 0.7090 time: 0.2559
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1082, 0.1087, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58482754
Epoch1071: train_loss: 4.0450 recon_acc: 0.6792 val_roc: 0.7757 val_ap: 0.8374 f1: 0.7090 time: 0.2484
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1087, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1082, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5846071
Epoch1072: train_loss: 4.0450 recon_acc: 0.6788 val_roc: 0.7757 val_ap: 0.8374 f1: 0.7090 time: 0.2563
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1087, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58439046
Epoch1073: train_loss: 4.0450 recon_acc: 0.6785 val_roc: 0.7756 val_ap: 0.8374 f1: 0.7090 time: 0.2649
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1087, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1088,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1088, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5842689
Epoch1074: train_loss: 4.0450 recon_acc: 0.6783 val_roc: 0.7756 val_ap: 0.8374 f1: 0.7090 time: 0.2687
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1077, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1087, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1085, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1077, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5839925
Epoch1075: train_loss: 4.0450 recon_acc: 0.6778 val_roc: 0.7756 val_ap: 0.8374 f1: 0.7090 time: 0.2627
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1085, 0.1076, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1087, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1087],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1076, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1087, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5838844
Epoch1076: train_loss: 4.0450 recon_acc: 0.6777 val_roc: 0.7756 val_ap: 0.8374 f1: 0.7090 time: 0.2472
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1087, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1089, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1089, 0.0000, 0.1086, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1086, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1076, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58364135
Epoch1077: train_loss: 4.0450 recon_acc: 0.6773 val_roc: 0.7756 val_ap: 0.8374 f1: 0.7074 time: 0.2500
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1087, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1084, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1085, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1076, 0.1077, 0.1078, 0.1084, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5834696
Epoch1078: train_loss: 4.0449 recon_acc: 0.6770 val_roc: 0.7755 val_ap: 0.8374 f1: 0.7074 time: 0.2642
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1087, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1085, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1087, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1076, 0.1077, 0.1078, 0.1083, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5833046
Epoch1079: train_loss: 4.0449 recon_acc: 0.6767 val_roc: 0.7755 val_ap: 0.8374 f1: 0.7074 time: 0.2556
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1085, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1076, 0.1077, 0.1078, 0.1083, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5801853
Epoch1080: train_loss: 4.0449 recon_acc: 0.6710 val_roc: 0.7756 val_ap: 0.8374 f1: 0.7087 time: 0.2670
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1085, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1076, 0.1077, 0.1078, 0.1083, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.580404
Epoch1081: train_loss: 4.0449 recon_acc: 0.6715 val_roc: 0.7756 val_ap: 0.8375 f1: 0.7087 time: 0.2689
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1085, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1076, 0.1077, 0.1078, 0.1083, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5806508
Epoch1082: train_loss: 4.0449 recon_acc: 0.6719 val_roc: 0.7756 val_ap: 0.8375 f1: 0.7087 time: 0.2517
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1085, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1076, 0.1077, 0.1078, 0.1083, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58086777
Epoch1083: train_loss: 4.0449 recon_acc: 0.6723 val_roc: 0.7756 val_ap: 0.8375 f1: 0.7087 time: 0.2485
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1085, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1089,
         0.1084],
        [0.1076, 0.1077, 0.1078, 0.1083, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58110344
Epoch1084: train_loss: 4.0449 recon_acc: 0.6728 val_roc: 0.7755 val_ap: 0.8374 f1: 0.7087 time: 0.2485
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1087],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1085, 0.0000, 0.1081, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1081, 0.0000, 0.1091, 0.1081, 0.1088,
         0.1084],
        [0.1076, 0.1077, 0.1078, 0.1083, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1089, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1087, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5813374
Epoch1085: train_loss: 4.0448 recon_acc: 0.6732 val_roc: 0.7755 val_ap: 0.8374 f1: 0.7087 time: 0.2548
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1078, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1085, 0.0000, 0.1080, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1091, 0.1081, 0.1088,
         0.1084],
        [0.1076, 0.1077, 0.1078, 0.1083, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58155423
Epoch1086: train_loss: 4.0448 recon_acc: 0.6737 val_roc: 0.7756 val_ap: 0.8375 f1: 0.7102 time: 0.2644
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1077, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1085, 0.0000, 0.1080, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1091, 0.1081, 0.1088,
         0.1084],
        [0.1076, 0.1077, 0.1077, 0.1083, 0.1088, 0.1091, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58176535
Epoch1087: train_loss: 4.0448 recon_acc: 0.6741 val_roc: 0.7755 val_ap: 0.8375 f1: 0.7102 time: 0.2763
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1083, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1077, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1083, 0.1081, 0.1088, 0.1085, 0.0000, 0.1080, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1090, 0.1081, 0.1088,
         0.1084],
        [0.1076, 0.1077, 0.1077, 0.1083, 0.1088, 0.1090, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58163744
Epoch1088: train_loss: 4.0448 recon_acc: 0.6739 val_roc: 0.7756 val_ap: 0.8376 f1: 0.7087 time: 0.2697
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1077, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1082, 0.1081, 0.1088, 0.1085, 0.0000, 0.1080, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1090, 0.1081, 0.1088,
         0.1084],
        [0.1076, 0.1077, 0.1077, 0.1083, 0.1088, 0.1090, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.581418
Epoch1089: train_loss: 4.0448 recon_acc: 0.6735 val_roc: 0.7757 val_ap: 0.8377 f1: 0.7087 time: 0.2519
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1077, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1082, 0.1081, 0.1088, 0.1085, 0.0000, 0.1080, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1090, 0.1081, 0.1088,
         0.1084],
        [0.1076, 0.1077, 0.1077, 0.1083, 0.1088, 0.1090, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5812411
Epoch1090: train_loss: 4.0448 recon_acc: 0.6732 val_roc: 0.7758 val_ap: 0.8377 f1: 0.7087 time: 0.2475
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1077, 0.1088, 0.1084,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1082, 0.1081, 0.1088, 0.1085, 0.0000, 0.1080, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1090, 0.1081, 0.1088,
         0.1084],
        [0.1076, 0.1077, 0.1077, 0.1083, 0.1088, 0.1090, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1088, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1084, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5810818
Epoch1091: train_loss: 4.0448 recon_acc: 0.6729 val_roc: 0.7758 val_ap: 0.8378 f1: 0.7087 time: 0.2480
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1082, 0.1081, 0.1088, 0.1085, 0.0000, 0.1080, 0.1088, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1090, 0.1081, 0.1088,
         0.1084],
        [0.1076, 0.1077, 0.1077, 0.1083, 0.1088, 0.1090, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1087, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.54982907
Epoch1092: train_loss: 4.0447 recon_acc: 0.6149 val_roc: 0.7757 val_ap: 0.8377 f1: 0.7081 time: 0.2546
difference_matrix tensor([[0.0000, 0.1083, 0.1085, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1085, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1082, 0.1081, 0.1088, 0.1085, 0.0000, 0.1080, 0.1087, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1090, 0.1081, 0.1088,
         0.1084],
        [0.1076, 0.1077, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1077, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1087, 0.1080, 0.1084, 0.1081, 0.1077, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55009997
Epoch1093: train_loss: 4.0447 recon_acc: 0.6155 val_roc: 0.7756 val_ap: 0.8377 f1: 0.7081 time: 0.2688
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1084, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1082, 0.1081, 0.1088, 0.1085, 0.0000, 0.1080, 0.1087, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1090, 0.1081, 0.1088,
         0.1084],
        [0.1076, 0.1077, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1087, 0.1080, 0.1084, 0.1081, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5503144
Epoch1094: train_loss: 4.0447 recon_acc: 0.6159 val_roc: 0.7757 val_ap: 0.8377 f1: 0.7081 time: 0.2687
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1084, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1082, 0.1081, 0.1088, 0.1085, 0.0000, 0.1080, 0.1087, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1090, 0.1081, 0.1088,
         0.1084],
        [0.1076, 0.1077, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1087, 0.1080, 0.1084, 0.1081, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5505663
Epoch1095: train_loss: 4.0447 recon_acc: 0.6164 val_roc: 0.7756 val_ap: 0.8377 f1: 0.7081 time: 0.2698
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1084, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1082, 0.1081, 0.1088, 0.1085, 0.0000, 0.1080, 0.1087, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1090, 0.1081, 0.1088,
         0.1084],
        [0.1076, 0.1077, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1087, 0.1080, 0.1084, 0.1081, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.55080837
Epoch1096: train_loss: 4.0447 recon_acc: 0.6169 val_roc: 0.7756 val_ap: 0.8377 f1: 0.7081 time: 0.2677
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1089, 0.1085, 0.1081, 0.1086, 0.1077, 0.1078, 0.1086,
         0.1080],
        [0.1084, 0.1089, 0.0000, 0.1088, 0.1088, 0.1080, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1082, 0.1081, 0.1088, 0.1085, 0.0000, 0.1080, 0.1087, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1090, 0.1081, 0.1088,
         0.1084],
        [0.1076, 0.1077, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1087, 0.1080, 0.1084, 0.1081, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5509232
Epoch1097: train_loss: 4.0447 recon_acc: 0.6171 val_roc: 0.7756 val_ap: 0.8377 f1: 0.7081 time: 0.2442
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1085, 0.1081, 0.1086, 0.1076, 0.1078, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1088, 0.1080, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1082, 0.1081, 0.1088, 0.1085, 0.0000, 0.1080, 0.1087, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1087, 0.1080, 0.1084, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5842773
Epoch1098: train_loss: 4.0447 recon_acc: 0.6789 val_roc: 0.7755 val_ap: 0.8377 f1: 0.7074 time: 0.2494
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1085, 0.1081, 0.1086, 0.1076, 0.1078, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1080, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1087, 0.1080, 0.1084, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5845071
Epoch1099: train_loss: 4.0446 recon_acc: 0.6793 val_roc: 0.7755 val_ap: 0.8377 f1: 0.7074 time: 0.2428
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1085, 0.1081, 0.1086, 0.1076, 0.1078, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1080, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1080, 0.1092, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1082],
        [0.1082, 0.1078, 0.1087, 0.1080, 0.1084, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1082, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5844501
Epoch1100: train_loss: 4.0446 recon_acc: 0.6792 val_roc: 0.7754 val_ap: 0.8376 f1: 0.7074 time: 0.2507
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1085, 0.1081, 0.1086, 0.1076, 0.1078, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1092, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1078, 0.1087, 0.1080, 0.1084, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5844086
Epoch1101: train_loss: 4.0446 recon_acc: 0.6792 val_roc: 0.7754 val_ap: 0.8377 f1: 0.7074 time: 0.2635
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1085, 0.1081, 0.1086, 0.1076, 0.1078, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1086,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1092, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1078, 0.1087, 0.1080, 0.1084, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1086, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.584354
Epoch1102: train_loss: 4.0446 recon_acc: 0.6791 val_roc: 0.7754 val_ap: 0.8377 f1: 0.7074 time: 0.2708
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1085, 0.1081, 0.1086, 0.1076, 0.1078, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1084, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1092, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1078, 0.1087, 0.1080, 0.1084, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5843008
Epoch1103: train_loss: 4.0446 recon_acc: 0.6790 val_roc: 0.7754 val_ap: 0.8377 f1: 0.7074 time: 0.2723
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1082, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1085, 0.1081, 0.1086, 0.1076, 0.1078, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1082, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1092, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1078, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58425534
Epoch1104: train_loss: 4.0446 recon_acc: 0.6789 val_roc: 0.7755 val_ap: 0.8378 f1: 0.7074 time: 0.2555
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1085, 0.1081, 0.1086, 0.1076, 0.1078, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1092, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1078, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5841934
Epoch1105: train_loss: 4.0446 recon_acc: 0.6788 val_roc: 0.7755 val_ap: 0.8378 f1: 0.7074 time: 0.2444
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1085, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1092, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58415055
Epoch1106: train_loss: 4.0445 recon_acc: 0.6788 val_roc: 0.7755 val_ap: 0.8378 f1: 0.7074 time: 0.2519
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1085, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1092, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5840886
Epoch1107: train_loss: 4.0445 recon_acc: 0.6787 val_roc: 0.7755 val_ap: 0.8378 f1: 0.7074 time: 0.2614
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1085, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1092, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5048039
Epoch1108: train_loss: 4.0445 recon_acc: 0.5279 val_roc: 0.7755 val_ap: 0.8378 f1: 0.7061 time: 0.2526
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1085, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1092, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5051902
Epoch1109: train_loss: 4.0445 recon_acc: 0.5287 val_roc: 0.7755 val_ap: 0.8378 f1: 0.7061 time: 0.2718
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1085, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1092, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58600205
Epoch1110: train_loss: 4.0445 recon_acc: 0.6822 val_roc: 0.7755 val_ap: 0.8378 f1: 0.7061 time: 0.2681
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1085, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1085, 0.1088, 0.0000, 0.1085, 0.1092, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1092, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5860175
Epoch1111: train_loss: 4.0445 recon_acc: 0.6823 val_roc: 0.7756 val_ap: 0.8379 f1: 0.7061 time: 0.2628
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0416, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5860087
Epoch1112: train_loss: 4.0445 recon_acc: 0.6823 val_roc: 0.7757 val_ap: 0.8379 f1: 0.7061 time: 0.2462
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5860256
Epoch1113: train_loss: 4.0445 recon_acc: 0.6823 val_roc: 0.7757 val_ap: 0.8379 f1: 0.7061 time: 0.2443
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58602285
Epoch1114: train_loss: 4.0444 recon_acc: 0.6823 val_roc: 0.7757 val_ap: 0.8380 f1: 0.7061 time: 0.2604
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5860324
Epoch1115: train_loss: 4.0444 recon_acc: 0.6824 val_roc: 0.7758 val_ap: 0.8380 f1: 0.7061 time: 0.2673
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58604074
Epoch1116: train_loss: 4.0444 recon_acc: 0.6824 val_roc: 0.7758 val_ap: 0.8381 f1: 0.7061 time: 0.2712
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1082, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1082, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5860419
Epoch1117: train_loss: 4.0444 recon_acc: 0.6825 val_roc: 0.7757 val_ap: 0.8380 f1: 0.7061 time: 0.2527
difference_matrix tensor([[0.0000, 0.1083, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1081, 0.1085,
         0.1086],
        [0.1083, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58347297
Epoch1118: train_loss: 4.0444 recon_acc: 0.6779 val_roc: 0.7757 val_ap: 0.8380 f1: 0.7074 time: 0.2496
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5860575
Epoch1119: train_loss: 4.0444 recon_acc: 0.6825 val_roc: 0.7757 val_ap: 0.8380 f1: 0.7077 time: 0.2510
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1084,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1084, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58607423
Epoch1120: train_loss: 4.0444 recon_acc: 0.6826 val_roc: 0.7757 val_ap: 0.8381 f1: 0.7077 time: 0.2677
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1083],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1083, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58607876
Epoch1121: train_loss: 4.0444 recon_acc: 0.6826 val_roc: 0.7758 val_ap: 0.8381 f1: 0.7077 time: 0.2714
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1084, 0.1076, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1082],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1076, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5860902
Epoch1122: train_loss: 4.0443 recon_acc: 0.6827 val_roc: 0.7758 val_ap: 0.8382 f1: 0.7077 time: 0.2740
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1084, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1082],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1075, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5831677
Epoch1123: train_loss: 4.0443 recon_acc: 0.6774 val_roc: 0.7757 val_ap: 0.8381 f1: 0.7074 time: 0.2585
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1084, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1082],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1075, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1088],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1084, 0.1081, 0.1082, 0.1088,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.58310366
Epoch1124: train_loss: 4.0443 recon_acc: 0.6773 val_roc: 0.7757 val_ap: 0.8381 f1: 0.7074 time: 0.2511
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1084, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1082],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1075, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1084, 0.1081, 0.1082, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5150879
Epoch1125: train_loss: 4.0443 recon_acc: 0.5487 val_roc: 0.7757 val_ap: 0.8381 f1: 0.7068 time: 0.2627
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1084, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1082],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1075, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1086, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1084, 0.1081, 0.1082, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5148887
Epoch1126: train_loss: 4.0443 recon_acc: 0.5483 val_roc: 0.7757 val_ap: 0.8381 f1: 0.7068 time: 0.2794
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1084, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1086,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1082],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1075, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1085, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1084, 0.1081, 0.1082, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.51468486
Epoch1127: train_loss: 4.0443 recon_acc: 0.5479 val_roc: 0.7756 val_ap: 0.8381 f1: 0.7068 time: 0.2825
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1084, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1081, 0.1086, 0.1076, 0.1077, 0.1085,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1082],
        [0.1082, 0.1081, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1075, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1085, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1084, 0.1081, 0.1082, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5144845
Epoch1128: train_loss: 4.0443 recon_acc: 0.5475 val_roc: 0.7756 val_ap: 0.8380 f1: 0.7068 time: 0.2619
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1084, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1086, 0.1076, 0.1077, 0.1085,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1084, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1084],
        [0.1075, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1082],
        [0.1085, 0.1085, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1084, 0.1081, 0.1082, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.514282
Epoch1129: train_loss: 4.0443 recon_acc: 0.5472 val_roc: 0.7757 val_ap: 0.8381 f1: 0.7068 time: 0.2593
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1086, 0.1076, 0.1077, 0.1085,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1083, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5140793
Epoch1130: train_loss: 4.0442 recon_acc: 0.5468 val_roc: 0.7758 val_ap: 0.8381 f1: 0.7068 time: 0.2680
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1086, 0.1076, 0.1077, 0.1085,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1080, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1083, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1080, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5134842
Epoch1131: train_loss: 4.0442 recon_acc: 0.5457 val_roc: 0.7758 val_ap: 0.8381 f1: 0.7080 time: 0.2785
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1086, 0.1076, 0.1077, 0.1085,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1083, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5136739
Epoch1132: train_loss: 4.0442 recon_acc: 0.5460 val_roc: 0.7757 val_ap: 0.8381 f1: 0.7080 time: 0.2772
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1086, 0.1076, 0.1077, 0.1085,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1077, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1083, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.51421773
Epoch1133: train_loss: 4.0442 recon_acc: 0.5471 val_roc: 0.7757 val_ap: 0.8381 f1: 0.7082 time: 0.2636
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1086, 0.1076, 0.1077, 0.1085,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1088, 0.1087, 0.1079, 0.1076, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1088, 0.0000, 0.1085, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1083, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1077, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.51434535
Epoch1134: train_loss: 4.0442 recon_acc: 0.5474 val_roc: 0.7757 val_ap: 0.8381 f1: 0.7068 time: 0.2554
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1086, 0.1076, 0.1077, 0.1085,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1085, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1083, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5140707
Epoch1135: train_loss: 4.0442 recon_acc: 0.5469 val_roc: 0.7756 val_ap: 0.8381 f1: 0.7068 time: 0.2545
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1086, 0.1076, 0.1077, 0.1085,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1083,
         0.1086],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1085, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1087,
         0.1085],
        [0.1083, 0.1086, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1083, 0.1085, 0.1087, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5138017
Epoch1136: train_loss: 4.0442 recon_acc: 0.5464 val_roc: 0.7756 val_ap: 0.8381 f1: 0.7068 time: 0.2698
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1086],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1085, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1085],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5135308
Epoch1137: train_loss: 4.0442 recon_acc: 0.5459 val_roc: 0.7756 val_ap: 0.8381 f1: 0.7068 time: 0.2621
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1080],
        [0.1084, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1086],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1085, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1085],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1080, 0.1086, 0.1082, 0.1085, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5132629
Epoch1138: train_loss: 4.0441 recon_acc: 0.5454 val_roc: 0.7757 val_ap: 0.8382 f1: 0.7068 time: 0.2677
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1084, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1086],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1085, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1085, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1086, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5116307
Epoch1139: train_loss: 4.0441 recon_acc: 0.5422 val_roc: 0.7757 val_ap: 0.8382 f1: 0.7063 time: 0.2937
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1084, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.51182294
Epoch1140: train_loss: 4.0441 recon_acc: 0.5426 val_roc: 0.7757 val_ap: 0.8382 f1: 0.7063 time: 0.2524
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1084, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5118446
Epoch1141: train_loss: 4.0441 recon_acc: 0.5427 val_roc: 0.7757 val_ap: 0.8383 f1: 0.7063 time: 0.2525
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1084, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5122013
Epoch1142: train_loss: 4.0441 recon_acc: 0.5434 val_roc: 0.7757 val_ap: 0.8383 f1: 0.7066 time: 0.2782
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1082, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1084, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1082, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5114366
Epoch1143: train_loss: 4.0441 recon_acc: 0.5420 val_roc: 0.7756 val_ap: 0.8383 f1: 0.7078 time: 0.2694
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1084, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.51123095
Epoch1144: train_loss: 4.0441 recon_acc: 0.5416 val_roc: 0.7757 val_ap: 0.8383 f1: 0.7078 time: 0.2560
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1084, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.51102746
Epoch1145: train_loss: 4.0441 recon_acc: 0.5412 val_roc: 0.7756 val_ap: 0.8382 f1: 0.7078 time: 0.2559
difference_matrix tensor([[0.0000, 0.1082, 0.1084, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1084, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5108219
Epoch1146: train_loss: 4.0440 recon_acc: 0.5408 val_roc: 0.7756 val_ap: 0.8382 f1: 0.7078 time: 0.2489
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.51061743
Epoch1147: train_loss: 4.0440 recon_acc: 0.5405 val_roc: 0.7756 val_ap: 0.8382 f1: 0.7078 time: 0.2779
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5104124
Epoch1148: train_loss: 4.0440 recon_acc: 0.5401 val_roc: 0.7755 val_ap: 0.8382 f1: 0.7078 time: 0.2850
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5102068
Epoch1149: train_loss: 4.0440 recon_acc: 0.5397 val_roc: 0.7755 val_ap: 0.8382 f1: 0.7078 time: 0.2470
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5100021
Epoch1150: train_loss: 4.0440 recon_acc: 0.5394 val_roc: 0.7756 val_ap: 0.8383 f1: 0.7078 time: 0.2492
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.50979596
Epoch1151: train_loss: 4.0440 recon_acc: 0.5390 val_roc: 0.7757 val_ap: 0.8383 f1: 0.7078 time: 0.2535
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1080, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1080, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5095909
Epoch1152: train_loss: 4.0440 recon_acc: 0.5386 val_roc: 0.7756 val_ap: 0.8383 f1: 0.7078 time: 0.2650
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1085,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1079, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1085, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.50938475
Epoch1153: train_loss: 4.0440 recon_acc: 0.5382 val_roc: 0.7757 val_ap: 0.8384 f1: 0.7078 time: 0.2902
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1079, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5091451
Epoch1154: train_loss: 4.0440 recon_acc: 0.5378 val_roc: 0.7757 val_ap: 0.8384 f1: 0.7078 time: 0.2705
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1087, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1087, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1079, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5088973
Epoch1155: train_loss: 4.0439 recon_acc: 0.5373 val_roc: 0.7756 val_ap: 0.8383 f1: 0.7078 time: 0.2488
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1086],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1086, 0.1090, 0.0000, 0.1076, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1079, 0.1076, 0.0000, 0.1087,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1086, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5086531
Epoch1156: train_loss: 4.0439 recon_acc: 0.5369 val_roc: 0.7756 val_ap: 0.8383 f1: 0.7078 time: 0.2492
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1086, 0.1090, 0.0000, 0.1075, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1087,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5084086
Epoch1157: train_loss: 4.0439 recon_acc: 0.5364 val_roc: 0.7756 val_ap: 0.8383 f1: 0.7078 time: 0.2567
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1086, 0.1090, 0.0000, 0.1075, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1087,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5081661
Epoch1158: train_loss: 4.0439 recon_acc: 0.5360 val_roc: 0.7756 val_ap: 0.8383 f1: 0.7078 time: 0.2435
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1076, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1085,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1076, 0.1076, 0.1083, 0.1086, 0.1090, 0.0000, 0.1075, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1087,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1085, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5079249
Epoch1159: train_loss: 4.0439 recon_acc: 0.5356 val_roc: 0.7756 val_ap: 0.8383 f1: 0.7078 time: 0.2647
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1075, 0.1076, 0.1083, 0.1086, 0.1090, 0.0000, 0.1075, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1087,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1088, 0.1083, 0.1087, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5076842
Epoch1160: train_loss: 4.0439 recon_acc: 0.5351 val_roc: 0.7756 val_ap: 0.8383 f1: 0.7078 time: 0.2751
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1075, 0.1076, 0.1083, 0.1086, 0.1090, 0.0000, 0.1075, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1088, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5074461
Epoch1161: train_loss: 4.0439 recon_acc: 0.5347 val_roc: 0.7756 val_ap: 0.8384 f1: 0.7078 time: 0.2721
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1075, 0.1076, 0.1083, 0.1086, 0.1090, 0.0000, 0.1075, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1088, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5072077
Epoch1162: train_loss: 4.0439 recon_acc: 0.5342 val_roc: 0.7756 val_ap: 0.8384 f1: 0.7078 time: 0.2501
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1090, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1075, 0.1076, 0.1083, 0.1086, 0.1090, 0.0000, 0.1075, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1088, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52484757
Epoch1163: train_loss: 4.0438 recon_acc: 0.5688 val_roc: 0.7757 val_ap: 0.8385 f1: 0.7073 time: 0.2564
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1079, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1079, 0.1091, 0.1080, 0.0000, 0.1089, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1075, 0.1076, 0.1083, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1088, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52518636
Epoch1164: train_loss: 4.0438 recon_acc: 0.5695 val_roc: 0.7757 val_ap: 0.8385 f1: 0.7073 time: 0.2745
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1080, 0.0000, 0.1089, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1075, 0.1076, 0.1083, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1088, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52552754
Epoch1165: train_loss: 4.0438 recon_acc: 0.5702 val_roc: 0.7756 val_ap: 0.8384 f1: 0.7073 time: 0.2740
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1087, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1080, 0.0000, 0.1089, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1075, 0.1076, 0.1083, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1087, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1088, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52586454
Epoch1166: train_loss: 4.0438 recon_acc: 0.5709 val_roc: 0.7757 val_ap: 0.8385 f1: 0.7088 time: 0.2659
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1080, 0.0000, 0.1089, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1075, 0.1076, 0.1083, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1088, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52620363
Epoch1167: train_loss: 4.0438 recon_acc: 0.5716 val_roc: 0.7757 val_ap: 0.8385 f1: 0.7088 time: 0.2566
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1080, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1080, 0.0000, 0.1089, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1075, 0.1076, 0.1083, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1088, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52653915
Epoch1168: train_loss: 4.0438 recon_acc: 0.5723 val_roc: 0.7756 val_ap: 0.8384 f1: 0.7088 time: 0.2502
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1079, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1088,
         0.1083],
        [0.1075, 0.1075, 0.1076, 0.1083, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1081],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1088, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1081, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52687603
Epoch1169: train_loss: 4.0438 recon_acc: 0.5729 val_roc: 0.7756 val_ap: 0.8385 f1: 0.7088 time: 0.2571
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1079, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1075, 0.1075, 0.1076, 0.1083, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1080],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52721
Epoch1170: train_loss: 4.0438 recon_acc: 0.5736 val_roc: 0.7757 val_ap: 0.8385 f1: 0.7088 time: 0.2526
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1079, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1075, 0.1075, 0.1076, 0.1083, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1080],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52754456
Epoch1171: train_loss: 4.0438 recon_acc: 0.5743 val_roc: 0.7757 val_ap: 0.8385 f1: 0.7088 time: 0.2666
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1083, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1079, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1075, 0.1075, 0.1076, 0.1083, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1080],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52787715
Epoch1172: train_loss: 4.0437 recon_acc: 0.5750 val_roc: 0.7757 val_ap: 0.8385 f1: 0.7088 time: 0.2605
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1075, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1079, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1075, 0.1075, 0.1076, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1080],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52820945
Epoch1173: train_loss: 4.0437 recon_acc: 0.5757 val_roc: 0.7756 val_ap: 0.8385 f1: 0.7088 time: 0.2668
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1074, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1079, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1076, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1080],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5285406
Epoch1174: train_loss: 4.0437 recon_acc: 0.5763 val_roc: 0.7755 val_ap: 0.8385 f1: 0.7088 time: 0.2745
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1074, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1079, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1076, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1080],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5288705
Epoch1175: train_loss: 4.0437 recon_acc: 0.5770 val_roc: 0.7755 val_ap: 0.8384 f1: 0.7088 time: 0.2525
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1074, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1079, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1076, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1080],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52920026
Epoch1176: train_loss: 4.0437 recon_acc: 0.5777 val_roc: 0.7756 val_ap: 0.8385 f1: 0.7088 time: 0.2493
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1074, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1079, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1076, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1080],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.57914335
Epoch1177: train_loss: 4.0437 recon_acc: 0.6715 val_roc: 0.7756 val_ap: 0.8385 f1: 0.7087 time: 0.2641
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1074, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1079, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1076, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1080],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5790493
Epoch1178: train_loss: 4.0437 recon_acc: 0.6714 val_roc: 0.7756 val_ap: 0.8385 f1: 0.7087 time: 0.2595
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1081, 0.1081, 0.1083, 0.1074, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1081, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1079, 0.1086, 0.1083, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1076, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1083,
         0.1080],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1083, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1083, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5190413
Epoch1179: train_loss: 4.0437 recon_acc: 0.5579 val_roc: 0.7756 val_ap: 0.8385 f1: 0.7082 time: 0.2688
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1083, 0.1074, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1087, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1076, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5192208
Epoch1180: train_loss: 4.0437 recon_acc: 0.5583 val_roc: 0.7756 val_ap: 0.8385 f1: 0.7082 time: 0.2827
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1083, 0.1074, 0.1081, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1087, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1076, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1081, 0.1077, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5194016
Epoch1181: train_loss: 4.0436 recon_acc: 0.5587 val_roc: 0.7756 val_ap: 0.8385 f1: 0.7082 time: 0.2564
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1083, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1086, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1076, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1077, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5195807
Epoch1182: train_loss: 4.0436 recon_acc: 0.5591 val_roc: 0.7755 val_ap: 0.8384 f1: 0.7082 time: 0.2575
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1083, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1086, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1076, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1077, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5197607
Epoch1183: train_loss: 4.0436 recon_acc: 0.5595 val_roc: 0.7756 val_ap: 0.8385 f1: 0.7082 time: 0.2530
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1083, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1086, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1076, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1077, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.51993954
Epoch1184: train_loss: 4.0436 recon_acc: 0.5599 val_roc: 0.7756 val_ap: 0.8385 f1: 0.7097 time: 0.2728
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1083, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1086, 0.1078, 0.1076, 0.1086, 0.1082,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1076, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1077, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52011895
Epoch1185: train_loss: 4.0436 recon_acc: 0.5603 val_roc: 0.7756 val_ap: 0.8385 f1: 0.7097 time: 0.2831
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1083, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1086, 0.1078, 0.1075, 0.1086, 0.1082,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1077, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1082, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0417, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5213241
Epoch1186: train_loss: 4.0436 recon_acc: 0.5626 val_roc: 0.7756 val_ap: 0.8384 f1: 0.7099 time: 0.2954
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1083, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1086, 0.1078, 0.1075, 0.1086, 0.1081,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1077, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1081, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0418, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5213948
Epoch1187: train_loss: 4.0436 recon_acc: 0.5628 val_roc: 0.7756 val_ap: 0.8385 f1: 0.7099 time: 0.2520
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1083, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1080, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1086, 0.1078, 0.1075, 0.1086, 0.1081,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1080, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1077, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1081, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0418, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.521465
Epoch1188: train_loss: 4.0436 recon_acc: 0.5630 val_roc: 0.7756 val_ap: 0.8385 f1: 0.7099 time: 0.2519
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1083, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1079, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1086, 0.1078, 0.1075, 0.1086, 0.1081,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1079, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1077, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1081, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0418, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5208324
Epoch1189: train_loss: 4.0436 recon_acc: 0.5618 val_roc: 0.7757 val_ap: 0.8385 f1: 0.7111 time: 0.2637
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1083, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1079, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1086, 0.1078, 0.1075, 0.1086, 0.1081,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1091, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1079, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1083, 0.1085, 0.1078, 0.1091, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1077, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1081, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0418, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52100956
Epoch1190: train_loss: 4.0435 recon_acc: 0.5622 val_roc: 0.7757 val_ap: 0.8385 f1: 0.7126 time: 0.2633
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1082, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1079, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1086, 0.1078, 0.1075, 0.1086, 0.1081,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1090, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1079, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1082, 0.1085, 0.1078, 0.1090, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1077, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1081, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0418, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5211877
Epoch1191: train_loss: 4.0435 recon_acc: 0.5625 val_roc: 0.7757 val_ap: 0.8385 f1: 0.7126 time: 0.2711
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1082, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1079, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1086, 0.1078, 0.1075, 0.1086, 0.1081,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1090, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1079, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1082, 0.1085, 0.1078, 0.1090, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1077, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1081, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0418, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52136415
Epoch1192: train_loss: 4.0435 recon_acc: 0.5629 val_roc: 0.7757 val_ap: 0.8386 f1: 0.7126 time: 0.2808
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1082, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1079, 0.1085, 0.1075, 0.1077, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1086, 0.1078, 0.1075, 0.1086, 0.1081,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1090, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1079, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1082, 0.1085, 0.1078, 0.1090, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1077, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1081, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0418, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5215421
Epoch1193: train_loss: 4.0435 recon_acc: 0.5633 val_roc: 0.7756 val_ap: 0.8386 f1: 0.7126 time: 0.2542
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1082, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1079, 0.1085, 0.1075, 0.1076, 0.1085,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1086, 0.1078, 0.1075, 0.1086, 0.1081,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1090, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1079, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1082, 0.1085, 0.1078, 0.1090, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1076, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1085, 0.1081, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0418, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5217178
Epoch1194: train_loss: 4.0435 recon_acc: 0.5637 val_roc: 0.7757 val_ap: 0.8386 f1: 0.7126 time: 0.2491
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1082, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1079, 0.1085, 0.1075, 0.1076, 0.1084,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1087, 0.1086, 0.1078, 0.1075, 0.1086, 0.1081,
         0.1085],
        [0.1080, 0.1084, 0.1087, 0.0000, 0.1084, 0.1090, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1079, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1082, 0.1085, 0.1078, 0.1090, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1076, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1084, 0.1081, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0418, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.52189535
Epoch1195: train_loss: 4.0435 recon_acc: 0.5640 val_roc: 0.7756 val_ap: 0.8385 f1: 0.7126 time: 0.2618
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1082, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1079, 0.1085, 0.1075, 0.1076, 0.1084,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1086, 0.1086, 0.1078, 0.1075, 0.1086, 0.1081,
         0.1085],
        [0.1080, 0.1084, 0.1086, 0.0000, 0.1084, 0.1090, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1079, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1082, 0.1085, 0.1078, 0.1090, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1076, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1084, 0.1081, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0418, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5220097
Epoch1196: train_loss: 4.0435 recon_acc: 0.5643 val_roc: 0.7756 val_ap: 0.8386 f1: 0.7126 time: 0.2642
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1082, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1079, 0.1085, 0.1075, 0.1076, 0.1084,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1086, 0.1086, 0.1078, 0.1075, 0.1086, 0.1081,
         0.1085],
        [0.1080, 0.1084, 0.1086, 0.0000, 0.1084, 0.1090, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1079, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1082, 0.1085, 0.1078, 0.1090, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1076, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1084, 0.1081, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0418, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5220757
Epoch1197: train_loss: 4.0435 recon_acc: 0.5644 val_roc: 0.7756 val_ap: 0.8386 f1: 0.7126 time: 0.2814
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1082, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1079, 0.1085, 0.1075, 0.1076, 0.1084,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1086, 0.1086, 0.1078, 0.1075, 0.1086, 0.1081,
         0.1085],
        [0.1080, 0.1084, 0.1086, 0.0000, 0.1084, 0.1090, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1079, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1082, 0.1085, 0.1078, 0.1090, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1076, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1084, 0.1081, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0418, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.522141
Epoch1198: train_loss: 4.0435 recon_acc: 0.5646 val_roc: 0.7756 val_ap: 0.8386 f1: 0.7126 time: 0.2732
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1082, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1079, 0.1085, 0.1075, 0.1076, 0.1084,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1086, 0.1086, 0.1078, 0.1075, 0.1086, 0.1081,
         0.1085],
        [0.1080, 0.1084, 0.1086, 0.0000, 0.1084, 0.1090, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1079, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1082, 0.1085, 0.1078, 0.1090, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1076, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1084, 0.1081, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0418, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.522206
Epoch1199: train_loss: 4.0435 recon_acc: 0.5647 val_roc: 0.7757 val_ap: 0.8387 f1: 0.7126 time: 0.2515
difference_matrix tensor([[0.0000, 0.1082, 0.1083, 0.1080, 0.1081, 0.1082, 0.1074, 0.1080, 0.1084,
         0.1085],
        [0.1082, 0.0000, 0.1088, 0.1084, 0.1079, 0.1084, 0.1075, 0.1076, 0.1084,
         0.1079],
        [0.1083, 0.1088, 0.0000, 0.1086, 0.1086, 0.1078, 0.1075, 0.1086, 0.1081,
         0.1085],
        [0.1080, 0.1084, 0.1086, 0.0000, 0.1084, 0.1090, 0.1082, 0.1079, 0.1084,
         0.1082],
        [0.1081, 0.1079, 0.1086, 0.1084, 0.0000, 0.1079, 0.1086, 0.1082, 0.1086,
         0.1084],
        [0.1082, 0.1084, 0.1078, 0.1090, 0.1079, 0.0000, 0.1089, 0.1079, 0.1087,
         0.1083],
        [0.1074, 0.1075, 0.1075, 0.1082, 0.1086, 0.1089, 0.0000, 0.1075, 0.1082,
         0.1080],
        [0.1080, 0.1076, 0.1086, 0.1079, 0.1082, 0.1079, 0.1075, 0.0000, 0.1086,
         0.1081],
        [0.1084, 0.1084, 0.1081, 0.1084, 0.1086, 0.1087, 0.1082, 0.1086, 0.0000,
         0.1087],
        [0.1085, 0.1079, 0.1085, 0.1082, 0.1084, 0.1083, 0.1080, 0.1081, 0.1087,
         0.0000]], device='cuda:3', grad_fn=<SubBackward0>)
Contrastive Loss tensor(0.0418, device='cuda:3', grad_fn=<DivBackward0>)
torch.Size([3327, 3327])
thresh 0.5222704
Epoch1200: train_loss: 4.0434 recon_acc: 0.5649 val_roc: 0.7757 val_ap: 0.8387 f1: 0.7126 time: 0.2531
Done! final results: test_roc: 0.7857 test_ap: 0.8419 test_f1: 0.7064 test_recon_acc: 0.4875
